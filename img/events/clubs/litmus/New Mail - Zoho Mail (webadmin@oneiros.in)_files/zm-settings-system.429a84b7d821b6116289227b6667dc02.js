"use strict";!function(){var a=zmail.Core.Namespaces,b=a.create("zmail.Settings.Modules"),c="zmail.Settings",d=function(b,d,e){var f="__namespace",g={create:"create","import":"get"}[b];return d=[c,d],"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))&&e.hasOwnProperty(f)&&(e=e[f]),"undefined"!=typeof e&&d.splice(1,0,e),d=d.join("."),a[g](d)},e=function(a,b){return d("create",a,b)},f=function(a,b){return e(a,b)},g=function(a,b){return d("import",a,b)},h=function(a,b){return g(a,b)};return window._defineSettingsModule=function(a,b,c){if(a=a||"",c=c||"",!a)throw new Error("[moduleName] is required");if("function"!=typeof b)throw new Error("[defineCallback] should be a function");c&&(a=[c,a].join("."));var d=e(a);if(!d)throw new Error("Module could not be created");return b(d,g,d),d},b.create=f,b["import"]=h,b}(),_defineSettingsModule("Utils",function(a){var b=function(a,b,c){return a=a||{},b=b||{},b=c===!0?$.extend(!0,b,a):$.extend(b,a)},c=function(a,b,c){for(a=a||window,b=c?b.split("."):[b];b.length&&"undefined"!=typeof a;)a=a[b.shift()];return a},d=function(a,b,c,d){a=a||window;var e;for(b=d?b.split("."):[b];b.length;)e=b.shift(),a[e]=a[e]||{},0===b.length?a[e]=c:a=a[e]},e=function(a,b){a=a||{},a[b]=void 0,delete a[b]},f=function(a){var b=_.clone(a);return b},g=function(a){var b={};return a=a||{},a.forEach(function(a){b[a]=a}),b},h=function(a,b){return function(){var c=this,d=Array.prototype.slice.apply(arguments);if(!(c instanceof b))throw new Error("Function called from invalid 'this' reference");return a.apply(c,d)}},i=function(a){a=a||{};var b=$.Deferred();return a.resolve===!0?b.resolve():a.reject===!0&&b.reject(),a.promise===!0&&(b=b.promise()),b},j=function(a){return!(!a||"function"!=typeof a.done||"function"!=typeof a.fail)},k=function(a){return!(!a||"function"!=typeof a.then)},l=function(){if(zmail.Settings.debug===!0){var a=Array.prototype.slice.apply(arguments);a.unshift("[zmail-settings-debug] > "),window.console.log.apply(window.console,a)}},m=function(){if(zmail.Settings.debug===!0){var a=Array.prototype.slice.apply(arguments);a.unshift("[zmail-settings-debug] > "),window.console.error?window.console.error.apply(window.console,a):window.console.log.apply(window.console,a)}},n=function(a){if(a&&a.constructor===Array){var b={};return a.forEach(function(a){b[a]=a}),Object.keys(b)}},o=function(){var a=function(a,b){var c=Array.prototype.filter.call(a,b);if(c&&c[0])return c[0]},b=function(a,b){return Array.prototype.find.call(a,b)};return"function"==typeof Array.prototype.find?b:a}();a.copyProperties=b,a.cloneObject=f,a.deleteProperty=e,a.getProperty=c,a.setProperty=d,a.listToMap=g,a.makePrivateMethod=h,a.makeDeferred=i,a.allDeferreds=$.when,a.isPromise=j,a.isNativePromise=k,a.debugLog=l,a.debugLogError=m,a.removeDuplicates=n,a.findInArray=o},"Platform.System"),_defineSettingsModule("Base",function(a){var b="_originalSubscriber",c="_proxySubscriber",d={},e=function(a,b){return a!==d&&b!==!0&&(a.hasOwnProperty("_eventSink")||(a._eventSink={}),a=a._eventSink),a},f=function(a,f,g,h){a=a||d,a=e(a,h);var i=g;return h||(g=function(a,b){i(b,a)},g[b]=i,i[c]=g),$(a).on(f,g),g},g=function(a,f,g,h){return a=a||d,a=e(a,h),!h&&g&&(g[c]?g=g[c]:g[b]&&(g=g[b])),$(a).off(f,g),g},h=function(a,b,c,f){a=a||d,a=e(a,f),c=c||{},$(a).trigger(b,c)},i=function(a,b,c){if(a||b||c)return f(a,b,c,!0)},j=function(a,b,c){if(a||b)return g(a,b,c,!0)},k=function(a,b,c){if(a||b)return h(a,b,c,!0)};a.subscribeEvent=f,a.unsubscribeEvent=g,a.publishEvent=h,a.bindEvent=i,a.unbindEvent=j,a.triggerEvent=k},"Platform.Events"),_defineSettingsModule("Utils",function(a,b){var c=b("Platform.Events.Base"),d=b("Platform.System.Utils"),e=function(a,b,c){c?$(c).before(a):b&&$(b).append(a)},f=function(a){$(a).remove()},g=function(a,b){switch(b=b||{},b.animation){case"slide":$(a).slideDown(b.duration);break;case"fade":$(a).fadeIn(b.duration);break;case"custom":b.custom(a);break;default:$(a).show()}},h=function(a,b){switch(b=b||{},b.animation){case"slide":$(a).slideUp(b.duration);break;case"fade":$(a).fadeOut(b.duration);break;case"custom":b.custom(a);break;default:$(a).hide()}},i=function(a){var b=$("<div />");return b.html(a),b=$(b.children(0))[0]},j=function(a,b){$(a).text(b)},k=function(a,b){$(a).css("background-color",b)},l=function(a,b){$(a).html(b)},m=function(a,b,c){c=c||"ref",a=$(a);var d,e,f,g=$("["+c+"]",a),h={};for(g=g||[],$(a).attr(c)&&g.push($(a)[0]),d=0,e=g.length;d<e;d++)f=g[d],h[$(f).attr(c)]=$(f)[0],b&&$(f).removeAttr(c);return h},n=function(a,b){return $(a).hasClass(b)},o=function(a,b){$(a).addClass(b)},p=function(a,b){$(a).removeClass(b)},q=function(a,b){$(a).toggleClass(b)},r=function(a,b,c){$(a).attr(b,c)},s=function(a,b){r(a,"class",b)},t=function(a,b){return $(a).attr(b)},u=function(a,b){return $(a).removeAttr(b)},v=function(a,b,c){$(a).css(b,c)},w=function(a,b){$(a).css(b,"")},x=function(a,b){return $(a).css(b)},y=function(a,b){b=b||{},a&&"A"===a.nodeName&&$(a).on("contextmenu",function(){return!1})},z=function(a,b){a&&a.stopPropagation&&(a.stopPropagation(),b&&a.preventDefault&&a.preventDefault())},A=function(a){return a?a.getBoundingClientRect():null},B=function(a){a=$(a),a=a[0],a&&(a.scrollTop=0)},C=function(a,b){_zm.succErrMsg("s",a,b)},D=function(a,b){_zm.succErrMsg("e",a,b)},E=function(a,b){_zm.succErrMsg("i",a,b)},F=function(a,c){var e=b("Platform.System.Base"),f=e.Error;a instanceof f?D(a.errorMessage,c):d.debugLogError?d.debugLogError(a,c):d.debugLog("[error] ",a,c)},G=function(a,b,d){return c.bindEvent(a,b,d)},H=function(a,b,d){return c.unbindEvent(a,b,d)},I=function(a,b,d){return c.triggerEvent(a,b,d)};a.bindEvent=G,a.unbindEvent=H,a.triggerEvent=I,a.addDOM=e,a.removeDOM=f,a.showDOM=g,a.hideDOM=h,a.constructDOM=i,a.setDOMText=j,a.setDOMColor=k,a.setDOMHtml=l,a.setDOMAttr=r,a.getDOMAttr=t,a.removeDOMAttr=u,a.addClass=o,a.removeClass=p,a.toggleClass=q,a.hasClass=n,a.setClass=s,a.getCSSProp=x,a.removeCSSProp=w,a.setCSSProp=v,a.getDOMReferenceMap=m,a.suppressAnchorEvents=y,a.stopEvent=z,a.getViewSize=A,a.showSuccessMessage=C,a.showErrorMessage=D,a.showInfoMessage=E,a.showException=F,a.resetScroll=B},"Platform.UI"),_defineSettingsModule("Constants",function(a){var b={UNDEFINED:void 0,NULL:null,NAN:NaN,INFINITY:1/0},c={MAILSUITE_APP_CORE:"zm-settings-mailsuite-appcore"};a.PrimitiveValues=b,a.ModuleList=c},"Platform.System"),_defineSettingsModule("Base",function(a){var b=function(){};a.Atom=b},"Platform.System"),_defineSettingsModule("Base",function(a,b,c){var d=c.Atom,e=function(){};e.prototype=new d,e.prototype.constructor=e,a.Class=e},"Platform.System"),_defineSettingsModule("Base",function(a){var b=function(a,b){this.errorMessage=a,this.opts=b||{}};a.Error=b},"Platform.System"),_defineSettingsModule("Base",function(a,b,c){var d=c.Error,e=function(a){this.message=a||"Cannot invoke Abstract method"};e.prototype=new d,e.prototype.constructor=e,a.AbstractMethodError=e},"Platform.System"),function(a,b){var c=b("Events"),d=b("InternalAPI"),e=a("Platform.Events.Base"),f=a("Platform.System.Utils"),g=zmail.Settings,h=!1;c.on=function(a,b){return e.subscribeEvent(c,a,b)},c.off=function(a,b){return e.unsubscribeEvent(c,a,b)},d.publishEvent=function(a,b){return e.publishEvent(c,a,b)};var i=function(b){b=b||{};var c=a("Platform.Components"),e=c.SettingManager,g=[];e.getAll().forEach(function(a){var b,c=a.getAttribute("id"),e=a.getState();e.initialized||(a._persister?(b=a.initialize(),f.isPromise(b.promise)&&g.push(b.promise)):d.publishEvent("setting/initialize/"+c,{setValue:function(b){a.initialize({value:b})}}))}),$.when(g).done(function(){b.deferred&&b.deferred.resolve()}).fail(function(){b.deferred&&b.deferred.reject()})};g.initializeSystem=function(){var a=f.makeDeferred();if(h)return a.resolve().promise();var b=[],c=function(a){f.isPromise(a)&&b.push(a)};return d.publishEvent("initialize",{pushTask:c}),$.when(b).done(function(){zmail.Settings.Platform.External.loadSettingsCore().always(function(){i({deferred:a})})}).fail(a.reject),a.done(function(){h=!0,d.publishEvent("initialized")}),a.promise()}}(zmail.Settings.Modules["import"],zmail.Settings.Modules.create);