"use strict";define([],function(a){var b=a("zmail.Core.Namespaces"),c=a("zmail.Utils.DOM"),d=b.create("zmsDialog");return d.templates=d.templates||{},$.extend(d.templates,{tabsDialogTemplate:function(a){return c.element(zdom("div",{className:"SC_Pop SC_cent wht",id:a+"_tabPopupDialog"},zdom("div",{className:"SC_pe SC_PopTop"},zdom("div",{className:"SC_PU"},zdom("div",{className:"SC_PUtt"},zdom("div",{className:"SC_flt"},zdom("ul",{id:a+"_tabContainer",className:"SCS_tab"})),zdom("div",{id:a+"_tabIconCont",className:"SC_frt"}),zdom("div",{className:"SCmb"},zdom("div",{id:a+"_closeIcon",className:"SC_frt"},zdom("ul",null,zdom("li",null,zdom("b",null,zdom("div",{className:"SC_hd"}),zdom("span",{className:"SC_ttip ttr","data-tooltip":"Close"},zdom("i",{className:"msi-close"})))))))),zdom("div",{className:"SC_PUcen",style:{overflow:"auto"}})))))},listingBox:function(){return c.element(zdom("div",null))},buttonTemplate:function(){return c.element(zdom("span",{className:"sel"}))},headerTemplate:function(){return c.element(zdom("li",null))},iconTemplate:function(){return c.element(zdom("li",null,zdom("b",null,zdom("span",null,zdom("i",null)))))},tabTextBox:function(){return c.element(zdom("span",null))},iconContainer:function(){return c.element(zdom("div",{className:"SCmb SC_flt"},zdom("ul",null)))},buttonContainer:function(){return c.element(zdom("div",{className:"SC_PUbtm"}))},succErrMsgBox:function(){return c.element(zdom("div",{style:{display:"none"},className:"SC_msg SC_emsg"},zdom("span",null,zdom("font",null),zdom("i",{className:"msi-close"}))))},dialogTitle:function(){return c.element(zdom("h3",{style:{paddingBottom:"20px"}}))}},!0),d}),define([],function(a){function b(){var a,b=this;s=v.keybindings.getScope(),a={allowDefaultScope:!1,shortcuts:[{uid:"close",keyStr:"esc",actions:[function(){b.close()}]}],scope:"tabDialog"},Array.isArray(b.configOption.shortcuts)&&(a.shortcuts=a.shortcuts.concat(b.configOption.shortcuts)),v.keybindings.registerAll(a),v.keybindings.setScope("tabDialog")}function c(a){return w.element(z.tabsDialogTemplate(a))}function d(a){var b=w.element(document.body),c=b.height(),d=b.width();c=65*c/100,d=75*d/100,a.$el.find("."+a.contentClass).css({"max-height":c+"px","max-width":d+"px",width:60*d/100+"px"}),a.$el.find("."+a.contentWrapperClass).css({"max-width":d+"px"}),a.$el.find("."+a.positionWrapperClass).css({top:10*c/100+"px"})}function e(a,b){a.addClass(b)}function f(a,b){a.css(b)}function g(a,b){a.attr(b)}function h(a){a.hide()}function i(a,b,c){var d=w.element(z.headerTemplate());return b.id&&(d[0].id=b.id),b.text&&d.text(b.text),d.on("click",function(){var a,e=Number(d.attr("tabid"));e!==c.selectedTabId&&(a=c.tabsInfo[e],d.addClass("stSel"),c.hideTab(c.selectedTabId,!0),c.showTab(e),!b.onClk||a.dataLoaded&&!b.forceCall||(b.hideButtons&&!a.dataLoaded&&c.getButtonContainer().addClass("SC_vh"),b.onClk(c,e,a.dataLoaded)),a.dataLoaded=!0)}),b.selected&&(e(d,"stSel"),c.selectedTab=d),b.classes&&e(d,b.classes),b.styles&&f(d,b.styles),b.attr&&g(d,b.attr),b.hide&&h(d),d}function j(a){var b=w.element(z.listingBox());return a.id&&(b[0].id=a.id),a.ele&&w.__dangerouslySetInnerHTML(b,a.ele),a.classes&&e(b,a.classes),a.styles&&f(b,a.styles),a.attr&&g(b,a.attr),a.parEle&&a.parEle.append&&(w.mount(b,a.parEle),b=a.parEle),a.hide&&h(b),b}function k(a,b,c){var d=w.element(z.buttonTemplate());return a.id&&(d[0].id=a.id,c.id=a.id),a.text&&d.text(a.text),a.onClk&&(c.onClk=function(){a.onClk(b)},d.on("click",c.onClk)),a.classes&&e(d,a.classes),a.styles&&f(d,a.styles),a.attr&&g(d,a.attr),a.hide&&d.attr("style","display:none !important"),d}function l(a,b,c){var d,e=w.element(z.iconTemplate());return a.id&&(e[0].id=a.id,c.id=a.id),a.onClk&&(c.onClk=function(){e.find("b").addClass("SC_sel"),a.onClk(b)},e.on("click",c.onClk)),a.iconClass&&e.find("i").addClass(a.iconClass),a.selected&&e.find("b").addClass("SC_sel"),a.text&&(e.addClass("SCtxt"),d=w.element(z.tabTextBox()),d.text(a.text),w.mount(d,w.selector("span",e))),a.attr&&g(e,a.attr),a.hide&&h(e),e}function m(){var a=this.tabsInfo[this.selectedTabId];this.configOption.tabs[this.selectedTabId].hideButtons&&this.getButtonContainer().addClass("SC_vh"),a.onClick&&a.onClick(this),a.dataLoaded=!0}function n(a){this.configOption=a,this.id=a.id||"def_tab_dialog",this.selectedTabId=void 0,this.tabsInfo=[],this.tabNameMap={},this.$el=void 0,this.maskWrapperClass="SC_Pop",this.positionWrapperClass="SC_pe",this.contentWrapperClass="SC_PU",this.headerClass="SC_PUtt",this.contentClass="SC_PUcen",this.ignoreMouseDown=a.ignoreMouseDown,this.onMouseDown=a.onMouseDown}function o(a,b){this.$tabEle=a,this.$buttons=void 0,this.$icons=void 0,this.$centerElem=void 0,this.$errBand=void 0,this.isSelected=b,this.onCancel=void 0,this.onClick=void 0,this.removeloadingband=function(){},this.dataLoaded=!1,this.tabId=void 0,this.iconsInfo=[],this.buttonsInfo=[]}function p(a,b){this.id=void 0,this.$iconEle=a,this.isSelected=b,this.onClk=function(){}}function q(a,b){this.id=void 0,this.$buttonEle=a,this.isSelected=b,this.onClk=function(){}}function r(a){var b=new n(a);return b.create(),b}var s,t=a("zmText"),u=a("zmail.Core.Namespaces"),v=a("zmComponent"),w=a("zmail.Utils.DOM"),x=t.get("dialog"),y=u.create("zmsDialog"),z=y.templates;return n.prototype={customizeDialog:function(){var b=this.configOption,c=this,d=this.id,e=this,f=this.$el.find("#"+d+"_closeIcon");if(b.classes&&this.$el.addClass(b.classes),b.hideCloseIcon?f.hide():f.on("click",function(){c.close(c)}),this.ignoreMouseDown||this.$el.on("mousedown mouseup",function(b){a("zmUtil").stopEvents(b,!0),"function"==typeof e.onMouseDown&&e.onMouseDown(b,e)}),b.title){var g=w.element(z.dialogTitle()),h=this.$el.find(".SC_PUtt .SC_flt");g.text(b.title),w.mountAtStart(g,h),h.find(" .SCS_tab").css("clear","both"),w.mountAfter(h.find(" .SCS_tab"),this.$el.find(".SC_PUtt .SC_frt").eq(0))}},close:function(){this.$el.remove(),s&&v.keybindings.setScope(s),v.keybindings.dropScope("tabDialog"),this.configOption.onClose&&this.configOption.onClose()},create:function(){var a,e=c(this.id),f=this.configOption,g=w.element(document.body);w.mount(e,g),this.$el=e,d(this),a=f.tabs,b.call(this),this.createTabs(a),this.customizeDialog(),m.call(this),f.dialogDidMount&&f.dialogDidMount(this)},createTabs:function(a,b){for(var c,d,e,f,g,h,j=a.length,k=0;k<j;k++)c=a[k],d=b||k,c.attr?c.attr.tabid=d:c.attr={tabid:d},this.tabNameMap[c.tabName]=d,e=i(this.id,c,this),f=new o(e,(!1)),w.mount(e,this.$el.find("#"+this.id+"_tabContainer")),c.selected&&(f.isSelected=!0,this.selectedTabId=k),g=c.icons?this.createIcons(c.icons,d,c.selected):null,f.$icons=null!==g&&g.$iconCont?g.$iconCont:null,f.iconsInfo=null!==g&&g.iconsInfo?g.iconsInfo:[],h=c.buttons?this.createButtons(c.buttons,d,c.selected):null,f.$buttons=null!==h&&h.$buttonCont?h.$buttonCont:null,f.buttonsInfo=null!==h&&h.buttonsInfo?h.buttonsInfo:[],c.listingArea||(c.listingArea={}),f.$centerElem=c.listingArea?this.createListingArea(c.listingArea,d,c.selected):null,f.$errBand=this.createErrBand(),f.onClick=c.onClk,f.name=c.tabName,c.hideCloseButton||this.createCloseButton(d,f),this.tabsInfo.push(f)},createErrBand:function(){var a=w.element(z.succErrMsgBox()),b=this;return a.find("i").off("click").on("click",function(){b.hideSuccErrMsg()}),w.mount(a,this.$el.find(".SC_pe")),a},createIcons:function(a,b,c){var d,e,f,g=a.length,h=this.$el.find("#"+b+"_tabIcons"),i=[];h.length||(h=w.element(z.iconContainer()),h.attr("id",b+"_tabIcons"),w.mount(h,this.$el.find("#"+this.id+"_tabIconCont"))),c||h.hide();for(var j=0;j<g;j++)d=a[j],e=new p((void 0),(!1)),f=l(d,this,e),e.$iconEle=f,w.mount(f,h.find("ul")),i.push(e);return{$iconCont:h,iconsInfo:i}},createButtons:function(a,b,c){var d,e,f,g,h=this.$el.find("#"+b+"_tabPopupButton"),i=[];h.length||(h=w.element(z.buttonContainer()),h.attr("id",b+"_tabPopupButton"),w.mount(h,this.$el.find(".SC_PU"))),c||h.hide(),d=a.length;for(var j=0;j<d;j++)e=a[j],f=new q((void 0),(!1)),g=k(e,this,f),f.$buttonEle=g,w.mount(g,this.$el.find("#"+b+"_tabPopupButton")),i.push(f);return{$buttonCont:h,buttonsInfo:i}},createListingArea:function(a,b,c){var d;return c||(a.hide=!0),d=j(a),w.mount(d,this.$el.find("."+this.contentClass)),d},replaceButtons:function(a,b){var c=b?this.getTabNumberByTabName(b):this.selectedTabId,d={},e=c===this.selectedTabId,f=this.tabsInfo[c];f.$buttons&&w.clearHTML(f.$buttons),d=this.createButtons(a,c,e),f.$buttons=d&&d.$buttonCont?d.$buttonCont:null,f.buttonsInfo=d&&d.buttonsInfo?d.buttonsInfo:[]},replaceIcons:function(a,b){var c,d=b?this.getTabNumberByTabName(b):this.selectedTabId,e={},f=d===this.selectedTabId;c=this.tabsInfo[d],c.$icons&&w.clearHTML(c.icons),e=this.createIcons(a,d,f),c.$icons=e&&e.$iconCont?e.$iconCont:null,c.iconsInfo=e&&e.iconsInfo?e.iconsInfo:[]},replaceCenterArea:function(a,b){var c=b?this.getTabNumberByTabName(b):this.selectedTabId;"string"==typeof a&&(a=w.__dangerouslyParseHTML(a)),w.__dangerouslySetInnerHTML(a,this.tabsInfo[c].$centerElem)},createCloseButton:function(a,b){var c,d=a||this.selectedTabId,e=[],f={},g=this,h=b||this.tabsInfo[d],i=Boolean(h.isSelected);f.text=x.cancel,f.attr={"data-val":"Cancel"},f.onClk=function(){g.close(g),g.tabsInfo[d]&&g.tabsInfo[d].onCancel&&g.tabsInfo[d].onCancel()},e.push(f),c=this.createButtons(e,d,i),h.$buttons=c&&c.$buttonCont?c.$buttonCont:null,h.buttonsInfo.concat(c&&c.buttonsInfo?c.buttonsInfo:[])},createNewTab:function(a){var b=[],c=this.tabsInfo.length;b.push(a),this.createTabs(b,c)},createNewButton:function(a,b){var c,d=b?this.getTabNumberByTabName(b):this.selectedTabId,e=[],f=this.tabsInfo[d];e.push(a),c=this.createButtons(e,d,f.isSelected),f.$buttons=c&&c.$buttonCont?c.$buttonCont:null,f.buttonsInfo.concat(c&&c.buttonsInfo?c.buttonsInfo:[])},createNewIcon:function(a,b){var c=b?this.getTabNumberByTabName(b):this.selectedTabId,d=[],e={},f=this.tabsInfo[c];d.push(a),e=this.createIcons(d,c,f.isSelected),f.$icons=e&&e.$iconCont?e.$iconCont:null,f.iconsInfo.concat(e&&e.iconsInfo?e.iconsInfo:[])},getAllIconsInfo:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId;return this.tabsInfo[b].iconsInfo},getAllButtonsInfo:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId;return this.tabsInfo[b].buttonsInfo},getSelectedTab:function(){return this.tabsInfo[this.selectedTabId].$tabEle},getCenterElem:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId;return this.tabsInfo[b].$centerElem},getIconContainer:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId;return this.tabsInfo[b].$icons},getButtonContainer:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId;return this.tabsInfo[b].$buttons},getSelectedTabId:function(){return Number(this.tabsInfo[this.selectedTabId].$tabEle.attr("tabid"))},getTabNumberByID:function(a){return Number(this.$el.find("#"+a).attr("tabid"))},getTabNumberByTabName:function(a){return this.tabNameMap[a]},currentTab:function(){return this.tabsInfo[this.selectedTabId].name},showTab:function(a){var b=this.tabsInfo[a],c=b.$errBand;b.$tabEle.show().addClass("stSel"),b.$icons&&b.$icons.show(),b.$buttons&&b.$buttons.show(),b.$centerElem&&b.$centerElem.show(),c.attr("visibilityInUI")&&c.show(),this.selectedTabId=a,b.isSelected=!0},hideTab:function(a,b){var c=this.tabsInfo[a];b||c.$tabEle.hide(),c.$tabEle.removeClass("stSel"),c.$icons&&c.$icons.hide(),c.$buttons&&c.$buttons.hide(),c.$centerElem&&c.$centerElem.hide(),c.$errBand.hide(),c.isSelected=!1},showLoadingBand:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId,c=this.tabsInfo[b];c.removeloadingband=v.loadingBand({container:c.$centerElem[0],type:"pagination"})},removeLoadingBand:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId,c=this.tabsInfo[b];c.removeloadingband&&(c.removeloadingband(),c.removeloadingband=void 0)},setDataLoaded:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId,c=this.tabsInfo[b];c.dataLoaded=!0,this.removeLoadingBand(b)},unsetDataLoaded:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId,c=this.tabsInfo[b];c.dataLoaded=!1},getDataLoaded:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId,c=this.tabsInfo[b];return c.dataLoaded},hideSuccErrMsg:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId,c=this.tabsInfo[b];c.$errBand.hide().removeAttr("visibilityInUI")},showSuccErrMsg:function(a,b,c,d){var e=c?this.getTabNumberByTabName(c):this.selectedTabId,f=this.tabsInfo[e],g=f.$errBand,h=this;void 0!==b&&(a=a||"e",a="w"===a?"i":a,g.find("font").text(b),g.show().attr({visibilityInUI:"true","class":"SC_msg SC_"+a+"msg"}),d&&window.setTimeout(function(){h.hideSuccErrMsg()},d))},showButtons:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId,c=this.tabsInfo[b].$buttons;c&&c.removeClass("SC_vh")},hideButtons:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId,c=this.tabsInfo[b].$buttons;c&&c.addClass("SC_vh")},showIcons:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId;this.tabsInfo[b].$icons.show()},hideIcons:function(a){var b=a?this.getTabNumberByTabName(a):this.selectedTabId;this.tabsInfo[b].$icons.hide()},setDialogDimension:function(a,b){var c=this.$el.find("."+this.contentClass);a&&c.css("height",a),b&&c.css("width",b)},setDialogPosition:function(a){var b=this.$el.find("."+this.positionWrapperClass);a&&(a.style&&b.css(a.style),a.classes&&b.addClass(a.classes))}},y.createTabPopupDialog=r,y});