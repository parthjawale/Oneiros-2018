"use strict";!function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Utils.CommonUtil");a(c)}(function(a){var b="Folder",c="Tag",d={Subject:{lhs:"Subject"},Sender:{lhs:"Sender"},"To/Cc":{lhs:"to/cc"},Content:{lhs:"content"},"Attachment Name":{lhs:"Attachment Name"},"Attachment Content":{lhs:"Attachment Content"},"Entire Message":{lhs:"entire message"},Has:{lhs:"entire message"}},e={"Has Attachment":{flagName:"hasAtt",value:"1"},"Has Flag":{flagName:"hasFlg",value:"1"},unread:{flagName:"unread",value:"1"},responseFilter:{flagName:"resp",value:"1/0"},conversation:{flagName:"thd",value:"1"}},f=function(a){var c=[];if(_(a).each(function(a){a.name===b&&c.push(a.value)}),c.length)return{folId:c}},g=function(a){var b=[];if(_(a).each(function(a){a.name===c&&b.push(a.value)}),b.length)return{labId:b}},h=function(a){var b={};return _(a).each(function(a){a.name in e&&(b[e[a.name].flagName]=a.value)}),b},i=function(a){var b=new msSearchCollection,c=[];return _(a).each(function(a){a.name in d&&c.push({lhs:d[a.name].lhs,value:a.value,contains:!0})}),b.searchQueryArr=c,{SearchStr:b.getSearchQueryFromArr()}},j=function(a){var b={accId:zmail.accId};return _.extend(b,h(a),i(a),f(a),g(a))};a.mailQueryConverter=j}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Utils.CommonUtil");a(c)}(function(a){var b=zmail.Utils.DOM;a.genereateMailRow=function(a){_.isArray(a)||(a=[a]);var c=b.element(document.createDocumentFragment());return _(a).each(function(a){var d=null;d=b.element(zdom("div",{style:{borderBottomStyle:"dotted"}},zdom("span",null,"From: "," + ",a.F),zdom("br",null),zdom("strong",null,a.SB),zdom("span",null,a.SM))),b.mount(d,c)}),c}}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=c.newType(a.ContactFilter,{className:"SenderFilter",name:"sender",description:"attachment sent/shared by",multipleInstance:!1});a.SenderFilter=d}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=b("zmail.ContactBook"),f=zmText.get("search-impl"),g=c.newType(a.ContactFilter,{className:"GroupFilter",name:f.commonfilter.ingrp,description:f.commondesc.ingrp,valueType:d.Group.name,defaultValue:function(){var a=b("zmStreamsApp.events.getCurrentGroupId");if(a){var c=a();if(e.isGroup(c))return e.getGroups(c)[0]}},values:function(a){a=(a||"").toLowerCase();var b,c=e.getGroups(a,{includeGroupHome:!0,includeAllGroups:!0,containsSearch:!0});zmAppLoader.load("streamsApp").then(function(){b=zmStreamsApp.events.getCurrentGroupId()});var d,f=_.pluck(c,"attrs");if(e.isGroup(b)){for(d=0;d<f.length&&b!==f[d].id;d++);var g=c[d];c.splice(d,1),c.splice(0,0,g)}return c},restrictedToValues:!0,multipleInstance:!1,filterProps:["name","eid"],getValue:function(){var a=this.value||{};return e.isGroup(a)?a.attrs.name:""},autofillText:function(a,b){return e.isGroup(a)?a.get("name"):""},validate:function(a){if(e.isGroup(a))return!0}});a.GroupFilter=g}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=zmText.get("search-impl"),f=c.newType(a.BaseFilter,{className:"EntityFilter",name:e.streamsFilter.filterby,description:e.streamsdesc.filterby,value:"",valueType:d.EntityType.name,values:["emails","notes","tasks","events","messages","bookmarks"],multipleInstance:!1,restrictedToValues:!0,removeDependentFilters:[]});a.EntityFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl","attachment"),e=c.newType(a.StringFilter,{className:"AttachmentContentFilter",name:d.filter.contains,description:d.description.contains,multipleInstance:!1});a.AttachmentContentFilter=e}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=zmText.get("search-impl","attachment"),f=c.newType(a.StringFilter,{className:"AttachmentTypeFilter",name:e.filter.filetype,description:e.description.filetype,value:"",multipleInstance:!1,values:d.AttachmentType.values,valueType:d.AttachmentType.name});a.AttachmentTypeFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl","attachment"),e=c.newType(a.StringFilter,{className:"AttachmentNameFilter",name:d.filter.attachmentname,description:d.description.attachmentname,multipleInstance:!1});a.AttachmentNameFilter=e}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl","attachment"),e=c.newType(a.SenderFilter,{className:"AttachmentSenderFilter",name:d.filter.from,description:d.description.from,multipleInstance:!1});a.AttachmentSenderFilter=e}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=c.newType(a.StringFilter,{className:"AttachmentDocTypeFilter",name:"attachment type",description:"attachment of type",value:"",multipleInstance:!1,values:d.AttachmentDocType.values,valueType:d.AttachmentDocType.name});a.AttachmentDocTypeFilter=e}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=c.newType(a.EntityFilter,{className:"AttachmentEntityFilter",name:"attachment from",description:"attachments from",autofillNotAfter:[{className:"InMail"}],value:"",values:d.AttachmentEntityFilter.values,valueType:d.AttachmentEntityFilter.name});a.AttachmentEntityFilter=e}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl","attachment");a.AttachmentGroupFilter=c.newType(a.GroupFilter,{className:"AttachmentGroupFilter",name:d.filter.ingroup,description:d.description.ingroup,autofillNotAfter:[{className:"InMail"}],multipleInstance:!1})}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=1024,e=function(a){this.text=a.text||"",this.val={start:a.start||0,end:a.end||0}},f=function(a){return a.convertToKB&&(a.start*=d,a.end*=d),new e(a)},g=function(){var a=window.parseInt(zmUtil.sizeConv(zmail.maxAttSz)),b=1,c=5,e=[];for(e.push(f({text:"Lesser than 1 MB",start:1,end:1023}));c<a;)e.push(f({text:b+" to "+c+" MB",start:b,end:c,convertToKB:!0})),b=c+1,c+=5;return b-=1,e.push(f({text:"greater than "+b+" MB",start:b*d,end:100*d})),e};a.AttachmentSizeFilter=c.newType(a.BaseFilter,{className:"AttachmentSizeFilter",name:"attachment size",description:"select attachment size range",multipleInstance:!1,value:"",values:function(){return g()},getValue:function(){var a=this.value||{};if(a instanceof e)return a.text},autofillText:function(a,b){return a instanceof e?a.text:""},validate:function(a){return a instanceof e}})}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=zmText.get("search-impl"),f=c.newType(a.StringFilter,{className:"FolderFilter",name:e.mailfilter.folder,description:e.maildesc.folder,valueType:d.Folder.name,filterValues:!1,defaultValue:function g(){var a,b,g,c=zmfolAction.getMailFolderPaths(),d=zmInit.getListingDetObj()&&zmInit.getListingDetObj().fId;if(d)for(a=0;a<c.length;a++)if(b=c[a],b&&b.id===d){g=b;break}return g},autofillNotAfter:[{className:"ShareFolFilter"}],values:function(a){a=(a||"").toLowerCase();var b,c,d=$.extend(!0,[],zmfolAction.getMailFolderPaths()),e=zmInit.getListingDetObj()&&zmInit.getListingDetObj().fId;if(e&&e!==d[0].id)for(b=1;b<d.length;b++)if(c=d[b],c&&c.id===e){d.splice(b,1),d.unshift(c);break}return d.filter(function(b){return b.path.toLowerCase().indexOf(a)!==-1})},validate:function(a){if(!_.isObject(a))return!1;var b,c=["id","name","path"];for(b in c)if(!_.has(a,c[b]))return!1;return!0},restrictedToValues:!0,multipleInstance:!1,filterProps:["path"],getValue:function(){var a=this.value||{};return a.path||""},autofillText:function(a){return a.path}});a.FolderFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=c.newType(a.BaseFilter,{className:"TagFilter",name:"tag",description:"has a tag",valueType:d.Tag.name,values:function(){return _.toArray(zmail.zohoAccLabInfo)},restrictedToValues:!0,multipleInstance:!1,filterProps:["label"],getValue:function(){var a=this.value||{};return a.label||""},autofillText:function(a){return a.label}});a.TagFilter=e}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=c.newType(a.ContactFilter,{className:"HasFilter",name:"contains"});a.HasFilter=d}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("_"),d=b("zmail.Search.Utils.TypeCreator"),e=b("zmail.ContactBook"),f=b("zmail.ValueTypeInferrer.TYPES"),g=d.newType(a.ContactFilter,{className:"ContactGroupFilter",name:"contact-group",valueType:f.Contact.name,validateValueTpe:!0,restrictedToValues:!0,multipleInstance:!1,filterValues:!1,values:function(a){return c.isEmpty(a)?e.getMostUsedContacts():e.get({str:a,includeAllGroups:!0,type:"org"})},getValue:function(){var a=this.value||{};return e.isContact(a)?a.attrs.fn||a.name:e.isGroup(a)?a.attrs.name:""},autofillText:function(b,c){return e.isGroup(b)?b.get("name"):a.ContactFilter.autofillText(b,c)},validate:function(a){return e.isContact(a)||e.isGroup(a)}});a.ContactGroupFilter=g}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=c.newType(a.BaseFilter,{className:"MailReminderFilter",name:d.mailfilter.remindertype,description:d.maildesc.remindertype,values:function f(){var f=[{name:d.mailfilter.reminder_nocondition,value:"1"},{name:d.mailfilter.reminder_noreply,value:"2"},{name:d.mailfilter.reminder_everyreply,value:"3"},{name:d.mailfilter.reminder_executed,value:"4"}];return f},filterProps:["name"],getValue:function(){var a=this.value||{};return void 0===a.name?"":a.name},autofillText:function(a){return a.name},restrictedToValues:!0,multipleInstance:!1,validate:function(){var a=this.value||{};return void 0!==a.name},dependedOn:["EntireMessage","Sender","ToOrCc","Subject","EmailContent","AttachmentName","AttachmentContent","AttachmentType","To","Cc","EntireMessageExclude","SenderExclude","ToOrCcExclude","SubjectExclude","EmailContentExclude","AttachmentNameExclude","AttachmentContentExclude","ToExclude","CcExclude"]});a.MailReminderFilter=e}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=[{severity:"High","const":2},{severity:"Medium","const":3},{severity:"Low","const":4}],f=c.newType(a.BaseFilter,{className:"MailPriorityFilter",name:d.mailfilter.priority,description:d.maildesc.priority,multipleInstance:!1,values:function(){return e},restrictedToValues:!0,filterProps:["severity"],getValue:function(){var a=this.value||{};return a.severity||""},autofillText:function(a){return a.severity},dependedOn:["EntireMessage","Sender","SentBy","ToOrCc","Subject","EmailContent","AttachmentName","AttachmentContent","AttachmentType","To","Cc","EntireMessageExclude","SenderExclude","ToOrCcExclude","SubjectExclude","EmailContentExclude","AttachmentNameExclude","AttachmentContentExclude","ToExclude","CcExclude"]});a.MailPriorityFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=zmText.get("search-impl"),f="^[0-9]+(k?|m?)b?$",g=function(a){var b;return a=a.replace(/ /gi,"").toLowerCase(),a.indexOf("k")!==-1?b=a.substring(0,a.indexOf("k")):a.indexOf("m")!==-1?(b=parseInt(a.substring(0,a.indexOf("m"))),b*=1024,b.toString()):a.indexOf("b")!==-1?(b=parseInt(a.substring(0,a.indexOf("b"))),b/=1024,b.toString()):(b=1024*parseInt(a),b.toString())},h=c.newType(a.BaseFilter,{className:"MailSizeFilter",name:e.mailfilter.size,description:e.maildesc.size,valueType:d.String.name,findValue:g,getValue:function(){var a=this.value||{};return"string"==typeof a?a=g(a):""},restrictedToValues:!1,multipleInstance:!1,validate:function(a){if(a=a||this.value||{},"string"==typeof a){a=a.replace(/ /gi,"");var b=new RegExp(f,"i");return b.test(a)}return!1}});a.MailSizeFilter=h}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=c.newType(a.BaseFilter,{className:"MailFlagFilter",name:d.mailfilter.flagAs,description:d.maildesc.flagAs,values:function f(){var f=[{name:"Info",value:1},{name:"Important",value:2},{name:"Follow-up",value:3}];return f},filterProps:["name"],getValue:function(){var a=this.value||{};return void 0===a.name?"":a.name},autofillText:function(a){return a.name},restrictedToValues:!0,multipleInstance:!1,validate:function(){var a=this.value||{};return void 0!==a.name}});a.MailFlagFilter=e}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=zmText.get("search-impl"),f=c.newType(a.ContactFilter,{className:"EntireMessage",name:e.commonfilter.contains,description:e.maildesc.contains,valueType:d.String.name,removeDependentFilters:["HasAttachmentFilter","HasFlagFilter","HasReplyFilter","MailDateFilter","MailFromDateFilter","MailToDateFilter","MailReminderFilter","HasMailReminderFilter","ForwardFilter","HasInlineAttachmentFilter","MailPriorityFilter","FromSizeFilter","ToSizeFilter"]});a.HasMailFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=b("zmail.ContactBook"),f=b("zmail.Search.Models.Filters.ContactGroupFilter"),g=zmText.get("search-impl"),h=c.newType(a.StringFilter,{className:"HasStreamsFilter",name:g.commonfilter.contains,valueType:d.String.name,description:g.commondesc.contains,values:function(a){if(""!==a){if(a.startsWith("@")){var b=a.split("@");return b=b[1]?b[1]:"",""!==b?f.values(b):e.getMostUsedContacts()}if(0===a.indexOf("#")){a=a.substring(1,a.length);var c=zmStreamsApp.GroupApp.fetchHashTags();if(""!==a){for(var d=[],g=0;g<c.length;g++)c[g].name.toLowerCase().startsWith(a)&&d.push(c[g].name);return d}return c.map(function(a){return"#"+a.name})}return f.values(a)}},validate:function(a){if(!a&&(this.nullableOnly||this.nullable))return!0;if(this.restrictedToValues){var b=this.getValues();if(_.isArray(b))return _(b).contains(a)}else if(this.regexp instanceof RegExp)return this.regex.test(a);return Boolean(a)},filterValues:!1,autofillDOM:function(a){if(!_.isString(a))return f.autofillDOM(a)},autofillText:function(a){return _.isString(a)?a:f.autofillText(a)},getValue:function(){var a=this.value||{};return _.isString(a)?a:zmail.ContactBook.isGroup(a)?a.attrs.name:_.isFunction(a.name)?a.attrs&&a.attrs.fn||_.isFunction(a.name)&&a.name():a.name}});a.HasStreamsFilter=h}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=c.newType(a.BaseFilter,{className:"BooleanFilter",name:"boolean",nullableOnly:!0,multipleInstance:!1});a.BooleanFilter=d}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl","attachment");a.InStreams=c.newType(a.BooleanFilter,{className:"InStreams",name:d.filter.instreams,description:d.description.instreams,autofillNotAfter:[{className:"InMail"}],multipleInstance:!1}),a.InMail=c.newType(a.BooleanFilter,{className:"InMail",name:"in mail",description:"search in personal mail attachment",autofillNotAfter:[{className:a.AttachmentGroupFilter.className},{className:a.InStreams.className},{className:a.AttachmentEntityFilter.className}],multipleInstance:!1})}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=zmText.get("search-impl"),f=c.newType(a.StringFilter,{className:"HashtagFilter",name:e.commonfilter.hashtag,description:e.commondesc.hashtag,valueType:d.HashTag.name,filterValues:!1,values:function(a){var b,c=zmStreamsApp.GroupApp.fetchHashTags(),d=[];if(a&&""!==a&&"#"===a.charAt(0)&&(a=a.substring(1,a.length)),!a||""===a)return c;for(b=0;b<c.length;b++)c[b].name.toLowerCase().startsWith(a)&&d.push(c[b]);return d},validate:function(a){if(!a&&(this.nullableOnly||this.nullable))return!0;if(this.restrictedToValues){var b=this.getValues();if(_.isArray(b))return _(b).contains(a)}else if(this.regexp instanceof RegExp)return this.regex.test(a);return Boolean(a)},multipleInstance:!1,filterProps:["name"],getValue:function(){var a=this.value||{};return a.name||""},autofillText:function(a){return a.name}});a.HashtagFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=[{severity:"High","const":2},{severity:"Medium","const":3},{severity:"Low","const":4}],f=c.newType(a.BaseFilter,{className:"TaskPriorityFilter",name:d.taskfilter.priority,description:d.taskdesc.priority,multipleInstance:!1,values:function(){return e},restrictedToValues:!0,filterProps:["severity"],getValue:function(){var a=this.value||{};return a.severity||""},autofillText:function(a){return a.severity}});a.TaskPriorityFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c,d=b("zmail.Search.Utils.TypeCreator"),e=zmText.get("search-impl"),f=d.newType(a.BaseFilter,{className:"TaskProjectFilter",name:e.taskfilter.project,description:e.taskdesc.project,autofillOnlyAfter:[{className:"GroupFilter"}],multipleInstance:!1,values:function(){var a={};if(zmail.Search.Environment.has("GroupFilter")){var b=zmail.Search.Environment.get("GroupFilter")[0].toJSON(),d=c[b.obj.id];d&&Object.keys(d).length>0&&(a=_.toArray(d))}return a},restrictedToValues:!0,filterProps:["categoryName"],getValue:function(){var a=this.value||{};return a.categoryName||""},autofillText:function(a){return a.categoryName},afterInit:function(){zmUtil.requireTaskModule("taskUtil").done(function(a){c=a.Categories()})}});a.TaskProjectFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=[{status:"In progress","const":2},{status:"Complete","const":3}],f=c.newType(a.BaseFilter,{className:"TaskStatusFilter",name:d.taskfilter.status,description:d.taskdesc.status,multipleInstance:!1,values:function(){return e},restrictedToValues:!0,filterProps:["status"],getValue:function(){var a=this.value||{};return a.status||""},autofillText:function(a){return a.status}});a.TaskStatusFilter=f}),function(a){a.call(zmail.Core.Namespaces.create("zmail.Search.Models.Filters"),zmail.Core.Namespaces.get)}(function(a){var b=a("zmail.Search.Utils.TypeCreator"),c=zmText.get("search-impl"),d=this.ContactFilter;this.TaskAssigneeFilter=b.newType(d,{name:c.taskfilter.assignee,className:"TaskAssigneeFilter",description:c.taskdesc.assignee,autofillNotAfter:[{className:"HasNoAssignee"}],multipleInstance:!1,values:function(a){var b=$.Deferred(),c=d.values(a),e=zmail.zuid;if(zmail.Search.Environment.has("GroupFilter")){var f=zmail.Search.Environment.get("GroupFilter")[0].toJSON();e=f.obj.get("id"),zmail.ContactBook.get({groupid:e,str:a}).done(function(a){b.resolve(a)})}else $.when(c).then(function(a){b.resolve(a)});return b.promise()},getValue:function(){var a=this.value||"";return _.isString(a)?a:a.name},autofillDOM:function(a){return d.autofillDOM(a)}})}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=[{repeatType:"Daily","const":1},{repeatType:"Weekly","const":2},{repeatType:"Monthly","const":3},{repeatType:"Yearly","const":4}],f=c.newType(a.BaseFilter,{className:"TaskRecurringFilter",name:d.taskfilter.recurring,description:d.taskdesc.recurring,multipleInstance:!1,values:function(){return e},restrictedToValues:!0,filterProps:["repeatType"],getValue:function(){var a=this.value||{};return a.repeatType||""},autofillText:function(a){return a.repeatType}});a.TaskRecurringFilter=f}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=b("zmail.ValueTypeInferrer.TYPES"),f=a.DateFilter,g=c.newType(f,{name:d.taskfilter.completeddate,className:"TaskCompletedDateFilter",description:d.taskdesc.completeddate,multipleInstance:!1,valueType:e.Date.name,autofillText:function(a){return a.display}});a.TaskCompletedDateFilter=g}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=b("zmail.ValueTypeInferrer.TYPES"),f=a.DateFilter,g=c.newType(f,{name:d.taskfilter.duedate,className:"TaskDueDateFilter",description:d.taskdesc.duedate,multipleInstance:!1,valueType:e.Date.name,autofillText:function(a){return a.display}});a.TaskDueDateFilter=g}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl"),e=d.notefilter,f=d.notedesc,g=c.newType(a.BaseFilter,{className:"NoteBookFilter",name:e.notebook,description:f.notebook,validateOnSet:!0,validate:function(a){return!_.isString(a)&&_.isObject(a)&&a.hasOwnProperty("id")&&a.hasOwnProperty("name")&&a.hasOwnProperty("display_text")},values:function(a){var b;if(zmail.Search.Environment.has("GroupFilter")){var c=zmail.Search.Environment.get("GroupFilter")[0].toJSON();b=c.obj.id}else b=zmail.zuid;return zmUtil.loadNoteCategories(b)},restrictedToValues:!0,multipleInstance:!1,filterProps:["display_text"],getValue:function(){var a=this.value||{};return a.display_text},autofillText:function(a){return a.display_text}});a.NoteBookFilter=g}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=b("zmail.ValueTypeInferrer.TYPES"),e=b("zmUtil"),f=zmText.get("search-impl"),g=f.notefilter,h=f.notedesc,i=c.newType(a.BaseFilter,{className:"NoteColorFilter",name:g.notecolor,valueType:d.NoteColor.name,values:function(){return e.noteColorArray},restrictedToValues:!0,multipleInstance:!1,filterProps:["dispname"],description:h.notecolor,getValue:function(){var a=this.value||{};return a.dispname},autofillText:function(a){return a.dispname}});a.NoteColorFilter=i}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=c.newType(a.StringFilter,{className:"NoteDescriptionFilter",name:"description",description:"text"});a.NoteDescriptionFilter=d}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=c.newType(a.StringFilter,{className:"NoteTitleFilter",name:"title",description:"text"});a.NoteTitleFilter=d}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Filters");a.call(c,c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Utils.TypeCreator"),d=zmText.get("search-impl","bookmark");a.LinkSearchKey=c.newType(a.HasStreamsFilter,{name:d.filter.contains,description:d.description.contains}),a.LinkGroup=c.newType(a.GroupFilter,{multipleInstance:!1}),a.LinkTitle=c.newType(a.StringFilter,{name:d.filter.ingroup,description:d.description.ingroup,multipleInstance:!1}),a.LinkCollection=c.newType(a.BaseFilter,{className:"LinkCollection",name:d.filter.incollection,description:d.description.incollection,values:function(){var a,b=$.Deferred();return zmUtil.requireLinkModule().done(function(){zmLink.Util.isProjLoaded().done(function(){if(zmail.Search.Environment.has("GroupFilter")){var c=zmail.Search.Environment.get("GroupFilter")[0].toJSON();a=c.obj?c.obj.id:zmail.zuid}else a=zmail.zuid;zmLink.Util.getCollectionByGroupId(a).then(b.resolve)})}),b.promise()},validate:function(a){var b,c,d=[],e=-1;return!(!a||a.constructor!==Object||!a.catid)&&(zmail.Search.Environment.has("GroupFilter")?(b=zmail.Search.Environment.get("GroupFilter")[0].toJSON(),c=b.obj?b.obj.id:zmail.zuid):c=zmail.zuid,window.zmLink&&(d=zmLink.Util.getLinkGroupObject()[c].linkCategories,e=d.indexOf(_.findWhere(d,{catid:a.catid}))),e>=0)},restrictedToValues:!1,multipleInstance:!1,filterProps:["catname"],getValue:function(){var a=this.value||{};return a.catname},autofillText:function(a){return a.catname}})}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Utils.CommonUtil");a(c)}(function(a){var b={},c=zmText.get("search-impl"),d=c.commondesc,e=c.commonfilter,f=c.streamsFilter,g=c.streamsdesc,h=zmail.Search.Models.Filters,i=zmail.ContactBook.Models.Entity.Contact,j=zmail.Search.Utils.TypeCreator,k={all:"-1",emails:"1",notes:"2",tasks:"3",events:"4",messages:"6",bookmarks:"10"},l={isSharedEmail:2,isSentEmail:1};b.filterConstantsClass={HasInlineImage:"HasInlineImage",HasNoDueDate:"HasNoDueDate",HasNoAssignee:"HasNoAssignee",PostedBy:"PostedBy",AttachName:"AttachName",AttachContent:"AttachContent",Summary:"Summary",IsFavourite:"IsFavourite",commentText:"commentText",CommentedBy:"CommentedBy",Invited:"Invited",Mentioned:"Mentioned",HasAttachment:"HasAttachment",title:"title",to:"to",cc:"cc",isSharedEmail:"isSharedEmail",isSentEmail:"isSentEmail",isCreateMail:"isCreateMail",sender:"sender",HasRecurring:"HasRecurring",MailAssociatedTask:"MailAssociatedTask",archived:"archived"},b.filterConstantsNames={HasInlineImage:f.hasimg,HasNoDueDate:f.duedt,HasRecurring:c.taskfilter.hasrecurring,HasNoAssignee:f.noassignee,PostedBy:f.posBy,AddedBy:"added by",CommentedBy:e.commby,Invited:e.invitee,Mentioned:e.mention,AttachName:e.attachname,AttachContent:e.attachcont,Summary:f.posText,IsFavourite:e.fav,commentText:e.commtext,HasAttachment:e.hasattach,title:f.title,to:f.to,cc:f.cc,isSharedEmail:"shared emails only",isSentEmail:"sent emails only",isCreateMail:f.frmemail,CreatedBy:"created by",sender:f.from,MailAssociatedTask:c.taskfilter.mailassociated,archived:e.archived},b.postedByFilter=j.newType(h.ContactFilter,{name:b.filterConstantsNames.PostedBy,className:b.filterConstantsClass.PostedBy,description:g.posBy,multipleInstance:!1,autofillText:function(a){return _.isString(a)?a:a.name},getValue:function(){var a=this.value||"";return _.isString(a)?a:(a=a.attrs,a.fn||a.name)}}),b.mentionedFilter=j.newType(h.ContactGroupFilter,{name:b.filterConstantsNames.Mentioned,className:b.filterConstantsClass.Mentioned,description:d.mention}),b.inviteeFilter=j.newType(h.ContactGroupFilter,{name:b.filterConstantsNames.Invited,className:b.filterConstantsClass.Invited,description:d.invitee}),b.isArchivedFilter=j.newType(h.BooleanFilter,{name:b.filterConstantsNames.archived,className:b.filterConstantsClass.archived,multipleInstance:!1}),b.isFavouriteFilter=j.newType(h.BooleanFilter,{name:b.filterConstantsNames.IsFavourite,className:b.filterConstantsClass.IsFavourite,multipleInstance:!1}),b.titleFilter=j.newType(h.StringFilter,{name:b.filterConstantsNames.title,className:b.filterConstantsClass.title,multipleInstance:!1,description:g.title}),b.descriptionFilter=j.newType(h.StringFilter,{name:b.filterConstantsNames.Summary,className:b.filterConstantsClass.Summary,description:g.posText}),b.postSummaryFilter=j.newType(h.HasStreamsFilter,{name:b.filterConstantsNames.Summary,className:b.filterConstantsClass.Summary,description:g.posText}),b.TaskFilters=[h.TaskAssigneeFilter,h.TaskPriorityFilter,h.TaskProjectFilter,h.TaskStatusFilter,h.TaskRecurringFilter,h.TaskDueDateFilter,h.TaskCompletedDateFilter,j.newType(h.BooleanFilter,{name:c.taskfilter.mailassociated,className:b.filterConstantsClass.MailAssociatedTask,description:c.taskdesc.mailassociated,multipleInstance:!1}),j.newType(h.BooleanFilter,{name:b.filterConstantsNames.HasNoDueDate,className:b.filterConstantsClass.HasNoDueDate,multipleInstance:!1}),j.newType(h.BooleanFilter,{name:b.filterConstantsNames.HasRecurring,className:b.filterConstantsClass.HasRecurring,multipleInstance:!1}),j.newType(h.BooleanFilter,{name:b.filterConstantsNames.HasNoAssignee,className:b.filterConstantsClass.HasNoAssignee,multipleInstance:!1})],b.NoteFilters=[h.NoteBookFilter,h.NoteColorFilter,j.newType(h.BooleanFilter,{name:b.filterConstantsNames.HasInlineImage,className:b.filterConstantsClass.HasInlineImage,multipleInstance:!1}),j.newType(h.BooleanFilter,{name:b.filterConstantsNames.isCreateMail,className:b.filterConstantsClass.isCreateMail,multipleInstance:!1})],b.BookmarkFilters=[h.LinkCollection],b.MailFilters=[j.newType(h.ContactFilter,{name:b.filterConstantsNames.to,
className:b.filterConstantsClass.to,description:g.to,restrictedToValues:!1,autofillNotAfter:[{className:h.EntityFilter.className,value:["messages","bookmarks","tasks","events","notes"]}],multipleInstance:!1}),j.newType(h.ContactFilter,{name:b.filterConstantsNames.cc,className:b.filterConstantsClass.cc,description:g.cc,restrictedToValues:!1,autofillNotAfter:[{className:h.EntityFilter.className,value:["messages","bookmarks","tasks","events","notes"]}],multipleInstance:!1}),j.newType(h.ContactFilter,{name:b.filterConstantsNames.sender,className:b.filterConstantsClass.sender,description:g.from,restrictedToValues:!1,autofillNotAfter:[{className:h.EntityFilter.className,value:["messages","bookmarks","tasks","events","notes"]}],multipleInstance:!1})],b.commentFilters=[j.newType(h.ContactFilter,{name:b.filterConstantsNames.CommentedBy,className:b.filterConstantsClass.CommentedBy,description:d.commby,validateValueTpe:!0,values:function(a,b){if(!_.isEmpty(a))return zmail.ContactBook.get({str:a,type:"org"})},autofillText:function(a){return _.isString(a)?a:a.name},getValue:function(){var a=this.value||"";return _.isString(a)?a:(a=a.attrs,a.fn||a.name)},validate:function(a){if(zmail.ContactBook.isContact(a))return!0},multipleInstance:!1}),j.newType(h.HasStreamsFilter,{name:b.filterConstantsNames.commentText,className:b.filterConstantsClass.commentText,description:d.commtext})],b.attachmentFilters=[j.newType(h.StringFilter,{name:b.filterConstantsNames.AttachName,className:b.filterConstantsClass.AttachName,description:d.attachname}),j.newType(h.AttachmentTypeFilter,{name:e.attType,description:d.attType}),j.newType(h.StringFilter,{name:b.filterConstantsNames.AttachContent,className:b.filterConstantsClass.AttachContent,description:d.attachcont}),j.newType(h.BooleanFilter,{name:b.filterConstantsNames.HasAttachment,className:b.filterConstantsClass.HasAttachment,multipleInstance:!1})],b.dateFilters=[h.FromDateFilter,h.ToDateFilter];var m=function(a){var b=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear();return b};b.constructQueryParams=function(a,c,d){var e,f,g,j,n,o,p,q,r,s,t,u,v,w,x=b.filterConstantsClass,y=a.data,z={mode:"searchStreams",grid:"false",range:25,entityType:"-1",groupId:"-1",streamsView:!0,actionType:"viewSelfData"};d.showNextPage&&a.paginate?(z.start=d.start+25,d.start=z.start):(z.start=0,d.start=0);for(var A=0;A<y.length;A++)switch(e=y[A],e.className){case h.EntityFilter.className:z.entityType=k[e.value];break;case h.HashtagFilter.className:f=e.actualValue.name,g=f?f:e.actualValue,z.hashtag=g;break;case h.GroupFilter.className:z.groupId=e.actualValue.attrs.id,z.actionType=z.groupId!==zmail.zuid?"viewGroupData":"viewSelfData";break;case h.HasStreamsFilter.className:j=z.SearchStr,u=e.actualValue.attrs,w=u?u.eid||u.name:e.actualValue,z.SearchStr=j?j+" "+w:w;break;case x.PostedBy:if(u=e.actualValue.attrs){var B=zmail.ContactBook;t=u.zid&&B.isContact(e.actualValue)?u.zid:u.eid}else t=e.actualValue;z.postAuthor=t;break;case x.AttachName:n=z.attachname,z.attachname=n?n+" "+e.value:e.value;break;case x.AttachContent:o=z.attachContent,z.attachcontent=o?o+" "+e.value:e.value;break;case x.Summary:p=z.summary,z.summary=p?p+" "+e.value:e.value;break;case x.IsFavourite:z.favourited=!0;break;case x.archived:z.isarchived=!0;break;case x.commentText:q=z.comment,z.comment=q?q+" "+e.value:e.value;break;case h.TagFilter.className:z.labelId=e.actualValue.id;break;case x.CommentedBy:u=e.actualValue.attrs,v=u?u.zid?u.zid:u.eid:e.actualValue,z.commentAuthor=v;break;case x.Invited:r=e.actualValue instanceof i?e.actualValue.attrs.zid:e.actualValue.attrs.id,z.inviteeZuid=r;break;case x.Mentioned:r=e.actualValue instanceof i?e.actualValue.attrs.zid:e.actualValue.attrs.id,z.mentionZuid=r;break;case h.AttachmentTypeFilter.className:z.attachextn=e.value;break;case x.HasAttachment:z.hasAttach=!0;break;case h.TaskPriorityFilter.className:z.priority=e.actualValue["const"];break;case h.TaskProjectFilter.className:z.folderId=e.actualValue.categoryId;break;case h.TaskStatusFilter.className:z.status=e.actualValue["const"];break;case h.NoteBookFilter.className:z.folderId=e.actualValue.id;break;case h.NoteColorFilter.className:z.colour=e.actualValue.value;break;case x.HasNoAssignee:z.hasNoAssignee=!0;break;case x.HasNoDueDate:z.hasNoDuedt=!0;break;case x.HasRecurring:z.recurringTask=!0;break;case x.MailAssociatedTask:z.createdFromMail=!0;break;case h.TaskRecurringFilter.className:z.repeatType=e.actualValue["const"];break;case h.TaskDueDateFilter.className:z.duedate=m(e.actualValue);break;case h.TaskCompletedDateFilter.className:z.completedDate=m(e.actualValue);break;case x.HasInlineImage:z.hasinline=!0;break;case h.FromDateFilter.className:z.fromDate=m(e.actualValue);break;case h.ToDateFilter.className:z.toDate=m(e.actualValue);break;case x.title:z.title=e.value;break;case x.to:s=e.actualValue&&e.actualValue.attrs?e.actualValue.attrs.eid:e.actualValue&&e.actualValue.eid?e.actualValue.eid:e.actualValue,z.toaddr=s;break;case x.cc:s=e.actualValue&&e.actualValue.attrs?e.actualValue.attrs.eid:e.actualValue&&e.actualValue.eid?e.actualValue.eid:e.actualValue,z.ccaddr=s;break;case x.sender:s=e.actualValue&&e.actualValue.attrs?e.actualValue.attrs.eid:e.actualValue&&e.actualValue.eid?e.actualValue.eid:e.actualValue,z.sender=s;break;case h.TaskAssigneeFilter.className:z.assignee=e.actualValue.id;break;case x.isCreateMail:z.createdFromMail=!0;break;case h.LinkCollection.className:z.folderId=e.actualValue.catid;break;case x.isSharedEmail:case x.isSentEmail:z.mailType=e.className===x.isSharedEmail?l.isSharedEmail:l.isSentEmail;break;case x.location:z.location=e.actualValue.LOC?e.actualValue.LOC:e.actualValue}return z.SearchStr&&(z.SearchStr=encodeURIComponent(z.SearchStr)),"task"===c.contextID?(z.entityType=k.tasks,z.appView=!0):"notes"===c.contextID?(z.entityType=k.notes,z.appView=!0):"bookmarks"===c.contextID&&(z.entityType=k.bookmarks,z.appView=!0),z},a.appUtil=b}),function(){var a=zmail.Utils.DOM,b={},c=zmText.get("search-impl"),d=c.commondesc,e=c.commonfilter,f=c.streamsFilter,g=c.streamsdesc,h=zmail.Search.Models.Filters,i=zmail.Search.Utils.TypeCreator,j=zmail.Search.Models.Contexts,k=zmail.Search.Utils.CommonUtil.appUtil,l=k.filterConstantsClass,m=[l.to,l.cc,l.sender],n=[h.TaskAssigneeFilter.className,h.TaskPriorityFilter.className,h.TaskProjectFilter.className,h.TaskStatusFilter.className,h.TaskRecurringFilter.className,h.TaskDueDateFilter.className,h.TaskCompletedDateFilter.className,l.MailAssociatedTask,l.HasNoDueDate,l.HasNoAssignee,l.HasRecurring],o=[h.NoteBookFilter.className,h.NoteColorFilter.className,l.HasInlineImage,l.isCreateMail],p=[h.LinkCollection.className],q=[],r=k.postedByFilter,s=function(){var a,b=[],j=[],m=[],n=[],o=[],p=[],q="",s="";for(b.push(h.HasStreamsFilter,r,h.GroupFilter,k.mentionedFilter,h.EntityFilter),a=0;a<k.NoteFilters.length;a++){switch(q="",s="",k.NoteFilters[a].className){case h.NoteBookFilter.className:q=f.notebook,s=g.notebook;break;case h.NoteColorFilter.className:q=f.color,s=g.color;break;case l.HasInlineImage:q=f.hasimg,s="";break;case l.isCreateMail:q=f.frmemail,s=""}m.push(i.newType(k.NoteFilters[a],{autofillNotAfter:[{className:h.EntityFilter.className,value:["messages","emails","tasks","events","bookmarks"]}],name:q,description:s}))}for(a=0;a<k.TaskFilters.length;a++){switch(p=[{className:h.EntityFilter.className,value:["messages","emails","bookmarks","events","notes"]}],o=[],q="",s="",k.TaskFilters[a].className){case h.TaskProjectFilter.className:o.push({className:h.GroupFilter.className,value:_.toArray(zmail.ContactBook.get({includeAllGroups:!0,promise:!1}))}),q=f.proj,s=g.proj;break;case h.TaskAssigneeFilter.className:p.push({className:l.HasNoAssignee}),q=f.assignee,s=g.assignee;break;case l.HasNoAssignee:p.push({className:h.TaskAssigneeFilter.className}),q=f.noassignee,s="";break;case h.TaskPriorityFilter.className:q=f.priority,s=g.priority;break;case h.TaskStatusFilter.className:q=f.status,s=g.status;break;case l.HasNoDueDate:q=f.duedt,s="";break;case l.HasRecurring:q=c.taskfilter.hasrecurring,s="";break;case h.TaskRecurringFilter.className:q=h.TaskRecurringFilter.name,s=h.TaskRecurringFilter.description;break;case h.TaskDueDateFilter.className:q=h.TaskDueDateFilter.name,s=h.TaskDueDateFilter.description;break;case h.TaskCompletedDateFilter.className:q=h.TaskCompletedDateFilter.name,s=h.TaskCompletedDateFilter.description;break;case l.MailAssociatedTask:q=c.taskfilter.mailassociated,s=c.taskdesc.mailassociated}j.push(i.newType(k.TaskFilters[a],{autofillOnlyAfter:o,autofillNotAfter:p,name:q,description:s}))}for(a=0;a<k.BookmarkFilters.length;a++){switch(q="",s="",k.BookmarkFilters[a].className){case h.LinkCollection.className:q=f.collection,s=g.collection}n.push(i.newType(k.BookmarkFilters[a],{autofillNotAfter:[{className:h.EntityFilter.className,value:["messages","emails","tasks","events","notes"]}],name:q,description:s}))}for(b=b.concat(k.MailFilters),m&&(b=b.concat(m)),j&&(b=b.concat(j)),n&&(b=b.concat(n)),b=b.concat(k.commentFilters),b.push(h.HashtagFilter),b.push(i.newType(h.TagFilter,{name:e.tag,description:d.tag})),b=b.concat(k.attachmentFilters),b.push(k.inviteeFilter),a=0;a<k.dateFilters.length;a++){switch(q="",s="",k.dateFilters[a].className){case h.FromDateFilter.className:q=e.fromdt,s=e.fromdt;break;case h.ToDateFilter.className:q=e.todt,s=e.todt}b=b.concat(i.newType(k.dateFilters[a],{name:q,description:s}))}return b.push(k.isFavouriteFilter,k.titleFilter,k.postSummaryFilter),zmUtil.isArchiveEnabled()&&b.push(k.isArchivedFilter),b},t=function(){var d={contextName:c.streamsContextName,contextID:"streams",contextIcon:"msi-streams",tabRegexp:/zmStreamsApp/,shortcutId:"streamsSearch",placeholder:c.streamsHolder,defaultFilterClass:h.HasStreamsFilter,filterClass:s(),url:zmail.conPath+"/stream.do",hasPagination:function(){return b.showNextPage},prioritizedFilterClass:[h.HasStreamsFilter,r,h.GroupFilter],onAdd:function(a){if(!zmail.Search.Environment.has("EntityFilter"))for(var b=0;b<a.length;b++)switch(a[b].className){case l.to:case l.cc:case l.sender:a[b].value&&zmail.Search.addToSearch({className:h.EntityFilter.className,value:"emails"},{silent:!0});break;case h.LinkCollection.className:a[b].value&&zmail.Search.addToSearch({className:h.EntityFilter.className,value:"bookmarks"},{silent:!0});break;case h.TaskAssigneeFilter.className:case h.TaskPriorityFilter.className:case h.TaskProjectFilter.className:case h.TaskStatusFilter.className:case h.TaskRecurringFilter.className:case h.TaskDueDateFilter.className:case h.TaskCompletedDateFilter.className:a[b].value&&zmail.Search.addToSearch({className:h.EntityFilter.className,value:"tasks"},{silent:!0});break;case l.MailAssociatedTask:case l.HasRecurring:case l.HasNoDueDate:case l.HasNoAssignee:zmail.Search.addToSearch({className:h.EntityFilter.className,value:"tasks"},{silent:!0});break;case h.NoteBookFilter.className:case h.NoteColorFilter.className:a[b].value&&zmail.Search.addToSearch({className:h.EntityFilter.className,value:"notes"},{silent:!0});break;case l.HasInlineImage:case l.isCreateMail:zmail.Search.addToSearch({className:h.EntityFilter.className,value:"notes"},{silent:!0});break;case l.location:a[b].value&&zmail.Search.addToSearch({className:h.EntityFilter.className,value:"events"},{silent:!0})}},onChange:function(a){if(a.className===h.EntityFilter.className){var b=[];switch(a.value){case"notes":b=b.concat(m).concat(n),b=b.concat(p).concat(q);break;case"tasks":b=b.concat(m).concat(o),b=b.concat(p).concat(q);break;case"bookmarks":b=b.concat(m).concat(o),b=b.concat(n).concat(q);break;case"emails":b=b.concat(p).concat(o),b=b.concat(n).concat(q);break;case"events":b=b.concat(p).concat(o),b=b.concat(n).concat(m);break;case"messages":b=b.concat(p).concat(o),b=b.concat(n).concat(m),b=b.concat(q)}zmail.Search.Environment.remove(b,{silent:!0})}else if(!zmail.Search.Environment.has("EntityFilter"))switch(a.className){case l.to:case l.cc:case l.sender:zmail.Search.addToSearch({className:h.EntityFilter.className,value:"emails"},{silent:!0});break;case h.LinkCollection.className:zmail.Search.addToSearch({className:h.EntityFilter.className,value:"bookmarks"},{silent:!0});break;case h.TaskAssigneeFilter.className:case h.TaskPriorityFilter.className:case h.TaskProjectFilter.className:case h.TaskStatusFilter.className:case h.TaskRecurringFilter.className:case h.TaskDueDateFilter.className:case h.TaskCompletedDateFilter.className:case l.MailAssociatedTask:zmail.Search.addToSearch({className:h.EntityFilter.className,value:"tasks"},{silent:!0});break;case h.NoteBookFilter.className:case h.NoteColorFilter.className:case l.HasInlineImage:case l.isCreateMail:zmail.Search.addToSearch({className:h.EntityFilter.className,value:"notes"},{silent:!0});break;case l.location:zmail.Search.addToSearch({className:h.EntityFilter.className,value:"events"},{silent:!0})}},onReset:function(a){var b=this.getFrameworkInstance(),c=b.getListingCenterDOM();c&&zmStreamsApp.util.detachAndRemove(c[0])},afterSearch:function(a){var b=this.getFrameworkInstance();b&&b.preview&&b.preview.close();var c=b.getListingCenterDOM();c&&(zmStreamsApp.util.detachAndRemove(c[0]),c.empty())},searchQuery:function(a){var c=k.constructQueryParams(a,this,b);return c},mountView:function(d){var e=this.getFrameworkInstance(),f=e.getListingCenterDOM(),g=d.response;if(g){var h=g[1],i=d.paginate;if(!i){var j=zdom("span",{className:"SC_mtb SC_Tcen"},c.streamsTabResult),k=a.selector(".SC_flt",e.listingHeader.$el);a.clearHTML(k),a.mount(j,k)}b.showNextPage=h.showNextPage,b.forceScroll=h.forceScroll,zmAppLoader.load("streamsApp").then(function(){zmStreamsApp.PostApp.searchView(h,f[0],i)})}},afterInit:function(){var a=this,b=m.concat(o);b=b.concat(n),b=b.concat(p);for(var c=0;c<b.length;c++)h.EntityFilter.removeDependentFilters.push(b[c]);$.subscribe("CALSEARCH_INIT",function(){for(var b,c=ZCL_getFilter(),d=[],e=0;e<c.length;e++)b=c[e],b&&b.className===h.LocationFilter.className&&d.push(i.newType(b,{autofillNotAfter:[{className:h.EntityFilter.className,value:["messages","emails","tasks","bookmarks","notes"]}],name:g.loc,description:g.loc}));a.registerFilterClasses(d),k.filterConstantsClass.location=h.LocationFilter.className,q.push(k.filterConstantsClass.location),h.EntityFilter.removeDependentFilters.push(k.filterConstantsClass.location)})}};return new j.SearchContext(d)},u=function(){var a=t();j.streamSearchContext=a,zmail.Search.registerContext(a)};u()}(),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Contexts");a(c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c,d,e=b("zmail.Search.Models.Contexts"),f=b("zmail.Search.Models.Filters"),g=b("zmail.Search.Utils.CommonUtil.appUtil"),h=b("zmail.Utils.DOM"),i={},j={},k=g.filterConstantsClass,l=zmail.Search.Utils.TypeCreator,m=g.filterConstantsNames,n=zmText.get("search-impl"),o=n.notefilter,p=n.notedesc,q=l.newType(g.postedByFilter,{name:o.addedby,description:p.addedby,multipleInstance:!1}),r=l.newType(g.descriptionFilter,{name:o.desc,description:p.desc}),s=l.newType(g.titleFilter,{name:o.title,description:p.title}),t=l.newType(f.HasStreamsFilter,{name:o.contains,description:p.contains}),u=l.newType(g.isArchivedFilter,{name:o.archived,description:p.archived}),v=function(){return t},w=function(){var a=[];return a.push(t,q,u,f.GroupFilter,f.NoteBookFilter,f.NoteColorFilter,r,s,l.newType(f.BooleanFilter,{name:m.HasInlineImage,className:k.HasInlineImage,multipleInstance:!1}),l.newType(f.BooleanFilter,{name:g.filterConstantsNames.isCreateMail,className:g.filterConstantsClass.isCreateMail,multipleInstance:!1}),f.TagFilter,l.newType(f.BooleanFilter,{name:m.IsFavourite,className:k.IsFavourite,multipleInstance:!1}),l.newType(f.ContactGroupFilter,{name:m.Invited,className:k.Invited,description:"Invitee name"}),f.HashtagFilter),a=a.concat(g.attachmentFilters),a=a.concat(g.commentFilters),a=a.concat(g.dateFilters)};a.noteSearchContext=new e.SearchContext({contextName:n.notesContextName,contextID:"notes",contextIcon:"msi-notes",tabRegexp:/zm_notes/,shortcutId:"notesSearch",placeholder:n.notesPlaceHolder||"",defaultFilterClass:v(),prioritizedFilterClass:[t,q,f.GroupFilter,f.NoteColorFilter],filterClass:w(),url:zmail.conPath+"/stream.do",searchQuery:function(a){a.paginate||d&&zNote.removeNoteFromView(d[0]);var b=g.constructQueryParams(a,this,i);return b},hasPagination:function(){return i.showNextPage},mountView:function(a){this.getView(a)},onReset:function(){c=void 0},getView:function(a,b){a.paginate||d&&d.empty(),c||(c=this.getFrameworkInstance(),c.onDelete=function(){d&&zNote.removeNoteFromView(d[0])},d=c.getListingCenterDOM()),a.response&&zmAppLoader.load("notes").then(function(){zNote.loadNoteCategories().done(function(){if(i.showNextPage=a.response[1].page.showNextPage,a.paginate)zNote.convertStreamsFormatToNotes(a.response,{},d[0],j);else{var b=zdom("span",{className:"SC_mtb SC_Tcen"},n.noteutil.resultsearch),e=h.selector(".SC_flt",c.listingHeader.$el);h.clearHTML(e),h.mount(b,e),j=zNote.convertStreamsFormatToNotes(a.response,{isnew:!0,mode:"search",id:"search",groupId:zmail.zuid},d[0])}})})}});var x=function(){zmail.Search.registerContext(a.noteSearchContext)};x()}),function(){var a,b=zmail.Search,c=zmail.Search.Models.Contexts,d=zmail.Search.Models.Filters,e=zmail.Search.Utils.TypeCreator,f=zmail.ValueTypeInferrer.TYPES,g=zmText.get("search-impl"),h=g.mailfilter,i=g.maildesc,j=[{className:"EntireMessage"},{className:"Sender"},{className:"SentBy"},{className:"ToOrCc"},{className:"Subject"},{className:"EmailContent"},{className:"AttachmentName"},{className:"AttachmentContent"},{className:"AttachmentType"},{className:"To"},{className:"Cc"}],k=["HasAttachmentFilter","HasFlagFilter","HasReplyFilter","MailDateFilter","MailFromDateFilter","MailToDateFilter","MailReminderFilter","HasMailReminderFilter","ForwardFilter","HasInlineAttachmentFilter","MailPriorityFilter","FromSizeFilter","ToSizeFilter"],l=["EntireMessage","Sender","SentBy","ToOrCc","Subject","EmailContent","AttachmentName","AttachmentContent","AttachmentType","To","Cc","EntireMessageExclude","SenderExclude","ToOrCcExclude","SubjectExclude","EmailContentExclude","AttachmentNameExclude","AttachmentContentExclude","ToExclude","CcExclude"],m=e.newType(d.ContactFilter,{name:h.sender,className:"Sender",description:i.sender,multipleInstance:!1,removeDependentFilters:k}),n=[d.HasMailFilter,m,e.newType(d.ContactFilter,{name:h.toOrcc,className:"ToOrCc",description:i.toOrcc}),d.FolderFilter,e.newType(d.StringFilter,{name:h.subject,className:"Subject",description:i.subject,valueType:f.String.name,removeDependentFilters:k}),e.newType(d.StringFilter,{name:h.emailcontent,className:"EmailContent",description:i.emailcontent,valueType:f.String.name,removeDependentFilters:k}),e.newType(d.StringFilter,{name:h.attachname,className:"AttachmentName",description:i.attachname,removeDependentFilters:k}),e.newType(d.StringFilter,{name:h.attachcontent,className:"AttachmentContent",description:i.attachcontent,removeDependentFilters:k}),e.newType(d.ContactFilter,{name:h.sentby,className:"SentBy",description:i.sentby,multipleInstance:!1,removeDependentFilters:k}),e.newType(d.AttachmentTypeFilter,{name:h.attachtype,className:"AttachmentType",description:i.attachtype}),e.newType(d.DateFilter,{name:h.date,className:"MailDateFilter",description:i.date,multipleInstance:!1,autofillNotAfter:[{className:"MailFromDateFilter"},{className:"MailToDateFilter"}],dependedOn:l}),e.newType(d.FromDateFilter,{name:h.fromdate,className:"MailFromDateFilter",description:i.fromdate,multipleInstance:!1,autofillNotAfter:[{className:"MailDateFilter"}],dependedOn:l}),e.newType(d.ToDateFilter,{name:h.tilldate,className:"MailToDateFilter",description:i.tilldate,multipleInstance:!1,autofillNotAfter:[{className:"MailDateFilter"}],dependedOn:l}),e.newType(d.ContactFilter,{name:h.to,className:"To",description:i.to,removeDependentFilters:k}),e.newType(d.ContactFilter,{name:h.cc,className:"Cc",description:i.cc,removeDependentFilters:k}),e.newType(d.TagFilter,{name:h.tag,className:"MailTagFilter",description:i.tag,values:function(){return _.toArray(zmail.labInfo)}}),e.newType(d.BooleanFilter,{name:h.hasreminder,className:"HasMailReminderFilter",description:i.hasreminder,multipleInstance:!1,dependedOn:l}),d.MailReminderFilter,e.newType(d.BooleanFilter,{name:h.withattachment,className:"HasAttachmentFilter",description:i.withattachment,multipleInstance:!1,dependedOn:l}),e.newType(d.BooleanFilter,{name:h.flagged,className:"HasFlagFilter",description:i.flagged,multipleInstance:!1,dependedOn:l}),e.newType(d.BooleanFilter,{name:h.replied,className:"HasReplyFilter",description:i.replied,multipleInstance:!1,autofillNotAfter:[{className:"ForwardFilter"}],dependedOn:l}),e.newType(d.HasMailFilter,{name:h.negatecontains,className:"EntireMessageExclude",description:i.negatecontains,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.ContactFilter,{name:h.negatesender,className:"SenderExclude",description:i.negatesender,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.ContactFilter,{name:h.negatetoOrcc,className:"ToOrCcExclude",description:i.negatetoOrcc,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.StringFilter,{name:h.negatesubject,className:"SubjectExclude",description:i.negatesubject,valueType:f.String.name,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.StringFilter,{name:h.negateemailcontent,className:"EmailContentExclude",description:i.negateemailcontent,valueType:f.String.name,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.StringFilter,{name:h.negateattachname,className:"AttachmentNameExclude",description:i.negateattachname,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.StringFilter,{name:h.negateattachcontent,className:"AttachmentContentExclude",description:i.negateattachcontent,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.ContactFilter,{name:h.negateto,className:"ToExclude",description:i.negateto,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.ContactFilter,{name:h.negatecc,className:"CcExclude",description:i.negatecc,autofillOnlyAfterOperator:"any",autofillOnlyAfter:j,removeDependentFilters:k}),e.newType(d.BooleanFilter,{name:h.forwarded,className:"ForwardFilter",description:i.forwarded,multipleInstance:!1,autofillNotAfter:[{className:"HasReplyFilter"}],dependedOn:l}),d.MailPriorityFilter,e.newType(d.BooleanFilter,{name:h.hasinline,className:"HasInlineAttachmentFilter",description:i.hasinline,multipleInstance:!1,dependedOn:l})];zmail.showFeature&&(n.push(d.MailFlagFilter),n.push(e.newType(d.BooleanFilter,{name:h.withComment,className:"HasComment",description:i.withComment,multipleInstance:!1})),n.push(e.newType(d.BooleanFilter,{name:h.withNote,className:"HasNote",description:i.withNote,multipleInstance:!1})),n.push(e.newType(d.BooleanFilter,{name:h.withTask,className:"HasTask",description:i.withTask,multipleInstance:!1})),n.push(e.newType(d.BooleanFilter,{name:h.withEvent,className:"HasEvent",description:i.withEvent,multipleInstance:!1})),n.push(e.newType(d.BooleanFilter,{name:h.withProject,className:"HasProject",description:i.withProject,multipleInstance:!1})),n.push(e.newType(d.BooleanFilter,{name:h.withChatlet,className:"HasChatlet",description:i.withChatlet,multipleInstance:!1}))),n.push(e.newType(d.MailSizeFilter,{name:h.from_size,className:"FromSizeFilter",description:i.from_size,multipleInstance:!1,validate:function(a){if(d.MailSizeFilter.validate(a)){var b=zmail.Search.Environment;if(b.has("ToSizeFilter")){var c=b.get("ToSizeFilter")[0].toJSON().value;if(d.MailSizeFilter.validate(c)){var e=d.MailSizeFilter.findValue(a);return parseInt(e)<parseInt(c)}return!1}return!0}return!1},getValue:function(){var a=this.value||{};return"string"==typeof a?(a=this.findValue(a),Math.floor(a).toString()):""},dependedOn:l}),e.newType(d.MailSizeFilter,{name:h.to_size,className:"ToSizeFilter",description:i.to_size,multipleInstance:!1,validate:function(a){if(d.MailSizeFilter.validate(a)){var b=zmail.Search.Environment;if(b.has("FromSizeFilter")){var c=b.get("FromSizeFilter")[0].toJSON().value;if(d.MailSizeFilter.validate(c)){var e=d.MailSizeFilter.findValue(a);return parseInt(e)>parseInt(c)}return!1}return!0}return!1},getValue:function(){var a=this.value||{};return"string"==typeof a?(a=this.findValue(a),Math.ceil(a).toString()):""},dependedOn:l})),zmfolAction&&zmfolAction.hasSharedFol()&&n.push(e.newType(d.FolderFilter,{className:"ShareFolFilter",name:g.mailfilter.sharedFol,description:g.maildesc.sharedFol,valueType:zmail.ValueTypeInferrer.TYPES.sharedFolder.name,autofillNotAfter:[{className:"FolderFilter"}],values:function(a){a=(a||"").toLowerCase();var b=zmfolAction.getSharedFolPaths();return b.filter(function(b){return b.path.toLowerCase().indexOf(a)!==-1})},defaultValue:void 0,validate:function(a){if(!_.isObject(a))return!1;var b,c=["fId","shId","path"];for(b in c)if(!_.has(a,c[b]))return!1;return!0}}));var o=function(){return new c.SearchContext({contextName:g.mailContextName,contextID:"mail",contextIcon:"msi-mail",tabRegexp:/zm_Container/,shortcutId:"mailSearch",placeholder:g.mailPlaceHolder,pageSize:50,defaultFilterClass:d.HasMailFilter,filterClass:n,prioritizedFilterClass:[d.HasMailFilter,m,d.FolderFilter],url:zmail.conPath+"/search.do",getFrameworkInstance:function(){if("pending"!==this.dependencyPromise.state()){var b=zmail.Search.Integrators.Framework;return this.frameworkInstance||(a=new b(zmailSearch.Core.getFrameworkConfig.call(this)),this.frameworkInstance=a),this.frameworkInstance}},searchQuery:function(a){return zmailSearch.Core.cookSearchQuery(a)},getView:function(a,b){zmailSearch.Core.generateView(a,b)},mountView:function(a){this.getView(a,this.getFrameworkInstance())},onAccountSwitch:function(a){zmailSearch.Core.isWorkspaceAvailable()&&(zmail.Search.Environment.remove(),zmsuite.closeWorkspace(zmailSearch.Model.getSearchData().tabInfo.appId))},hasPagination:function(){return zmailSearch.Core.hasPagination()},afterSearch:function(a){zmailSearch.Model.resetSearchData(this.getFrameworkInstance())},active:function(){var a=this;zmAppLoader.load("mailSearch").then(function(){a.dependencyPromise.resolve()})}})};c.mailSearchContext=o();var p=function(){b.registerContext(c.mailSearchContext)};p()}(),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Contexts");a(c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c,d=b("zmail.Search.Models.Contexts"),e=b("zmail.Search.Models.Filters"),f=b("zmail.Search.Utils.CommonUtil.appUtil"),g=b("zmail.Search.Utils.TypeCreator"),h=zmText.get("search-impl","attachment"),i=[{className:e.AttachmentNameFilter.className},{className:e.AttachmentContentFilter.className},{className:e.AttachmentDocTypeFilter.className},{className:e.AttachmentEntityFilter.className},{className:e.AttachmentGroupFilter.className},{className:e.AttachmentSenderFilter.className},{className:e.AttachmentTypeFilter.className},{className:e.TagFilter.className}],j=function(){return e.AttachmentNameFilter},k=function(){return g.newType(f.isFavouriteFilter,{name:"in favourites"})},l=function(){return e.InMail},m=function(){return g.newType(e.FromDateFilter,{autofillOnlyAfterOperator:"any",autofillOnlyAfter:i})},n=function(){return g.newType(e.ToDateFilter,{autofillOnlyAfterOperator:"any",autofillOnlyAfter:i})},o=function(){return[m(),n()]},p=function(){var a=[];return a.push(e.AttachmentNameFilter,e.AttachmentContentFilter,e.AttachmentSenderFilter,e.AttachmentTypeFilter,e.AttachmentGroupFilter,e.InStreams,l(),k(),e.TagFilter,e.AttachmentDocTypeFilter,e.AttachmentEntityFilter,e.AttachmentSizeFilter),a=a.concat(o())};a.attachmentSearchContext=new d.SearchContext({contextName:h.contextName,contextID:"Attachment",contextIcon:"msi-attachview",tabRegexp:/attView/,placeholder:h.placeholder.searchbox,shortcutId:"attachmentsSearch",url:zmail.conPath+"/postAttach.do",defaultFilterClass:j(),filterClass:p(),prioritizedFilterClass:[e.AttachmentNameFilter,e.AttachmentContentFilter,e.AttachmentSenderFilter],getFrameworkInstance:function(){var a=b("zmail.Search.Integrators.Framework");if("pending"!==this.dependencyPromise.state())return c||(c=new a(zmAttachment.search.core.getFrameworkConfig.call(this))),c},searchQuery:function(a){return zmAttachment.search.core.getAttachmentSearchQuery(a)},hasPagination:function(){return zmAttachment.search.core.hasPagination()},mountView:function(a){this.getView(a,this.getFrameworkInstance())},getView:function(a,b){zmAttachment.search.core.generateView(a,b)},onReset:function(){c=void 0,this.paginationBinded=!1,this.paginationRequestSent=!1},active:function(){var a=this;zmAppLoader.load("attachmentSearch").then(function(){a.dependencyPromise.resolve()})}});var q=function(){zmail.Search.registerContext(a.attachmentSearchContext)};q()}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Contexts");a(c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c,d=b("zmail.Search.Models.Contexts"),e=b("zmail.Search.Models.Filters"),f=b("zmail.Search.Utils.CommonUtil.appUtil"),g=b("zmail.Search.Utils.TypeCreator"),h=zmText.get("search-impl","bookmark"),i={},j=function(){return e.LinkSearchKey},k=function(){return g.newType(f.postedByFilter,{name:f.filterConstantsNames.AddedBy,description:h.description.addedby,multipleInstance:!1})},l=function(){return g.newType(f.isFavouriteFilter,{name:h.filter.infavourites,description:h.description.infavourites})},m=function(){return g.newType(f.titleFilter,{name:h.filter.title,description:h.description.title,multipleInstance:!1})},n=function(){return g.newType(f.descriptionFilter,{name:h.filter.description,description:h.description.description,multipleInstance:!1})},o=function(){return[e.LinkSearchKey,k(),e.LinkGroup,e.LinkCollection,l(),m(),n()].concat(f.dateFilters)};a.linkSearchContext=new d.SearchContext({contextName:h.contextName,contextID:"bookmarks",contextIcon:"msi-links",tabRegexp:/zm_link/,shortcutId:"bookmarksSearch",placeholder:h.workspace.placeholder.searchbox,defaultFilterClass:j(),filterClass:o(),url:zmail.conPath+"/stream.do",getFrameworkInstance:function(){var a=b("zmail.Search.Integrators.Framework");if("pending"!==this.dependencyPromise.state())return c||(c=new a(zmLink.search.core.getFrameworkConfig())),c},searchQuery:function(a){return i.showNextPage=zmLink.search.core.hasPagination(),f.constructQueryParams(a,this,i)},hasPagination:function(){return zmLink.search.core.hasPagination()},mountView:function(a){this.getView(a)},getView:function(a){zmLink.search.core.generateView(a)},reset:function(){c=void 0,this.paginationBinded=!1,this.paginationRequestSent=!1},active:function(){var a=this;zmUtil.requireLinkModule().done(function(){zmLink.Util.isProjLoaded().done(function(){a.dependencyPromise.resolve()})})}});var p=function(){zmail.Search.registerContext(a.linkSearchContext)};p()}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Contexts");a(c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Utils.DOM"),d=b("zmail.Search.Models.Contexts"),e=b("zmail.Search.Models.Filters"),f=zmail.Search.Utils.TypeCreator,g=zmail.Search.Utils.CommonUtil.appUtil,h=g.filterConstantsClass,i={},j={},k=zmText.get("search-impl"),l=b("zmTask"),m=f.newType(e.ContactFilter,{name:k.taskfilter.addedby,className:h.PostedBy,description:k.taskdesc.addedby,multipleInstance:!1}),n=function(){var a=[];return a.push(f.newType(e.HasStreamsFilter,{description:k.taskdesc.contains}),m,e.TaskAssigneeFilter,e.GroupFilter,e.TaskStatusFilter,e.TaskPriorityFilter,e.TaskProjectFilter,f.newType(e.BooleanFilter,{name:k.taskfilter.hasrecurring,description:k.taskdesc.hasrecurring,className:g.filterConstantsClass.HasRecurring,multipleInstance:!1
}),f.newType(e.BooleanFilter,{name:k.taskfilter.noduedate,className:g.filterConstantsClass.HasNoDueDate,description:k.taskdesc.noduedate,multipleInstance:!1}),f.newType(e.BooleanFilter,{name:k.taskfilter.noassignee,className:g.filterConstantsClass.HasNoAssignee,description:k.taskdesc.noassignee,autofillNotAfter:[{className:"TaskAssigneeFilter"}],autofillOnlyAfterOperator:"any",multipleInstance:!1}),g.titleFilter,f.newType(e.BaseFilter,{name:k.taskfilter.desccontains,className:g.filterConstantsClass.Summary,description:k.taskdesc.desccontains}),g.mentionedFilter,e.HashtagFilter,e.TagFilter,g.inviteeFilter,g.isFavouriteFilter),a=a.concat(g.attachmentFilters),a=a.concat(g.commentFilters),a=a.concat(g.dateFilters),a.push(e.TaskRecurringFilter),a.push(e.TaskDueDateFilter),a.push(e.TaskCompletedDateFilter),a.push(f.newType(e.BooleanFilter,{name:k.taskfilter.mailassociated,className:g.filterConstantsClass.MailAssociatedTask,description:k.taskdesc.mailassociated,autofillOnlyAfterOperator:"any",multipleInstance:!1})),a};a.taskContextSearch=new d.SearchContext({tabRegexp:/zm_task/,contextName:k.taskContextName,contextID:"task",contextIcon:"msi-task",shortcutId:"taskSearch",placeholder:k.taskHolder,defaultFilterClass:e.HasStreamsFilter,filterClass:n(),prioritizedFilterClass:[f.newType(e.HasStreamsFilter,{description:k.taskdesc.contains}),m,e.TaskAssigneeFilter],url:zmail.conPath+"/stream.do",searchQuery:function(a){var b=g.constructQueryParams(a,this,i);return b},hasPagination:function(){return i.showNextPage},mountView:function(a){this.getView(a)},getView:function(a){var b=this.getFrameworkInstance(),d=b.getListingCenterDOM();a.pageNo||d.empty();var e=a.response;if(e){var f=e[1];if(i.showNextPage=f.showNextPage,i.forceScroll=f.forceScroll,a.paginate)l.Search.constructList(e,b,j);else{j=l.Search.constructList(e,b);var g=zdom("span",{className:"SC_mtb SC_Tcen"},k.taskutil.resultsearch),h=c.selector(".SC_flt",b.listingHeader.$el);c.clearHTML(h),c.mount(g,h)}}},active:function(){this.dependencyPromise.resolve()}});var o=function(){zmUtil.requireTaskModule("taskSearchUtil").done(function(){zmail.Search.registerContext(a.taskContextSearch)})};o()}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Contexts");a(c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search.Models.Contexts"),d=b("zmText"),e=d.get("search-impl");a.zohoOneSearchContext=new c.SearchContext({tabRegexp:/search_across_zoho/,contextName:e.zohoOneSearchPlaceholder,contextID:"search across zoho",contextIcon:"msi-search",placeholder:e.zohoOneSearchPlaceholder,shortcutId:"search_across_zoho",__isZohoOneSearch:!0,__specialIconClass:"msi-popout",__zohoOneElementID:"wmsglobalsearch"});var f=function(){zmail.isRebranded||zmail.Search.registerContext(a.zohoOneSearchContext,{silent:!0})};f()}),function(a){var b=zmail.Core.Namespaces,c=b.create("zmail.Search.Models.Contexts");a(c,function(a){return b.get(a,{ignore__namespace:!0})})}(function(a,b){var c=b("zmail.Search"),d=b("zmail.Search.Models.Contexts.SearchContext"),e=b("zmText").get("search-impl"),f=e.quickAccessPlaceHolder||"",g=b("zmail.Search.Models.Contexts");g.Commands=new d({contextName:e.quickAccessContextName,contextID:"quick access",contextIcon:"msi-quickAction",placeholder:f,shortcutId:"quickAccess",tabRegexp:/zm-settings|settings/i,__isCommand:!0}),c.registerContext(g.Commands,{silent:!0})});