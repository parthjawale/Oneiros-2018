"use strict";!function(a){a.call(zmail.Core.Namespaces.create("zmail.ValueTypeInferrer.TYPES"),zmail.Core.Namespaces.get)}(function(a){var b=a("_"),c=this.BaseValueType=function(a){return this instanceof c?(a=a||{},void b.extend(this,this.defaults(),a)):new c(a)};c.prototype={defaults:function(){return{name:"",valueStartsWith:b.noop}}}}),function(a){a.call(zmail.Core.Namespaces.create("zmail.ValueTypeInferrer"),zmail.Core.Namespaces.get)}(function(a){var b=a("_"),c=a("zmail.ValueTypeInferrer.TYPES"),d=a("zmail.ValueTypeInferrer.TYPES.BaseValueType"),e=this.TYPE_NAMES=[];this.register=function(a){return b.isArray(a)||(a=[a]),a.forEach(function(a){a instanceof d||(a=new d(a)),a.name in c||(c[a.name]=a,e.push(a.name))}),this},this.infer=function(a){return e.reduce(function(d,e){var f=c[e];if(f){var g=f.valueStartsWith(a);b.isEmpty(g)||(d[f.name]=b.isArray(g)?g[0]:g)}return d},{})}}),function(a){a(zmail.Core.Namespaces.get)}(function(a){var b=a("_"),c=a("zmail.ValueTypeInferrer");c.register([{name:"SavedSearch",valueStartsWith:function(a){if(a)return a=a.toLowerCase(),b(b.toArray(zmail.savedSearchList)).find(function(b){return 0===b.FN.toLowerCase().indexOf(a)})}},{name:"StreamsLink",valueStartsWith:function(b){if(b&&a("zmUtil").isValidStreamsUrl(b))return b}},{name:"Link",valueStartsWith:function(a){var b=/((?=http|https)[\S]*:\/\/[\S]*.+)|([\S]*(?:\w{2}\.\w+\.\w+)[\S]*)/gi;if(a&&b.test(a))return a}},{name:"Contact",valueStartsWith:function(a){if(a){var c=zmail.ContactBook.getMostUsedContacts(a);return b.isEmpty(c)?zmail.ContactBook.get({promise:!1,str:a}):c}}},{name:"Group",valueStartsWith:function(a){if(a)return zmail.ContactBook.getGroups(a,{containsSearch:!0,includeAllGroups:!0})}},{name:"NoteColor",valueStartsWith:function(c){if(c)return b(a("zmUtil.noteColorArray")).find(function(a){return 0===a.dispname.toLowerCase().indexOf(c)})}},{name:"HashTag",valueStartsWith:function(c){if(c)return c=c.toLowerCase(),"#"===c.charAt(0)&&(c=c.substring(1,c.length)),b(a("zmStreamsApp").GroupApp.fetchHashTags()).find(function(a){return 0===a.name.toLowerCase().indexOf(c)})}},{name:"Folder",valueStartsWith:function(c){if(c)return c=c.toLowerCase(),b(a("zmfolAction").getMailFolderPaths()).find(function(a){return a.path.toLowerCase().indexOf(c)!==-1})}},{name:"sharedFolder",valueStartsWith:function(c){if(c)return c=c.toLowerCase(),b(a("zmfolAction").getSharedFolPaths()).find(function(a){return a.path.toLowerCase().indexOf(c)!==-1})}},{name:"Tag",valueStartsWith:function(c){if(c)return c=c.toLowerCase(),b(b.toArray(a("zmail.labInfo"))).find(function(a){return 0===a.label.toLowerCase().indexOf(c)})}},{name:"MailView",supportedValues:[{name:"Unread",id:"zm_unread"},{name:"All messages",id:"zm_all"},{name:"Flagged",id:"zm_flag"}],valueStartsWith:function(a){if(a)return a=a.toLowerCase(),b(this.supportedValues).find(function(b){return 0===b.name.toLowerCase().indexOf(a)})}}])}),function(a){a(zmail.Core.Namespaces.get)}(function(a){var b=a("_"),c=a("zmail.ValueTypeInferrer"),d={SECONDS:"SECONDS",MINUTES:"MINUTES",HOURS:"HOURS",DAYS:"DAYS",WEEKS:"WEEKS",WEEKS_DAYS:"WEEKS_DAYS",MONTHS:"MONTHS",YEARS:"YEARS"},e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].map(function(a,b){return{name:a,display:"last "+a,value:b,type:d.WEEKS_DAYS,__date:!0}});e=e.concat(["january","february","march","april","may","june","july","august","september","october","november","december"].map(function(a,b){return{name:a,display:"last "+a,value:b,type:d.MONTHS,__date:!0}}));var f=function(a){var b=function(){return new Date},c=function(a){return a=a||b(),a.setHours(0,0,0,0),a.setHours(23,59,59,0),a},e=function(a,c){return c=c||b().getFullYear(),new Date(c,a+1,0).getDate()};return a.dayAgo=function(a,b){return a=void 0!==a?a:-1,b=b||c(),b.setDate(b.getDate()+a),b},a.monthAgo=function(a,b){return a=void 0!==a?a:-1,b=b||c(),b.setMonth(b.getMonth()+a),b},a.yearAgo=function(a,b){return a=void 0!==a?a:-1,b=b||c(),b.setFullYear(b.getFullYear()+a),b},a.today=function(){return c()},a.lastDay=function(d){var e=b(),f=d.value-e.getDay();return a.dayAgo(f,e),f>=0&&a.dayAgo(-7,e),c(e)},a.lastMonth=function(d){var f=b(),g=d.value-f.getMonth();a.monthAgo(g,f),g>=0&&a.yearAgo(-1,f);var h=e(f.getMonth())-f.getDate();return a.dayAgo(h,f),c(f)},a.toDate=function(b){return b instanceof Date?b:b.type===d.WEEKS_DAYS?a.lastDay(b):b.type===d.MONTHS?a.lastMonth(b):void 0},a}({});c.register([{name:"Date",toDate:function(a){return f.toDate(a)},valueStartsWith:function(a){if(a)return a=a.toLowerCase(),b(e).find(function(b){return 0===b.name.toLowerCase().indexOf(a)})}}])}),function(a){a(zmail.Core.Namespaces.get)}(function(a){}),function(a){a(zmail.Core.Namespaces.get)}(function(a){var b=a("zmail.ValueTypeInferrer");b.register({name:"EntityType",valueStartsWith:function(a){if(a){var b=["all","emails","notes","tasks","events","messages","bookmarks"];return _(b).find(function(b){return 0===b.toLowerCase().indexOf(a)})}}})}),function(a){a(zmail.Core.Namespaces.get)}(function(a){var b=a("_"),c=a("zmail.ValueTypeInferrer");c.register({name:"String",valueStartsWith:function(a){if(a&&b.isString(a))return a}})}),function(a){a(zmail.Core.Namespaces.get)}(function(a){var b=a("_"),c=a("zmail.ValueTypeInferrer");c.register({name:"AttachmentType",values:["doc","docx","sxw","odt","rtf","txt","js","java","css","jsp","jspf","json","c","cpp","xml","go","eml","sh","bat","log","pps","ppt","pptx","odp","sxi","xls","xlsx","sxc","ods","csv","tsv","mp3","mpa","wma","wav","ra","m3u","m4a","avi","flv","mp4","mpg","wmv","vob","swf","mov","3gp","rm","pdf","zip","rar","jpg","jpeg","gif","png","bmp","ics"],valueStartsWith:function(a){if(a)return a=a.toLowerCase(),b(this.values).find(function(b){return 0===b.indexOf(a)})}}),c.register({name:"AttachmentDocType",values:["Images","Documents","Media","Compressed","Others"],valueStartsWith:function(a){if(a)return a=a.toLowerCase(),b(this.values).find(function(b){return 0===b.indexOf(a)})}}),c.register({name:"AttachmentEntityFilter",values:["Mail","Notes","Task","Event","Message","Bookmarks"],valueStartsWith:function(a){if(a)return a=a.toLowerCase(),b(this.values).find(function(b){return 0===b.indexOf(a)})}})});