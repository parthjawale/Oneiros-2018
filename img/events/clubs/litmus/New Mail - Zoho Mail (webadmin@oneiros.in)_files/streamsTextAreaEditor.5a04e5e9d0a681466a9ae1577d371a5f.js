"use strict";define([],function(a){var b=a("zmail.Streams.Components"),c=a("zmail.Components.TextAreaEditor.BaseEditor"),d=c.EVENTS;d.mentionAdded="MENTION_ADDED",d.mentionRemoved="MENTION_REMOVED";var e=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"initBlockRenderers",value:function(){var a=this;babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"initBlockRenderers",this).call(this),a.setBlockRenderer("mention",a.mentionBlockRenderer)}},{key:"mentionBlockRenderer",value:function(a,b){var c=null;b=b||{};var d=b.className||"zm_groupMember";return c=React.createElement("b",{className:d},a.value)}}]),b}(c.BackgroundContent),f=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"getBackgroundContentClass",value:function(){return e}},{key:"blockRemovedHandler",value:function(a,b){var c=this;"mention"===b.type&&setTimeout(function(){$(c).triggerHandler(d.mentionRemoved,{id:b.id})})}},{key:"bindEvents",value:function(){var a=this;babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"bindEvents",this).call(this),a.blockRemovedHandler=a.blockRemovedHandler.bind(a),$(a).on(c.EVENTS.blockRemoved,a.blockRemovedHandler)}},{key:"unbindEvents",value:function(){var a=this;babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"bindEvents",this).call(this),$(a).off(c.EVENTS.blockRemoved,a.blockRemovedHandler)}},{key:"replaceCurrentTypingWordWithMention",value:function(a){var b=this;if(a=a||{},!a.id||!a.text)return!1;var c=b.getCursorPositionWithBOM(),e=b.getCurrentTypingWord(),f=c-e.length,g=c;b.replaceTextRangeWith(a.text,f,g);var h=f,i=f+a.text.length,j=b.bomCountBeforeIndex(f),k=b.addMetaBlock({id:a.id,type:"mention",start:h-j,end:i-j,text:a.text,data:a});return k&&(b.checkCursorPositionAndAdjust(),setTimeout(function(){$(b).triggerHandler(d.mentionAdded,{id:a.id})})),k}},{key:"replaceCurrentWordWithMention",value:function(a,b){var c=this;if(a=a||{},b=b||"",!a.id||!a.text||!b.length)return!1;var e=c.getCursorPositionWithBOM(),f=e-b.length,g=e;c.replaceTextRangeWith(a.text,f,g);var h=f,i=f+a.text.length,j=c.bomCountBeforeIndex(f),k=c.addMetaBlock({id:a.id,type:"mention",start:h-j,end:i-j,text:a.text,data:a});return k&&(c.checkCursorPositionAndAdjust(),setTimeout(function(){$(c).triggerHandler(d.mentionAdded,{id:a.id})})),k}},{key:"replaceTextBeforeCursorWith",value:function(a,b){var c=this,d=c.getCursorPositionWithBOM(),e=d-a.length,f=d;c.replaceTextRangeWith(b,e,f),c.syncText()}},{key:"insertTextAtCursorPosition",value:function(a,b){var c=this,d=c.textarea,e=d.value;e=e.substring(0,d.selectionStart)+a+e.substring(d.selectionEnd),b+=a.length,d.value=e,c.setCursorPosition(b),c.syncText()}}]),b}(c);return f.EVENTS=d,b.StreamsEditor=f,b.StreamsEditor});