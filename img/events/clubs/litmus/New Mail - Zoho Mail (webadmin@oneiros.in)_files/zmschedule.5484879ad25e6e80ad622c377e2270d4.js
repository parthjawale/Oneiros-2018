"use strict";window.zmScheduleTemplates=function(){var a=zmText.get("zmschedule"),b={topBar:['<ul class="SC_schd SC_Phr zmMenuList">',"</ul>"].join(""),topBarRecurring:['<ul class="SC_schd zmMenuList">',"</ul>"].join(""),sendLater:['<li data-val="0" class="nohr">',"<b>"+a.schedule.title+"</b></li>",'<li class="selCheck"><i class="msi-none" data-val="1"></i>'+a.schedule.onehr+"</li>",'<li class="selCheck"><i class="msi-none" data-val="2"></i>'+a.schedule.twohr+"</li>",'<li class="selCheck"><i class="msi-none" data-val="3"></i>'+a.schedule.fourhr+"</li>",'<li class="selCheck"><i class="msi-none" data-val="4"></i>'+a.schedule.Tmrmrn+"</li>",'<li class="selCheck"><i class="msi-none" data-val="5"></i>'+a.schedule.Tmraft+"</li>",'<li class="SC_lne"></li>','<li class="nohr selCheck"><div class="SC_dib"><i class="msi-none" data-val="6"></i>',a.schedule.schat,'</div><div class="ZM_date SC_dib">','<input type="textbox" class="SC_input" data-type="date" readonly>','</div><div class="ZM_time SC_dib"><input type="textbox" class="SC_input" data-type="time"></div></li>','<li class="SC_lne SC_line"></li>'].join(""),recBand:["<li><b>"+a.recurring.title+"</b></li>","<li>",'<div><div class="SC_dib">','<div class="SC_select repeatType">','<select><option value="1">',a.recurring.daily+'</option><option value="2">',a.recurring.weekly+'</option><option value="3">',a.recurring.monthly+'</option><option value="4">',a.recurring.yearly+"</option></select>","</div></div>",'<div class="SC_dib"><div class="SC_select repeatLimit">','<select><option value="2">'+a.recurring.nodt+"</option>",'<option value="1">'+a.recurring.until+"</option>",'<option value="3">'+a.recurring.noof+"</option></select>","</div></div>",'<div class="SC_dib ZM_date SC_dyn">','<input type="textbox" class="SC_input" data-type="date"></div>','<div class="SC_dib SC_dyn repeatCount">','<input type="textbox" style="width:50px !important"> '+a.recurring.times+"</div>","</div></li>"].join(""),recStartDate:['<li class="SC_lne"></li>','<li class="nohr"><div class="SC_dib">'+a.recurring.startdt+"</div>",'<div class="ZM_rdate SC_dib"><input type="textbox" class="SC_input" data-type="date"></div>','<div class="ZM_rtime SC_dib"><input type="textbox" class="SC_input" data-type="time"></div>',"</li>"].join(""),monthStr:['<select class="monthStr"><option value="0">'+a.months.jan+"</option>",'<option value="1">'+a.months.feb+"</option>",'<option value="2">'+a.months.mar+"</option>",'<option value="3">'+a.months.apl+"</option>",'<option value="4">'+a.months.may+"</option>",'<option value="5">'+a.months.jun+"</option>",'<option value="6">'+a.months.jul+"</option>",'<option value="7">'+a.months.aug+"</option>",'<option value="8">'+a.months.sep+"</option>",'<option value="9">'+a.months.oct+"</option>",'<option value="10">'+a.months.nov+"</option>",'<option value="11">'+a.months.dec+"</option></select>"].join(""),dateStr:['<select class="dateStr"><option value="1">'+a.recurring.first+"</option>",'<option value="2">'+a.recurring.second+"</option>",'<option value="3">'+a.recurring.third+"</option>",'<option value="4">'+a.recurring.fourth+"</option>",'<option value="5">'+a.recurring.last+"</option></select>"].join(""),dayStr:['<select class="dayStr"><option value="1">'+a.days.sunday+"</option>",'<option value="2">'+a.days.monday+"</option>",'<option value="3">'+a.days.tuesday+"</option>",'<option value="4">'+a.days.wednesday+"</option>",'<option value="5">'+a.days.thursday+"</option>",'<option value="6">'+a.days.friday+"</option>",'<option value="7">'+a.days.saturday+"</option></select>"].join(""),repeatFrequency:['<li style="display:none;" class="checkBox" data-key="repeatFrequency">','<div class="SC_dib"><i class="msi-option"></i>',a.recurring.recurev+" </div>",'<div class="SC_dib"><input type="text" class="repeatFrequency SC_input" style="width:40px;">',"</div>"+a.recurring.dayon+"</li>"].join(""),dailyRepeatWeek:['<li style="display:none;" class="checkBox" data-key="dailyRepeatOnlyOnWeekDays">','<i class="msi-unoption"></i>',a.recurring.evweek+"</li>"].join(""),weeklyRepeatDays1:['<li style="display:none;" data-key="weeklyRepeatDays">','<div class="SC_dib"> '+a.recurring.recurev+" </div>",'<div class="SC_dib"><input type="text" class="weeklyRepeatDays" style="width:40px;">',"</div>"+a.recurring.weekon+"</li>"].join(""),weeklyRepeatDays2:['<li style="display:none;"" data-key="weeklyRepeatDays">','<div class="SC_ft90" data-key="1"><i class="msi-uncheck"></i>'+a.days.sun+"</div>",'<div class="SC_ft90" data-key="2"><i class="msi-uncheck"></i>'+a.days.mon+"</div>",'<div class="SC_ft90" data-key="3"><i class="msi-uncheck "></i>'+a.days.tue+"</div>",'<div class="SC_ft90" data-key="4"><i class="msi-uncheck "></i>'+a.days.wed+"</div>",'<br style="clear:both;">','<div class="SC_ft90"  data-key="5"><i class="msi-uncheck "></i>'+a.days.thu+"</div>",'<div class="SC_ft90"  data-key="6"><i class="msi-uncheck "></i>'+a.days.fri+"</div>",'<div class="SC_ft90"  data-key="7"><i class="msi-uncheck "></i>'+a.days.sat+"</div></li>"].join(""),monthlyString:['<li style="display:none;" class="checkBox" data-key="monthlyRepeatDay">','<div class="SC_dib"><i class="msi-option"></i>',a.common.day,'</div> <input type="text" class="monthlyRepeatDay" style="width:40px;">',' <div class="SC_dib">'+a.recurring.ofevery,'</div> <input type="text" class="monthlyRepeatFrequency" style="width:40px;">',a.recurring.months+"</li>"].join(""),monthlyRepeat:function(b,c){return['<li style="display:none;" class="checkBox" data-key="monthlyRepeat">','<i class="msi-unoption"></i>'+a.common.on+' <div class="SC_select">',b+'</div><div class="SC_select SC_dib">'+c+"</div>",' <div class="SC_dib">'+a.recurring.ofevery+"</div>",' <input type="text" class="monthRepeatFreq" style="width:40px;">',a.recurring.months+" </div></li>"].join("")},monthlyDays:["<select>",'<option value="1">'+a[1]+"</option>",'<option value="2">'+a[2]+"</option>",'<option value="3">'+a[3]+"</option>",'<option value="4">'+a[4]+"</option>",'<option value="5">'+a[5]+"</option>",'<option value="6">'+a[6]+"</option>",'<option value="7">'+a[7]+"</option>",'<option value="8">'+a[8]+"</option>",'<option value="9">'+a[9]+"</option>",'<option value="10">'+a[10]+"</option>",'<option value="11">'+a[11]+"</option>",'<option value="12">'+a[12]+"</option>",'<option value="13">'+a[13]+"</option>",'<option value="14">'+a[14]+"</option>",'<option value="15">'+a[15]+"</option>",'<option value="16">'+a[16]+"</option>",'<option value="17">'+a[17]+"</option>",'<option value="18">'+a[18]+"</option>",'<option value="19">'+a[19]+"</option>",'<option value="20">'+a[20]+"</option>",'<option value="21">'+a[21]+"</option>",'<option value="22">'+a[22]+"</option>",'<option value="23">'+a[23]+"</option>",'<option value="24">'+a[24]+"</option>",'<option value="25">'+a[25]+"</option>",'<option value="26">'+a[26]+"</option>",'<option value="27">'+a[27]+"</option>",'<option value="28">'+a[28]+"</option>",'<option value="29">'+a[29]+"</option>",'<option value="30">'+a[30]+"</option>",'<option value="31">'+a[31]+"</option>",'<option value="-1">'+a.onlast+"</option>","</select>"].join(""),yearlyString:function(b,c,d){return['<li style="display:none;" class="checkBox" data-key="yearlyRepeatDay">','<i class="msi-option"></i>',a.recurring.every+'  <div class="SC_select SC_dib">',b+'</div><div class="SC_dib">','<input type="text" class="yearlyRepeatDay" style="width:40px;">',"</div></li>",'<li class="checkBox" style="display:none;" data-key="yearlyRepeatDayOfMonth">','<i class="msi-unoption"></i>',a.recurring.every+'  <div class="SC_select">',c+'</div><div class="SC_select SC_dib">',d+'</div> of <div class="SC_select">',b+"</div></li>"].join("")},buttonLine:['<li class="SC_lne SC_rline"></li>'].join(""),recurringButton:['<div class="SC_PUbtm SC_rbuttons">','<span class="SC_rok">'+a.common.save+"</span>"].join(""),clearLink:['<div class="SC_frt SC_link SC_thm SC_clr">'+a.common.clear+"</div>"].join("")};return b}(),window.zmSchedule=function(){var a={},b="",c=function(){var a=zmText.get("zmschedule");return a}(),d={},e=function(a,b){switch(a){case"0":case"2":case"4":case"6":case"7":case"9":case"11":if(b>=1&&b<=31)return!0;break;case"3":case"5":case"8":case"10":if(b>=1&&b<=30)return!0;break;case"1":if(b>=1&&b<=29)return!0}return!1},f=function(){return a},g=function(b,c){var d=a[b].ele;a[b].schedule=c;var e=zmSchedule.getRecurringObject(b);null!==c?$(d).addClass("SC_thm"):e||$(d).removeClass("SC_thm")},h=function(b,c){a[b].recurring=c;var d=a[b].ele,e=zmSchedule.getScheduleObject(b);null!==c?$(d).addClass("SC_thm"):e||$(d).removeClass("SC_thm");var f=zmSchedule.showTitle(b),g={};g.tooltip=f,g.ele=d,zmSchedule.updateTooltip(g)},i=function(a,c){var d=1;if(a.WRD){b="weeklyRepeatDays",c.find("i").attr("class","msi-uncheck"),c.find(".weeklyRepeatDays").val(a.RPTI);for(var e=0,f=a.WRD.length;e<f;e++)c.next().find('div[data-key="'+a.WRD[e]+'"]').trigger("click")}else if(a.DRWD)b="dailyRepeatOnlyOnWeekDays",c.next().filter("[data-key=dailyRepeatOnlyOnWeekDays]").trigger("click"),c.find(".repeatFrequency").val(d);else if(a.MRD)b="monthlyRepeatDay",c.filter("[data-key=monthlyRepeatDay]").trigger("click"),c.find(".monthlyRepeatFrequency").val(a.RPTI),c.filter("[data-key=monthlyRepeatDay]").find(".monthlyRepeatDay").val(a.MRD),c.next().find(".monthRepeatFreq").val(d);else if(a.MRDM)b="monthlyRepeat",c.next().filter("[data-key=monthlyRepeat]").trigger("click"),c.next().find(".dateStr").val(a.MRDM),c.next().find(".dayStr").val(a.MRWD),c.next().find(".monthRepeatFreq").val(a.RPTI),c.find(".monthRepeatFreq").val(d),c.filter("[data-key=monthlyRepeatDay]").find(".monthlyRepeatFrequency").val(d),c.filter("[data-key=monthlyRepeatDay]").find(".monthlyRepeatDay").val(d);else if(a.YRD)b="yearlyRepeatDay",c.filter("[data-key=yearlyRepeatDay]").trigger("click"),c.find(".monthStr").val(a.YRM),c.find(".yearlyRepeatDay").val(a.YRD);else if(a.YRDM){b="yearlyRepeatDayOfMonth",c.next().filter("[data-key=yearlyRepeatDayOfMonth]").trigger("click");var g=c.next().filter("[data-key=yearlyRepeatDayOfMonth]");g.find(".monthStr").val(a.YRM),g.find(".dateStr").val(a.YRDM),g.find(".dayStr").val(a.YRWD),c.filter("[data-key=yearlyRepeatDay]").find(".yearlyRepeatDay").val(d)}else b="repeatFrequency",c.find("[data-key=repeatFrequency]").trigger("click"),c.find(".repeatFrequency").val(a.RPTI)},j=function(a,b){var c=a.RPT,d=String(a.RL),e=b.recurringElement.find("div.ZM_date"),f=b.recurringElement.find("div.repeatCount");switch(b.recurringElement.find(".repeatType select").val(c),b.recurringElement.find(".repeatLimit select").val(d),d){case"1":e.find("input").val(a.RU),f.addClass("SC_dyn"),e.removeClass("SC_dyn");break;case"2":f.addClass("SC_dyn"),e.addClass("SC_dyn");break;case"3":f.find("input").val(a.RC),f.removeClass("SC_dyn"),e.addClass("SC_dyn")}var g=parseInt(c)-1,h=g;0!==g&&(h=2*g);var j=$(b.recurringChild[h]);b.recurringChild.hide(),j.show(),j.next().show(),j.attr("data-set","true"),j.next().attr("data-set","true"),i(a,j)},k=function(a){var b=new Date((new Date).getTime()+60*a*60*1e3),c=b.getHours(),d=b.getMinutes(),e=c>=12?"PM":"AM";return(c<10?"0":"")+c+":"+(d<10?"0":"")+d+" "+e};d.sendLater=function(){return zmScheduleTemplates.sendLater},d.buttonRecurring=function(){return zmScheduleTemplates.recurringButton},d.clearLinkHtml=function(){return zmScheduleTemplates.clearLink},d.recurring=function(){return zmScheduleTemplates.recBand},d.recurringChild=function(){var a=zmScheduleTemplates.dateStr,b=zmScheduleTemplates.dayStr,c=zmScheduleTemplates.monthStr;return[zmScheduleTemplates.repeatFrequency,zmScheduleTemplates.dailyRepeatWeek,zmScheduleTemplates.weeklyRepeatDays1,zmScheduleTemplates.weeklyRepeatDays2,zmScheduleTemplates.monthlyString,zmScheduleTemplates.monthlyRepeat(a,b),zmScheduleTemplates.yearlyString(c,a,b)].join("")},d.buttonHtml=function(){return zmScheduleTemplates.buttonLine},d.topBarHtml=function(){return zmScheduleTemplates.topBar},d.StartDateHtml=function(){return zmScheduleTemplates.recStartDate},d.topBarRecurringHtml=function(){return zmScheduleTemplates.topBarRecurring};var l=function(a){var b=$(zmSchedule.returnTemplate("topBar")),d=$(zmSchedule.returnTemplate("sendLater")),e=$(zmSchedule.returnTemplate("recurring")),f=$(zmSchedule.returnTemplate("recurringChild")),g=$(zmSchedule.returnTemplate("button")),h=$(zmSchedule.returnTemplate("startDate")),i=$(zmSchedule.returnTemplate("clearLink")),j=$(zmSchedule.returnTemplate("topBarRecurring")),k={};k.id=a,k.tabs=[{id:"tab1",tabName:"schedule",text:c.title.sendLater,selected:!0,onClk:function(a){$(b).html(""),b.append(d),zmSchedule.bindScheduleEvents({scheduleElement:d,clearElement:i,topBarElement:b},a)},buttons:[{text:c.common.save,onClk:function(c){zmSchedule.setSchObj(a,{scheduleElement:d,topBarElement:b}),c.close()}}],listingArea:{}},{id:"tab2",tabName:"recurring",text:c.title.recurring,onClk:function(a){$(j).html(""),j.append(e),j.append(f),j.append(h),j.append(g),zmSchedule.bindRecurringEvents({recurringElement:e,recurringChild:f,buttonElement:g,startElement:h,topBarElement:j,clearElement:i},a)},buttons:[{text:c.common.save,onClk:function(b){zmSchedule.setRecObj(a,{recurringElement:e,recurringChild:f,buttonElement:g,startElement:h,topBarElement:j},b)}}],listingArea:{}}],k.onClose=function(){};var l=zmsDialog.createTabPopupDialog(k);zmSchedule.getRecurringObject(a)?($("#tab2").trigger("click"),l.getButtonContainer("recurring").append(i),i.addClass("SC_clr")):zmSchedule.getScheduleObject(a)&&(l.getButtonContainer("schedule").append(i),i.addClass("SC_clr"))},m=function(a){switch(a=String(a)){case"1":return c.days.sunday;case"2":return c.days.monday;case"3":return c.days.tuesday;case"4":return c.days.wednesday;case"5":return c.days.thursday;case"6":return c.days.friday;case"7":return c.days.saturday}},n=function(a){switch(a=String(a)){case"1":return c.recurring.first;case"2":return c.recurring.second;case"3":return c.recurring.third;case"4":return c.recurring.fourth;case"5":return c.recurring.last}},o=function(a){switch(a=String(a)){case"0":return c.months.jan;case"1":return c.months.feb;case"2":return c.months.mar;case"3":return c.months.apl;case"4":return c.months.may;case"5":return c.months.jun;case"6":return c.months.jul;case"7":return c.months.aug;case"8":return c.months.sep;case"9":return c.months.oct;case"10":return c.months.nov;case"11":return c.months.dec}},p={returnTemplate:function(a){var b;return"sendLater"===a?b=d.sendLater():"recurring"===a?b=d.recurring():"recurringChild"===a?b=d.recurringChild():"button"===a?b=d.buttonHtml():"topBar"===a?b=d.topBarHtml():"startDate"===a?b=d.StartDateHtml():"clearLink"===a?b=d.clearLinkHtml():"topBarRecurring"===a?b=d.topBarRecurringHtml():"buttonRecurring"===a&&(b=d.buttonRecurring()),b},showTitle:function(b){var d,e,f,g,h="",i="",j=zmSchedule.getRecurringObject(b),k="",l="";if(j){if(j.WRD){if(h=c.title.week,k="",7===j.WRD.length)k=c.days.daily;else for(var p=0,q=j.WRD.length;p<q;p++)k=k+m(j.WRD[p])+" , ";i=zmText.applyArgs(h,{weekdays:k,num:j.RPTI})}else j.DRWD?i=c.title.daily2:j.MRD?(h=c.title.monthly1,i=zmText.applyArgs(h,{day:j.MRD,num:j.RPTI})):j.MRDM?(g={num:d,weekday:k,number:j.RPTI},d=n(j.MRDM),k=m(j.MRWD),h=c.title.monthly2,i=zmText.applyArgs(h,g)):j.YRD?(h=c.title.yearly1,e=o(j.YRM),i=zmText.applyArgs(h,{month:e,day:j.YRD})):j.YRDM?(h=c.title.yearly2,e=o(j.YRM),d=n(j.YRDM),f=m(j.YRWD),i=zmText.applyArgs(h,{date:d,day:f,month:e})):(h=c.title.daily1,i=zmText.applyArgs(h,{day:j.RPTI}));l=i}else l=a[b].title;return l},showRecurring:function(b){var c=a[b].component,d=$(zmSchedule.returnTemplate("recurring")),e=$(zmSchedule.returnTemplate("recurringChild")),f=$(zmSchedule.returnTemplate("button")),g=$(zmSchedule.returnTemplate("clearLink")),h=$(zmSchedule.returnTemplate("buttonRecurring")),i=$(zmSchedule.returnTemplate("topBarRecurring")),j=$(zmSchedule.returnTemplate("startDate")),k=$("<div></div>");return h.addClass("SC_p10"),h.append(g),g.removeClass("SC_clr").addClass("SC_rclr"),i.removeClass().addClass("SC_schd"),"task"===c&&(j.hide(),zmSchedule.getRecurringObject(b)?g.show():g.hide()),$(i).html(""),i.append(d),i.append(e),i.append(j),i.append(f),i.append(h),k.append(i),zmSchedule.bindRecurringEvents({recurringElement:d,recurringChild:e,buttonElement:h,startElement:j,topBarElement:i,clearElement:g},{id:b,isTaskRef:!0}),k},scheduleDROP:function(a){var b=$("<div></div>");if("zm_sendLater"===a){var c=$(zmSchedule.returnTemplate("sendLater"));b.append(c),zmSchedule.bindScheduleEvents({scheduleElement:c})}return b},getScheduleTitle:function(a){var b=zmSchedule.getScheduleObject(a),d="";if(6===b.scheduleType){var e=b.customTime;e=e.split(" ");var f=e[0]+":"+e[1];d=c.schedule.scheat+" "+f+" "+c.schedule.modify}else 5===b.scheduleType?d=c.schedule.tma:4===b.scheduleType?d=c.schedule.tmm:3===b.scheduleType?d=c.schedule.toat+" "+k(4):2===b.scheduleType?d=c.schedule.toat+" "+k(2):1===b.scheduleType&&(d=c.schedule.toat+" "+k(1));return d},processScheduleObject:function(b,d){if(a[b]||(a[b]={}),d.SCTI){var e=d.SCTI.split(" "),f=e[0],h=e[1].substr(0,e[1].lastIndexOf(":"));if(g(b,{scheduleType:6,customTime:f+" "+h}),"st"!==zmComp.getType(b)){var i=c.schedule.scheat+" "+f+":"+h+" "+c.schedule.modify,j={};j.tooltip=i;var k=a[b].ele;if(!k){var l=zmsuite.getCenter(b)[0].getNodes()[0].$el;k=$(l).find("[data-event='cmp_schedule']")[0]}j.ele=k,zmSchedule.updateTooltip(j)}}else d.SCT&&g(b,{scheduleType:d.SCT,customTime:""})},processRecurringObject:function(b,c){a[b]||(a[b]={});var d={};for(var e in c)"SCTX"!==e&&"OT"!==e&&c[e]!==-1&&("WRD"===e&&"string"==typeof c[e]?d[e]=$.parseJSON(c[e]):d[e]=c[e]);h(b,d)},getScheduleObject:function(b){var c=!1;return a[b]&&a[b].schedule&&null!==a[b].schedule&&(c=a[b].schedule),c},getRecurringObject:function(b){var c=!1;return a[b]&&a[b].recurring&&null!==a[b].recurring&&(c=a[b].recurring),c},setRecObj:function(d,f,i){g(d,null),h(d,null);var j=f.recurringElement.find(".repeatType>select").val(),k={},l=f.recurringElement.find(".repeatLimit select").val();switch(k={RPT:j,RL:l},l){case"1":if(k.RU=f.recurringElement.find(".ZM_date input").val(),""===k.RU)return zmSchUtil.showMsg(d,"e",c.error.invalidDate,"","u"),!1;break;case"3":var m=f.recurringElement.find(".repeatCount input").val();if(""===m||isNaN(m)||"0"===m)return zmSchUtil.showMsg(d,"e",c.error.invalid,"","u"),f.recurringElement.find(".repeatCount input").focus(),!1;k.RC=m}var n=f.recurringChild.filter("li[data-set=true]"),o="";o=b;var p,q,r,s,t;switch(o){case"repeatFrequency":var u=n.find(".repeatFrequency").val();if(""===u||isNaN(u)||"0"===u)return zmSchUtil.showMsg(d,"e",c.error.invalid,"","u"),n.find(".repeatFrequency").focus(),!1;k.RPTI=u;break;case"dailyRepeatOnlyOnWeekDays":k.DRWD="true";break;case"monthlyRepeatDay":var v=n.find(".monthlyRepeatDay").val();if(p=n.find(".monthlyRepeatFrequency").val(),!(""!==v&&!isNaN(v)&&v>=1&&v<=31))return zmSchUtil.showMsg(d,"e",c.error.invalid,"","u"),n.find(".monthlyRepeatDay").focus(),!1;if(k.MRD=v,""===p||isNaN(p)||"0"===p)return zmSchUtil.showMsg(d,"e",c.error.invalid,"","u"),n.find(".monthlyRepeatFrequency").focus(),!1;k.RPTI=p;break;case"monthlyRepeat":var w=n.find(".dateStr").val(),x=n.find(".dayStr").val();if(p=n.find(".monthRepeatFreq").val(),""===p||isNaN(p)||"0"===p)return zmSchUtil.showMsg(d,"e",c.error.invalid,"","u"),n.find(".monthRepeatFreq").focus(),!1;k.RPTI=p,k.MRDM=w,k.MRWD=x;break;case"weeklyRepeatDays":p=n.find(".weeklyRepeatDays").val();for(var y=[],z=$(n.find("i.msi-check")),A=0;A<z.length;A++)y.push($(z[A]).parent().data("key"));if(""===p||isNaN(p)||"0"===p)return zmSchUtil.showMsg(d,"e",c.error.invalid,"","u"),n.find(".weeklyRepeatDays").focus(),!1;k.RPTI=p,k.WRD=y;break;case"yearlyRepeatDay":q=n.filter("[data-key='yearlyRepeatDay']").find(".monthStr").val(),t=n.find(".yearlyRepeatDay").val();var B=e(q,t);if(""===t||isNaN(t)||"0"===t||!B)return zmSchUtil.showMsg(d,"e",c.error.invalid,"","u"),n.find(".yearlyRepeatDay").focus(),!1;k.YRD=t,k.YRM=q;break;case"yearlyRepeatDayOfMonth":q=n.filter("[data-key='yearlyRepeatDayOfMonth']").find(".monthStr").val(),r=n.find(".dateStr").val(),s=n.find(".dayStr").val(),k.YRM=q,k.YRDM=r,k.YRWD=s}if("task"!==a[d].component){var C=f.startElement.find(".ZM_rdate input").val(),D=f.startElement.find(".ZM_rtime input").val();""===D&&(D="00:00"),k.RD=C+" "+D+":00"}return h(d,k),zmSchUtil.hideDatePicker(),void 0!==i&&i.close(),!0},setSchObj:function(b,d){g(b,null),h(b,null);var e,f={},i=d.scheduleElement.find("i.msi-tick").data("val");if(6!==i){g(b,{scheduleType:i,customTime:""});var j=d.scheduleElement.find("i.msi-tick").parent().attr("title");e=c.schedule.scheduled+" "+j+" "+c.schedule.modify,f.tooltip=e,f.ele=a[b].ele,zmSchedule.updateTooltip(f)}else{var k=d.scheduleElement.find(".ZM_date input").val(),l=d.scheduleElement.find(".ZM_time input").val();""===l&&(l="00:00"),g(b,{scheduleType:i,customTime:k+" "+l});var m=k+":"+l;e=c.schedule.scheat+" "+m+" "+c.schedule.modify,f.tooltip=e,f.ele=a[b].ele,zmSchedule.updateTooltip(f)}zmUtil.hideMenu(),zmSchUtil.hideTimePicker(),zmSchUtil.hideDatePicker()},confirmDel:function(a,b,c,d){var e={};e.onOk=function(){"zm_recur"===d?zmSchedule.setRecObj(b,c):"zm_sched"===d&&zmSchedule.setSchObj(b,c)},e.stopPropagation=!0,zmsDialog.confirm(a,e)},bindScheduleEvents:function(b,d){var e=d.id;void 0!==d&&d.getCenterElem(d.configOption.tabs[0].tabName).html($(b.topBarElement));var f=zmSchedule.getScheduleObject(e),h="",i="";b.scheduleElement.filter(".selCheck").off("click").on("click",function(){if(0!==$(this).data("val")){b.scheduleElement.filter(".selCheck").find("i").attr("class","msi-none");var a=$(this).find("i");a.toggleClass("msi-tick"),a.removeClass("msi-none"),b.scheduleElement.filter(".SC_buttons").show(),b.scheduleElement.filter(".SC_line").show()}}),b.scheduleElement.find(".ZM_time input").off("click").on("click",function(){b.scheduleElement.filter(".selCheck").find("i").removeClass("msi-tick"),$(this).parent().parent().find("i").toggleClass("msi-tick"),b.scheduleElement.filter(".SC_buttons").show(),b.scheduleElement.filter(".SC_line").show()});var j=b.scheduleElement.filter("li");if($(j[1]).attr("title",c.schedule.toat+" "+k(1)),$(j[2]).attr("title",c.schedule.toat+" "+k(2)),$(j[3]).attr("title",c.schedule.toat+" "+k(4)),$(j[4]).attr("title",c.schedule.tmm),$(j[5]).attr("title",c.schedule.tma),b.clearElement.filter(".SC_clr").off("click").on("click",function(){var c={};c.tooltip=a[e].title,c.ele=a[e].ele,zmSchedule.updateTooltip(c),b.scheduleElement.filter(".selCheck").find("i").removeClass("msi-tick"),g(e,null),$(b.scheduleElement.filter(".selCheck")[0]).trigger("click"),d.close(),$(this).remove(),zmSchUtil.hideTimePicker(),zmSchUtil.hideDatePicker()}),f){var l=$(b.scheduleElement.find("i"));for(var m in l)if($(l[m]).data("val")===f.scheduleType){$(l[m]).addClass("msi-tick");break}}else $(b.scheduleElement.filter(".selCheck")[0]).trigger("click");if(f&&6===f.scheduleType){var n=f.customTime.split(" ");i=n[0],h=n[1];var o=c.schedule.scheat+"  "+i+":"+h+" "+c.schedule.modify,p={};p.tooltip=o,p.ele=a[e].ele,zmSchedule.updateTooltip(p)}else{var q=zmSchedule.getDateAndTime(5);h=q.time,i=q.date}b.scheduleElement.find(".ZM_date input").val(i),b.scheduleElement.find(".ZM_time input").val(h),zmSchUtil.bindDatePicker(b.scheduleElement.find(".ZM_date")[0]),zmSchUtil.bindTimePicker(b.scheduleElement.find(".ZM_time input")[0])},getDateAndTime:function(a){var b=new Date;b.setMinutes(b.getMinutes()+a);var c=String(b.getHours()),d=String(b.getMinutes()),e=c.length>1?c:"0"+b.getHours(),f=d.length>1?d:"0"+b.getMinutes(),g=e+":"+f,h=b.getDateBy(zmail.userDateFormat.toUpperCase());return{date:h,time:g}},bindRecurringEvents:function(d,e){var f,g=e.id;void 0===e||e.isTaskRef||e.getCenterElem(e.configOption.tabs[1].tabName).html($(d.topBarElement));var k=zmSchedule.getRecurringObject(g);if(d.buttonElement.find(".SC_rclr").off("click").on("click",function(){"task"===a[g].component&&d.buttonElement.find(".SC_rclr").hide(),$(d.recurringChild[0]).show(),$(d.recurringChild[1]).show(),h(g,null);var b={};b.tooltip=a[g].title,b.ele=a[g].ele,zmSchedule.updateTooltip(b);var c=a[g].callback;c("clear"),zmSchUtil.hideDatePicker()}),d.buttonElement.find(".SC_rok").off("click").on("click",function(){if(zmSchedule.getScheduleObject(g))zmSchedule.confirmDel(c.schedule.setMsg,g,d,"zm_recur");else{var b=zmSchedule.setRecObj(g,d);if("task"===a[g].component){var e=a[g].callback;e(b)}else zmUtil.hideMenu()}}),d.clearElement.filter(".SC_clr").off("click").on("click",function(){$(this).remove(),h(g,null);var c={};c.tooltip=a[g].title,c.ele=a[g].ele,zmSchedule.updateTooltip(c),e.close(),d.recurringElement.find(".repeatLimit select").val("2").trigger("change"),d.recurringElement.find(".repeatType select").val("1").trigger("change"),$(d.recurringChild).hide(),$(d.recurringChild[0]).show(),$(d.recurringChild[1]).show(),$(d.recurringChild[0]).attr("data-set","true"),$(d.recurringChild[1]).attr("data-set","true"),$(d.recurringChild[0]).trigger("click"),b="repeatFrequency",d.recurringChild.filter("[data-key='repeatFrequency']").find(".repeatFrequency").val("1"),zmSchUtil.hideDatePicker();var f=zmSchedule.getDateAndTime(5);d.startElement.find(".ZM_rdate input").val(f.date),d.startElement.find(".ZM_rtime input").val(f.time)}),d.recurringElement.off("change.repeatType").on("change.repeatType",".repeatType select",function(){var a=$(this).val(),b=parseInt(a)-1,c=b;0!==b&&(c=2*b);var e=$(d.recurringChild[c]);switch(d.recurringChild.attr("data-set","false"),d.recurringChild.hide(),e.show(),e.next().show(),e.attr("data-set","true"),e.next().attr("data-set","true"),a){case"1":d.recurringChild.filter("[data-key=repeatFrequency]").trigger("click"),d.recurringChild.filter("[data-key='repeatFrequency']").find(".repeatFrequency").val("1");var g=k,h=!0;(g.WRD||g.MRD||g.MRDM||g.YRD||g.YRDM)&&(h=!1),(g.DRWD||g.RPTI&&!h)&&(f=d.recurringChild.filter("[data-key=repeatFrequency]"),i(g,f));break;case"2":var j=d.recurringChild.filter("[data-key='weeklyRepeatDays']");j.find(".weeklyRepeatDays").val("1"),k.WRD?(f=d.recurringChild.filter("[data-key=weeklyRepeatDays]"),i(k,f)):j.find('[data-key="1"]').trigger("click");break;case"3":var l=d.recurringChild.filter("[data-key='monthlyRepeatDay']");l.trigger("click"),l.find(".monthlyRepeatDay").val("1"),l.find(".monthlyRepeatFrequency").val("1"),d.recurringChild.filter("[data-key='monthlyRepeat']").find(".monthRepeatFreq").val("1"),(k.MRD||k.MRDM)&&(f=d.recurringChild.filter("[data-key=monthlyRepeatDay]"),i(k,f));break;case"4":d.recurringChild.filter("[data-key=yearlyRepeatDay]").trigger("click"),d.recurringChild.filter("[data-key='yearlyRepeatDay']").find(".yearlyRepeatDay").val("1"),(k.YRD||k.YRDM)&&(f=d.recurringChild.filter("[data-key=yearlyRepeatDay]"),i(k,f))}}),d.recurringElement.off("change.repeatLimit").on("change.repeatLimit",".repeatLimit select",function(){var a=$(this),b=a.val(),c=a.parent().parent().parent(),d=c.find("div.ZM_date"),e=c.find("div.repeatCount");switch(b){case"1":d.removeClass("SC_dyn"),d.find("input").val(zmail.userDateVal),e.addClass("SC_dyn");break;case"2":e.addClass("SC_dyn"),d.addClass("SC_dyn");break;case"3":d.addClass("SC_dyn"),e.removeClass("SC_dyn"),e.find("input").val("1")}}),zmSchUtil.bindDatePicker(d.recurringElement.find(".ZM_date")[0]),d.recurringChild.off("click.checkBox").on("click.checkBox",function(){var a=d.recurringChild.filter(":not([data-key='weeklyRepeatDays'])");a.find("i").attr("class","msi-unoption"),b=$(this).data("key"),$(this).filter(":not([data-key='weeklyRepeatDays'])").find("i").attr("class","msi-option")}),d.recurringChild.find("div.SC_ft90").off("click").on("click",function(a){var b=$(this);b.find("i").hasClass("msi-uncheck")?b.find("i").attr("class","msi-check"):b.parent().find("i.msi-check").length-1!==0&&b.find("i").attr("class","msi-uncheck"),a.preventDefault()}),k&&k.RPT){if("task"===a[g].component&&d.buttonElement.find(".SC_rclr").show(),j(k,d),k.RD){var l=k.RD.split(" "),m=l[0],n=l[1].substr(0,l[1].lastIndexOf(":"));d.startElement.find(".ZM_rdate input").val(m),d.startElement.find(".ZM_rtime input").val(n)}}else{"task"===a[g].component&&d.buttonElement.find(".SC_rclr").hide(),$(d.recurringChild[0]).show(),$(d.recurringChild[1]).show(),$(d.recurringChild[0]).attr("data-set","true"),$(d.recurringChild[1]).attr("data-set","true"),b="repeatFrequency",d.recurringChild.filter("[data-key='repeatFrequency']").find(".repeatFrequency").val("1");var o=zmSchedule.getDateAndTime(5);d.startElement.find(".ZM_rdate input").val(o.date),d.startElement.find(".ZM_rtime input").val(o.time)}zmSchUtil.bindDatePicker(d.startElement.find(".ZM_rdate")[0]),zmSchUtil.bindTimePicker(d.startElement.find(".ZM_rtime input")[0])},getCmpScheduleObj:f,updateTooltip:function(a){var b=a.tooltip;a.ele&&a.ele[0]&&zmComponent.tooltip({elm:a.ele[0],text:b,arrow:"top"})},initScRec:function(b){var c=b.id;switch(a[c]||(a[c]={}),b.title&&(a[c].title=b.title),b.component&&(a[c].component=b.component),b.callback&&(a[c].callback=b.callback),a[c].type=b.type,a[c].ele=b.ele,b.type){case 1:var d=zmSchedule.showRecurring(c);return d;case 2:l(c)}}};return p}(),window.zmSchUtil=function(){var a={showMsg:function(a,b,c,d,e,f){zmUtil.debugLog(a,b,d,e,f),zmUtil.succErrMsg("e",c)},bindDatePicker:function(a,b){if("undefined"!=typeof ZEVENTS){var c=zmail.userDateFormat.toUpperCase(),d=zmail.userDateVal;void 0!==a&&ZEVENTS(a).picker("date",{dform:c,wkst:0,mode:"popup",update:"yes",range:[d,""],minhgt:251}).on("dateclick",function(){b&&b(this.getDate().getDateBy(c))}).bind()}},bindTimePicker:function(a){"undefined"!=typeof ZEVENTS&&void 0!==a&&ZEVENTS(a).picker("time",{tform:"HH:mm ss"}).bind()},hideDatePicker:function(){$(".zcal_cn").remove()},hideTimePicker:function(){$(".zcal_tilst").remove()}};return a}();