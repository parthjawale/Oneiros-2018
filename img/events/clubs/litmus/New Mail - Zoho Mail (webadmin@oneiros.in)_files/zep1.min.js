ZE.create=function(a){"use strict";return new ZE(a)},ZE.prototype.execCommand=function(a,b){"use strict";var c,d,e,f=this,g=document,h=["zei-smiley","zei-table","zei-textclr","zei-bgclr"];f.toolbarobject&&(e=f.toolbarobject[b]),f._stopEvent(a),f.squireInstance.focus();var i=a.target,j=function(){var a,b,c=g.getElementsByClassName("ze_tbEd"),d=g.getElementsByClassName("IconDiv")[0],e=g.getElementById("ze_dropdown");a=function(){f.insertIconRef.className="ui-insert",f.insertIconRef.style.visibility="",f.paraIconRef.className="ui-paragraph",f.initobj.microParaToolbar?(f.paraIconRef.className="ui-paragraph",f.paraIconRef.style.visibility=""):f.paraIconRef.style.visibility="hidden"},b=g.getElementById("stickIcon"),b?"zei-unlink"===b.className||e||(c[0].parentElement.removeChild(c[0]),d.parentElement.removeChild(d)):(a(),e||c[0].parentElement.removeChild(c[0])),c[1]&&(a(),c[1].parentElement.removeChild(c[1]))};i.hasAttribute("class")&&h.indexOf(i.className)>=0?i=i.parentElement:"LI"===a.target.nodeName&&(i=i.firstChild);var k=f.toolbarobject;if("smartCompose"===f.initobj.editorType)for(var l in k)switch(k[l].title){case"Font":case"Font Size":case"Heading":case"Font Color":case"Background Color":case"Align Options":case"List Options":case"Smiley":case"Table":if(k[l].title===i.title){if(k[l].hasAttribute("sel"))return k[l].removeAttribute("sel"),ZE.removeClass(k[l],"ze_Sel"),!1;k[l].setAttribute("sel","selected"),ZE.addClass(k[l],"ze_Sel")}else k[l].hasAttribute("sel")&&(k[l].removeAttribute("sel"),ZE.removeClass(k[l],"ze_Sel"))}switch(b){case"forecolor":case"backcolor":case"fontfamily":case"fontsize":f.showDropDown(a,b);break;case"alignoptions":f.showDropDown(a,b,"align");break;case"listoptions":f.showDropDown(a,b,"list");break;case"directionoptions":f.showDropDown(a,b,"textDir");break;case"alignLeft":case"alignRight":case"alignCenter":case"alignjustify":f.updateFormatoptions(a.target,e,"align");break;case"NumBullets":case"DotBullets":f.updateFormatoptions(a.target,e,"list");break;case"LefttoRight":case"RightToLeft":f.updateDirectionOptions(a.target,e,"textDir");break;case"indentoptions":f.showDropDown(a,b,"indent");break;case"otheroptions":f.showDropDown(a,b,"others");break;case"heading":f.showDropDown(a,b,"heading");break;case"smiley":f.showDropDown(a,b);break;case"link":f.createLink(),ZE_Init.needEditorStats&&f.updateCount(b),"smartCompose"===f.initobj.editorType&&j();break;case"tableGrid":f._createTableGrid(a,b),ZE_Init.needEditorStats&&f.updateCount(b);break;case"image":f.createImage(),ZE_Init.needEditorStats&&f.updateCount(b),"smartCompose"===f.initobj.editorType&&j();break;case"table":f.createTable(),ZE_Init.needEditorStats&&f.updateCount(b);break;case"save":if(f.initobj.saveContent){var m=f.doc,n="<html><head>"+m.getElementsByTagName("head")[0].innerHTML;n+="</head><body>"+m.body.innerHTML+"</body></html>",f.initobj.saveContent(n)}break;case"insertoptions":f.insertOptions(a);break;case"quote":f.squireInstance.focus(),f.insertQuote(),ZE_Init.needEditorStats&&f.updateCount(b),"smartCompose"===f.initobj.editorType&&(f.PlaceIcon(),j());break;case"object":f.insertObj(),ZE_Init.needEditorStats&&f.updateCount(b);break;case"code":f.insertCode(),ZE_Init.needEditorStats&&f.updateCount(b);break;case"edithtml":f.htmlView(),ZE_Init.needEditorStats&&f.updateCount(b);break;case"more":f.expandToolbar(a);break;case"attach":c=a.target||a.srcElement,ZE.hasClass(c,"zei-arrow")?f.showDropDown(a,"attach"):f.initobj.id?ZE_Init.attach(f.initobj.id):ZE_Init.attach();break;case"template":c=a.target,ZE_Init.template(f.initobj.id);var o=document.getElementById("alter_toolbar");o&&(o.style.display="none");break;case"signature":c=a.target,ZE_Init.signature(f.initobj.id);break;case"spellcheck":c=a.target||a.srcElement,ZE.hasClass(c,"zei-arrow")?f.spellcheckOptions(a,b):f.spellcheck(a);break;case"plainText":f.updateOtheroptions(a.target,"others"),ZE_Init.needEditorStats&&f.updateCount(b);break;case"bold":d=f.doc.queryCommandState("bold"),d?f.squireInstance.removeBold():f.squireInstance.bold(),f.saveCurrentState(),f.updateToolbar();break;case"italic":d=f.doc.queryCommandState("italic"),d?f.squireInstance.removeItalic():f.squireInstance.italic(),f.saveCurrentState(),f.updateToolbar();break;case"underline":d=f.doc.queryCommandState("underline"),d?f.squireInstance.removeUnderline():f.squireInstance.underline(),f.saveCurrentState(),f.updateToolbar();break;case"j-left":case"j-right":case"j-center":case"j-full":f.squireInstance.setTextAlignment(b.split("-")[1]),f.saveCurrentState(),f.updateToolbar();break;case"insertorderedlist":f.insertListOperation("OL"),f.saveCurrentState();break;case"insertunorderedlist":f.insertListOperation("UL"),f.saveCurrentState();break;case"insertHTML":f.showInsertHTMLDialog();break;case"format":f.formatPainter();break;case"superscript":d=f.doc.queryCommandState(b),d?f.squireInstance.removeSuperscript():f.squireInstance.superscript(),f.saveCurrentState(),f.updateToolbar();break;case"subscript":d=f.doc.queryCommandState(b),d?f.squireInstance.removeSubscript():f.squireInstance.subscript(),f.saveCurrentState(),f.updateToolbar();break;case"lineHeight":f.showDropDown(a,b,"lineHeight");case"removeformat":var p,q=f.getContent();f.win.focus(),ZE_Init.is_ie?f.squireInstance.removeAllFormatting(null):f.doc.execCommand(b,!1,void 0),p=f.getContent(),p!==q&&f.saveCurrentState();break;default:f.doc.execCommand(b,!1,void 0),f.updateToolbar(),ZE_Init.needEditorStats&&f.updateCount(b)}var r=document.getElementsByClassName("ze_SCmb ze_SCmbN")[0];r&&"smiley"!==b&&"tableGrid"!==b&&j()},ZE.prototype.insertListOperation=function(a){"use strict";var b,c=this,d="makeUnorderedList",e="makeOrderedList";switch(a){case"UL":b=c.squireInstance.testPresenceinSelection(d,d,a,/>UL\b/),b?c.squireInstance.removeList():c.squireInstance.makeUnorderedList(),c.updateToolbar();break;case"OL":b=c.squireInstance.testPresenceinSelection(e,e,a,/>OL\b/),b?c.squireInstance.removeList():c.squireInstance.makeOrderedList(),c.updateToolbar()}},ZE.drag=function(a,b){"use strict";var c=document,d=c.body,e=c.getElementById(b),f=e.style,g=ZE.getPos(e),h=a.clientX-g.offsetLeft,i=a.clientY-g.offsetTop,j=d.clientWidth-e.offsetWidth,k=Math.max(d.scrollHeight,c.documentElement.scrollHeight)-e.offsetHeight;return f.cursor="move",f.filter='alpha(opacity="90")',f.opacity="0.9",c.onmousemove=function(b){a=b||window.event;var c=a.clientX-h,d=a.clientY-i;return c>=0&&c<=j?f.left=c+"px":c<0?f.left="0px":c>j&&(f.left=j+"px"),d>=0&&d<=k?f.top=d+"px":d<0?f.top="0px":d>k&&(f.top=k+"px"),!1},c.onmouseup=function(){return f.cursor="",f.filter='alpha(opacity="100")',f.opacity="1",c.onmousemove=null,c.onmouseup=null,!1},!1},ZE.setPosition=function(a,b){"use strict";var c,d,e,f=document,g=f.body,h=f.documentElement,i=a.style;ZE_Init.is_ie?(d=g.clientHeight-a.offsetHeight,e=Math.max(g.scrollTop,f.documentElement.scrollTop),c=d/3+e):(d=Math.min(g.clientHeight,h.clientHeight),e=Math.max(g.scrollTop,h.scrollTop),c=(d-a.offsetHeight)/3+e),c<0&&(c=10),i.top=c+"px",c=(g.clientWidth-a.offsetWidth)/3+ZE.getPos(b).offsetLeft/2,c<50&&(c=100),i.left=c+"px"},ZE.prototype.focus=function(){"use strict";var a=this;"plaintext"===a.mode?a._textarea.focus():a.win.focus()},ZE.getPos=function(){"use strict";var a={};return a.left=0,a.top=0,ZE_Init.is_ie&&(a=document.documentElement.getBoundingClientRect()),function(b){var c=b.getBoundingClientRect(),d=document.documentElement.scrollTop,e=document.documentElement.scrollLeft,f=window.scrollY||window.pageYOffset||d||document.body.scrollTop,g=window.scrollX||window.pageXOffset||e||document.body.scrollLeft;return{offsetLeft:c.left+g-a.left,offsetTop:c.top+f-a.top}}}(),ZE.prototype.updateCount=function(a){"use strict";var b=this;switch(a){case"bold":a="b";break;case"italic":a="i";break;case"underline":a="u";break;case"strikethrough":a="st";break;case"justifyleft":a="jl";break;case"justifyright":a="jr";break;case"justifyfull":a="jf";break;case"justifycenter":a="jc";break;case"insertunorderedlist":a="ul";break;case"insertorderedlist":a="ol";break;case"outdent":a="od";break;case"indent":a="id";break;case"removeformat":break;case"link":a="li";break;case"unlink":a="uli";break;case"table":a="ta";break;case"inserthorizontalrule":a="hr";break;case"quote":a="qu";break;case"image":a="img";break;case"spellcheck":a="sp";break;case"subscript":a="ss";break;case"superscript":a="sps";break;case"forecolor":a="fc";break;case"hilitecolor":a="bc";break;case"object":a="ihtm";break;case"edithtml":a="ehtm";break;case"code":a="cod"}b.clickCount[a]?b.clickCount[a]++:b.clickCount[a]=1},ZE.prototype.resize=function(a){"use strict";var b=this,c=b.iframe,d=b.editordiv;a.height&&(d.style.height=a.height+"px",c.style.height=a.height+"px"),a.width&&(d.style.height=a.height+"px",c.style.height=a.height+"px")},ZE.prototype.freeze=function(){"use strict";var a,b=document,c=b.body,d=b.getElementById("ze_freeze");if(d)a=d.style,a.height=Math.max(c.scrollHeight,b.documentElement.scrollHeight)+"px",a.width=c.clientWidth+"px",a.display="";else{var e=b.createElement("div");a=e.style,e.id=e.className="ze_freeze",a.height=Math.max(c.scrollHeight,b.documentElement.scrollHeight)+"px",a.width=c.clientWidth+"px",document.body.appendChild(e),window.addEventListener("resize",function(a){var d=b.getElementById("ze_freeze"),e=d.style;d&&e&&"none"!==e.display&&(c=b.body,e.height=Math.max(c.scrollHeight,b.documentElement.scrollHeight)+"px",e.width=c.clientWidth+"px")},!0)}},ZE.prototype.hideFreeze=function(){"use strict";var a=document.getElementById("ze_freeze");a&&(a.style.display="none")},ZE.conDrop=function(a,b){var c,d,e,f,g=ZE.i18n,h=a.list.length;c=document.createElement("div"),c.id="ze_dropdown",c.className="ze_dd shw";var i=a.type;for(d=document.createElement("ul"),a.ulClass&&(d.className=a.ulClass),attachOnClick=function(a){return function(){a.clk(b.initobj.id)}},f=0;f<h;f++){if(e=document.createElement("li"),"fontsize"==i?e.setAttribute("data-size",a.list[f].datAttr):"fontfamily"==i?"systemFont"!==!a.list[f].htm&&(e.style.fontFamily=a.list[f].ff):"colorpicker"==i?e.style.backgroundColor=a.list[f]:"align"==i||"list"==i||"indent"==i||"textDir"==i||"others"==i||"lineHeight"===i?e.setAttribute("data-"+i,a.list[f].datAttr):"heading"===i&&(e.setAttribute("data-"+i,a.list[f].datAttr),e.style.fontSize=a.list[f].fontsize+"px"),a.list[f].htm)if(a.list[f].datAttr&&"switchmode"==a.list[f].datAttr){if(b.initobj.avoidPlainText||!ZE_Init.needplaintext)continue;"richtext"==a.editr.mode?"ja"===ZE_Init.language?e.innerHTML=g("Plain Text Mode"):e.innerHTML="Plain Text mode":"plaintext"==a.editr.mode&&("ja"===ZE_Init.language?e.innerHTML=g("Rich Text Mode"):e.innerHTML="Rich Text mode")}else if(e.innerHTML=a.list[f].htm,"systemFont"===a.list[f].htm){var j=document.createElement("li");j.className="ze_lne";var k=document.createElement("b");d.appendChild(j),e.innerHTML="",k.innerHTML=a.list[f].htm,e.appendChild(k),e.className="nohr"}if(a.list[f].liClass&&(e.className=a.list[f].liClass),d.appendChild(e),a.list[f].clk){var l=a.list[f];ZE._addEvent(e,"click",attachOnClick(l))}}c.appendChild(d),document.body.appendChild(c)},ZE.prototype.showDropDown=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=a.currentTarget,s=document,t=q.doc;switch(n=["#ffffff","#cceeff","#ccccff","#e5ccff","#ffccff","#ffccee","#ffcccc","#ffe5cc","#ffffcc","#ccffcc","#ccffff","#cccccc","#99ccff","#9999ff","#cc99ff","#ff99ff","#ff99cc","#ff9999","#ffcc99","#ffff99","#99ff99","#99ffff","#c0c0c0","#66ccff","#6666ff","#b266ff","#ff66fe","#ff66b2","#ff6666","#ffb266","#feff66","#66ff66","#66feff","#999999","#399cfd","#3333ff","#9933ff","#ff33fe","#ff3398","#ff3333","#ff9933","#feff33","#33ff33","#33feff","#666666","#3399ff","#0000ff","#7700ff","#ff00ee","#ff0077","#ff0000","#ff7f00","#feff00","#00ff00","#00feff","#444444","#0065cc","#0000cc","#6600cc","#cc00cb","#cc00cb","#cc0000","#cc6600","#cbcc00","#00cc00","#00cbcc","#333333","#004c99","#000099","#4B0099","#990098","#99004c","#990000","#994c00","#989900","#009900","#009899","#000000","#003366","#000066","#330066","#660066","#660032","#660000","#663300","#666600","#006600","#006666"],o=[{htm:"<i class='ze_smilenew'></i>"},{htm:"<i class='ze_sad'></i>"},{htm:"<i class='ze_lol'></i>"},{htm:"<i class='ze_angry'></i>"},{htm:"<i class='ze_tongueout'></i>"},{htm:"<i class='ze_coolnew'></i>"},{htm:"<i class='ze_winknew'></i>"},{htm:"<i class='ze_meh'></i>"},{htm:"<i class='ze_tearofjoy'></i>"},{htm:"<i class='ze_shocked'></i>"},{htm:"<i class='ze_loveit'></i>"},{htm:"<i class='ze_neutral'></i>"},{htm:"<i class='ze_worried'></i>"},{htm:"<i class='ze_yummy'></i>"},{htm:"<i class='ze_sleepy'></i>"},{htm:"<i class='ze_dizzy'></i>"},{htm:"<i class='ze_sick'></i>"},{htm:"<i class='ze_injured'></i>"},{htm:"<i class='ze_idea'></i>"},{htm:"<i class='ze_doubtful'></i>"},{htm:"<i class='ze_tensed'></i>"},{htm:"<i class='ze_searching'></i>"},{htm:"<i class='ze_anxious'></i>"},{htm:"<i class='ze_lipssealed'></i>"},{htm:"<i class='ze_halo'></i>"},{htm:"<i class='ze_like'></i>"},{htm:"<i class='ze_dislike'></i>"},{htm:"<i class='ze_claps'></i>"},{htm:"<i class='ze_yoyo'></i>"},{htm:"<i class='ze_ontarget'></i>"}],d=q.toolbarobject[b],l=function(){e&&(document.body.removeChild(e),ZE.removeClass(d,"ze_dn"),"attach"!=b&&ZE.removeClass(d,"ze_Sel"),ZE._removeEvent(s,"mousedown",g),ZE._removeEvent(t,"mousedown",g),ZE._removeEvent(t,"keydown",g))},g=function(a){if(e=document.getElementById("ze_dropdown"),"fontsizeEditable"===a.target.getAttribute("id"))return!1;if(a)for(m=a.target;null!==m&&m!==e;)m=m.parentNode;m||l()},f=function(a){var e=a.target;switch("richtext"==q.mode&&p&&(q.win.focus(),q.restoreSelection(p)),b){case"fontfamily":q.win.focus(),q.updateFontfamily(e,d);break;case"fontsize":q.win.focus(),q.updateFontsize(e,d);break;case"forecolor":case"backcolor":q.win.focus(),q.updateColor(e,r,b);break;case"alignoptions":case"listoptions":case"indentoptions":q.updateFormatoptions(e,d,c);break;case"heading":q.updateFormatoptions(e,d,c);break;case"directionoptions":q.updateDirectionOptions(e,d,c);break;case"otheroptions":q.updateOtheroptions(e,c);break;case"lineHeight":q.updateFormatoptions(e,d,c);break;case"smiley":if("smartCompose"===q.initobj.type||"function"!=typeof q.initobj.getSmiley){q.insertSmiley(e);break}for(var e=a.target;null!==e;){if("smileydivmn"===e.className)return l(),!0;if("smileyCateg"===e.className)return!0;e=e.parentElement}}l()},b){case"fontfamily":k={type:b,list:ZE_Init._getFontFamily()};var u,v,w=q.doc.queryCommandValue("fontname"),x=ZE_Init[b].length;if(w)for(u=w.split(",")[0].toLowerCase(),v=0;v<x;v++)fontFamilyLiObj=ZE_Init[b][v],fontFamilyLiObj.ff.split(",")[0].toLowerCase()===u?fontFamilyLiObj.liClass="sel":fontFamilyLiObj.liClass="";break;case"fontsize":k={type:b,list:ZE_Init[b]};var y,z,A=q.doc.queryCommandValue("fontSize");if(fontSizeAnchorArray=ZE_Init[b],fontSizeAnchorArrayLength=fontSizeAnchorArray.length,A||(A=q.getFormattingValues("size")),A){switch(A){case"1":case 1:case"10px":z="1";break;case"2":case 2:case"13px":z="2";break;case"3":case 3:case"16px":z="3";break;case"4":case 4:case"18px":z="4";break;case"5":case 5:case"24px":z="5";break;case"6":case 6:case"32px":z="6";break;case"7":case 7:case"48px":z="7"}for(y=0;y<fontSizeAnchorArrayLength;y++)fontSizeAnchorArray[y].datAttr===z?fontSizeAnchorArray[y].liClass="sel":fontSizeAnchorArray[y].liClass=""}else for(y=0;y<fontSizeAnchorArrayLength;y++)fontSizeAnchorArray[y].liClass="";break;case"forecolor":case"backcolor":k={type:"colorpicker",ulClass:"ze_cb",list:n};break;case"smiley":var B=function(a){q.insertSmiley(a)};if("function"==typeof q.initobj.getSmiley){q.squireInstance.focus();var C=q.initobj.getSmiley(B),D=document.createElement("ul");D.appendChild(C),D.className="ze_smiley";var E=document.createElement("div");E.id="ze_dropdown",E.className="ze_dd shw",C.className="ze_sb",E.appendChild(D),document.body.appendChild(E);var F=C.getElementsByClassName("smileydivmn")[0],G=C.getElementsByClassName("smileyCateg")[0].offsetHeight}else k={type:b,ulClass:"ze_sb",list:o};break;case"otheroptions":k={type:c,list:ZE_Init[c],editr:q},k.ulClass="ze_ddr";break;case"alignoptions":case"listoptions":case"indentoptions":k={type:c,list:ZE_Init[c]};break;case"heading":k={type:c,list:ZE_Init[c]};break;case"directionoptions":k={type:c,list:ZE_Init[c]};break;case"attach":k={type:b,list:ZE_Init.attachDrop};break;case"lineHeight":k={type:c,list:ZE_Init[c]}}for(q.win.focus(),"richtext"==q.mode&&(p=q.saveSelection()),("smiley"!==b||"smiley"===b&&"function"!=typeof q.initobj.getSmiley)&&ZE.conDrop(k,q),e=s.getElementById("ze_dropdown"),"fontfamily"==b?e.style.minWidth="189px":"fontsize"==b&&(e.style.minWidth="52px"),"smartCompose"!==q.initobj.editorType&&ZE.addClass(d,"ze_dn"),ZE.addClass(d,"ze_Sel"),ZE._addEvent(e,"click",f),ZE._addEvent(s,"mousedown",g),ZE._addEvent(t,"mousedown",g),ZE._addEvent(t,"keydown",g);"B"!==r.nodeName;)r=r.parentNode;if(h=ZE.getPos(r),i=e.style,"otheroptions"===b?i.left=h.offsetLeft-e.offsetWidth+r.getBoundingClientRect().width+"px":"smiley"===b?"smartCompose"===q.initobj.editorType?(j=s.getElementsByClassName("ze_tbEd")[0].offsetWidth,i.left=h.offsetLeft+j-2+"px"):i.left=h.offsetLeft-e.offsetWidth+r.getBoundingClientRect().width+5+"px":i.left=h.offsetLeft+"px","smiley"===b&&"smartCompose"===q.initobj.editorType?i.top=h.offsetTop+"px":i.top=h.offsetTop+r.offsetHeight-1+"px",e.style.display="block",rectObj=document.body.getBoundingClientRect(),dropRectObj=e.getBoundingClientRect(),dropRectObj.height+dropRectObj.top>rectObj.height){var H=dropRectObj.height+dropRectObj.top-rectObj.height;if(e.firstChild.style.height=dropRectObj.height-H-50+"px","smiley"===b&&"function"==typeof q.initobj.getSmiley){var I=D.offsetHeight;F.style.height=I-G-30+"px"}}},ZE.prototype.updateFontfamily=function(a,b){var c,d=this;d.doc,d.getContent({plaintext:!0});"smartCompose"===d.initobj.editorType&&(b.firstChild.innerHTML=a.innerHTML),c=a.style.fontFamily,b.hasAttribute("sel")&&b.removeAttribute("sel"),d.win.focus(),d.squireInstance.setFontFace(c),d.saveCurrentState()},ZE.prototype.updateFontsize=function(a,b){var c=this;c.doc,c.getContent();"UL"===a.nodeName?b.firstChild.innerHTML=parseInt(ZE_Init.defaultFontSize):b.firstChild.innerHTML=a.innerHTML,b.hasAttribute("sel")&&b.removeAttribute("sel"),c.win.focus();var d=a.getAttribute("data-size"),e=document.getElementById("fontsizeEditable");e&&(e.contentEditable=!1),c.squireInstance.setFontSize(c.fontsizeConversion("fontvaltopx",d)+"px"),c.saveCurrentState()},ZE.prototype.updateColor=function(a,b,c){var d,e,f,g=this,h=g.doc;g.getContent();for(d=a.style.backgroundColor,b.hasAttribute("sel")&&b.removeAttribute("sel"),d=d.replace(/rgb\(|\)/g,"").split(","),f=d.length,e=0;e<f;e++)d[e]=parseInt(d[e],10).toString(16),d[e]=1==d[e].length?"0"+d[e]:d[e];if(d="#"+d.join(""),g.win.focus(),"backcolor"==c?g.squireInstance.setHighlightColour(d):"forecolor"==c&&g.squireInstance.setTextColour(d),"backcolor"==c){var i=h.queryCommandValue("backcolor");"number"==typeof i?b.firstChild.style.borderBottom="3px rgb("+(255&i)+","+(i>>8&255)+","+(i>>16&255)+") solid":("transparent"==i&&(i=g.getFormattingValues("highlight")||"white"),b.firstChild.style.borderBottom="3px "+i+" solid")}else{var i=h.queryCommandValue("forecolor");"number"==typeof i?b.firstChild.style.color="rgb("+(255&i)+","+(i>>8&255)+","+(i>>16&255)+")":b.firstChild.style.color=h.queryCommandValue("forecolor")}g.saveCurrentState()},ZE.prototype.updateDirectionOptions=function(a,b,c){var d=this,e=a.getAttribute("data-"+c)||b.getAttribute("data-attr");switch(b.hasAttribute("sel")&&b.removeAttribute("sel"),d.win.focus(),e){case"rtl":case"RTL":d.squireInstance.setTextDirection("rtl");break;case"ltr":case"LTR":d.squireInstance.setTextDirection("ltr")}d.saveCurrentState()},ZE.prototype.updateFormatoptions=function(a,b,c){var d,e=this;e.doc;switch(b.hasAttribute("sel")&&b.removeAttribute("sel"),d=a.getAttribute("data-"+c)||b.getAttribute("data-attr"),e.win.focus(),d){case"Normal":e.doc.execCommand("formatBlock",!1,"<div>"),b.firstChild.innerHTML="1.2 (Normal)";break;case"Heading1":e.doc.execCommand("formatBlock",!1,"<H1>"),b.firstChild.innerHTML="Heading1";break;case"Heading2":e.doc.execCommand("formatBlock",!1,"<H2>"),b.firstChild.innerHTML="Heading2";break;case"Heading3":e.doc.execCommand("formatBlock",!1,"<H3>"),b.firstChild.innerHTML="Heading3";break;case"Heading4":e.doc.execCommand("formatBlock",!1,"<H4>"),b.firstChild.innerHTML="Heading4";break;case"Heading5":e.doc.execCommand("formatBlock",!1,"<H5>"),b.firstChild.innerHTML="Heading5";break;case"Heading6":e.doc.execCommand("formatBlock",!1,"<H6>"),b.firstChild.innerHTML="Heading6";break;case"justifyleft":e.squireInstance.setTextAlignment("left"),"zei-textleft\tze_txt"!==b.firstChild.className&&(b.firstChild.className="zei-textleft");break;case"justifyright":e.squireInstance.setTextAlignment("right"),"zei-textright\tze_txt"!==b.firstChild.className&&(b.firstChild.className="zei-textright");break;case"justifyfull":e.squireInstance.setTextAlignment("justify"),"zei-textjustify\tze_txt"!==b.firstChild.className&&(b.firstChild.className="zei-textjustify");break;case"justifycenter":e.squireInstance.setTextAlignment("center"),"zei-textcenter\tze_txt"!==b.firstChild.className&&(b.firstChild.className="zei-textcenter");break;case"insertunorderedlist":case"Bullet":if(e.insertListOperation("UL"),"Bullets"===b.title)return;b.firstChild.className="zei-unorder";break;case"insertorderedlist":case"Numbering":if(e.insertListOperation("OL"),"Numbering"===b.title)return;b.firstChild.className="zei-order";break;case"removelist":e.squireInstance.removeList();break;case"indent":e.getPosFromCursor("UL")>0||e.getPosFromCursor("OL")>0?e.squireInstance.increaseListLevel():e.squireInstance.increaseQuoteLevel(),b.firstChild.className="zei-outdent";break;case"outdent":var f=e.getPosFromCursor("OL"),g=e.getPosFromCursor("UL");f==-1&&g==-1?e.squireInstance.decreaseQuoteLevel():g>f?e.getPosFromCursor("UL",1)>0||e.getPosFromCursor("OL")>0?e.squireInstance.decreaseListLevel():e.squireInstance.removeList():f>g&&(e.getPosFromCursor("OL",1)>0||e.getPosFromCursor("UL")>0?e.squireInstance.decreaseListLevel():e.squireInstance.removeList()),b.firstChild.className="zei-indent";break;case"singleInd":e.squireInstance.setLineHeight("1.0");break;case"normalInd":e.squireInstance.setLineHeight("1.2");break;case"mediumInd":e.squireInstance.setLineHeight("1.5");break;case"doubleInd":e.squireInstance.setLineHeight("2.0")}e.saveCurrentState()},ZE.prototype.updateOtheroptions=function(a,b){var c=this,d=a.getAttribute("data-"+b)||a.getAttribute("title");c.win.focus(),"switchmode"==d?"richtext"==c.mode?c.confirmPlainText(c.getContent()):"plaintext"==c.mode&&c.richText(c.getContent()):"spellcheck"==d&&c.spellcheck()},ZE.prototype.insertSmiley=function(a){var b,c,d=this,e=ZE.getContextValue(),f="vertical-align:middle; width:24px; height:24px;";if(d.win.focus(),"function"!=typeof d.initobj.getSmiley){if(c=ZE_Init.smileyPath||e+"/ze/images/","LI"==a.nodeName&&(a=a.firstChild),0!=a.className.indexOf("ze_")||"I"!=a.nodeName)return;b=a.className.replace("ze_",""),d.pasteHTML("<IMG style='"+f+"' src='"+c+b+".gif'></IMG>")}else d.pasteHTML("<img style = '"+f+"' src = '"+a+"'></img>");d.saveCurrentState()},ZE.prototype.createToolbar=function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=this,C={},D=B.initobj.toolbar,E=document,F=(E.body,E.createDocumentFragment()),G=ZE.i18n,H=(ZE_Init.imgPath,0),I=function(a){return function(){a(B.initobj.id,B)}};if(document.getElementsByClassName("ze_tbEd").length>=1)if(e=E.getElementsByClassName("ze_tbEd")[0],v=E.getElementsByClassName("IconDiv")[0],w=E.getElementById("stickIcon"),"zei-unpin"===w.className){if("paragraph"!==a&&"insert"!==a)return!1}else v.parentElement.removeChild(v),e.parentElement.removeChild(e);if(x=function(b,c){var d,f,g,h,i=0,j=0,k=B._microdiv;"insert"===c?d=B._microdiv.childNodes[0]:"paragraph"===c&&(d=B._microdiv.childNodes[1]),f=d.className,h=d.getBoundingClientRect(),"ui-insert"!==f&&"ui-paragraph"!==f||(d.className=f+"\tsel"),g=k.getBoundingClientRect(),i=E.body.offsetLeft+g.left,j=E.body.offsetTop+g.top,B.iframe.contentWindow.scrollX&&(i-=B.iframe.contentWindow.scrollX),g.left-e.offsetWidth>=0?(i-=e.offsetWidth,"paragraph"===a&&(i+=h.left-g.left)):(i+=g.width,"insert"===a?i=i-h.width-8:"paragraph"===a&&(i-=4)),e.style.left=i+"px",e.style.top=j+"px"},e=E.createElement("div"),"general"===a)c=B.initobj.toolbarOrder?B.initobj.toolbarOrder:D?ZE_Init.toolbarOrderGenerate(D):ZE_Init.SmarttoolbarOrder;else if("paragraph"===a)c=ZE_Init.Paragraphtoolbar;else if("insert"===a){if(B.initobj.customToolbar){B.getDropObj(B.initobj.customToolbar());var J=B.DrawList();return e.style.position="absolute",e.className="ze_tbEd ze_SCmbN",e.appendChild(J),document.body.appendChild(e),void x(b,a)}c=ZE_Init.insertToolbar}f=function(a){return function(b){B._stopEvent(b);var c=B._getSelection();try{B._createRange(c)}catch(d){B.range?(B.range.select(),delete B.range):B.win.focus()}return B.execCommand(b,a),!1}},ZE_Init.needEditorBorder||(d.style.borderWidth="0px"),B.toolbarobject=C,"insert"===a?e.className="ze_tbEd ze_SCmbN":"paragraph"===a?e.className="ze_tbEd ze_SCmbPI":(e.className="ze_tbEd",e.style.boxSizing="border-box");var K=function(a){return B._stopEvent(a),!1};A=function(){return function(a){B._stopEvent(a);var b,c=a.target.className,d=B._getSelection();try{B._createRange(d)}catch(e){B.range?(B.range.select(),delete B.range):B.win.focus()}switch(c){case"zei-order":b="insertorderedlist";break;case"zei-unorder":b="insertunorderedlist";break;case"zei-textleft":b="j-left";break;case"zei-textright":b="j-right";break;case"zei-textfull":b="j-full";break;case"zei-textcenter":b="j-center"}return B.execCommand(a,b),B.saveCurrentState(),!1}},y=function(a){a.stopPropagation(),e=E.getElementsByClassName("ze_tbEd")[0],E.getElementsByClassName("ze_tbEd").length>=1&&(e.parentElement.removeChild(e),v.parentElement.removeChild(v))},z=function(a){a.stopPropagation();var b=E.getElementById("stickIcon"),c=b.className;"zei-pin"===c?(b.className="",b.className="zei-unpin"):"zei-unpin"===c&&(b.className="",b.className="zei-pin")},u=function(){var a;if(a=E.createElement("div"),a.className="zei-close",w=document.createElement("div"),w.className="zei-pin",w.id="stickIcon",v=E.createElement("div"),v.style.zIndex="1000",v.className="IconDiv",v.appendChild(w),v.appendChild(a),E.getElementsByClassName("IconDiv")[0]){var b=E.getElementsByClassName("IconDiv")[0];b.parentElement.removeChild(b)}E.body.appendChild(v),t=v.style,t.position="absolute",t.left=e.offsetLeft+e.offsetWidth-37+"px",t.top=e.offsetTop-15+"px",ZE._addEvent(a,"mousedown",y),ZE._addEvent(w,"mousedown",z)};var L=function(a){var b=document.getElementsByClassName("ze_tbEd")[0],c=b.offsetWidth,d=ZE.getPos(B.editordiv),e=B.doc.getSelection().getRangeAt(0).getBoundingClientRect(),f=b.style,g=a.top;g<0&&(g=0),f.top=d.offsetTop+g-b.offsetHeight+"px";var h=B.editordiv.offsetWidth-e.width;h>b.offsetWidth?f.left=d.offsetLeft+e.left+"px":f.left=d.offsetLeft+e.left-h+"px",c!==b.offsetWidth&&(b.style.left=parseInt(b.style.left)-c+"px")};for(h=E.createElement("ul"),g=c.length,H=0;H<g;H++){for("insert"!==a&&H>0&&(h=E.createElement("ul")),k=c[H],l=0,o=k.length;l<o;l++){p=k[l],q=p[0],r=p[2],"paragraph"===a&&"alignLeft"===q?h.className="ta":"paragraph"!==a||"NumBullets"!==q&&"LefttoRight"!==q||(h.className="fl"),i=E.createElement("li"),h.appendChild(i),m=E.createElement("b"),"heading"!==q&&"fontsize"!==q&&"fontfamily"!==q&&"forecolor"!==q&&"backcolor"!==q&&"alignoptions"!==q&&"listoptions"!==q||(m.className="zeSeldd"),"heading"!==q&&"fontsize"!==q&&"fontfamily"!==q||(m.className="ze_ddBg"),"forecolor"!==q&&"backcolor"!==q&&"alignoptions"!==q&&"listoptions"!==q||(m.className="ze_Seldd"),"fontsize"===q&&(n=E.createElement("span"),m.style.minWidth="36px",m.appendChild(n),n.className="ze_txt"),"fontfamily"===q&&(n=E.createElement("span"),n.style.width="100px",n.className="ze_txt",m.style.width="194px",m.appendChild(n)),"heading"===q&&(n=E.createElement("span"),n.innerHTML="Heading1",n.className="ze_txt","general"===a?m.style.width="158px":"paragraph"===a&&(m.style.width="142px"),m.appendChild(n));var M,N=E.createElement("span");N.className=r,"insert"===a&&(N.innerHTML=p[1]),"plainText"===q&&(m.innerHTML="plainText"),"fontsize"===q&&(N.style.cssFloat="right"),m.appendChild(N),"attach"!==q&&"spellcheck"!==q||(M=document.createElement("span"),M.className="zei-arrow",m.appendChild(M)),"alignoptions"!==q&&"listoptions"!==q||(M=document.createElement("span"),M.className="zei-arrow bdr",m.appendChild(M)),i.appendChild(m);var O={alignLeft:G("justifyleft"),alignRight:G("justifyright"),alignCenter:G("justifycenter"),alignjustify:G("justifyfull"),NumBullets:G("Bullet"),DotBullets:G("Numbering"),RightToLeft:G("RTL"),LefttoRight:G("LTR")};q in O&&m.setAttribute("data-attr",O[q]),m.title=G(p[1]),m.title=G(p[1]),"alignoptions"===q||"listoptions"===q?(ZE._addEvent(M,"click",f(q)),ZE._addEvent(M,"mousedown",K),ZE._addEvent(N,"click",A()),ZE._addEvent(N,"mousedown",K)):"custom"===q?(ZE._addEvent(m,"click",I(p[3])),ZE._addEvent(m,"mousedown",K)):(ZE._addEvent(m,"click",f(q)),ZE._addEvent(m,"mousedown",K)),C[q]=m,0!==l&&(j=document.createElement("div"),m.appendChild(j))}("general"===a&&(0===H||3===H)||"insert"===a&&0===H)&&(s=E.createElement("div")),"paragraph"===a?e.appendChild(h):s.appendChild(h),("general"===a&&(2===H||7===H)||"insert"===a&&7===H)&&e.appendChild(s)}"function"==typeof ZE_Init.afterToolbarGenerate&&ZE_Init.afterToolbarGenerate(C);var P,Q,R,S,T,U,V,W,X,Y,Z=0,$=0,_=0,aa=0,ba=document.body.offsetWidth;Y=function(){P=null,ZE._removeEvent(document.body,"mousemove",R)},R=function(a){Z=a.pageX,$=a.pageY,U=e.offsetWidth,P&&(S=Z-_,T=$-aa,V=ba+16-P.getBoundingClientRect().right,S>1&&T>1?(W=S,X=T,P.style.left=S+"px",P.style.top=T+"px",t.left=P.offsetLeft+P.offsetWidth-37+"px",t.top=P.offsetTop-14+"px"):(P.style.left=W+"px",P.style.top=X+"px"))},Q=function(a){e.style.cursor="hand",Z=a.pageX,$=a.pageY,"ze_tbEd"===a.target.className&&(P=e,_=Z-P.offsetLeft,aa=$-P.offsetTop,ZE._addEvent(document.body,"mousemove",R),ZE._addEvent(document.body,"mouseup",Y))},e.appendChild(F),ZE._addEvent(e,"mousedown",Q),ZE._addEvent(e,"mouseup",function(a){return a.stopPropagation(),!1}),E.body.appendChild(e),e.style.position="absolute","general"!==a?x(b,a):(L(b),u()),B.updateToolbar()},ZE.prototype.saveSelection=function(){"use strict";var a,b=this,c=(document,b.doc),d=b.win.getSelection?b.win.getSelection():c.selection;try{d&&(d.createRange?a=d.createRange():d.getRangeAt?0==d.rangeCount?b.focusAtStart(!0):a=d.getRangeAt(0):d.anchorNode&&d.focusNode&&c.createRange&&(a=c.createRange(),a.setStart(d.anchorNode,d.anchorOffset),a.setEnd(d.focusNode,d.focusOffset),a.collapsed!==d.isCollapsed&&(a.setStart(d.focusNode,d.focusOffset),a.setEnd(d.anchorNode,d.anchorOffset))))}catch(e){}return a},ZE.prototype.restoreSelection=function(a){"use strict";var b=this,c=(document,b.doc),d=b.win.getSelection?b.win.getSelection():c.selection;d&&a&&(a.select?a.select():d.removeAllRanges&&d.addRange&&(d.removeAllRanges(),d.addRange(a)))},ZE.prototype._getSelection=function(){"use strict";var a=this;return"comment"!==a.initobj.type?this.win.getSelection():document.getSelection()},ZE.prototype._createRange=function(a){"use strict";try{return a.getRangeAt(0)}catch(b){return this.doc.createRange()}},ZE.prototype._getSelectedText=function(){"use strict";try{var a=this._getSelection();if(a)return a.toString()}catch(b){return}},ZE.prototype.getParentElement=function(){"use strict";var a=this,b=a._getSelection(),c=a._createRange(b),d=c.commonAncestorContainer;try{for(!c.collapsed&&c.startContainer==c.endContainer&&c.startOffset-c.endOffset<=1&&c.startContainer.hasChildNodes()&&(d=c.startContainer.childNodes[c.startOffset]);3===d.nodeType;)d=d.parentNode;return d}catch(e){return}},ZE.prototype.pasteHTML=function(a){"use strict";var b,c,d=this,e=d.win;if(e.getSelection){
if(b=e.getSelection(),b.getRangeAt&&b.rangeCount){c=b.getRangeAt(0),c.deleteContents();var f=d.doc.createElement("div");f.innerHTML=a;for(var g,h,i=d.doc.createDocumentFragment();g=f.firstChild;)h=i.appendChild(g);c.insertNode(i),h&&(c=c.cloneRange(),c.setStartAfter(h),c.collapse(!0),b.removeAllRanges(),b.addRange(c))}}else d.doc.selection&&"Control"!==d.doc.selection.type&&d.doc.selection.createRange().pasteHTML(a)},ZE.prototype.insertHTML=function(a,b){"use strict";var c=this,d=c.mode;d&&"plaintext"===d?c.insertText(a):(c.win.focus(),c.squireInstance?c.squireInstance.insertHTML(a,null,{avoidSanitize:!0}):c.pasteHtml(a),b||c.saveCurrentState())},ZE.prototype.insertText=function(a){"use strict";var b=this,c=b._textarea,d=c.value,e=c.selectionStart,f=c.selectionEnd;c&&(a=ZE.getText(a),e||0===e?c.value=d.substring(0,e)+a+d.substring(f,d.length):c.value+=a,c.focus())},ZE.prototype.getAllAncestors=function(){"use strict";for(var a=this,b=a.getParentElement(),c=[];b&&1===b.nodeType&&"body"!==b.tagName.toLowerCase();)c.push(b),b=b.parentNode;return c.push(a.doc.body),c},ZE.prototype.createImage=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=this,Q=document.getElementById("ze_ins_image"),R=ZE.i18n,S="bestfit",T=P.getParentElement(),U=P.initobj.imgMaxUploadSize||ZE_Init.maxImageUploadSize||3,V=U+" MB";U<1&&(V=1024*U+" KB"),b="function"==typeof P.initobj.getImgUploadAction?P.initobj.getImgUploadAction():P.initobj.imgAction||ZE_Init.imgAction;T&&"IMG"!==T.nodeName&&(T=void 0),"function"==typeof P.initobj.getImgUploadParameters?b+=P.initobj.getImgUploadParameters():("function"==typeof ZE_Init.imgParametersFunction&&ZE_Init.imgParametersFunction(),ZE_Init.imgParameters&&(b+=ZE_Init.imgParameters));var W=function(){Q.parentNode.removeChild(Q),ZE.hideOverlay(),e.disabled=c.disabled=d.disabled=g.disabled=!1,a&&a.reset(),P.win.focus(),ZE._removeEvent(document,"keydown",X),ZE._removeEvent(P.doc,"keydown",X),i.removeAttribute("src"),j.removeAttribute("src"),i.style.display="none",j.style.display="none",ZE.activeEditor&&delete ZE.activeEditor,ZE.captchaProcessing&&delete ZE.captchaProcessing},X=function(a){var b=document.getElementById("ze_captcha");if(27==a.keyCode){if(b&&"none"!==b.style.display)return void(b.style.display="none");P._stopEvent(a),W()}},Y=function(){var a=P.initobj.defaultImageOption||S;ZE.removeClass(B,"zei-unoption"),ZE.addClass(B,"zei-option"),ZE.removeClass(A,"zei-option"),ZE.addClass(A,"zei-unoption"),"bestfit"===a?(ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-unoption"),ZE.addClass(D,"zei-option"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption")):"smallfit"===a?(ZE.removeClass(C,"zei-unoption"),ZE.addClass(C,"zei-option"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption")):(ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-unoption"),ZE.addClass(E,"zei-option")),s.style.display="",t.style.display="none",i.src?(i.style.display="",x.style.display="none",n.style.display="",k.style.display="none",l.style.display="none"):(x.style.display="block",i.style.display="none",o&&"finished"!=o?o&&"loading"==o&&(l.style.display="",k.style.display="none"):(ZE.insertImageMsg(R("Maximum file size supported: "+V),"imginfo"),ZE.removeClass(k,"ze_popuperrmsg"),l.style.display="none")),j.style.display="none"},Z=function(a){a.stopPropagation();var b=P.initobj.defaultImageOption||S;ZE.removeClass(B,"zei-option"),ZE.addClass(B,"zei-unoption"),ZE.removeClass(A,"zei-unoption"),ZE.addClass(A,"zei-option"),"bestfit"===b?(ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-unoption"),ZE.addClass(D,"zei-option"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption")):"smallfit"===b?(ZE.removeClass(C,"zei-unoption"),ZE.addClass(C,"zei-option"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption")):(ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-unoption"),ZE.addClass(E,"zei-option")),s.style.display="none",t.style.display="",i.style.display="none",j.src?(j.style.display="",x.style.display="none"):(j.style.display="none",x.style.display="block"),f.focus(),n.style.display="none",k.style.display="none",l.style.display="none"},$=function(){T?g.focus():d.checked&&f.focus()},_=function(){var o=Q.getElementsByTagName("input");e=o[0],f=o[1];var y=Q.getElementsByTagName("span"),z=Q.getElementsByTagName("label");c=y[0],d=y[1],m=z[2],k=y[2],l=y[3],n=y[4],u=y[5],v=y[6],w=y[7],x=y[8],g=y[13],h=y[14],H=y[9],G=y[11],I=y[10],J=y[12],a=document.ze_img_form,a.action=b;var O=Q.getElementsByTagName("div");s=O[3],t=O[5],F=s=O[4];var P=Q.getElementsByTagName("td");r=P[0],p=Q.getElementsByTagName("i"),q=p[1],i=document.getElementById("ze_comp_img"),j=document.getElementById("ze_url_img"),i.removeAttribute("src"),j.removeAttribute("src"),B=c.getElementsByTagName("i")[0],A=d.getElementsByTagName("i")[0],C=u.getElementsByTagName("i")[0],D=v.getElementsByTagName("i")[0],E=w.getElementsByTagName("i")[0],L=H.getElementsByTagName("i")[0],K=G.getElementsByTagName("i")[0],M=I.getElementsByTagName("i")[0],N=J.getElementsByTagName("i")[0],T?(Z(event),r.style.display="none",j.src=T.src,j.style.display="",f.disabled=!0,f.value=T.src):(Y(),r.style.display="",f.disabled=!1)};ZE.showOverlay(),P.win.focus(),O=P.saveSelection();var aa='<div class="zep_PUtt">'+R("Insert Image")+'<i class="zei-close"></i></div>';aa+='<div class="zep_PUcen"><form name="ze_img_form" method="post" enctype="multipart/form-data" action="'+b+'" target="ze_img_request">',aa+='<table class="ze_ptble">',aa+="<tbody>",aa+="<tr>",aa+='<td colspan="2" style="padding-bottom:10px;"><span><i class="zei-option"></i>',aa+='<label for="ze_img_comp">'+R("Upload from Disk")+"</label>",aa+='</span><span><i class="zei-unoption"></i>',aa+='<label for="ze_img_url">'+R("Link from Web (Url)")+"</label>",aa+="</span></td>",aa+="</tr>",aa+="<tr>",aa+='<td colspan="2" style="padding-bottom:10px;">',aa+="<div>",aa+='<div style="height:0px;width:0px;visibility:hidden;">',aa+='<input id="uploadfile" type="file" name="img_file">',aa+="</div>",aa+="<div>",aa+='<label for="uploadfile" id="ze_choose_image" class="ze_input_text">'+R("Click to choose an image")+"</label>",aa+="</div>",aa+='<div style="display: none;"><input  class="ze_input_text"  type="text" placeholder = "'+R("Provide an image URL")+'"></div>',aa+="</div>",aa+='<p class="ze_iiSnF"><span>'+R("Maximum file size supported: "+V)+'</span></p><span style="display: none;"><img src="'+ZE_Init.imgPath+'/images/process.gif" align="absmiddle" style="margin-right:3px;"><b style="color:#1daf15;">'+R("Uploading image...")+'</b></span><span class="ze_iiSnF" style="display:none;"></span>',aa+="</td>",aa+="</tr>",aa+="<tr>",aa+='<td valign="middle">',aa+='<div class="ze_iiS"><span><i class="zei-unoption"></i>',aa+='<label for="ze_img_comp">'+R("Small")+"</label>",aa+="</span></div>",aa+='<div class="ze_iiS"><span><i class="zei-unoption"></i>',aa+='<label for="ze_img_comp">'+R("Best Fit")+"</label>",aa+="</span></div>",aa+='<div class="ze_iiS"><span><i class="zei-option"></i>',aa+='<label for="ze_img_comp">'+R("Original")+"</label>",aa+="</span></div></td>",aa+='<td  width="122"><div class="ze_iiI"><span class="ze_iiIP" style="display: block;">Image Preview</span><img id="ze_comp_img" display:="" none;"="" style="display: none;"><img id="ze_url_img" style="width: 120px; height: 120px; display: none;"></div></td>',aa+="</tr>",aa+="<tr>",aa+='<td class = "ze_image_align">',aa+="<div><b>"+R("Alignment Options")+"</b></div>",aa+='<div class = "ze_image_list">',aa+='<span> <i class = "zei-option"></i> <label for="ze_img_comp">'+R("Bottom")+"</label></span>",aa+='<span> <i class = "zei-unoption"></i> <label for="ze_img_comp">'+R("Left")+"</label></span>",aa+='<span> <i class = "zei-unoption"></i> <label for="ze_img_comp">'+R("Top")+"</label></span>",aa+='<span> <i class = "zei-unoption"></i> <label for="ze_img_comp">'+R("Right")+"</label></span>",aa+="</div></td></tr>",aa+='</tbody></table><input type="hidden" name="'+ZE.getCSRFParamName()+'" value="'+ZE.getCSRFCookie(P)+'"/></form>',aa+="</div>",aa+='<div class="zep_PUbtm"><span class="sel">Insert</span><span data-val="Cancel">Cancel</span></div>';var ba=document.createElement("div");ba.className="zep_PU",ba.id="ze_ins_image",ba.name="ze_ins_image",ba.innerHTML=aa,document.body.appendChild(ba),Q=ba,_(),ZE.setPosition(Q,P.editordiv),$(),ZE._addEvent(P.doc,"keydown",X),ZE._addEvent(document,"keydown",X),c.onclick=function(a){a.stopPropagation(),document.getElementById("ze_comp_img")&&(document.getElementById("ze_comp_img").style.display=""),document.getElementById("ze_url_img")&&(document.getElementById("ze_url_img").style.display="none"),Y(),$()},d.onclick=function(a){document.getElementById("ze_comp_img")&&(document.getElementById("ze_comp_img").style.display="none"),document.getElementById("ze_url_img")&&(document.getElementById("ze_url_img").style.display=""),Z(a),$()},u.onclick=function(a){a.stopPropagation(),ZE.removeClass(C,"zei-unoption"),ZE.addClass(C,"zei-option"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption")},v.onclick=function(a){a.stopPropagation(),ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-unoption"),ZE.addClass(D,"zei-option"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption")},w.onclick=function(a){a.stopPropagation(),ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-unoption"),ZE.addClass(E,"zei-option")};var ca=function(a){for(var b in a){var c=a[b];ZE.removeClass(c,"zei-option"),ZE.addClass(c,"zei-unoption")}},da={};G.onclick=function(a){a.stopPropagation(),ZE.removeClass(K,"zei-unoption"),ZE.addClass(K,"zei-option"),da={n1:L,n2:M,n3:N},ca(da)},H.onclick=function(a){a.stopPropagation(),ZE.removeClass(L,"zei-unoption"),ZE.addClass(L,"zei-option"),da={n1:K,n2:M,n3:N},ca(da)},I.onclick=function(a){a.stopPropagation(),ZE.removeClass(M,"zei-unoption"),ZE.addClass(M,"zei-option"),da={n1:L,n2:K,n3:N},ca(da)},J.onclick=function(a){a.stopPropagation(),ZE.removeClass(N,"zei-unoption"),ZE.addClass(N,"zei-option"),da={n1:L,n2:M,n3:K},ca(da)},url_img_upload=function(a){var b,c=f.value;if(0!==c.length){var d="http://",e="https://";if(0!==f.value.indexOf(d)&&0!==f.value.indexOf(e))return b=R("Invalid URL. Make sure it starts with "+d+" or "+e+". "),ZE.insertImageMsg(b,"error"),x.style.display="block",j.style.display="none",void j.removeAttribute("src");if(c&&j.src!==c){var g=c.lastIndexOf("."),h=c.length,i=c.slice(g+1,h);if("svg"===i.toLowerCase())return b=R("Oops!  .svg image types are not supported. Try with another format."),ZE.insertImageMsg(b,"error"),x.style.display="block",j.style.display="none",void j.removeAttribute("src");x.style.display="none",j.src=c,j.style.display="",j.onerror=function(){j.removeAttribute("src"),j.style.display="none",b=R("There are no images found in the specified URL"),ZE.insertImageMsg(b,"error"),x.style.display="block"}}k.style.display="none"}},f.onkeyup=f.onblur=url_img_upload,f.onpaste=f.oncut=function(){setTimeout(url_img_upload,50)},fileInputChange=function(f){var h="";if(e.files&&e.files[0]&&e.files[0].size/1048576>U){if(ZE.insertImageMsg(R("Maximum file size supported: "+V),"error"),e.value="",""!=e.value){var j=e.cloneNode(!0);j.onchange=e.onchange,e.parentNode.replaceChild(j,e)}}else{ZE_Init.context&&(ZE_Init.imgParameters?a.action=b+"&context="+ZE_Init.context:a.action=b+"?context="+ZE_Init.context,h="&context="+ZE_Init.context),ZE.captchaParam?(ZE_Init.imgParameters||ZE_Init.context?a.action=b+"&"+ZE.captchaParam+h:a.action=b+"?"+ZE.captchaParam+h,delete ZE.captchaParam):P._stopEvent(f),ZE.captchaProcessing=e.onchange;var p=e.value;if(""!=e.value){if(!/(\.(gif|jpg|jpeg|bmp|png))$/i.test(p)){var q=R("Formats: ");return a.reset(),ZE.insertImageMsg(q+" GIF/JPG/PNG","error"),x.style.display="block",i.style.display="none",i.removeAttribute("src"),e.focus(),!1}ZE.activeEditor=P,i.style.visibility="hidden",n.style.display="none",i.style.width="",i.style.height="";var r;o="loading",r=e.files?e.files[0].name:e.value,i.onload=function(){if(o="finished",i.onload=void 0,e.disabled=c.disabled=d.disabled=g.disabled=!1,l.style.display="none",r.length>45){var a=r.substring(r.lastIndexOf("."),r.length),b=r.substring(0,40)+"..";r=b+a}n.textContent=R(r),y=this.width,z=this.height,i.style.width="120px",i.style.height="120px",ZE.hasClass(A,"zei-option")?(i.style.display="none",n.style.display="none"):(x.style.display="none",n.style.display="",k.style.display="none"),i.style.visibility="",m.innerHTML=R("Replace Image")},e.disabled=!1,a.submit(),e.disabled=c.disabled=d.disabled=g.disabled=!0,ZE.insertImageMsg(R("Uploading Image"),"info")}}},e.onchange=fileInputChange,F.onclick=function(a){a.stopPropagation(),ZE_Init.is_ie||(P._stopEvent(a),e.click())},Q.getElementsByClassName("zei-close")[0].onclick=h.onclick=function(a){P._stopEvent(a),W()},g.onclick=function(a){a.stopPropagation();var b=function(a){var b=400,c=parseInt(.75*P.editordiv.offsetWidth);if(c>b&&(c=b),ZE.hasClass(A,"zei-option")&&(a.width?(y=a.width,z=a.height):(y=a.naturalWidth,z=a.naturalHeight)),a.setAttribute("orig_width",y),a.setAttribute("orig_height",z),a.setAttribute("size_option","original"),ZE.hasClass(C,"zei-option")){var d=2.5;y>c&&(d=y/150),a.width=y/d,a.height=z/d,a.setAttribute("size_option","small")}else if(ZE.hasClass(D,"zei-option")){var d=1;y>c&&(d=y/c),a.width=y/d,a.height=z/d,a.setAttribute("size_option","bestfit")}ZE.hasClass(M,"zei-option")?a.style["float"]="left":ZE.hasClass(N,"zei-option")&&(a.style["float"]="right"),a.style.display=""};if(T)b(T);else{var c;if(ZE.hasClass(B,"zei-option")){if(c=P.imgURL,!e.value||!c){var d=R("Please browse and choose an image");return ZE.insertImageMsg(d,"error"),e.focus(),!1}}else if(ZE.hasClass(A,"zei-option")){if(c=f.value,!c){var d=R("Provide a valid image URL");return ZE.insertImageMsg(d,"error"),f.focus(),!1}if(!j.src)return!1}O&&P.restoreSelection(O),P.win.focus();var g,h=P._getSelection();try{h.isCollapsed||sel.deleteFromDocument(),g=h.getRangeAt(0)}catch(i){g=P._createRange(h)}var k=P.doc.createElement("img");k.src=c,k.style.display="none",setTimeout(function(){b(k),P.saveCurrentState()},500);var l=P.doc.createElement("br");ZE.hasClass(L,"zei-option")?(g.insertNode(l),g.insertNode(k),g.selectNode(l)):ZE.hasClass(K,"zei-option")?(g.insertNode(k),g.insertNode(l),g.selectNode(l)):(g.insertNode(k),g.selectNode(k)),g.collapse(!1),h.removeAllRanges(),h.addRange(g)}P._stopEvent(a),W(),delete P.imgURL},ZE.prototype.previewImage=function(a){var b,c,d,e=this,f=document.getElementById("ze_ins_image");f&&"none"!=f.style.display?(b=document.getElementById("ze_comp_img"),b.src=a,e.imgURL=a,b.style.display=""):(b=document.createElement("img"),b.src=a,c=e._getSelection(),d=e._createRange(c),d.insertNode(b),d.selectNode(b),d.collapse(!1),c.removeAllRanges(),c.addRange(d))}},ZE.insertImageMsg=function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o=document.getElementById("ze_ins_image"),p=ZE.i18n;if(o)if(c=o.getElementsByTagName("input"),d=o.getElementsByTagName("span"),e=o.getElementsByTagName("label"),f=e[2],g=d[2],h=d[3],i=d[4],j=d[8],k=d[0],l=k.getElementsByTagName("i")[0],n=document.getElementById("ze_comp_img"),"info"==b)g.innerHTML="",g.style.display="none",h.style.display="";else if("error"==b){if(h.style.display="none",g.innerHTML=a,g.style.display="block",ZE.addClass(g,"ze_popuperrmsg"),m=c[0],n&&ZE.hasClass(l,"zei-option")){if(n.removeAttribute("src"),j.style.display="block",n.style.display="none",m.disabled=!1,m.value="",""!=m.value){var q=m.cloneNode(!0);q.onchange=m.onchange,m.parentNode.replaceChild(q,m)}f.innerHTML=p("Click to choose an image"),i.style.display="none"}}else"imginfo"==b&&(h.style.display="none",g.innerHTML=a,g.style.display="block")},ZE.insertErrorMsg=function(a){"use strict";var b=document.getElementById("ze_comp_img"),c=ZE.i18n;if(b){var d,e,f,g,h,i=document.getElementById("ze_ins_image"),j=i.getElementsByTagName("span"),k=j[0],l=(j[1],i.getElementsByTagName("input")),m=i.getElementsByTagName("label"),n=l[0];if(d=m[2],g=j[2],h=j[3],f=j[4],e=j[8],l=i.getElementsByTagName("input"),j=i.getElementsByTagName("span"),n.disabled=k.disabled=!1,h.style.display="none",g.innerHTML=a,ZE.addClass(g,"ze_popuperrmsg"),g.style.display="",d.innerHTML=c("Click to choose an image"),f.style.display="none",e.style.display="block",b.removeAttribute("src"),n.value="",""!=n.value){var o=n.cloneNode(!0);o.onchange=n.onchange,n.parentNode.replaceChild(o,n)}}else alert(a)},ZE.prototype.insertImage=function(a,b,c){"use strict";var d,e,f,g,h,i,j=this;if(b=b||{},i=b.size||"original",a){var k=function(a,b,c){var d,e,f,g=400,h=parseInt(.75*j.editordiv.offsetWidth);return c=c||"original",h>g&&(h=g),"small"===c?(f=2.5,a>h&&(f=a/150),d=a/f,e=b/f):"bestfit"===c?(f=1,a>h&&(f=a/h),d=a/f,e=b/f):(d=a,e=b),{width:d,height:e}};d="function"==typeof Image?new Image:document.createElement("img"),d.onload=function(){h=c||{},e=this.width,f=this.height,h.orig_width=e,h.orig_height=f,g=k(e,f,i),h.style=h.style||"",this.width=g.width,this.height=g.height,h.width=this.width,h.height=this.height,h.size_option=i,j.squireInstance.insertImage(a,h)},d.onerror=function(){},d.src=a}},ZE.prototype.showInsertHTMLDialog=function(a){"use strict";var b,c,d,e,f,g,h=this,i=document,j=h.doc.getElementById("ze_ins_insertHtml"),k=ZE.i18n,l=function(){return['<div class="zep_PUtt">'+k("Insert HTML")+'<i class="zei-close"></i></div>','<div class="zep_PUcen">','<table class="ze_ptble">',"<tbody>","<tr>","<td>",'<textarea style="width:500px;height:250px;resize:none;">',"</textarea>","</td>","</tr>","</tbody>","</table>","</div>",'<div class="zep_PUbtm">','<span class="sel">'+k("OK")+"</span>",'<span data-val="Cancel">'+k("Cancel")+"</span>","</div>"].join("")},m=function(){i.removeEventListener("keydown",g,!0),j.parentNode.removeChild(j),ZE.hideOverlay()};g=function(a){27===a.keyCode&&(h._stopEvent(a),m())};var n=function(){var a,b=d.value;m(),DOMPurify&&(a=ZE.getHookMethod("ze_insert_html",h.initobj.hookOnInsertHTML),ZE.addHook("afterSanitizeElements",a),b=DOMPurify.sanitize(b,{originator:"ze_insert_html",ADD_TAGS:h.initobj.allowTagsInsertHTML||[],ADD_ATTR:h.initobj.allowAttrsInsertHTML||[]}),ZE.removeHook("afterSanitizeElements",a)),h.insertHTML(b)};j||(ZE.showOverlay(),j=i.createElement("div"),j.id="ze_ins_insertHtml",j.className="zep_PU zep_arrb",j.innerHTML=l(),i.body.appendChild(j),ZE.setPosition(j,h.editordiv),d=j.getElementsByTagName("textarea")[0],b=j.getElementsByClassName("zei-close")[0],c=j.getElementsByTagName("span"),e=c[0],f=c[1],d.focus(),f.onclick=b.onclick=function(a){h._stopEvent(a),m()},e.onclick=function(a){h._stopEvent(a),n()},ZE._addEvent(i,"keydown",g))},ZE.prototype.resizeElement=function(a){"use strict";var b,c,d,e,f,g,f,e,h,i,j,k,l,m,n,o,p,q,r,s=this,t=(document,ZE.i18n),u=!1,v=s.doc,w=a,x=18,y=function(){var a=400,b=parseInt(.75*s.editordiv.offsetWidth),g=1,h=2.5;if(b>a&&(b=a),e=w.getAttribute("orig_width"),f=w.getAttribute("orig_height"),e>b&&(g=e/b,h=e/150),c=g,d=h,w.hasAttribute("size_option")){var l=w.getAttribute("size_option");"small"===l?i.className="ze_sltd":"original"===l?k.className="ze_sltd":"bestfit"===l&&(j.className="ze_sltd")}},z=function(a){return parseFloat(a.style.height)},A=function(a){return parseFloat(a.style.width)},B=function(a){return parseFloat(a.style.top)},C=function(a){return parseFloat(a.style.left)},D=function(a){return a.width||parseFloat(a.style.width)},E=function(a,b){a.height=b},F=function(a,b){a.width=b},G=function(a,b){a.style.top=b+"px"},H=function(a,b){a.style.left=b+"px"},I=function(){return A(b)>x},J=function(){F(w,e/d),E(w,f/d),w.setAttribute("size_option","small"),s.win.focus(),q(),s.saveCurrentState()},K=function(){F(w,e/c),E(w,f/c),w.setAttribute("size_option","bestfit"),s.win.focus(),q(),s.saveCurrentState()},L=function(){w.parentElement.removeChild(w),s.win.focus(),q(),s.saveCurrentState()},M=function(){E(w,f),F(w,e),w.setAttribute("size_option","original"),q(),s.win.focus(),s.saveCurrentState()},N=function(){var a=s.doc.getSelection(),b=document.createRange();b.selectNode(w),a.removeAllRanges(),a.addRange(b),s.createLink(),q(),a.removeRange(b)};g=v.createElement("span"),g.id="ze_imgBlock",g.className="ze_spell",i=v.createElement("span"),i.innerHTML=t("Small"),j=v.createElement("span"),j.innerHTML=t("Best Fit"),k=v.createElement("span"),k.innerHTML=t("Original"),l=v.createElement("span"),l.className="sep",l.innerHTML=t("Remove"),h=v.createElement("span"),h.innerHTML=t("More"),h.className="sep",h.id="more",g.appendChild(i),g.appendChild(j),g.appendChild(k),"comment"!==s.initobj.type&&g.appendChild(h),g.appendChild(l),v.body.appendChild(g);var O=function(){return function(a){w.src=ZE_Init.imgPath+"/images/process.gif",w.id="ze_"+a+"_refresh",s._pendingImagesList[w.id]=!0,w.style.height="16px",w.style.width="16px",w.removeAttribute("height"),w.removeAttribute("width"),w.className="ze_img_upload",s.squireInstance.focus();var b=s._getSelection(),c=s._createRange(b);c.insertNode(w),c.selectNode(w),c.collapse(!1),b.removeAllRanges(),b.addRange(c)}},P=function(){return function(a){a="ze_"+a+"_refresh";var b=s.doc.getElementById(a);delete s._pendingImagesList[a],b&&b.parentNode.removeChild(b)}},Q=function(a){return function(b,c){c="ze_"+c+"_refresh";var d=s.doc.getElementById(c);return delete s._pendingImagesList[c],d?(d.onload=function(){d.setAttribute("orig_width",e),d.setAttribute("orig_height",f),d.style.removeProperty("height"),d.style.removeProperty("width"),"edit"===a?(d.width=parseInt(e),d.height=parseInt(f),ZE.setImageSizeOptions(d,"bestfit",s.editordiv.offsetWidth)):(d.width=this.width+"px",d.height=this.height+"px",ZE.setImageSizeOptions(d,"bestfit",s.editordiv.offsetWidth)),d.removeAttribute("data-zeload")},d.setAttribute("data-zeload",!0),d.src=b,d.removeAttribute("id"),d.removeAttribute("class"),void s.saveCurrentState()):void(s._unusedImagesList[c]=b)}};ZE._addEvent(l,"mousedown",L),ZE._addEvent(k,"mousedown",M),ZE._addEvent(i,"mousedown",J),ZE._addEvent(j,"mousedown",K),"comment"!==s.initobj.type&&ZE._addEvent(h,"mousedown",function(b){if(document.getElementById("img_edit_link_options"))return!1;var c=[[{cmd:"Edit",id:"Edit"}],[{cmd:"Link",id:"Link"}]],d=function(a){"Link"===a.target.id?(h.parentElement.removeChild(h),N()):"Edit"===a.target.id&&"function"==typeof s.initobj.processPastedFile&&(h.parentElement.removeChild(h),e=w.getAttribute("orig_width"),f=w.getAttribute("orig_height"),q(),s.initobj.processPastedFile(w.src,s,O(),Q("edit"),P(),"source"))},g="img_edit_link_options";s.constructContextMenu(c,g,d);var h=document.getElementById(g),i=(ZE.getPos(s.editordiv),h.style);R=0,S=0;var j=s.iframe.getBoundingClientRect(),k=a.getBoundingClientRect();b.pageX||b.pageY?(R=j.left+k.left+(b.pageX-k.left),S=s.win.scrollY?j.top+k.top+(b.pageY-k.top)-s.win.scrollY:j.top+k.top+(b.pageY-k.top)-s.win.pageYOffset):(R=j.left+k.left+(b.clientX-k.left),S=s.win.scrollY?j.top+k.top+(b.clientY-k.top)-s.win.scrollY:j.top+k.top+(b.clientY-k.top)-s.win.pageYOffset),i.left=parseInt(R)+"px",i.top=parseInt(S)+"px";var l=h.offsetHeight;if(S+l>window.innerHeight-20){var m=S-l;m<41?i.top="40px":i.top=parseInt(m)+"px"}},!1),b=v.createElement("div"),v.body.appendChild(b),b.className="enc",b.id="enclose",n=w.getBoundingClientRect();var R=n.left,S=n.top;s.win.scrollX?b.style.left=R+s.win.scrollX+"px":b.style.left=R+s.win.pageXOffset+"px",s.win.scrollY?b.style.top=n.top+s.win.scrollY+"px":b.style.top=n.top+s.win.pageYOffset+"px",b.style.height=n.height+"px",b.style.width=n.width+"px",g.contentEditable="false",g.style.left=b.style.left,G(g,B(b)+z(b)),y(),S+=s.win.scrollY?s.win.scrollY:s.win.pageYOffset,R+=s.win.scrollX?s.win.scrollX:s.win.pageXOffset;var T=v.createElement("div");T.className="smallDiv smallDiv-tl",T.id="smallDiv1",v.body.appendChild(T),T.setAttribute("data-resize","resize"),T.style.top=S+"px",T.style.left=R+"px",T.style.cursor="nw-resize";var U=v.createElement("div");U.className="smallDiv smallDiv-tr",U.id="smallDiv2",v.body.appendChild(U),T.setAttribute("data-resize","resize"),U.style.top=S+"px",U.style.left=R+n.width-12+"px",U.style.cursor="ne-resize";var V=v.createElement("div");V.className="smallDiv smallDiv-br",V.id="smallDiv3",v.body.appendChild(V),T.setAttribute("data-resize","resize"),V.style.top=S+n.height-14+"px",V.style.left=R+n.width-14+"px",V.style.cursor="se-resize";var W=v.createElement("div");W.className="smallDiv smallDiv-bl",W.id="smallDiv4",T.setAttribute("data-resize","resize"),v.body.appendChild(W),W.style.top=S+n.height-14+"px",W.style.left=R+"px",W.style.cursor="sw-resize";var X=v.createElement("div");X.className="smallDiv smallDiv-bl",X.id="more",X.style.top=S+"px",X.style.left=R+n.width-12+"px";var Y=function(a){var b=a.keyCode;46===b?L():q()},Z=function(){T.style.left=b.style.left,T.style.top=b.style.top,H(U,A(b)+C(b)-14),U.style.top=b.style.top,W.style.left=b.style.left-14,G(W,z(b)+B(b)-14),H(V,A(b)+C(b)-14),G(V,z(b)+B(b)-14)};q=function(){var a=v.getElementById("ze_imgBlock");a&&v.body.removeChild(a),ZE._removeEvent(v,"keydown",Y);var c=document.getElementById("img_edit_link_options");v.getElementById("smallDiv1")&&(T.parentElement.removeChild(T),U.parentElement.removeChild(U),V.parentElement.removeChild(V),W.parentElement.removeChild(W),c&&c.length>1&&c.parentElement.removeChild(c),b.parentElement.removeChild(b))};var $=function(a){m=this,u=!0,s._stopEvent(a),o=a.clientX,p=a.clientY,ZE._removeEvent(v,"keydown",Y),ZE._addEvent(v,"mousemove",ca),ZE._addEvent(v,"mouseup",da)},_=function(){w.height=parseFloat(b.style.height),w.width=parseFloat(b.style.width),w.style.width&&(w.style.width=""),w.style.height&&(w.style.height="")},aa=function(){u=!1,r(),_(),ZE._removeEvent(T,"mousedown",$),ZE._removeEvent(U,"mousedown",$),ZE._removeEvent(V,"mousedown",$),ZE._removeEvent(W,"mousedown",$),T.parentElement.removeChild(T),U.parentElement.removeChild(U),V.parentElement.removeChild(V),W.parentElement.removeChild(W),b.parentElement.removeChild(b);var a=v.getElementById("ze_imgBlock");a&&v.body.removeChild(a),D(w)===e/c?w.setAttribute("size_option","bestfit"):D(w)===e/d?w.setAttribute("size_option","small"):D(w)===e&&w.setAttribute("size_option","original"),s.saveCurrentState()},ba=function(a,c){if(u){if(c.clientX<=0||c.clientY<=0||c.clientX>s.editordiv.offsetWidth)return void aa(a);var d,e,f,g,h,i,j,k,l,m=(C(b),B(b),z(b)),n=A(b);a===U?(d=0,e=0):a===V?(d=0,e=1):a===W?(d=1,e=0):(d=1,e=1),c.clientX<o?(f=o-c.clientX,0===d?I()&&(g=n/(n-f),n/=g,h=m-m/g,m/=g,ZE.setCss(b,"height",m+"px"),ZE.setCss(b,"width",n+"px"),0===e&&G(b,B(b)+h)):(g=(n+f)/n,i=n-n/g,n+=n-n/g,j=m-m/g,m+=m-m/g,ZE.setCss(b,"height",m+"px"),ZE.setCss(b,"width",n+"px"),k=C(b),l=B(b),H(b,k-i),1===e&&G(b,B(b)-j))):(f=c.clientX-o,0===d?(g=(n+f)/n,n+=n-n/g,h=m-m/g,m+=h,ZE.setCss(b,"height",m+"px"),ZE.setCss(b,"width",n+"px"),0===e&&G(b,B(b)-h)):I()&&(g=n/(n-f),i=n-n/g,n/=g,j=m-m/g,m/=g,ZE.setCss(b,"height",m+"px"),ZE.setCss(b,"width",n+"px"),k=C(b),H(b,k+i),1===e&&G(b,B(b)+j))),Z(),o=c.clientX,p=c.clientY,w.hasAttribute("size_option")&&w.removeAttribute("size_option")}},ca=function(a){ba(m,a)},da=function(a){s._stopEvent(a),aa(m,a)};r=function(){ZE._removeEvent(v,"mousemove",ca),ZE._removeEvent(v,"mouseup",da)},ZE._addEvent(v,"keydown",Y),ZE._addEvent(T,"mousedown",$),ZE._addEvent(U,"mousedown",$),ZE._addEvent(V,"mousedown",$),ZE._addEvent(W,"mousedown",$)},ZE.prototype.getDropObj=function(a){"use strict";this.insertListObj=a,this.list=a.lists},ZE.prototype.DrawList=function(){"use strict";var a,b=this,c=ZE.i18n,d={},e=function(a){return b._stopEvent(a),!1},f=function(a){return function(c){b._stopEvent(c);var d=b._getSelection();try{b._createRange(d)}catch(e){b.range?(b.range.select(),delete b.range):b.win.focus()}return b.execCommand(c,a),!1}},g=this.insertListObj||[],h=this.list||[],i=document,j=i.createElement("div"),k=i.createElement("ul"),l=g.divId;if(g.onClick&&k.addEventListener("mousedown",function(a){a.stopPropagation();var b=a.target||a.srcElement,c=$(b).closest("li"),d=$(c).data();g.onClick(b,c,d,j)}),k.type="none",k.className="ze_txtIcon",h.forEach(function(b){if(a=i.createElement("li"),b.htm&&"object"==typeof b.htm)for(var c=b.htm.length,d=0;d<c;d++)a.innerHTML+=b.htm[d];else b.htm&&"string"==typeof b.htm?a.innerHTML=b.htm:b.dom&&a.appendChild(b.dom);$(a).data(b.data),k.appendChild(a)}),b.initobj.customNotesToolbar){var m,n,o,p,q,r,s,a,f=function(a){return function(c){b._stopEvent(c);var d=b._getSelection();try{b._createRange(d)}catch(e){b.range?(b.range.select(),delete b.range):b.win.focus()}return b.execCommand(c,a),!1}},t=ZE_Init.insertNotesToolbar,u=t.length;b.toolbarobject=d,r=i.createElement("ul");for(var v=0;v<u;v++){m=t[v],n=m.length;for(var w=0;w<n;w++){o=m[w],p=o[0],q=o[2],a=i.createElement("li"),k.appendChild(a),s=i.createElement("b");var x=i.createElement("span");x.className=q,x.innerHTML=o[1],s.appendChild(x),a.appendChild(s),s.title=c(o[1]),d[p]=s,ZE._addEvent(s,"click",f(p)),ZE._addEvent(s,"mousedown",e)}}}return j.id=l||"ze_SmartDropDown",j.appendChild(k),j},ZE.prototype.removeToolbar=function(){var a,b=document.getElementsByClassName("ze_tbEd"),c=b.length,d=document.getElementsByClassName("IconDiv"),e=d.length;for(a=0;a<e;a++)d[a].parentElement.removeChild(d[a]);for(a=0;a<c;a++)b[a].parentElement.removeChild(b[a])},ZE.prototype.createLink=function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=document,w=v.getElementById("ze_link"),x=ZE.i18n,y=u._getSelectedText();for(m=u.getParentElement();null!==m&&"BODY"!==m.nodeName;m=m.parentNode){if("A"===m.nodeName){l=!0;break}if("IMG"===m.nodeName){n=!0,"A"===m.parentNode.nodeName&&(l=!0,m=m.parentNode);break}}var z=function(){var a=w.getElementsByTagName("form")[0];ZE._removeEvent(v,"keydown",s),w.parentNode.removeChild(w),ZE.hideOverlay(),a&&a.reset()};s=function(a){27===a.keyCode&&(u._stopEvent(a),z()),13===a.keyCode&&(u._stopEvent(a),t(a))};var A=function(){b.checked=!0,c.checked=!1,j.style.display=k.style.display="none",i.style.display=""},B=function(){b.checked=!1,c.checked=!0,i.style.display="none",j.style.display=k.style.display=""},C=function(){b.checked&&(n||y)?e.focus():c.checked&&(n||y)?f.focus():d.focus()},D=function(a,b){var c,d,e;u.doc.execCommand("createlink",!1,a);try{c=u._getSelection(),c.collapseToEnd(),e=u.getParentElement(),"A"===e.tagName&&(ZE_Init.preventTargetBlank||(e.target="_blank",u.initobj.anchorReferer&&(e.rel="noreferer")),e.textContent===b||e.getElementsByTagName("img")||(e.textContent=b),d=u._createRange(c),d.selectNode(e),c.removeAllRanges(),c.addRange(d),c.collapseToEnd())}catch(f){u.range&&(u.range.select(),delete u.range),u.doc.execCommand("createlink",!1,a),e=u.getParentElement(),"A"===e.tagName&&(ZE_Init.preventTargetBlank||(e.target="_blank",u.initobj.anchorReferer&&(e.rel="noreferer")),e.innerText===b||e.getElementsByTagName("img")||(e.innerText=b),c=u._getSelection(),d=u._createRange(c),d.moveToElementText(e),d.collapse(!1),d.select())}var g=u.doc.createRange();g.setStart(e,0),g.setEndAfter(e),g.selectNode(e);var h=u.iframe.contentWindow.getSelection();h.removeAllRanges(),h.addRange(g),u.win.focus(),u.iframe.contentWindow.getSelection().collapseToEnd(),u.saveCurrentState()},E=function(){var o,r,s,t;a=w.getElementsByTagName("input"),b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],p=w.getElementsByTagName("span"),q=w.getElementsByClassName("zei-close")[0],o=w.getElementsByTagName("tr"),h=o[1],i=o[2],j=o[3],k=o[4],n?h.style.display="none":h.style.display="",l?(n||(d.value=m.textContent),
"mailto:"===m.protocol?(B(),r=m.href,s=r.split("mailto:"),t=s[1].split("?subject="),f.value=t[0]||"",g.value=t[1]||""):(A(),e.value=m.href)):(A(),n||(d.value=y||""))},F=new RegExp("^[\\w]([\\w-\\.\\+\\']*)@([\\w\\-\\.]*)(\\.[a-zA-Z]{2,22}(\\.[a-zA-Z]{2}){0,2})$"),G=new RegExp("^(ht|f)tp(s?)\\:\\/\\/[-.\\w]*(\\/?)([a-zA-Z0-9\\-\\.\\?\\,\\:\\'\\/\\\\\\+=&amp;%\\$#_@]*)?$"),H=ZE.trim(y);if(F.test(H)&&!l)return void D("mailto:"+H,H);if(G.test(H)&&!l)return void D(H,H);ZE.showOverlay(),u.win.focus(),r=u.saveSelection(),o='<div class="zep_PUtt">'+x("Insert Link")+'<i class="zei-close"></i></div>',o+='<div class="zep_PUcen">',o+='<form><table class="ze_ptble">',o+="<tr><td>"+x("Link")+'</td><td><input type="radio" id="ze_link_url" checked="true"/><label for="ze_link_url">'+x("URL")+'</label>&nbsp;<input id="ze_link_email" type="radio"/><label for="ze_link_email">'+x("Email")+"</label></td>",o+="<tr><td>"+x("Selected Text")+'&nbsp;</td><td><input type="text"></td></tr>',o+="<tr><td>"+x("Web address")+'</td><td><input type="text"></td></tr>',o+='<tr style="display:none;"><td>'+x("Email address")+'</td><td><input type="text"></td></tr>',o+='<tr style="display:none;"><td>'+x("Subject")+'</td><td><input type="text"></td></tr>',o+="</table></form></div>",o+='<div class="zep_PUbtm"><span class="sel">'+x("OK")+'</span><span data-val="Cancel">'+x("Cancel")+"</span></div></div>";var I=v.createElement("div");I.className="zep_PU",I.innerHTML=o,I.id="ze_link",document.body.appendChild(I),w=I,E(),ZE.setPosition(w,u.editordiv),C(),b.onclick=function(){A(),C()},c.onclick=function(){B(),C()},q.onclick=p[1].onclick=function(a){u._stopEvent(a),z()},t=function(a){var h="http://",i="https://";u._stopEvent(a);var j,k,o,p,q,s,t,v=d.value;if(q=/^\/\/[a-zA-Z0-9]/g,r&&u.restoreSelection(r),b.checked?(j=e.value,j=ZE.trim(j)):c.checked&&(j=f.value,j=ZE.trim(j)),k=g.value,l)if(j){b.checked?0!==j.indexOf(h)&&0!==j.indexOf(i)&&0!==j.indexOf("ftp://")&&0!==j.indexOf("ssh://")&&(j=h+j):c.checked&&(j="mailto:"+j,k&&(j+="?subject="+k)),m.href=j,ZE_Init.preventTargetBlank||(m.target="_blank",u.initobj.anchorReferer&&(m.rel="noreferer")),n||m.textContent===v||(m.textContent=v),p=u.doc.createRange(),p.setStart(m,0),p.setEndAfter(m),p.selectNode(m);var w=u.iframe.contentWindow.getSelection();w.removeAllRanges(),w.addRange(p),u.win.focus(),r&&u.restoreSelection(r),u.saveCurrentState()}else confirm("Please confirm that you want to unlink this element.\n\nLink points to: "+decodeURI(m.href))&&(o=u._getSelection(),p=u._createRange(o),p.selectNode(m),u.doc.execCommand("unlink",!1,null),z());else{if(v=ZE.trim(v),!v&&!n)return alert(x("You must Select or ENTER Some text to create link")),d.focus(),!1;if(b.checked){if(!j)return alert(x("Please enter URL to make a link")),e.focus(),!1;q.lastIndex=0,0!==j.indexOf(h)&&0!==j.indexOf(i)&&q.test(j)!==!0&&0!==j.indexOf("ftp://")&&0!==j.indexOf("ssh://")&&(j=h+j)}else if(c.checked){if(!j)return alert(x("Please enter Email to make a link")),f.focus(),!1;j="mailto:"+j,k&&(j+="?subject="+k)}if(n)u.squireInstance.makeLink(j),s=u.getParentElement(),s&&"a"===s.tagName.toLowerCase()&&(ZE_Init.preventTargetBlank||(s.target="_blank",u.initobj.anchorReferer&&(s.rel="noreferer")));else if(y&&0!==y.length)D(j,v);else{var A="<a id='an_link'";ZE_Init.preventTargetBlank||(A+="target='_blank'",u.initobj.anchorReferer&&(A+="rel='noreferer'")),A+="></a>",u.win.focus(),u.pasteHTML(A),t=u.doc.getElementById("an_link"),t&&(t.appendChild(u.doc.createTextNode(v)),t.setAttribute("href",j),t.removeAttribute("id")),u.saveCurrentState()}}return z(),!1},p[0].onclick=t,ZE._addEvent(v,"keydown",s)},ZE.prototype.showAnchorTag=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k=a,l=this,m=document,n=ZE.i18n,o=l.saveSelection();b=function(b){if(c=document.getElementById("ze_linkBlock"),b)for(a=b.target;null!==a&&a!==c;a=a.parentNode);a||d()},e=function(){d()},d=function(){c=document.getElementById("ze_linkBlock"),c&&(document.body.removeChild(c),ZE._removeEvent(m,"mousedown",b),ZE._removeEvent(l.doc,"mousedown",b),ZE._removeEvent(l.doc,"keydown",e))},f=function(){var a=l.doc.createRange();a.setStart(k,0),a.setEndAfter(k),a.selectNode(k);var b=l.iframe.contentWindow.getSelection();b.removeAllRanges(),b.addRange(a),l.win.focus(),o&&l.restoreSelection(o)},g=function(){var a=l.doc.createRange();a.setStart(k,0),a.setEndAfter(k),a.selectNode(k);var b=l.iframe.contentWindow.getSelection();b.removeAllRanges(),b.addRange(a),l.win.focus(),l.doc.execCommand("unlink",!1,null),l.iframe.contentWindow.getSelection().collapseToStart(),d(),l.saveCurrentState()},h=function(){var a,b,c=document.getElementById("ze_linkBlock"),d=ZE.getPos(l.editordiv),e=c.style,f=document,g=document.body,h=f.documentElement,j=0,m=0,n=l.iframe.getBoundingClientRect(),o=k.getBoundingClientRect(),p=document.body.getBoundingClientRect().width,q=Math.max(g.scrollTop,h.scrollTop);if(j=n.left+o.left,m=n.top+o.top+k.offsetHeight+(q||0),j<p/2?(e.left=parseInt(j)+"px",e.top=parseInt(m)+"px",e.right="auto",b=j+c.offsetWidth):(e.left="auto",e.top=parseInt(m)+"px",j=window.innerWidth-j-k.offsetWidth,e.right=parseInt(j)+"px",b=j+c.offsetWidth),b>=p){var r=i.innerHTML;r.length>55&&(r=r.substring(0,54)+"..."),i.innerHTML=r}if(m+c.offsetHeight>l.editordiv.offsetHeight+d.offsetTop&&(e.top="auto",m=window.innerHeight-m+k.offsetHeight,e.bottom=parseInt(m)+"px"),"comment"===l.initobj.type&&(e.bottom="auto","auto"===e.right?e.left=d.offsetLeft+"px":e.left="auto",a=document.getSelection().getRangeAt(0).getBoundingClientRect().top,e.top=a+c.offsetHeight+"px"),"IMG"===k.firstChild.nodeName){var s=k.firstChild,t=s.style["float"];if("left"===t){var u=s.offsetHeight+m;e.top=u+"px"}else if("right"===t){var v=s.getBoundingClientRect().x+j,u=s.offsetHeight+m;e.top=u+"px",e.left=v+"px"}}},c=document.getElementById("ze_linkBlock"),c&&d(),j=document.createElement("span"),j.id="ze_linkBlock",j.className="ze_spell",i=document.createElement("a"),0===k.href.indexOf("mailto")?i.appendChild(l.doc.createTextNode(k.href)):(i.setAttribute("href",k.href),j.appendChild(l.doc.createTextNode(n("Go to:"))),i.appendChild(l.doc.createTextNode(k.href)),i.target="_blank",l.initobj.anchorReferer&&(i.rel="noreferrer"),i.style.marginLeft="-5px"),j.appendChild(i);var p=document.createElement("span");p.innerHTML=n("Change");var q=document.createElement("span");q.innerHTML=n("Remove");var r=document.createElement("i");r.className="zei-close",j.appendChild(i),j.appendChild(p),j.appendChild(q),j.appendChild(r),document.body.appendChild(j),h(),ZE._addEvent(r,"click",function(){d(),f()}),ZE._addEvent(i,"click",function(){d(),f()}),ZE._addEvent(q,"click",g),ZE._addEvent(p,"click",function(){o&&l.restoreSelection(o),l.win.focus(),l.createLink(k),d()}),l.updateToolbar(),ZE._addEvent(m,"mousedown",b),ZE._addEvent(l.doc,"mousedown",b),ZE._addEvent(l.doc,"keydown",e)},ZE.prototype.spellcheck=function(){var a=this,b=a.toolbarobject,c=(b.spellcheck,b.spellcheckoptions,"locale"),d=document,e=ZE.i18n,f=ZE.getContextValue();ZE.activeEditor=a,c="undefined"!=typeof a.defaultSpellcheckLanguage?a.defaultSpellcheckLanguage:ZE_Init.useProxy?navigator.language:"locale";var g=d.getElementById("ze_spellcheck"),h=f+"/ze/spellcheck?spellchecklang="+c+"&domainname="+ZE_Init.domain;if(h+=ZE_Init.useProxy&&ZE_Init.spellcheckProxyUrl?"&spellcheckurl="+ZE_Init.spellcheckProxyUrl+"&useProxy="+ZE_Init.useProxy:"&spellcheckurl="+ZE_Init.spellcheckURL,ZE_Init.useSameDomain&&(h+="&useSameDomain=true"),g)g.src=h;else{var i=d.createElement("iframe");i.name=i.id="ze_spellcheck",i.src=h;var j=i.style,k=a.iframe;j.width="500px",j.left="-1000px",j.height="50px",j.top=ZE.getPos(k).offsetTop+"px",j.position="absolute",d.body.appendChild(i)}if(a.scspan){var l=a.sclog;l.style.display="",l.innerHTML=e("Checking..."),a.screcheck.style.display="none",a.sccancel.style.display="",a.scclose.style.display="none",a.scspan.style.display=""}else{var m=d.createDocumentFragment(),n=d.createElement("span");n.className="ze_spell";a.toolbardiv.getBoundingClientRect();m.appendChild(n),a.scspan=n;var o=d.createElement("span");o.appendChild(d.createTextNode(e("Checking")+"...")),n.appendChild(o),a.sclog=o;var p=d.createElement("a"),q=e("Recheck");p.style.display="none",p.title=p.href=q,p.appendChild(d.createTextNode(q)),p.onclick=function(){return a.removeSpellcheckspans(),a.spellcheck(),!1},n.appendChild(p),a.screcheck=p;var r=d.createElement("a"),s=e("Cancel");r.title=r.href=s,r.appendChild(d.createTextNode(s)),r.onclick=function(){return a.cancelSpellcheck(),a.scspan.style.display="none",!1},n.appendChild(r),a.sccancel=r;var t=d.createElement("a"),u=e("Close");t.title=t.href=u,t.style.display="none",t.appendChild(d.createTextNode(u)),t.onclick=function(){return a.removeSpellcheckspans(),a.scspan.style.display="none",!1},n.appendChild(t),a.scclose=t,a.toolbardiv.appendChild(m)}},ZE.prototype.cancelSpellcheck=function(){var a=this;return document.getElementById("ze_spellcheck").src=ZE_Init.jsPath+"/html/blank.html",a.spellcheckContentSet&&(a.removeSpellcheckspans(),delete a.spellcheckContentSet),!1},ZE.prototype.getSpellcheckRemovedContent=function(a){"use strict";var b,c,d,e,f,g=this,h=g.spellcheckdiv;if("plaintext"===a&&"undefined"!=typeof h?(b=h.cloneNode(!0),c=b,d=c.getElementsByTagName("span")):"richtext"===a&&(b=g.doc.body.cloneNode(!0),c=b,d=c.getElementsByTagName("span")),d){for(f=d.length-1;f>=0;f--)if(e=d[f],e.hasAttribute("data-s")||e.getAttribute("data-s"))if(e.style.backgroundColor="",e.style.length>0)e.removeAttribute("data-s");else if(e.hasChildNodes()){for(var i=e.childNodes,j=e.parentNode,k=0;k<i.length;k++)j.insertBefore(i[k].cloneNode(!0),e);j.removeChild(e)}return c.innerHTML}},ZE.prototype.removeSpellcheckspans=function(){var a,b=this,c=b.mode,d=b.spellcheckdiv;if(ZE.activeEditor&&delete ZE.activeEditor,"plaintext"===c?d&&(a=d.getElementsByTagName("span"),b.spellCheckDivEvent&&ZE._removeEvent(d,"mouseup",b.spellCheckDivEvent)):(a=b.doc.getElementsByTagName("span"),b.spellCheckEvent&&ZE._removeEvent(b.doc,"mouseup",b.spellCheckEvent)),a){for(var e=a.length-1;e>=0;e--){var f=a[e];if(f.hasAttribute("data-s")||f.getAttribute("data-s"))if(f.style.backgroundColor="",f.style.length>0)f.removeAttribute("data-s");else if(f.hasChildNodes()){for(var g=f.childNodes,h=f.parentNode,i=0;i<g.length;i++)h.insertBefore(g[i].cloneNode(!0),f);h.removeChild(f)}}if("plaintext"===c&&d){var j=b._textarea;j.value=ZE.getText(d.innerHTML),j.style.display="",d.parentNode.removeChild(d),delete b.spellcheckdiv}}},ZE.prototype.setSpellcheckContent=function(a){var b=this;if(b.spellcheckContentSet=!0,"plaintext"===b.mode){var c=document.createElement("div"),d=b._textarea;c.className=d.className,c.style.cssText=d.style.cssText,c.style.overflow="auto",c.style.clear="both",c.innerHTML=a,b.spellCheckDivEvent=function(a){return b.spellCheckEventDiv(a)},ZE._addEvent(c,"mouseup",b.spellCheckDivEvent),b.editordiv.appendChild(c),d.style.display="none",b.spellcheckdiv=c}else{var e=b.doc;e.body.innerHTML=a,b.spellCheckEvent||(b.spellCheckEvent=function(a){return b.spellCheckMenu(a)}),ZE._addEvent(e,"mouseup",b.spellCheckEvent),b.win.focus()}b.sclog.style.display="none",b.screcheck.style.display="",b.sccancel.style.display="none",b.scclose.style.display=""},ZE.prototype.spellCheckEventDiv=function(a){if(0!==a.button)return!1;for(var b=this,c=a.target,d=c;d&&"BODY"!==d.nodeName&&"HTML"!==d.nodeName;d=d.parentNode)if(d.hasAttribute("data-s")){c=d;break}if(!c.hasAttribute("data-s"))return!1;b._stopEvent(a);var e,f=document,g=function(a){a&&b._stopEvent(a),ZE._removeEvent(f,"keydown",g),ZE._removeEvent(f,"mousedown",h),e.parentNode.removeChild(e)},h=function(a){b._stopEvent(a);for(var c=a.target;null!==c&&c!==ze_spellcheck_options;)c=c.parentNode;null===c&&g()},i=function(a){b._stopEvent(a);var d=a.target;if("UL"===d.nodeName)return!1;if("LI"===d.nodeName){if(value=d.getAttribute("data-i"),"No Suggestions"===value)return;if("Ignore All"===value)b.leaveSimilarErrorWords(c.getAttribute("replaceword"));else if("Dictionary"===value)b.addToDictionary(c.getAttribute("replaceword"));else if("Custom Dictionary"===value)b.customDictionary();else{var e,h=c,i=h.parentNode,j=h.style;if(e="Ignore"===value?h.textContent:d.textContent,j&&j.length>1)j.backgroundColor="",h.removeAttribute("data-s"),h.textContent=h.textContent.replace(h.getAttribute("replaceword"),e),h.removeAttribute("replaceword");else{if(h.textContent===h.getAttribute("replaceword"))i.insertBefore(f.createTextNode(e),h);else{h.textContent=h.textContent.replace(h.getAttribute("replaceword"),e);for(var k=h.firstChild;k;){var l=k.cloneNode(!0);i.insertBefore(l,h),k=k.nextSibling}}i.removeChild(h)}}}return g(),!1},j=(f.createDocumentFragment(),{spellcheck:[]}),k=c.getAttribute("data-s");k=k.split(","),j.spellcheck[0]=[];for(var l,m=0;(l=k[m])&&m<5;m++){var n=f.createElement("li");n.innerHTML=l,j.spellcheck[0][m]={},j.spellcheck[0][m].cmd=l,0===m&&"No Suggestions"===l&&(j.spellcheck[0][m]["data-i"]="No Suggestions",j.spellcheck[0][m].color="#bcb9af",j.spellcheck[0][m].fontWeight="Normal")}j.spellcheck[1]=[],j.spellcheck[1][0]={},j.spellcheck[1][0].cmd="Add to Dictionary",j.spellcheck[1][0]["data-i"]="Dictionary",j.spellcheck[1][1]={},j.spellcheck[1][1].cmd="Ignore",j.spellcheck[1][1]["data-i"]="Ignore",j.spellcheck[1][2]={},j.spellcheck[1][2].cmd="Ignore All",j.spellcheck[1][2]["data-i"]="Ignore All",j.spellcheck[2]=[],j.spellcheck[2][0]={},j.spellcheck[2][0].cmd="Custom Dictionary",j.spellcheck[2][0]["data-i"]="Custom Dictionary",b.constructContextMenu(j.spellcheck,"ze_spellcheckmenu_div",i),e=document.getElementById("ze_spellcheckmenu_div"),ZE._addEvent(f,"mousedown",h),ZE._addEvent(f,"mousedown",h),ZE._addEvent(f,"keydown",g);var o=(ZE.getPos(b.editordiv),e.style);posx=0,posy=0;var p=b.iframe.getBoundingClientRect(),q=c.getBoundingClientRect();a.pageX||a.pageY?(posx=p.left+q.left+(a.pageX-q.left),b.win.scrollY?posy=p.top+q.top+(a.pageY-q.top)-b.win.scrollY:posy=p.top+q.top+(a.pageY-q.top)-b.win.pageYOffset):(posx=p.left+q.left+(a.clientX-q.left),b.win.scrollY?posy=p.top+q.top+(a.clientY-q.top)-b.win.scrollY:posy=p.top+q.top+(a.clientY-q.top)-b.win.pageYOffset),o.left=parseInt(posx)+"px",o.top=parseInt(posy)+"px";var r=e.offsetHeight;if(posy+r>window.innerHeight-20){var s=posy-r;s<41?o.top="40px":o.top=parseInt(s)+"px"}},ZE.prototype.spellCheckMenu=function(a){if(0!==a.button)return!1;for(var b=this,c=a.target,d=c;d&&"BODY"!==d.nodeName&&"HTML"!==d.nodeName;d=d.parentNode)if(d.hasAttribute("data-s")){c=d;break}if(!c.hasAttribute("data-s"))return!1;b._stopEvent(a);var e,f=b.doc,g=document,h=function(a){a&&"keydown"!==a.type&&b._stopEvent(a),ZE._removeEvent(g,"mousedown",i),ZE._removeEvent(f,"mousedown",h),ZE._removeEvent(f,"keydown",h),e.parentNode.removeChild(e)},i=function(a){b._stopEvent(a);for(var c=a.target;null!==c&&c!==ze_spellcheck_options;)c=c.parentNode;null===c&&h()},j=function(a){b._stopEvent(a);var d,e=a.target;if("UL"===e.nodeName)return!1;if("LI"===e.nodeName){if(d=e.getAttribute("data-i"),"No Suggestions"===d)return;if("Ignore All"===d)b.leaveSimilarErrorWords(c.getAttribute("replaceword"));else if("Dictionary"===d)b.addToDictionary(c.getAttribute("replaceword"));else if("Custom Dictionary"===d)b.customDictionary();else{var g,i=c,j=i.parentNode,k=i.style;if(g="Ignore"===d?i.textContent:e.textContent,k&&k.length>1)k.backgroundColor="",i.removeAttribute("data-s"),i.textContent=i.textContent.replace(i.getAttribute("replaceword"),g),i.removeAttribute("replaceword");else{if(i.textContent===i.getAttribute("replaceword"))j.insertBefore(f.createTextNode(g),i);else{i.textContent=i.textContent.replace(i.getAttribute("replaceword"),g);for(var l=i.firstChild;l;){var m=l.cloneNode(!0);j.insertBefore(m,i),l=l.nextSibling}}j.removeChild(i)}}}return h(),!1},k=(g.createDocumentFragment(),{spellcheck:[]}),l=c.getAttribute("data-s");l=l.split(","),k.spellcheck[0]=[];for(var m,n=0;(m=l[n])&&n<5;n++){var o=g.createElement("li");o.innerHTML=m,k.spellcheck[0][n]={},k.spellcheck[0][n].cmd=m,0===n&&"No Suggestions"===m&&(k.spellcheck[0][n]["data-i"]="No Suggestions",k.spellcheck[0][n].color="#bcb9af",k.spellcheck[0][n].fontWeight="Normal")}k.spellcheck[1]=[],k.spellcheck[1][0]={},k.spellcheck[1][0].cmd="Add to Dictionary",k.spellcheck[1][0]["data-i"]="Dictionary",k.spellcheck[1][1]={},k.spellcheck[1][1].cmd="Ignore",k.spellcheck[1][1]["data-i"]="Ignore",k.spellcheck[1][2]={},k.spellcheck[1][2].cmd="Ignore All",k.spellcheck[1][2]["data-i"]="Ignore All",k.spellcheck[2]=[],k.spellcheck[2][0]={},k.spellcheck[2][0].cmd="Custom Dictionary",k.spellcheck[2][0]["data-i"]="Custom Dictionary",b.constructContextMenu(k.spellcheck,"ze_spellcheckmenu_div",j),e=document.getElementById("ze_spellcheckmenu_div"),ZE._addEvent(g,"mousedown",i),ZE._addEvent(f,"mousedown",h),ZE._addEvent(f,"keydown",h);var p=ZE.getPos(b.editordiv),q=e.style;a.clientY+p.offsetTop+b.toolbardiv.offsetHeight,a.clientX+p.offsetLeft;posx=0,posy=0;var r=b.iframe.getBoundingClientRect(),s=c.getBoundingClientRect();a.pageX||a.pageY?(posx=r.left+s.left+(a.pageX-s.left),b.win.scrollY?posy=r.top+s.top+(a.pageY-s.top)-b.win.scrollY:posy=r.top+s.top+(a.pageY-s.top)-b.win.pageYOffset):(posx=r.left+s.left+(a.clientX-s.left),b.win.scrollY?posy=r.top+s.top+(a.clientY-s.top)-b.win.scrollY:posy=r.top+s.top+(a.clientY-s.top)-b.win.pageYOffset),q.left=parseInt(posx)+"px",q.top=parseInt(posy)+"px";var t=e.offsetHeight;if(posy+t>window.innerHeight-20){var u=posy-t;u<41?q.top="40px":q.top=parseInt(u)+"px"}},ZE.prototype.removeSpellcheckEvent=function(a){var b=this;b.spellCheckEvent&&ZE._removeEvent(b.doc,"mouseup",b.spellCheckEvent),ZE.activeEditor&&delete ZE.activeEditor;var c=b.sclog;c.style.display="","success"===a?c.innerHTML=ZE.i18n("No errors"):c.innerHTML=ZE.i18n("Try Again"),setTimeout(function(){b.sclog.style.display="none",b.screcheck.style.display=""},2500),b.screcheck.style.display="none",b.sccancel.style.display="none",b.scclose.style.display="",b.scspan.style.display=""},ZE.prototype.leaveSimilarErrorWords=function(a){var b,c=this,d=c.mode,e=c.spellcheckdiv;if(a=a.toLowerCase(),"plaintext"===d?e&&(b=e.getElementsByTagName("span")):b=c.doc.getElementsByTagName("span"),b)for(var f=b.length-1;f>=0;f--){var g=b[f];if(g.hasAttribute("replaceword")&&a===g.getAttribute("replaceword").toLowerCase())if(g.style.backgroundColor="",g.style.length>0)g.removeAttribute("data-s"),g.removeAttribute("replaceword");else if(g.hasChildNodes()){for(var h=g.childNodes,i=g.parentNode,j=0;j<h.length;j++)i.insertBefore(h[j].cloneNode(!0),g);i.removeChild(g)}}},ZE.prototype.spellcheckOptions=function(a,b){var c=this,d=a.currentTarget,e=document,f=e.getElementById("ze_spellcheck_options"),g=c.doc,h=c.toolbarobject[b];ZE.addClass(h,"ze_dn ze_Sel");var i=function(a){a&&"keydown"!==a.type&&c._stopEvent(a),f.style.display="none",ZE.removeClass(h,"ze_dn ze_Sel"),ZE._removeEvent(f,"click",j),ZE._removeEvent(e,"mousedown",l),ZE._removeEvent(g,"mousedown",l),ZE._removeEvent(g,"keydown",l),f.parentElement.removeChild(f),n.appendChild(q)},j=function(a){c._stopEvent(a);var b=a.target,e=b.nodeName;if("LI"===e);else"IMG"===b.nodeName&&(b=b.parentNode),"SPAN"===b.nodeName&&(b=b.parentNode);if(b.hasAttribute("data-cd")&&"customdictionary"===b.getAttribute("data-cd"))c.customDictionary();else{var g=document.createElement("i");g.className="zei-tick",b.insertBefore(g,b.firstChild),f.setAttribute("data-index",b.getAttribute("data-index")),d.setAttribute("data-lang",b.getAttribute("data-lang")),c.defaultSpellcheckLanguage=b.getAttribute("data-lang"),"function"===c.initobj.changeSpellcheckLanguage&&c.initobj.changeSpellcheckLanguage(c.defaultSpellcheckLanguage)}i()},k=function(){var a=.6*(window.innerHeight-c.iframe.getBoundingClientRect().top);return a<150?a=150:a>300&&(a=300),a},l=function(a){if(a)for(_target=a.target;null!==_target&&_target!==f;)_target=_target.parentNode;_target||i()},m=d.className;if(m&&m.search("ze_dn")>0)return i(),!1;if(f)f.style.display="",f.firstChild.style.height=k()+"px",ZE.addClass(h,"ze_dn"),ZE_Init.needEditorStats&&c.updateCount("spo");else{var n=e.createDocumentFragment(),o=(ZE_Init.imgPath,ZE.i18n),p=e.createElement("div");p.className="ze_dd shw",p.id="ze_spellcheck_options",f=p;var q=e.createElement("ul");q.className="ze_spellCheck",q.style.height=k()+"px",q.style.overflow="hidden",q.style.overflowY="scroll",n.appendChild(q);var r=ZE_Init.spellCheckOptions;r||(r=[["locale","Auto"],["af-ZA","Afrikaans"],["am","Amharic"],["ar","العربية"],["hy_AM","Հայերեն"],["az","Azeri"],["bg_BG","Български"],["bn_BN","Bengali"],["ca","Català"],["cs_CZ","Český"],["da","Danske"],["nl_NL","Nederlands"],["en-AU","English(AU)"],["en-CA","English(CA)"],["en-NZ","English(NZ)"],["en-GB","English(UK)"],["en-US","English(US)"],["en_ZA","English(ZA)"],["eo_l3","Esperanto"],["et_EE","Eesti"],["fo_FO","Faroese"],["fa","Farsi"],["fj_FJ","Fijian"],["fr-FR","Français"],["fy_NL","Frisian"],["gl","Galego"],["de-AT","Deutsch(AT)"],["de-CH","Deutsch(CH)"],["de-DE","Deutsch(DE)"],["el_GR","Ελληνικά"],["he-IL","עברית"],["hi_IN","हिन्दी"],["hu","Magyar"],["id_ID","Indonesia"],["ia","Interlingua"],["ga_IE","Gaeilge"],["is","Íslenska"],["it","Italiano"],["ko","Korean"],["la","Latin"],["lv-LV","Latvijas"],["lt","Lietuvos"],["mi","Maori"],["ms_MY","Melayu"],["mr_IN","Marathi"],["mn_MN","Mongolian(MN)"],["ne_NP","Nepali"],["nb_NO","Norsk bokmål"],["nn","Norsk Nynorsk"],["ns_ZA","Northern Sotho"],["oc_FR","Occitan"],["or_OR","Oriya"],["PL","Polski"],["pt_PT","Português(PT)"],["pt-BR","Português(BR)"],["qu_BO","Quechua"],["rw_RW","Rheato-Romanic"],["ro","Română"],["ru","Русский"],["gd_GB","Scots gaelic"],["sr","Српски"],["sk","Slovenský"],["sl","Slovenski"],["es_CL","Español(CL)"],["es_CO","Español(CO)"],["es_EC","Español(EC)"],["es-ES","Español(ES)"],["es-MX","Español(MX)"],["es_NI","Español(NI)"],["es_PE","Español(PE)"],["es_PR","Español(PR)"],["es_UY","Español(UY)"],["sv_SE","Svenska"],["sw_KE","Swahili"],["ta_TA","தமிழ்"],["tn_ZA","Tswana"],["ts_ZA","Tsonga"],["uz_UZ","Uzbek"],["ve_ZA","Venda"],["vi_VI","Vietnamese"],["xh_ZA","Xhosa"],["zu-ZA","Zulu"]]),c.defaultSpellcheckLanguage||(c.defaultSpellcheckLanguage=ZE_Init.spellcheckLanguage||c.initobj.spellcheckLanguage||"locale");for(var s,t=0;s=r[t];t++){var u=s[0],v=s[1],w=e.createElement("li");w.title=w.href=v,w.setAttribute("data-index",t),w.setAttribute("data-lang",u);var x=e.createElement("i");c.defaultSpellcheckLanguage===u&&(x.className="zei-tick"),w.appendChild(x);e.createElement("span");w.appendChild(e.createTextNode(v)),q.appendChild(w)}var y=e.createElement("ul");y.className="custom";var z=e.createElement("li");y.appendChild(z),z.setAttribute("data-cd","customdictionary"),z.title=z.href="Custom Dictionary";var A=(e.createElement("span"),document.createElement("i"));A.className="zei-custDict",z.appendChild(A),z.appendChild(e.createTextNode(o("Custom Dictionary"))),ZE.addClass(h,"ze_dn"),p.appendChild(n),p.appendChild(y),e.body.appendChild(p),ZE_Init.needEditorStats&&c.updateCount("spo")}ZE._addEvent(f,"click",j),ZE._addEvent(e,"mousedown",l),ZE._addEvent(g,"mousedown",l),ZE._addEvent(g,"keydown",l);var B=ZE.getPos(d),C=f.style,D=B.offsetLeft,E=D-f.offsetWidth+d.offsetWidth;E<c.editordiv.getBoundingClientRect().left?C.left=D+"px":C.left=E+5+"px",C.top=B.offsetTop+d.offsetHeight-1+"px"},ZE.prototype.addToDictionary=function(a){var b,c=this,d=location,e="locale",f=(c.popupdiv,document);c.leaveSimilarErrorWords(a),b=document.createElement("form"),b.method="POST",ZE_Init.useProxy?b.action=ZE_Init.spellcheckProxyUrl+"/lt/customdictionary.lt?operation=add&word="+a+"&servicename="+d.hostname.split(".")[0]+"&language="+e:b.action=d.protocol+"//"+ZE_Init.spellcheckURL+"/lt/customdictionary.lt?operation=add&word="+a+"&servicename="+d.hostname.split(".")[0]+"&language="+e,b.target="ze_spellcheck",f.body.appendChild(b),b.submit(),f.body.removeChild(b)},ZE.prototype.customDictionary=function(){var a=this,b=document,c=b.getElementById("ze_cstm_dict"),d=ZE.i18n,e="locale";e=a.defaultSpellcheckLanguage||"locale";var f=function(){ZE._removeEvent(b,"keydown",g),c.parentNode.removeChild(c),ZE.hideOverlay(),a.win.focus()},g=function(b){27==b.keyCode&&(a._stopEvent(b),f())};if(ZE.showOverlay(),c)c.style.display="",c.getElementsByTagName("iframe")[0].src=location.protocol+"//"+ZE_Init.spellcheckURL+"/lt/customdictionary2g.lt?CD_LANGUAGE="+e;else{var h="<div class='zep_PUtt' onmousedown='ZE.drag(event,\"ze_cstm_dict\");return false;'>";h+=d("Custom Dictionary"),h+="<i class='zei-close'></i></div>",h+="<div class='zep_PUcen' style='margin:10px 0px 10px 0px;'>",h+="<iframe frameborder='0' style='border: medium none; width: 420px; height: 260px;' src="+location.protocol+"//"+ZE_Init.spellcheckURL+"/lt/customdictionary2g.lt?CD_LANGUAGE="+e+"></iframe>",h+="</div>";var i=b.createElement("div");i.className="zep_PU",i.innerHTML=h,i.id="ze_cstm_dict",document.body.appendChild(i),c=i}ZE.setPosition(c,a.editordiv),c.getElementsByClassName("zei-close")[0].onclick=function(b){a._stopEvent(b),f()},c.focus(),ZE._addEvent(b,"keydown",g)},ZE.prototype.createTable=function(a){function b(b){n._stopEvent(b);var d,e,f,i,j,l,m,o,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=n.initobj;ZE_Init.outGoingFontFamily;if(k&&n.restoreSelection(k),d=h.value,!(d>0&&d<500))return r(q("Specify valid number for Rows")),h.focus(),h.select(),!1;if(e=g[1],f=e.value,!(f>0&&f<500))return r(q("Specify valid number for Columns")),e.focus(),e.select(),!1;if(i=g[2],j=i.value,!(j>1&&j<1e4))return r(q("Specify valid number for Width")),i.focus(),i.select(),!1;if(l=g[3],a){if(D=g[3],F=D.value,""==F||!(F>=0&&F<100))return r(q("Specify valid number for Cell Padding")),D.focus(),D.select(),!1;if(E=g[4],G=E.value,""==G||!(G>=0&&G<100))return r(q("Specify valid number for Cell Spacing")),E.focus(),E.select(),!1;l=g[5]}if(m=l.value,""==m||!(m>=0&&m<100))return r(q("Specify valid number for Border")),l.focus(),l.select(),!1;if(o=n.doc,s=p.getElementsByTagName("select")[0],a)C=a.style,a.width&&(a.width=""),C.width=j+s.options[s.selectedIndex].value,a.style.border&&(a.style.border=""),a.border=m,a.cellPadding=F,a.cellSpacing=G,C.border=m+"px solid black",C.color="black",n.win.focus();else{for(t=o.createDocumentFragment(),t.appendChild(o.createElement("br")),u=o.createElement("table"),C=u.style,C.width=j+s.options[s.selectedIndex].value,C.fontSize=H.defaultfontsize||ZE_Init.defaultFontSize||"",C.fontFamily=H.defaultfontfamily||ZE_Init.defaultFontFamily||"",u.cellPadding="2",u.cellSpacing="2",u.border=m,C.border=m+"px solid black",C.color="black",v=o.createElement("tbody"),w=0;w<d;w++){for(y=o.createElement("tr"),x=0;x<f;x++){z=o.createElement("td");var I=o.createElement("div");I.appendChild(o.createElement("br")),z.appendChild(I),y.appendChild(z)}v.appendChild(y)}u.appendChild(v),t.appendChild(u),t.appendChild(o.createElement("br")),n.win.focus(),A=n._getSelection();try{A.isCollapsed||A.deleteFromDocument(),B=A.getRangeAt(0)}catch(J){B=n._createRange(A)}try{B.insertNode(t)}catch(K){r(q("Exception in inserting table"))}}return c(),n.saveCurrentState(),!1}var c,d,e,f,g,h,i,j,k,l,m,n=this,o=document,p=o.getElementById("ze_ins_table"),q=ZE.i18n;c=function(){var a=p.getElementsByTagName("form")[0];o.removeEventListener("keydown",d,!0),p.parentNode.removeChild(p),ZE.hideOverlay(),a&&a.reset(),n.win.focus(),n.range&&(n.range.select(),delete n.range)},initialize=function(){var b,c,d,e,f,i,j,k;h.value=a.rows.length,h.disabled=!0,b=g[1],b.value=a.rows[0].cells.length,b.disabled=!0,c=g[2],f=a.style.width||a.width,i=p.getElementsByTagName("select")[0],f.indexOf("%")!=-1?i.selectedIndex="0":i.selectedIndex="1",f&&(c.value=parseInt(f)),c.focus(),j=g[3],a.cellPadding?j.value=a.cellPadding:j.value="0",k=g[4],a.cellSpacing?k.value=a.cellSpacing:k.value="0",d=g[5],e=a.style.border||a.border,e?d.value=parseInt(e):d.value="0"},d=function(a){27===a.keyCode&&(n._stopEvent(a),c()),13===a.keyCode&&(n._stopEvent(a),b(a))},l=a?"Edit Table":"Insert Table",e='<div class="zep_PUtt">'+q(l)+'<i class="zei-close"></i></div>',e+='<div class="zep_PUcen">',e+='<form><table class="ze_ptble"><tr><td>'+q("Rows")+'</td><td><input type="text" class="ze_m20" value="2" maxlength="2" size="2"></td><td>'+q("Columns")+'</td><td><input type="text" value="2" maxlength="2" size="2"></td></tr>',e+="<tr><td>"+q("Width")+'</td><td><input type="text" value="100" maxlength="4" size="2"/></td><td colspan="2"><div class="ze_select"><select class="select"><option value="%">%</option><option value="px">'+q("px")+"</option></select></div></td></tr>",a&&(e+="<tr><td>"+q("Cell Padding")+'</td><td><input type="text" maxlength="2" size="2"/></td><td>'+q("Cell Spacing")+'</td><td><input type="text" maxlength="2" size="2"/></td></tr>'),e+="<tr><td>"+q("Border")+'</td><td><input type="text" value="1" maxlength="2" size="2"/></td></tr>',e+='<tr><td></td></tr><tr><td colspan="4"><p class="ze_iiSnF"><span class="ze_popuperrmsg"style="display:none;">this is temp text</span></p></td></tr></table></form></div>',e+='<div class="zep_PUbtm"><span class="sel">'+q("OK")+'</span><span data-val="Cancel">'+q("Cancel")+"</span></div>",ZE.showOverlay(),n.win.focus(),k=n.saveSelection(),f=o.createElement("div"),f.setAttribute("class","zep_PU zep_arrb"),f.innerHTML=e,f.id="ze_ins_table",p=f,document.body.appendChild(f),ZE.setPosition(p,n.editordiv),g=p.getElementsByTagName("input"),h=g[0],i=p.getElementsByTagName("span"),m=i[0],j=p.getElementsByClassName("zei-close")[0],a?initialize():h.focus(),j.onclick=i[2].onclick=function(a){n._stopEvent(a),c()};var r=function(a){m=p.getElementsByTagName("span"),m[0].style.display="",m[0].innerHTML=a};i[1].onclick=b,ZE._addEvent(o,"keydown",d)},ZE.prototype.insertObj=function(){"use strict";var a,b,c,d,e,f,g=this,h=document,i=h.getElementById("ze_ins_obj"),j=ZE.i18n;g.freeze(),b=function(){i.style.display="none",a.value="",g.hideFreeze(),g.win.focus(),h.removeEventListener("keydown",c,!0)},c=function(a){27===a.keyCode&&(g._stopEvent(a),b())},i?i.style.display="":(d="<div class='ze_pop_header' onmousedown='ZE.drag(event,\"ze_ins_obj\");return false;'><img class='ze_closeimg' src='",d+=ZE_Init.imgPath+"/images/spacer.gif'/>",d+="<h4>"+j("Insert HTML")+"</h4></div>",d+='<div class="ze_subpart ze_objsub"><span class="ze_clr"><textarea class="ze_objecttxt">',d+="</textarea></span></div>",d+='<div class="ze_botpart"><input type="submit" class="ze_btn" value=',d+=j("Insert")+' /><input type="submit" class="ze_btn" value='+j("Cancel")+" /></div>",e=h.createElement("div"),e.className="ze_objpop",e.innerHTML=d,e.id="ze_ins_obj",document.body.appendChild(e),i=e),ZE.setPosition(i,g.editordiv),a=i.getElementsByTagName("textarea")[0],a.focus(),f=i.getElementsByTagName("input"),i.getElementsByTagName("img")[0].onclick=f[1].onclick=function(a){g._stopEvent(a),b()},f[0].onclick=function(c){g._stopEvent(c);var d=a.value;return d=ZE.trim(d),0===d.length?(alert(j("Please Enter some HTML")),a.focus(),!1):(g.win.focus(),g.doc.execCommand("inserthtml",!1,d),void b())},h.addEventListener("keydown",c,!0)},ZE.prototype.showContextMenu=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=document,n=l.doc;a.target;_target1=a.target,delete_table=function(){l.win.focus(),c.parentNode.removeChild(c),hideContextMenu(),l.win.focus(),l.saveCurrentState()},delete_current_row=function(){if(l.win.focus(),j=get_current_row()){if(j.parentNode.removeChild(j),0==c.rows.length)return void delete_table();hideContextMenu(),l.saveCurrentState()}},delete_current_column=function(){if(l.win.focus(),j=get_current_row()){var a=get_current_column(),b=getPosition(j,a),c=j.parentNode,e=c.getElementsByTagName("TR");for(d=e.length,k=0;k<d;k++){var f=e[k].children;e[k].removeChild(f[b])}if(!e[0].hasChildNodes())return void delete_table();hideContextMenu(),l.saveCurrentState()}},get_current_row=function(){if(i=_target1,"TR"!=i.nodeName)for(;null!==i&&"TR"!=i.nodeName;i=i.parentNode);return i},getColumnsNo=function(a){var b=a.children;return b.length},constructRow=function(a,b){var c,d=n.createDocumentFragment(),e=n.createElement("tr"),f=b.rowStyle,g=b.colStyle;
if(f)for(var h=f.split(";"),i=h.length,j=0;j<i;j++)c=h[j].split(":"),c[0].trim().length>0&&(e.style[c[0].trim()]=c[1].trim());if(d.appendChild(e),g){var l=g.split(";");i=l.length}else i=0;for(k=0;k<a;k++){for(var m=n.createElement("td"),o=0;o<i;o++)c=l[o].split(":"),c[0].trim().length>0&&(m.style[c[0].trim()]=c[1].trim());var p=n.createElement("div");p.appendChild(n.createElement("br")),m.appendChild(p),e.appendChild(m)}return d},insert_row_above=function(a){l.win.focus(),j=get_current_row();var b={},c=j.getAttribute("style")||null,d=j.childNodes[0].getAttribute("style")||null;if(b={rowStyle:c,colStyle:d},j){var e=getColumnsNo(j);f=constructRow(e,b),j.parentNode.insertBefore(f,j),"noHide"!==a&&hideContextMenu(),selectedRange&&l.restoreSelection(selectedRange),l.win.focus(),l.saveCurrentState()}},insert_row_below=function(a){l.win.focus(),j=get_current_row();var b={},c=j.getAttribute("style")||null,d=j.childNodes[0].getAttribute("style")||null;if(b={rowStyle:c,colStyle:d},j){var e=getColumnsNo(j);f=constructRow(e,b),j.parentNode.insertBefore(f,j.nextSibling),"noHide"!==a&&hideContextMenu(),selectedRange&&l.restoreSelection(selectedRange),l.win.focus(),l.saveCurrentState()}},insert_column_left=function(a){if(l.win.focus(),j=get_current_row()){var b=get_current_column(),c=b.getAttribute("style"),e=0,f={};if(c){var g=c.split(";");e=g.length;var h;f.borderWidth=j.parentElement.firstChild.firstChild.style.borderWidth,f.borderStyle=j.parentElement.firstChild.firstChild.style.borderStyle}var i=getPosition(j,b),m=j.parentNode,o=m.getElementsByTagName("TR");for(d=o.length,k=0;k<d;k++){var p=o[k].children,q=n.createElement("td");e>0&&(q.style.width=j.offsetWidth+"px");for(var r=0;r<e;r++)h=g[r].split(":"),h[0].trim().length>0&&(q.style[h[0].trim()]=h[1].trim());for(r=0;r<Object.keys(f).length;r++)q.style.borderWidth=f.borderWidth,q.style.borderStyle=f.borderStyle;var s=n.createElement("div");s.appendChild(n.createElement("br")),q.appendChild(s),o[k].insertBefore(q,p[i])}"noHide"!==a&&hideContextMenu(),l.saveCurrentState()}},getPosition=function(a,b){var c=a.children;for(d=c.length,k=0;k<d;k++)if(b===c[k])return k},get_current_column=function(){if(i=_target1,"TD"!=i.nodeName)for(;null!==i&&("TD"!=i.nodeName&&"TH"!=i.nodeName);i=i.parentNode);return i},insert_column_right=function(a){if(l.win.focus(),j=get_current_row()){var b=get_current_column(),c=b.getAttribute("style"),e=0,f={};if(c){var g=c.split(";");e=g.length;var h;f.borderWidth=j.parentElement.firstChild.firstChild.style.borderWidth,f.borderStyle=j.parentElement.firstChild.firstChild.style.borderStyle}var i=getPosition(j,b),m=j.parentNode,o=m.getElementsByTagName("TR");for(d=o.length,k=0;k<d;k++){var p=o[k].children,q=n.createElement("td");e>0&&(q.style.width=j.offsetWidth+"px");for(var r=0;r<e;r++)h=g[r].split(":"),h[0].trim().length>0&&(q.style[h[0].trim()]=h[1].trim());for(r=0;r<Object.keys(f).length;r++)q.style.borderWidth=f.borderWidth,q.style.borderStyle=f.borderStyle;var s=n.createElement("div");s.appendChild(n.createElement("br")),q.appendChild(s),o[k].insertBefore(q,p[i].nextSibling)}"noHide"!==a&&hideContextMenu(),l.saveCurrentState()}},edit_table=function(){var a=c;l.createTable(a),hideContextMenu(1)};var o={table:[[{cmd:"Insert Rows Above",id:"insert_row","class":"li_class",method:insert_row_above,subMenu:"RA"},{cmd:"Insert Rows Below","class":"li_class",method:insert_row_below,subMenu:"RB"},{cmd:"Insert Column left","class":"li_class",method:insert_column_left,subMenu:"CL"},{cmd:"Insert Column right","class":"li_class",method:insert_column_right,subMenu:"CR"}],[{cmd:"Delete Row",id:"delete_row",method:delete_current_row},{cmd:"Delete Column","class":"li_class",method:delete_current_column},{cmd:"Delete Table",method:delete_table}],[{cmd:"Edit Table",method:edit_table}]]};switch(executeFunction=function(a,b){b[a].method()},b){case"table":if(!get_current_row())return;e=o.table}hideContextMenu=function(a){a||(selectedRange&&l.restoreSelection(selectedRange),l.win.focus()),g=document.getElementById("ze_contextMenudd"),g&&(document.body.removeChild(g),ZE._removeEvent(m,"mousedown",h),ZE._removeEvent(n,"mousedown",h),ZE._removeEvent(n,"keydown",h))},h=function(a){if(g=document.getElementById("ze_contextMenudd"),a)for(i=a.target;null!==i&&i!==g;i=i.parentNode);i||hideContextMenu()},setPositions=function(a){var b=0,c=0,d=document,e=document.body,f=d.documentElement,h=Math.max(e.scrollTop,f.scrollTop),i=l.iframe.getBoundingClientRect(),j=_target1.getBoundingClientRect();a.pageX||a.pageY?(b=i.left+j.left+(a.pageX-j.left),l.win.scrollX>0&&(b-=l.win.scrollX),c=l.win.scrollY?i.top+j.top+(a.pageY-j.top)-l.win.scrollY:i.top+j.top+(a.pageY-j.top)-l.win.pageYOffset):(b=i.left+j.left+(a.clientX-j.left),c=l.win.scrollY?i.top+j.top+(a.clientY-j.top)-l.win.scrollY:i.top+j.top+(a.clientY-j.top)-l.win.pageYOffset),c+=h||0,g.style.left=parseInt(b)+"px",g.style.top=parseInt(c)+"px";var k=(ZE.getPos(l.editordiv),g.style),m=g.offsetHeight,n=document.body.getBoundingClientRect().width;if(b+g.offsetWidth+10>n&&(k.left="auto",b=window.innerWidth-b,k.right=parseInt(b)+"px"),c+m>window.innerHeight-20){var o=c-m;o<10?k.top="40px":k.top=parseInt(o)+"px"}},l.constructContextMenu(e,"ze_contextMenudd"),l.win.focus(),selectedRange=l.saveSelection(),g=document.getElementById("ze_contextMenudd"),setPositions(a),ZE._addEvent(m,"mousedown",h),ZE._addEvent(n,"mousedown",h),ZE._addEvent(n,"keydown",h)};var constructTable=function(a){"use strict";a.preventDefault(),a.stopPropagation();var b=a.target.getAttribute("data-action"),c=a.target.parentNode.getAttribute("data-subMenu");switch(c){case"RB":"increase"===b?insert_row_below("noHide"):"decrease"===b&&delete_current_row("RB");break;case"RA":"increase"===b?insert_row_above("noHide"):"decrease"===b&&delete_current_row("RA");break;case"CL":"increase"===b?insert_column_left("noHide"):"decrease"===b&&delete_current_column("CL");break;case"CR":"increase"===b?insert_column_right("noHide"):"decrease"===b&&delete_current_column("CR")}};ZE.prototype.constructContextMenu=function(a,b,c){var d,e,f,g,h,i,j=this,k=a.length;for(d=document.createElement("div"),d.className="ze_dd shw notrans ze_tbdr",d.id=b,e=document.createElement("div"),f=document.createElement("ul"),h=0;h<k;h++){var l=a[h];for(i=0;i<l.length;i++)if(g=document.createElement("li"),g.innerHTML=l[i].cmd,l[i].id&&(g.id=l[i].id),l[i]["class"]&&(g.className=l[i]["class"]),f.appendChild(g),g.setAttribute("data-value",i),l[i]["data-i"]&&g.setAttribute("data-i",l[i]["data-i"]),l[i].color&&(g.style.color=l[i].color),l[i].fontWeight&&(g.style.fontWeight=l[i].fontWeight),l[i].method&&(g.onclick=l[i].method),l[i].subMenu){var m=document.createElement("i");m.className="zei-plus",m.setAttribute("data-action","increase"),m.id="ze_subMenu",g.appendChild(m),g.setAttribute("data-subMenu",l[i].subMenu),ZE._addEvent(m,"click",constructTable)}g=document.createElement("li"),g.className="ze_lne",f.appendChild(g)}e.appendChild(f),d.appendChild(e),document.body.appendChild(d),c&&ZE._addEvent(f,"click",c),d.addEventListener("contextmenu",function(a){return j._stopEvent(a),!1},!1)},ZE.prototype.insertCode=function(){var a,b,c,d,e,f,g,h,i=this;if(i.doc.execCommand("insertorderedlist",!1," "),a=i.win.getSelection(),b=a.anchorNode,"OL"===b.nodeName)return void(b.className="code");for(c=!1;null!==b&&"BODY"!==b.nodeName;b=b.parentNode)if("OL"===b.nodeName){b.className="code",c=!0;break}if(!c){if(d=a.getRangeAt(0),e=d.commonAncestorContainer,1!==e.nodeType)for(;null!==e&&"BODY"!==e.nodeName&&1!==e.nodeType;e=e.parentNode);if(1===e.nodeType)for(f=e.getElementsByTagName("ol"),g=f.length,h=0;h<g;h++)if(a.containsNode(f[h],!0)){f[h].className="code";break}}},ZE.prototype._createTableGrid=function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=document,v=t.doc,w=a.currentTarget,x=t.initobj,y=5,z=5,A=[],B=0,C=0;s=t.toolbarobject[b],"smartCompose"!==t.initobj.editorType?ZE.addClass(s,"ze_dn ze_Sel"):ZE.addClass(s,"ze_Sel");var D={TABLEID:"tablegen_div",DROPDOWNID:"ze_dropdown",ROWATTR:"data-row_num",COLATTR:"data-col_num"};k=t.saveSelection();var E=function(a,b,c){a.setAttribute(b,c)},F=function(a,b){var c,d;for(c=0;c<y;c++)for(d=0;d<z;d++)if(c<a&&d<b){var e=u.getElementById("displayDiv");e.innerHTML=a+"x"+b,A[c].childNodes[d].style.backgroundColor="#F4F4F4"}else A[c].childNodes[d].style.backgroundColor="#fff"},G=function(){var a=u.createElement("div");a.id=D.DROPDOWNID,a.className="ze_dd shw ze_dropDown";var b=u.createElement("div");b.innerHTML="1 x 1",b.align="center",b.id="displayDiv",b.className="ze_tableDtl",e=document.createElement("table"),E(e,"id",D.TABLEID),e.className="ze_mainTable";for(var c=1;c<=y;c++){f=u.createElement("tr");for(var d=1;d<=z;d++)g=u.createElement("td"),g.className="ze_tableGridCol",ZE._setAttribute(g,D.ROWATTR,c),ZE._setAttribute(g,D.COLATTR,d),ZE._appendChildren(f,[g]);A.push(f),ZE._appendChildren(e,[f])}var h=u.createElement("ul"),i=u.createElement("li");return i.className="iTable",ZE._appendChildren(i,[b,e]),ZE._appendChildren(h,[i]),ZE._appendChildren(a,[h]),a};j=G(),l=ZE.getPos(w),"smartCompose"===t.initobj.editorType?(h=u.getElementsByClassName("ze_tbEd")[0].offsetWidth-2,j.style.left=l.offsetLeft+h+"px",j.style.top=l.offsetTop+"px"):(j.style.left=l.offsetLeft+"px",j.style.top=l.offsetTop+w.offsetHeight-1+"px"),u.body.appendChild(j);var H=u.getElementById(D.TABLEID),I=function(a){if(j=document.getElementById(D.DROPDOWNID),a)for(c=a.target;null!==c&&c!==j;)c=c.parentNode;c||(r(),j.parentElement.removeChild(j))};q=function(a){var b,c;if(d&&(B=d),i&&(C=i),d=a.target.dataset.row_num,i=a.target.dataset.col_num,Number(B)>Number(d))Number(B)>=5&&(m=u.getElementById(D.TABLEID),y--,m.deleteRow(y),A.pop());else if(Number(d)===y&&10!==y){m=u.getElementById(D.TABLEID),f=u.createElement("tr"),f.style.border="2",y++;for(var h=0;h<z;h++)g=u.createElement("td"),g.className="ze_tableGridCol",ZE._setAttribute(g,D.ROWATTR,y),ZE._setAttribute(g,D.COLATTR,h+1),f.appendChild(g);A.push(f),m.insertBefore(f,m.lastChild.nextSibling)}if(Number(C)>Number(i)){if(Number(C)>=5){b=e.getElementsByTagName("TR");for(var j,k=0;k<b.length;k++){j=z;for(var l=b[k].getElementsByTagName("TD"),n=0;n<1;n++)b[k].removeChild(l[j-1]),j--}z--}}else if(Number(i)===Number(z)&&10!==z){A=[],z+=1;var o=z;c=e.getElementsByTagName("TR"),m=u.getElementById(D.TABLEID);for(var p=0;p<c.length;p++){g=u.createElement("td");var q=c[p].getElementsByTagName("TD");g.className="ze_tableGridCol",ZE._setAttribute(g,D.ROWATTR,p+1),ZE._setAttribute(g,D.COLATTR,o),c[p].insertBefore(g,q[q.length-1].nextSibling),A.push(c[p])}}d||i?d?i?F(d,i):F(d,C):F(B,i):F(B,C)};var J=function(a){for(var b=a,c=b.offsetWidth,d=b.getElementsByTagName("TR"),e=d[0].getElementsByTagName("TD"),f=e.length,g=d.length,h=c/f,i=0;i<g;i++)for(var j=0;j<f;j++)d[i].getElementsByTagName("TD")[j].style.width=h+"px"},K=function(a,b){var c,d;t.win.focus(),k&&t.restoreSelection(k);var e=v.body.ownerDocument.createDocumentFragment();e.appendChild(u.createElement("br"));var f=u.createElement("table"),g=f.style;g.fontSize=x.defaultfontsize||ZE_Init.defaultFontSize||"",g.fontFamily=x.defaultfontfamily||ZE_Init.defaultFontFamily||"",g.width="100%",g.borderCollapse="collapse",g.border="1px solid black",f.className="ze_tableView",f.cellPadding="2",f.cellSpacing="2",f.border="1";var h,i,j=u.createElement("tbody");for(c=0;c<a;c++){for(h=u.createElement("tr"),d=0;d<b;d++){i=u.createElement("td");var l=u.createElement("div");l.appendChild(u.createElement("br")),i.appendChild(l),h.appendChild(i)}j.appendChild(h)}f.appendChild(j),e.appendChild(f),e.appendChild(u.createElement("br")),t.win.focus(),n=t._getSelection();try{n.isCollapsed||n.deleteFromDocument(),o=n.getRangeAt(0)}catch(m){o=t._createRange(n)}try{t.win.focus(),o.insertNode(e),J(f)}catch(p){}o.collapse(!1),n.removeAllRanges(),n.addRange(o),t.saveCurrentState()};r=function(){"smartCompose"===t.initobj.editorType?ZE.removeClass(s,"ze_Sel"):ZE.removeClass(s,"ze_dn ze_Sel"),ZE._removeEvent(H,"click",p),ZE._removeEvent(H,"mousemove",q),ZE._removeEvent(u,"mousedown",I),ZE._removeEvent(v,"mousedown",I),ZE._removeEvent(v,"keydown",I)},p=function(b){t._stopEvent(a),b.target.hasAttribute(D.ROWATTR)&&b.target.hasAttribute(D.COLATTR)?K(d,i):K(B,C),j=u.getElementById(D.DROPDOWNID),r(),j.parentElement.removeChild(j)},ZE._addEvent(u,"mousedown",I),ZE._addEvent(v,"mousedown",I),ZE._addEvent(v,"keydown",I),ZE._addEvent(H,"click",p),ZE._addEvent(H,"mousemove",q)},ZE.prototype.insertQuote=function(){"use strict";var a,b,c,d,e,f,g=this,h=g.doc;for(g.win.focus(),f=g.win.getSelection().anchorNode.parentNode;null!==f;){if("BLOCKQUOTE"===f.nodeName)return!0;f=f.parentNode}if(a=g._getSelection(),b=g._createRange(a),c=h.createDocumentFragment(),d=h.createElement("blockquote"),c.appendChild(d),e=h.createElement("div"),d.appendChild(e),ZE_Init.inlineQuotes?(d.style.border="1px solid #CCCCCC",d.style.padding="7px",d.style.backgroundColor="#F5F5F5"):d.className="block_quote",a.isCollapsed)e.appendChild(h.createElement("br")),b.insertNode(c),b.selectNodeContents(e),b.collapse(!0),a.removeAllRanges(),a.addRange(b);else{e.appendChild(b.cloneContents());var i=h.createElement("div");i.appendChild(c),c.appendChild(h.createElement("br")),g.insertHTML(i.innerHTML,!0)}g.saveCurrentState()},ZE.prototype.htmlView=function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=document;l=p.getContent();var r={TITLE:"EDIT HTML",HTAB:"HTML",PTAB:"Preview",SAVE:"Save",CANCEL:"Cancel"};g=function(c){a.style.display="block",b.style.display="block",a.value=n(c)},f=function(){a.style.display="block",b.style.display="block";var c=DOMPurify.sanitize(a.value),d=b.contentWindow.document.body;d.innerHTML=c},k=function(){ZE.hideOverlay(),c.parentNode.removeChild(c)},m=function(a){for(var b="",c=4*a;c--;)b+=" ";return b},n=function(a){a=a.trim();for(var b="",c=0,d=a.split(/</),e=d.length,f=0,g=e;f<g;f++){var h=d[f].split(/>/);2===h.length?("/"===d[f][0]&&c--,b+=m(c),"/"!==d[f][0]&&c++,f>0&&(b+="<"),b+=h[0].trim()+">\n",""!==h[1].trim()&&(b+=m(c)+h[1].trim().replace(/\s+/g," ")+"\n"),h[0].match(/^(img|hr|br)/)&&c--):b+=m(c)+h[0]+"\n"}return b},o=[String('<div class = "ze_popupTitle">'+r.TITLE),'<span class = "zei-close"> </span>',"</span>","</div>",'<div class = "ze_popupEditor">',"<textarea></textarea>","<iframe></iframe>","</div>",'<div class = "ze_popupButton">','<span class = "sel">'+r.SAVE+"</span>",'<span data-val = "Cancel">'+r.CANCEL+"</span>","</div>"].join(""),ZE.showOverlay(),c=q.createElement("div"),c.className="ze_popup",c.innerHTML=o,q.body.appendChild(c),ZE.setPosition(c,p.editordiv),d=c.getElementsByClassName("ze_popupEditor")[0],a=d.childNodes[0],b=d.childNodes[1],e=c.getElementsByClassName("ze_popupButton")[0],h=e.childNodes[0],i=e.childNodes[1],j=c.getElementsByClassName("zei-close")[0],ZE._addEvent(h,"mousedown",function(){var b=DOMPurify.sanitize(a.value);p.setContent(b),k()}),ZE._addEvent(i,"mousedown",k),ZE._addEvent(j,"mousedown",k),ZE._addEvent(a,"keyup",function(){var c=DOMPurify.sanitize(a.value),d=b.contentWindow.document.body;d.innerHTML=c}),g(l),f()},ZE.prototype.resizeColumn=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l=this,m=l.doc,n=document,o=a;m.getElementById("_resizecolDivs")&&(d=m.getElementById("_resizecolDivs"),d.parentElement.removeChild(d)),k=function(){m.getElementById("_resizecolDivs")&&(d=m.getElementById("_resizecolDivs"),d.parentElement.removeChild(d),delete m.event,ZE._removeEvent(m,"keydown",k))},f=function(a,b){var c=a,d=b,e=c.getElementsByTagName("TR"),f=e[0].getElementsByTagName("TD"),g=f.length,h=e.length;c.style.width=null;for(var i=d/g,j=0;j<h;j++)for(var k=0;k<g;k++)e[j].getElementsByTagName("TD")[k].style.width=i+"px"},j=function(a){var b,c,d,f=a.clientY,g=0,h=o.getBoundingClientRect();m.documentElement.scrollTop?g=m.documentElement.scrollTop:m.body.scrollTop&&(g=m.body.scrollTop);var i=h.height;c=function(){e&&e.parentElement.removeChild(e),l.doc.querySelectorAll("#_resizecolDivs")[0]&&(s=l.doc.querySelectorAll("#_resizecolDivs")[0],s.parentElement.removeChild(s)),ZE._removeEvent(m,"mousemove",d),ZE._removeEvent(m,"mouseup",c),o.style.height=b+"px"},d=function(c){b="rowTop"===a.target.id?f>c.clientY?i+c.clientY:i-c.clientY:i+c.clientY-f,e.style.top=c.clientY+g+"px"},ZE._addEvent(m,"mousemove",d),ZE._addEvent(m,"mouseup",c)},h=function(a){var b=a.clientY,c=a.target.id,d=e.getBoundingClientRect(),f=d.height,g=function(a){var c=f+a.clientY-b;e.style.height=c+"px"},h=function(){var a=q[c].getElementsByTagName("td").length;b=e.getBoundingClientRect().height;for(var d=0;d<a;d++)q[c].getElementsByTagName("td")[0].style.height=b+"px";e.parentElement.removeChild(e),l.doc.querySelectorAll("#_resizecolDivs")[0]&&(s=l.doc.querySelectorAll("#_resizecolDivs")[0],s.parentElement.removeChild(s)),ZE._removeEvent(m,"mousemove",g),ZE._removeEvent(m,"mouseup",h)};ZE._addEvent(m,"mousemove",g),ZE._addEvent(m,"mouseup",h)},c=function(a){var b,c=a.clientX,d=0,h=o.getBoundingClientRect(),j=h.width;m.documentElement.scrollLeft?d=m.documentElement.scrollLeft:m.body.scrollLeft&&(d=m.body.scrollLeft),g=function(f){b="tabLeft"===a.target.id?j-f.clientX:j+f.clientX-c,e.style.left=f.clientX+d+"px"},i=function(){f(o,b),e=m.getElementById("_colEncloseDiv"),e&&e.parentElement.removeChild(e),s=l.doc.querySelectorAll("#_resizecolDivs")[0],l.doc.querySelectorAll("#_resizecolDivs")[0]&&s.parentElement.removeChild(s),ZE._removeEvent(m,"mousemove",g),ZE._removeEvent(m,"mouseup",i)},ZE._addEvent(m,"mousemove",g),ZE._addEvent(m,"mouseup",i)};var p=function(a){var b=a.clientX,c=e.getBoundingClientRect(),d=c.width,f=function(){u=q.length;var b=parseInt(a.target.id);for(y=0;y<u;y++)q[y].getElementsByTagName("TD")[b]&&(q[y].getElementsByTagName("TD")[b].style.width=e.offsetWidth-9+"px");m.removeEventListener("mousemove",g,!1),m.removeEventListener("mouseup",f,!1),ZE._removeEvent(m,"keydown",k),e.parentElement.removeChild(e);var c=m.getElementById("_resizecolDivs");c&&c.parentElement.removeChild(c)},g=function(a){var c=75,f=d+a.clientX-b;f<=75?e.style.width=c+"px":e.style.width=f+"px",e.style.height=o.offsetHeight+"px"};m.addEventListener("mousemove",g,!1),m.addEventListener("mouseup",f,!1)};b=function(a){if(l._stopEvent(a),3===a.which)return!1;e=n.createElement("div");var b,d,f=a.target,g=0,i=e.style,k=parseInt(f.id);return e.id="_colEncloseDiv",i.position="absolute","number"==typeof k&&"ze_rowResize"===f.className&&"rowTop"!==f.id&&"rowBottom"!==f.id?(b=q[k].getBoundingClientRect(),i.left=b.left+"px",i.width=b.width+"px",i.height=b.height+"px",i.border="2px dashed #686666",i.top=b.top+w+"px",m.body.appendChild(e),h(a),!0):"rowTop"===f.id||"rowBottom"===f.id?(b=q[0].getBoundingClientRect(),i.left=b.left+"px",g=o.getBoundingClientRect().top,i.width=b.width+"px",i.border="2px dashed #686666","rowBottom"===a.target.id&&(g=o.getBoundingClientRect().bottom),i.top=g+w+"px",m.body.appendChild(e),j(a),!0):(g=o.getBoundingClientRect().top,i.top=g+w+"px",i.height=o.getBoundingClientRect().height+"px","tabLeft"===a.target.id?(i.left=o.getBoundingClientRect().left+x+"px",i.border="2px dashed #686666",m.body.appendChild(e),c(a),!0):"tabRight"===a.target.id?(i.left=o.getBoundingClientRect().right+x+"px",i.border="2px dashed #686666",m.body.appendChild(e),c(a),!0):(d=r[k].getBoundingClientRect(),i.left=d.left+x+"px",i.width=d.width+"px",i.border="2px dashed #686666",m.body.appendChild(e),void p(a)))};var q=o.getElementsByTagName("tr"),r=q[0].getElementsByTagName("td"),s=document.createElement("div");s.id="_resizecolDivs";var t,u=r.length,v=0,w=0,x=0;m.documentElement.scrollTop?w=m.documentElement.scrollTop:m.body.scrollTop&&(w=m.body.scrollTop),m.documentElement.scrollLeft?x=m.documentElement.scrollLeft:m.body.scrollLeft&&(x=m.body.scrollLeft);for(var y=0;y<=u;y++){t=document.createElement("div");var z=t.style;t.className="ze_colResize",t.id=y-1,v=o.getBoundingClientRect().top,z.top=w+v+"px",m.documentElement.scrollLeft?x=m.documentElement.scrollLeft:m.body.scrollLeft&&(x=m.body.scrollLeft),z.width="3px",z.height=o.getBoundingClientRect().height+"px",y===u?(t.id="tabRight",z.left=o.getBoundingClientRect().right+x+"px"):0===y?(t.id="tabLeft",z.left=o.getBoundingClientRect().left+"px"):z.left=r[y].getBoundingClientRect().left+x+"px",s.appendChild(t)}for(var A=0;A<=q.length;A++){t=n.createElement("div");var B,C=t.style,D=o.getBoundingClientRect();v=0,t.className="ze_rowResize",t.id=A-1,C.position="absolute",0===A?(t.id="rowTop",C.left=D.left+"px",C.width=D.width+"px",v+=D.top+w,C.top=v-1+"px"):A===q.length?(t.id="rowBottom",v+=D.bottom+w,C.left=D.left+"px",C.width=D.width+"px",C.top=v-1+"px"):(B=q[A].getBoundingClientRect(),v+=B.top,C.left=B.left+"px",C.width=B.width+"px",C.top=w+v-1+"px"),C.height="3px",s.appendChild(t)}m.body.appendChild(s),ZE._addEvent(s,"mousedown",b);var E=m.event;void 0===E&&(m.event="added",ZE._addEvent(m,"keydown",k))},ZE.show_CaptchaImage=function(a,b){"use strict";var c,d,e,f,g,h,i,j=document,k=j.getElementById("ze_captcha"),l=ZE.i18n;i=b?b:ZE.activeEditor;var m=function(){var a=k.getElementsByTagName("span");h=a[0],f=a[1],g=a[2]};k?k.style.display="":(d="<div class='zep_PUtt' onmousedown='ZE.drag(event,\"ze_captcha\");return false;'>",d+=l("Word Verification")+"<i class='zei-close'></i></div>",d+="<div class='zep_PUcen'>",d+="<div><table width='100%' cellspacing='0' cellpadding='5' border='0' align='center' class='ze_bordersizemain'>",d+="<tbody><tr><th align='right'>",d+=l("Image Text")+"</th><td>"+l("Enter the text you see in below image"),d+="</td></tr>",d+="<tr><td>&nbsp;</td><td>"+l("Letters are not case sensitive")+"</td></tr>",d+="<tr><td>&nbsp;</td><td>",d+="<input type='text' id ='ze_captcha_text' class='.ze_textbox' style='width: 202px;'>",d+="</td></tr>",d+="<tr><td>&nbsp;</td><td>",d+="<div  class='ze_captcha'>",d+="<img align='absmiddle' height ='72px' class='ze_hip' alt="+l("HIPImage")+" title="+l("Image Verification")+" name='ze_hipImg'></div><span id ='ze_refresh_hip' title ="+l("Refresh image")+" class='ze_change-captcha-icon'></span></td></tr>",d+="</tbody></table></div></div>",d+="<div class='zep_PUbtm'><span>"+l("Go")+"</span><span>"+l("Cancel")+"</span></div>",k=j.createElement("div"),k.className="zep_PU",k.innerHTML=d,k.id="ze_captcha",document.body.appendChild(k)),m(),e=j.getElementById("ze_captcha_text"),e.value="",e.focus(),ZE.setPosition(k,i.editordiv),c=k.getElementsByTagName("img"),c[0].src="/showcaptcha?digest="+a,f.onclick=h.onclick=function(b){var c=e.value,d=b?b.target:window.event.srcElement;return ZE.captchaParam=a+"="+c,"ze_refresh_hip"===d.id&&(ZE.captchaParam=" "),ZE.captchaProcessing&&ZE.captchaProcessing(),"ze_refresh_hip"!==d.id&&(k.parentNode.removeChild(k),!1)},k.getElementsByClassName("zei-close")[0].onclick=g.onclick=function(){k.parentNode.removeChild(k);var a=l("Unable to insert image. Retry after sometime");return ZE.insertImageMsg(a,"error"),i.inlineImagesToBe&&i.inlineImagesToBe.length>0&&i.inlineImagesToBe.splice(0,i.inlineImagesToBe.length),!1}},ZE.prototype.formatPainter=function(){"use strict";var a,b,c,d,e,f,g;a=this,a.doc.body.className+=" formatPainter";var h="makeUnorderedList",i="makeOrderedList";d=function(b){if("backcolor"===b||"forecolor"===b){var c=a.doc.queryCommandValue(b);return f(c)}return a.doc.queryCommandValue(b)},e=function(b){return a.doc.queryCommandState(b)},f=function(a){return"number"!=typeof a?a:"rgb("+(255&a)+", "+((65280&a)>>8)+", "+((16711680&a)>>16)+")"};var j=a.squireInstance.testPresenceinSelection(h,h,"UL",/>UL\b/);j?b=!0:(j=a.squireInstance.testPresenceinSelection(i,i,"OL",/>OL\b/),j&&(c=!0)),e("justifyLeft")?g="left":e("justifyRight")?g="Right":e("justifyFull")?g="justify":e("justifyCenter")&&(g="center"),a.initobj.formatPainter={fontName:d("fontname"),fontsize:d("fontsize"),backcolor:d("backcolor"),forecolor:d("forecolor"),bold:e("bold"),italic:e("italic"),underline:e("underline"),strike:e("strikethrough"),numbering:c,bullets:b,txtAli:g}};