"use strict";window.zmWatch=function(){var a,b={},c=function(a,b,c){a.accId=zmail.accId,zmAjq.XHR({u:zmail.conPath+"/watch.do",t:"POST",fn:c,p:a,ep:b})},d=function(){var a=zmText.get("zmreminder");return a}(),e={getTxt:function(){var a=['<tr id="zmWatch_type_{{cmpId}}">','<td class="ZM_SCType">','<label data-val="zm_watchType_1">','<i class="msi-unoption"></i>','<span data-tooltip="'+d.watch.regardless_tooltip+'">',d.watch.regardless+"</span></label>",'<label data-val="zm_watchType_3"><i class="msi-unoption"></i>','<span data-tooltip="'+d.watch.response_tooltip+'">'+d.watch.response+"</span>","</label>",'<label data-val="zm_watchType_2">','<i class="msi-unoption"></i>','<span data-tooltip="'+d.watch.noreply_tooltip+'">',d.watch.noreply+"</span></label>","</td>","</tr>"],b=['<tr id="zmWatch_header_{{cmpId}}">',"<td>",'<div id="zmWatch_clear_{{cmpId}}" class="SC_frt SC_link SC_dyn SC_thm">',d.watch.clear+"</div><b>",d.watch.remind+"</b></td>","</tr>"],c=['<tr id="zmWatch_desc_{{cmpId}}">',"<td>",'<textarea id="zmWatch_txtdesc_{{cmpId}}"',' placeholder="'+d.watch.adddes+'"',' class="SC_tiput" style="resize: none;">',"</textarea>","</td>","</tr>"],e=['<tr id="zmWatch_option_{{cmpId}}">',"<td>",'<div class="SC_dib">','<div class="SC_dib" ','data-val="zm_reminderDate" ','data-tooltip="'+d.watch.remindon+'">','<input class="SC_input" type="textbox" data-type="date" readonly>',"</div>",'<div class="SC_dib" data-val="zm_reminderTime">','<input class="SC_input" type="textbox" data-type="time">',"</div>",'<div class="SC_dib" data-val="zm_reminderMode">','<div class="zmSelect" data-tooltip="'+d.watch.remindmode+'">','<span class = "reminderMode" data-val = "0">'+d.watch.bynotif+"</span></div>","</div>","</div>","</div>",'<div class="SC_mt10 checkBox" data-val="zm_reminderType_1">','<i class="msi-uncheck"></i>','<label data-tooltip="'+d.watch.remindrecip_tooltip+'">',d.watch.remindrecip+"</label>","</div>","</td>","</tr>"],f=['<tr id="zmWatch_editor_{{cmpId}}" class="SC_dyn">','<td><div id="zmWatch_editor_load_{{cmpId}}" class="zmCE">',"</div></td></tr>"],g=["<tr><td>",'<div class="SC_PUbtm">','<span id="zmWatch_save_{{cmpId}}">'+d.watch.addrem+"</span>",'<span id="zmWatch_close_{{cmpId}}">'+d.buttons.close+"</span>","</div>","</td></tr>"],h={};return h.header=b,h.type=a,h.desc=c,h.editor=f,h.option=e,h.button=g,h},getWatchTxt:function(a){var b=zmWatch.getTxt(a),c=[],d=[],e=[];b.type&&(c=b.type),b.option&&(d=b.option),b.editor&&(e=b.editor);var f=['<div id="zmWatch_{{cmpId}}">','<table class="SC_schd">',"<tbody>",c.join(""),d.join(""),e.join(""),"</tbody>","</table>","</div>"];return f.join("")},showWatch:function(c){var d={};a=zmComponent.keybindings.getScope();var e=!1;if(!zmUtil.isChildWindow()&&"compose_tab"===c.openWatch){var f=zmComp.getObj(c.msgId);f.RMOBJ&&!$.isEmptyObject(f.RMOBJ)&&(d=f.RMOBJ),f._reminder_draft&&(e=!0)}var g=c.msgId;b[g]||(b[g]={}),$.isEmptyObject(d)||(b[g]._load_type||(b[g]._load_type="drafted"),b[g]._draft_obj=d,e&&(b[g]._reminder_draft=e)),b[g].openWatch=c.openWatch,b[g].dialogType=c.loadType,b[g].calleeObj=c,zmWatch.watchDialog(g);var h=function(){},i=[{uid:"navigation",keyStr:"tab",actions:[h],preventDefault:!0}];zmComponent.keybindings.registerAll({scope:"reminder",shortcuts:i,allowDefaultScope:!1,preventDefault:!0}),zmComponent.keybindings.setScope("reminder")},updateDialog:function(a){var b=a.config.cmpId;a.$els.$positionWrapper.addClass("SC_PopTop"),a.$els.$positionWrapper.css("top","150px"),zmWatch.triggerWatch(b),"undefined"!=typeof window.event&&zmUtil.stopEvents(window.event)},modifyDialog:function(a){var c=a.config.cmpId;b[c]._dDialog=a;var e=['<span class="sel" id="zmWatch_save_'+c+'">'+d.watch.addrem+"</span>",'<span data-val="Cancel" id="zmWatch_close_'+c+'">'+d.buttons.close,"</span>",'<label  data-val="Cancel" id="zmWatch_clear_'+c+'" ','class="SC_frt SC_link SC_dyn SC_thm">'+d.watch.clear+"</label>"],f=['<div id="zmWatch_error_band_'+c+'" class="SC_msg SC_emsg SC_dyn"><span>','<font  id="zmWatch_server_error_'+c+'"></font>','<i id="zmWatch_error_close_'+c+'" class="msi-close"></i></span></div>'];a.$els.$contentWrapper.prepend(f.join("")),a.$els.$content.attr("id","zmwatch_center_"+c),a.$els.$buttonContainer.html(e.join(""))},watchDialog:function(a){var c=[{attrs:'id="zmWatch_save_'+a+'" data-watch="add"',callback:function(){zmsDialog.remove()}}],e=zmWatch.loadWatch(a),f=$(e).find(".zmSelect"),g=[],h={htm:d.watch.bynotif,data:{val:"0",text:d.watch.bynotif}},i={htm:d.watch.bymail,data:{val:"1",text:d.watch.bymail}},j=function(a){var b=f[0].firstChild;b.setAttribute("data-val",a.val),b.innerText=a.text,zmUtil.hideMenu()};g.push(h),g.push(i),f.on("click",function(){var a={par:$(e).find(".zmSelect"),clk:function(a){j(a)},list:g,ulClass:"SC_tin",align:"pleft"},b=new zmDropDownMenu(a);b.paint()}),b[a]._watchDOM=e;var k={};k.title=d.watch.remind,k.cmpId=a,k.openWatch=b[a].openWatch;var l='<h3><i class="msi-mail SC_thm"></i><label id="zm_reminder_dialog_title_'+a+'">';l+="</label></h3>";var m=$("<div/>");m.append(l),m.append(e),k.$content=m,k.buttons=c,k.ignoreMouseDown=!1,k.dialogDidMount=function(b){var c=b.config.cmpId,e=b.config.openWatch,f="",g=zmUtil.getMailObj(c);if(g&&(f=g.SB),e&&"compose_tab"===e){f=d.nosubject;var h=zmComp.getSubject(a);h&&""!==$.trim(h)&&(f=$.trim(h))}f=_zm.unescapeTags(f),$("#zm_reminder_dialog_title_"+c).text(f),zmWatch.updateDialog(b)},k.dialogWillMount=function(a){zmWatch.modifyDialog(a)},Dialog["new"](k)},listDialog:function(a,c){var e=a.msgId;b[e]||(b[e]={}),b[e].openWatch=a.openWatch,b[e].dialogType=a.loadType,b[e].calleeObj=a,b[e]._dDialog=c;var f=$("<label/>");f.text(d.watch.clear),f.attr("id","zmWatch_clear_"+e),f.addClass("SC_frt SC_link SC_thm SC_dyn"),c.getButtonContainer().append(f);var g=zmWatch.loadWatch(e);c.getCenterElem(c.configOption.tabs[0].tabName).append(g),b[e]._watchDOM=g,zmWatch.triggerWatch(e)},listDOM:function(a){var b,c,d=zmCenterListing.mailObjectAPI.getViewObject(a);return d?b=d.$element:(c=zmsuite.getCenter("zm_Container")[0].getNodes()[2].$el,c.length&&(b=c.find("#"+a))),b},updateWatch:function(a,c){var e,f,g=c.cmpId,h="",i=c.watchMode,j=zmWatch.listDOM(g);if("success"===a.stat){var k=ZMail.lConstants.cls;"a"!==i&&"u"!==i||(f=zmUtil.getMailObj(g),f&&(f.RMOBJ=c.RMOBJ,b[g].reminder=!0),"a"===i&&(h=d.errors.watchadd),"u"===i&&(h=d.errors.watchupd),e=$("#zmprv_header_"+g+"_remind*"),e.attr("title",d.watch.updrem),e.find(".msi-mailReminder").addClass("SC_thm"),j.length&&!j.find("."+k.associate).length&&zmList.addAssociateIndication(j)),"d"===i&&(e=$("#zmprv_header_"+g+"_remind*"),e.attr("title",d.watch.setrem),e.find(".msi-mailReminder").removeClass("SC_thm"),j.length&&j.find("."+k.associate).length&&j.find("."+k.associate).remove(),f=zmUtil.getMailObj(g),f&&delete f.RMOBJ,h=d.errors.watchrem),zmWatch.closeWatch(g),zmWatch.hideWatch(g),_zm.succErrMsg("s",h)}else{$("#zmWatch_save_"+g).off("click").on("click",function(){zmWatch.addWatch(g,$(this))});var l=$("#zmWatch_save_"+g).attr("vtxt");$("#zmWatch_save_"+g).text(l),"a"===c.watchMode&&(a.emsg?zmWatch.errorShow(g,a.emsg):_zm.succErrMsg("e",d.errors.probadd)),"d"===c.watchMode&&(a.emsg?zmWatch.errorShow(g,a.emsg):_zm.succErrMsg("e",d.errors.probrem)),"u"===c.watchMode&&(a.emsg?zmWatch.errorShow(g,a.emsg):_zm.succErrMsg("e",d.errors.probupd))}},errorShow:function(a,c){b[a]&&b[a]._dDialog&&"header_all"===b[a].openWatch?b[a]._dDialog.showSuccErrMsg("e",c):($("#zmWatch_error_band_"+a).removeClass("SC_dyn"),$("#zmWatch_server_error_"+a).text(c),$("#zmWatch_error_close_"+a).off("click").on("click",function(){$("#zmWatch_error_band_"+a).addClass("SC_dyn")}))},errorHide:function(a){$("#zmWatch_error_band_"+a).addClass("SC_dyn")},getWatchType:function(a){return b[a].WT},setWatchType:function(a,c){b[a].WT=c},getReminderType:function(a){return b[a].RMT},setReminderType:function(a,c){b[a].RMT=c},getReminderMode:function(a){return b[a].RMM},setReminderMode:function(a,c){b[a].RMM=c},getReminderDesc:function(a){return b[a].RMDSC},setReminderDesc:function(a,c){b[a].RMDSC=c},getReminderDate:function(a){return b[a].RMD},setReminderDate:function(a,c){b[a].RMD=c},getEditor:function(a){return b[a].editor},setEditor:function(a,c){b[a].editor=c},allowWatch:function(a){var c,d=!1;return b[a]&&b[a].WT&&(c=b[a].WT),1!==c&&2!==c&&3!==c||(d=!0),d},loadWatch:function(a){var b=zmWatch.getWatchTxt(a);return b=b.replace(/{{cmpId}}/g,a),$(b)},getHours:function(a){var b=zmWatch.getWatchDateEle(a)._time_elm,c=b.val();c=$.trim(c);var d=c.split(" "),e=d[1],f=d[0].split(":"),g=f[0];return"pm"===e&&(g=String(parseInt(f[0])+12)),g+":"+f[1]},getCurrentDate:function(){var a,b,c,d,e=zmWatch.getCurrentDateObj();return e&&(a=e.getDate(),b=e.getMonth()+1,c=e.getFullYear(),a<10&&(a="0"+a),b<10&&(b="0"+b)),"dd/mm/yyyy"===zmail.userDateFormat.toLowerCase()?d=a+"/"+b+"/"+c:"mm/dd/yyyy"===zmail.userDateFormat.toLowerCase()&&(d=b+"/"+a+"/"+c),d},getCurrentDateObj:function(a){var b=new Date,c=a||zmail.timeZoneOffset,d=b.getTime()+6e4*b.getTimezoneOffset(),e=new Date(d+c);return e},getCurrentTime:function(){var a=new Date;a.setMinutes(a.getMinutes()+30);var b=zmWatch.getCurrentDate(),c=String(a.getHours()),d=String(a.getMinutes()),e=c.length>1?c:"0"+a.getHours(),f=d.length>1?d:"0"+a.getMinutes(),g=e+":"+f;return{date:b,time:g}},bindDatePicker:function(a,b){var c;if("undefined"!=typeof ZEVENTS){var d=zmail.userDateFormat.toUpperCase(),e=zmWatch.getCurrentDate();void 0!==a&&(c=ZEVENTS(a).picker("date",{dform:d,wkst:0,mode:"popup",update:"yes",range:[e,""],minhgt:251}).on("dateclick",function(){b&&b(this.getDate().getDateBy(d))}).bind())}return c},bindTimePicker:function(a){var b;return"undefined"!=typeof ZEVENTS&&void 0!==a&&(b=ZEVENTS(a).picker("time",{tform:"HH:mm ss"}).bind()),b},triggerWatch:function(a){zmWatch.clearWatchElem(a,"trigger"),zmWatch.loadEditor(a)},addWatchTheme:function(a){if("compose_tab"===b[a].openWatch){var c=b[a].calleeObj.elem;c.addClass("SC_thm")}},clearWatchTheme:function(a){if("compose_tab"===b[a].openWatch){var c=b[a].calleeObj.elem;c.removeClass("SC_thm")}},showWatchClear:function(a){$("#zmWatch_clear_"+a).removeClass("SC_dyn"),$("#zmWatch_clear_"+a).off("click").on("click",function(){b[a].reminder?zmWatch.deleteReminder(a):b[a].clear_reminder?(zmWatch.clearWatchTheme(a),zmWatch.setCmpModified(a),zmWatch.setAvoidWatch(a,!0),b[a]._load_type="reupdate",b[a]&&"list"===b[a].dialogType?b[a]._dDialog.$el.remove():b[a]._dDialog.remove()):zmWatch.clearReminder(a)})},hideWatchClear:function(a){$("#zmWatch_clear_"+a).addClass("SC_dyn")},clearWatchElem:function(a,c){var e=b[a]._watchDOM,f=e.find("tr#zmWatch_type_"+a),g=f.find('label[data-val^="zm_watchType_"]'),h=g.filter('label[data-val="zm_watchType_3"]');h.find("i").eq(0).removeClass().addClass("msi-unoption");var i=g.filter('label[data-val="zm_watchType_2"]');i.find("i").eq(0).removeClass().addClass("msi-unoption");var j=g.filter('label[data-val="zm_watchType_1"]');j.find("i").eq(0).removeClass().addClass("msi-unoption");var k=g.filter('label[data-val="zm_watchType_3"]').find("span").get(0),l=g.filter('label[data-val="zm_watchType_2"]').find("span").get(0),m=g.filter('label[data-val="zm_watchType_1"]').find("span").get(0);k&&zmComponent.tooltip({elm:k,text:d.watch.response_tooltip,arrow:"top"}),l&&zmComponent.tooltip({elm:l,text:d.watch.noreply_tooltip,arrow:"top"}),m&&zmComponent.tooltip({elm:m,text:d.watch.regardless_tooltip,arrow:"top"});var n=e.find("tr#zmWatch_option_"+a),o=n.find('div[data-val="zm_reminderType_1"]');o.find("i").eq(0).removeClass().addClass("msi-uncheck");var p=n.find('div[data-val="zm_reminderType_1"]').find("label").get(0);p&&zmComponent.tooltip({elm:p,text:d.watch.remindrecip_tooltip,arrow:"top"});var q=n.find('div[data-val="zm_reminderDate"]');q.find("input").eq(0).val(zmWatch.getCurrentTime().date);var r=n.find('div[data-val="zm_reminderDate"]').find("input").get(0);r&&zmComponent.tooltip({elm:r,text:d.watch.remindon,arrow:"top"});var s=n.find('div[data-val="zm_reminderTime"]').find("input").eq(0);s.val(zmWatch.getCurrentTime().time);var t=n.find('div[data-val="zm_reminderMode"]'),u=t.find("select").find('option[value="1"]');u.attr("selected","selected");var v=n.find("div[data-val='zm_reminderMode']").find("select").eq(0);v.removeAttr("disabled");var w=u.get(0);w&&zmComponent.tooltip({elm:w,text:d.watch.remindmode,arrow:"top"}),zmWatch.hide(n),zmWatch.errorHide(a),zmWatch.hideWatchClear(a);var x=e.find("tr#zmWatch_editor_"+a);if(zmWatch.hide(x),"clear"===c){var y=g.filter('label[data-val="zm_watchType_3"]').find("i").eq(0);y.removeClass().addClass("msi-option");var z="<div><br/></div>";zmWatch.getEditor(a).setContent(z)}},updateWatchType:function(a){var c,e;try{var f={},g=!0,h=b[a].openWatch;"compose_tab"===h&&(g=!1);var i="";g&&zmList.isRMOBJ(a)?(f=$.extend({},zmUtil.getMailObj(a).RMOBJ),b[a].reminder=!0,i="remove_list"):"drafted"===b[a]._load_type&&b[a]._reminder_draft?(f=b[a]._draft_obj,b[a].clear_reminder=!0,i="clear_drafted"):"compose_saved"===b[a]._load_type&&(f.WT=b[a].WT,f.RMDSC=b[a].RMDSC,f.RMM=b[a].RMM,f.RMT=b[a].RMT,f.RMD=b[a].RMD,b[a].clear_reminder=!0,i="clear_saved"),c=zmWatch.getCurrentTime().date,e=zmWatch.getCurrentTime().time;var j="",k=0,l=c+" "+e,m=1,n=0;f&&(f.WT&&(m=f.WT),f.RMDSC&&(j=f.RMDSC),"undefined"!=typeof f.RMM&&(k=f.RMM),"undefined"!=typeof f.RMT&&(n=f.RMT),f.RMD&&(l=f.RMD),3===f.WT&&(n=0));var o=!0,p=!0,q=b[a]._watchDOM,r=q.find("tr#zmWatch_type_"+a),s=r.find('label[data-val^="zm_watchType_"]'),t=q.find("tr#zmWatch_option_"+a),u=q.find("tr#zmWatch_editor_"+a);r.off("click").on("click",function(b){b=b||window.event;var c=b.target||b.srcElement,d=$(c).parents().filter('label[data-val^="zm_watchType"]').eq(0),e=d.attr("data-val");if("zm_watchType_1"===e||"zm_watchType_2"===e||"zm_watchType_3"===e){var f=s.filter('label[data-val="zm_watchType_3"]').find("i").eq(0),g=s.filter('label[data-val="zm_watchType_2"]').find("i").eq(0),h=s.filter('label[data-val="zm_watchType_1"]').find("i").eq(0);f.removeClass().addClass("msi-unoption"),g.removeClass().addClass("msi-unoption"),h.removeClass().addClass("msi-unoption");var i=s.filter('label[data-val="'+e+'"]').find("i").eq(0);if(i.addClass("msi-option"),"zm_watchType_3"===e&&(zmWatch.hide(t),zmWatch.hide(u)),"zm_watchType_2"===e||"zm_watchType_1"===e){zmWatch.show(t);var j=t.find('div[data-val="zm_reminderType_1"]').find("i").eq(0);j.hasClass("msi-check")&&zmWatch.show(u)}zmWatch.showWatchClear(a)}});var v=t.find("div[data-val='zm_reminderType_1']");v.off("click").on("click",function(){var b=$(this).find("i").eq(0);b.hasClass("msi-uncheck")?(b.removeClass().addClass("msi-check"),zmWatch.show(u),setTimeout(function(){zmWatch.getEditor(a).squireInstance.focus()},100)):(zmWatch.hide(u),b.removeClass().addClass("msi-uncheck"))}),1===n&&v.find("i").eq(0).removeClass().addClass("msi-check");var w=t.find('div[data-val="zm_reminderMode"]');0===k?w.find("select").find('option[value="0"]').attr("selected","selected"):w.find("select").find('option[value="1"]').attr("selected","selected");var x=s.filter('label[data-val="zm_watchType_'+m+'"]');x.find("i").eq(0).removeClass().addClass("msi-option"),2!==m&&1!==m||(p=!1,n&&(o=!1)),p?zmWatch.hide(t):zmWatch.show(t),c=zmWatch.getCurrentTime().date,e=zmWatch.getCurrentTime().time;var y=t.find("div[data-val='zm_reminderDate']").find("input").get(0),z=t.find("div[data-val='zm_reminderTime']").find("input").get(0);zmWatch.bindTimePicker(z),l||(l=c+" "+e);var A=zmWatch.getUpdateDate(a,l);if(c=A[0],e=A[1],t.find('div[data-val="zm_reminderDate"]').find("input").eq(0).val(c),t.find('div[data-val="zm_reminderTime"]').find("input").eq(0).val(e),zmWatch.bindDatePicker(y),zmWatch.showWatchClear(a),i||zmWatch.hideWatchClear(a),"compose_tab"===b[a].openWatch?($("#zmWatch_save_"+a).text("Add"),$("#zmWatch_save_"+a).off("click").on("click",function(){zmWatch.cmpWatch(a)}),$("#zmWatch_close_"+a).text("Cancel"),b[a].clear_reminder&&($("#zmWatch_save_"+a).text(d.watch.updrem),$("#zmWatch_clear_"+a).text(d.watch.remrem)),$("#zmWatch_clear_"+a).text(d.watch.close),$("#zmWatch_close_"+a).off("click").on("click",function(){zmWatch.closeWatch(a)})):($("#zmWatch_save_"+a).off("click").on("click",function(){zmWatch.addWatch(a,$(this))}),b[a].reminder&&($("#zmWatch_save_"+a).text(d.watch.updrem),$("#zmWatch_clear_"+a).text(d.watch.remrem)),$("#zmWatch_close_"+a).off("click").on("click",function(){zmWatch.closeWatch(a),zmWatch.hideWatch(a)})),o)zmWatch.hide(u);else{zmWatch.show(u);try{var B=j+"<div><br/></div>";zmWatch.getEditor(a).setContent(B),setTimeout(function(){zmWatch.getEditor(a).squireInstance.focus()},100)}catch(C){zmUtil.debugLog(C)}}}catch(C){zmUtil.debugLog(C)}},getToolbar:function(){var a=[[["bold","Bold (Ctrl+B)","zei-bold"],["italic","Italic (Ctrl+I)","zei-italic"],["underline","Underline (Ctrl+U)","zei-underline"],["strikethrough","Strikethrough","zei-strike"]],[["fontfamily","Font","zei-fontfamily"]],[["fontsize","Font Size","zei-arrow"]],[["forecolor","Font color","zei-textclr"],["backcolor","Background Color","zei-bgclr"]],[["link","Insert Link","zei-link"]],[["quote","Insert Quote","zei-quote"],["removeformat","Remove Formatting","zei-removeformat"]],[["spellcheck","Check Spelling","zei-spellCheck"]]];return a},loadEditor:function(a){var c=b[a]._watchDOM.find("tr#zmWatch_editor_"+a);c.removeClass("SC_dyn");var d=zmWUtil.getfontFamily(zmail.mailOpt.ff);"Default"!==d&&(ZE_Init.defaultFontFamily=d),zmail.mailOpt.fs&&(ZE_Init.defaultFontSize=zmail.mailOpt.fs+"pt");var e="";ZE_Init.needEditorFocus=!1,ZE_Init.toolbarOrder=zmWatch.getToolbar();var f=ZE.create({id:"zmWatch_editor_load_"+a,avoidPlainText:!0,content:e});zmWatch.setEditor(a,f);try{var g=function(a){return function(){zmWatch.postEditorLoad(a)}};zmWatch.getEditor(a).afterEditorLoad(g(a))}catch(h){zmUtil.debugLog("Editor load ",h)}},postEditorLoad:function(a){var c=b[a]._watchDOM.find("tr#zmWatch_editor_"+a);c.find(".zmCE").height("200px");var d=c.find(".ze_SCmb").outerHeight(),e=200-(d+4);c.find(".ze_area").height(e+"px"),ZE_Init.inlineImage=zmWUtil.editorInlineImage,zmWatch.updateWatchType(a,"trigger")},getWatchDate:function(a){var b="",c=zmWatch.getWatchDateEle(a)._date_elm,d=zmWatch.getWatchDateEle(a)._time_elm;if(zmWatch.getReminderDate(a)&&c&&d){var e=$(c).val(),f=$(d).val();b=e+" "+f}return b},show:function(a){a.removeClass("SC_dyn")},hide:function(a){a.addClass("SC_dyn")},getUpdateDate:function(a,b){var c="",d="";if(b){var e=b.split(" ");c=e[0];var f=e[1];f=f.split(":"),d=f[0]+":"+f[1]}return[c,d]},deleteReminder:function(a){var b={accId:zmUtil.getZohoAccId(),mymId:a,actType:"watch",watchMode:"d"},d=zmUtil.getMailObj(a);b.watchType=d.RMOBJ.WT;var e={};e.cmpId=a,e.watchMode=b.watchMode,c(b,e,zmWatch.updateWatch)},clearReminder:function(a){zmWatch.clearWatchTheme(a),zmWatch.clearWatchElem(a,"clear"),zmWatch.hideWatchClear(a)},closeWatch:function(c){b[c]&&"list"===b[c].dialogType?b[c]._dDialog.$el.remove():b[c]&&b[c]._dDialog.remove(),zmComponent.keybindings.setScope(a),a=""},cmpWatch:function(a){try{var c,d=b[a]._watchDOM,e=d.find("tr#zmWatch_type_"+a);if(e.find("i.msi-option").length){var f=e.find("i.msi-option").closest("label").eq(0);c=f.attr("data-val").split("_")[2]}if(!c)return zmWatch.errorShow(a,"Please select any reminder type"),!1;var g=zmWatch.getRMOBJ(a);if(!g)return!1;b[a]._load_type="compose_saved",zmWatch.setRMOBJ(a,g),zmWatch.closeWatch(a),zmWatch.addWatchTheme(a)}catch(h){zmUtil.debugLog(h)}},setRMOBJ:function(a,b){zmWatch.setWatchType(a,b.WT),zmWatch.setReminderDesc(a,b.RMDSC),zmWatch.setReminderDate(a,b.RMD),zmWatch.setReminderType(a,b.RMT),zmWatch.setReminderMode(a,b.RMM),zmWatch.setCmpModified(a),zmWatch.setModified(a,!0),zmWatch.setAvoidWatch(a,!1)},getRMOBJ:function(a){try{var c={};if(b[a]._watchDOM){var d,e=b[a]._watchDOM,f=e.find("tr#zmWatch_type_"+a),g=e.find("tr#zmWatch_option_"+a);if(f.find("i.msi-option").length){var h=f.find("i.msi-option").closest("label");d=h.eq(0).attr("data-val").split("_")[2],d=parseInt(d)}var i=g.find('div[data-val="zm_reminderMode"]'),j=i.find(".reminderMode").attr("data-val");j=parseInt(j);var k=g.find('div[data-val="zm_reminderDate"]').find("input").eq(0),l=k.val(),m=g.find('div[data-val="zm_reminderTime"]').find("input").eq(0),n=m.val();if(!n&&""===$.trim(n))return zmWatch.errorShow(a,"Time field is empty! Please provide the time"),!1;if(n&&!zmWUtil.isValidateTime(n))return zmWatch.errorShow(a,"Please provide the valid time"),!1;if(n){n=$.trim(n);var o=n.split(":")[0];1===o.length&&(n="0"+n)}l=l+" "+n;var p=zmWatch.getEditor(a).getContent(),q=0,r=g.find('div[data-val="zm_reminderType_1"]').find("i").eq(0);r.hasClass("msi-check")&&(q=1),c.WT=d,c.RMM=j,c.RMD=l,c.RMDSC=p,c.RMT=q}return c}catch(s){zmUtil.debugLog(s)}},addWatch:function(a,e){var f,g=b[a]._watchDOM,h=g.find("tr#zmWatch_type_"+a);if(h.find("i.msi-option").length){var i=h.find("i.msi-option").closest("label").eq(0);f=i.attr("data-val").split("_")[2]}if(!f)return zmWatch.errorShow(a,"Please select any reminder type"+a),!1;var j={accId:zmUtil.getZohoAccId(),mymId:a,actType:"watch",watchMode:"a"};b[a]&&b[a].reminder&&(j.watchMode="u");var k=zmWatch.getRMOBJ(a);if(!k)return!1;b[a]._load_type="list_saved",zmWatch.setRMOBJ(a,k),j.watchType=zmWatch.getWatchType(a),j.reminderMode=0,j.reminderDesc=zmWatch.getReminderDesc(a);var l=j.watchType;!l||1!==l&&2!==l||(j.reminderType=zmWatch.getReminderType(a),j.reminderMode=zmWatch.getReminderMode(a),j.rDate=zmWatch.getReminderDate(a)+":00");var m={};m.cmpId=a,m.RMOBJ=zmWatch.getRMOBJ(a),m.watchMode=j.watchMode,e.attr("vtxt",e.html()),e.text(d.watch.adding),$("#zmWatch_save_"+a).off("click"),c(j,m,zmWatch.updateWatch)},resetWatch:function(a){var c=!1;b[a]&&!b[a].reminder&&(c=!0),c&&zmWatch.clearWatchTheme(a),b[a]&&(zmWatch.clearWatchElem(a),zmWatch.hideWatchClear(a),delete b[a])},setCmpModified:function(a){"undefined"!=typeof zmComp&&zmComp.getCurrentCompId()&&zmComp.setModified(a,1)},setModified:function(a,c){b[a]._modified_draft=c},getModified:function(a){var c=!1;return b[a]&&b[a]._modified_draft&&(c=!0),c},setAvoidWatch:function(a,c){b[a]._avoidWatch=c},getAvoidWatch:function(a){var c=!1;return b[a]&&b[a]._avoidWatch&&(c=!0),c},hideWatch:function(a){zmWatch.resetWatch(a)},getWatchObj:b};return e}(),window.zmWUtil=function(){var a={editorInlineImage:function(a,b){var c="/mail/ImageSignature?fileName="+b.fileName;c+="&accountId="+b.aId+"&storeName="+b.storeName,c+="c"===b.frm?"&frm=c":"&frm=s",a(c)},isValidateTime:function(a){var b=/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/;return!(""===a||""!==a&&!a.match(b))},addWatchTheme:function(a){$(zmsuite.getCenter(a)[0].getNodes()[0].$el).find("[data-event='watch']").addClass("SC_thm")},getfontFamily:function(a){var b="";switch(a){case"Arial":b="Arial,Helvetica,sans-serif";break;case"Courier":b="Courier New,Courier,monospace";break;case"Georgia":b="Georgia,Times New Roman,Times,serif";break;case"Tahoma":b="Tahoma,Arial,Helvetica,sans-serif";break;case"Times":b="Times New Roman,Times,serif";break;case"Trebuchet":b="Trebuchet ms,Arial,Helvetica,sans-serif";break;case"Verdana":b="Verdana,Arial,Helvetica,sans-serif";break;case"Comic Sans MS":b="Comic Sans MS";break;case"Serif":b="Serif";break;case"Default":b="Default";break;case"Calibri":b="Calibri,Arial,Verdana,sans-serif";break;case"MS Mincho":case"MS Gothic":case"MS PMincho":case"MS PGothic":b=a}return b}};return a}();