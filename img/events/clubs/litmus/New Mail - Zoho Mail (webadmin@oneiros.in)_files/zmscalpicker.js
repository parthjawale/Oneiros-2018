function ZCL_XHR(u,f,d,ct){if(u="/mail"+u,ZCL_LOGIN_STATE){rt=ZCL_RQ.length,ZCL_RQ[rt]=ZCL_GetHTTPTransport(),ZCL_URL[rt]=u,"function"==typeof f?(ZCL_RQ[rt].zcal_callback=f,ZCL_RQ[rt].zcal_reqindex=rt,ZCL_RQ[rt].onreadystatechange=function(){var callback=this.zcal_callback,rt=this.zcal_reqindex;if(4==this.readyState){var ret=this.getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");-1!=ret?callback(this.responseXML,ZCL_URL[rt]):callback(this,ZCL_URL[rt]),ZCL_RQ[rt]=null}}):ZCL_RQ[rt].onreadystatechange=new Function("{ 				if( ZCL_RQ["+rt+"].readyState == 4 ) { 					ZCL_XHRInclude(ZCL_RQ["+rt+"],ZCL_URL["+rt+"]);					var ret = ZCL_RQ["+rt+'].getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");					'+f+"((ret !=-1 ? ZCL_RQ["+rt+"].responseXML:ZCL_RQ["+rt+"]) ,ZCL_URL["+rt+"]);ZCL_RQ["+rt+"]=null;}}"),m="POST";var tmp1=ZCL_getCookie("aprmjrnpkcrkks");return-1!=u.indexOf("?")?(d=u.substring(u.indexOf("?")+1,u.length),u=u.substring(0,u.indexOf("?"))):d="",d+=(""!=d?"&":"")+"mstpcrdhkur="+tmp1,ZCL_RQ[rt].open(m,u,!0),"POST"==m?(ct||(ct="application/x-www-form-urlencoded;charset=UTF-8"),ZCL_RQ[rt].setRequestHeader("Content-Type",ct),ZCL_RQ[rt].send(d)):ZCL_RQ[rt].send(null),!0}return!1}function ZCL_XHRInclude(){return!0}function ZCL_XHRSync(u,d,ct){var ZCL_RQ=ZCL_GetHTTPTransport();return m=d?"POST":"GET",u+=(u.indexOf("?")+1?"&":"?")+(new Date).getTime(),ZCL_RQ.open(m,u,!1),"POST"==m?(ct||(ct="application/x-www-form-urlencoded;charset=UTF-8"),ZCL_RQ.setRequestHeader("Content-Type",ct),ZCL_RQ.send(d)):ZCL_RQ.send(null),ZCL_RQ}function ZCL_$(id){return document.getElementById(id)}function ZCL_getCalopt(key){var opt,deferred=$.Deferred();return"undefined"!=typeof zcal&&"undefined"==typeof zcal.cdata?ZCL_uXHR("/cal/set.do?type=opt",function(res){"200"==res.status?(opt=JSON.parse(res.responseText),deferred.resolve(opt.opt[key])):deferred.reject()}):(opt=zcal.cdata.opt,deferred.resolve(opt[key])),deferred}function ZCL_getFilter(){var Filters=zmail.Search.Models.Filters,FilterArray=[Filters.ZCalTitleFilter,Filters.ZCalAlldayFilter,Filters.LocationFilter,Filters.ZCalCalendarFilter,Filters.ZCalOrganizerFilter,Filters.ZCalDateFilter,Filters.ZCalFromDateFilter,Filters.ZCalToDateFilter];return FilterArray}function ZCL_getWeekStart(){var key="WK";return ZCL_getCalopt(key)}function ZCL_mailDetViewEvePopup(option){var s=option.ST;if(void 0!=s)var h=s.slice(0,2),m=s.slice(2,4),hr=h>12?h-12:h,ap=h>12?"pm":"am",ST=hr+":"+m+" "+ap;var SD=ZCL_dputDate(option.SD),eveElem={},dateEle=$('<ul id="c_event" class="zm_dateExt shw"></ul>');if(option.view&&"new"==option.view)var eveCon=$('<li><div class="zmcDatePost"><div id="zcl_scroll"><div class="SC_floatLabel zmIconLabel"><input type="text" id="de_eveTitle" class="zmQukAddTitle"  value="'+option.SUM+'"  placeholder="Enter event title" /><i class="msi-Vevnt SC_thm"></i></div><div class="SC_floatLabelRow fLCol3"><div class="SC_floatLabel zmIconLabel" id="de_eveDate"><input class="hasDD" type="text" id="eveInpDt" value="'+SD+'" required="" readonly="readonly" placeholder="Due date" style="display: inline-block;"><i class="msi-calendar SC_thm"></i></div><div class="SC_floatLabel zmIconLabel" id="de_eveTime"><input class="hasDD" id="eveInpTi" title="Time" type="text" required="" value="2:30 pm" placeholder="Time"><i class="msi-clock SC_thm"></i></div><div class="SC_floatLabel zmIconLabel" id="de_eveDur"><input class="hasDD" id="eveInpDu" title="Duration" onclick="ZCL_streamEve.setEventDurDropdwn(event,this)" value="00:30 Min" type="text" readonly="" placeholder="Duration"><i class="msi-duration SC_thm"></i></div></div><div class="SC_dyn" id="optMore1"><div class="SC_floatLabel zmIconLabel"><input class="hasDD" type="text" id="de_eveLoc" required="" placeholder="Set a location"><i class="msi-location SC_thm"></i></div><div class="SC_floatLabel zmIconLabel"><textarea id="de_eveDesc" class="" placeholder="Enter description" spellcheck="true" style="z-index: auto; position: relative; line-height: 18px; font-size: 14px; transition: none; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0);"></textarea><i class="msi-rsvp SC_thm"></i></div></div></div><div class="addInv SC_floatLabel flFLabel clearfix"  id="de_attDiv" title="Attendee"><b style="vertical-align: middle"><i class="msi-group SC_thm"></i> Invitees :</b><div class="SC_cs myInv dFill addNew" id="de_eveAtt" data-uid="52882865"><div class="SC_avtr "><span><i class="msi-plus"></i></span></div></div></div><div class="SC_frt " id="moreOpt1" style="margin-top: 15px;"><span class="SC_gray SC_dyn">Less<i class="msi-prev SC_gray"></i></span><span class="SC_gray">More<i class="msi-next SC_gray"></i></span></div><div class="SC_PUbtm"><span id="de_savEve">Create</span><span id="de_canEve" data-val="Cancel">Cancel</span></div></div></li>');else var eveCon=$('<li><div class="zmcDatePost"><div class="SC_floatLabel placeholder zm_mention noBdr" style="color: transparent; overflow: hidden;"><div class="zm_mentionbg"></div><input type="text" id="de_eveTitle" placeholder="Untitled event" value="'+option.SUM+'" class="ZT_prvTitle"><label>Event Title</label></div><div class="SC_floatLabelRow fLCol3"><div class="SC_floatLabel placeholder noBdr"  id="de_eveDate"><input class="hasDD" id="eveInpDt" title="Date" value="'+SD+'" type="text" required="" readonly="" placeholder="Pick a date"><label>When</label></div><div class="SC_floatLabel placeholder noBdr" id="de_eveTime"><input class="hasDD" id="eveInpTi" title="Time" type="text" required="" value="'+(void 0!=ST?ST:"")+'"  placeholder="Time"></div><div class="SC_floatLabel placeholder noBdr" id="de_eveDur"><input class="hasDD" id="eveInpDu" title="Duration" onclick="ZCL_streamEve.setEventDurDropdwn(event,this)" value="00:30 Min" type="text" readonly="" placeholder="Duration"></div></div><div class="SC_dyn" id="optMore1"><div class="SC_floatLabel placeholder noBdr"><input class="hasDD" type="text"  id="de_eveLoc" required=""  placeholder="Set a location"><label>Where</label></div><div class="SC_floatLabel placeholder noBdr"><textarea id="de_eveDesc" class="" placeholder="Enter description" spellcheck="true" style="z-index: auto; position: relative; line-height: 18px; font-size: 14px; transition: none; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0);"></textarea><label>Description</label></div></div><div class="addInv SC_floatLabel flFLabel clearfix" id="de_attDiv" title="Attendee"><div class="SC_cs myInv dFill addNew" id="de_eveAtt" data-uid="52882865"><div class="SC_avtr "><span><i class="msi-plus"></i></span></div></div></div><div class="SC_frt " id="moreOpt1" style="margin-top: 15px;"><span class="SC_gray SC_dyn">Less<i class="msi-prev SC_gray"></i></span><span class="SC_gray">More<i class="msi-next SC_gray"></i></span></div><div class="SC_PUbtm"><span id="de_savEve">Create</span><span id="de_canEve" data-val="Cancel">Cancel</span></div></div></li>');return dateEle.append(eveCon),$(dateEle).on("click",function(ev){if("de_eveAtt"===$(ev.target).parent()[0].id)$("#de_attDiv")[0].childNodes.length>2?($(dateEle).find("#de_attDiv")[0].className="addInv SC_floatLabel flFLabel clearfix edit_parti",$(dateEle).find("input").focus()):($(dateEle).find("#de_attDiv")[0].className="addInv SC_floatLabel flFLabel clearfix edit_parti",$(dateEle).find("#de_attDiv")[0].innerHTML='<input type="text" class="zm_sgst" id="de_att"><div class="SC_cs myInv dFill addNew" id="de_eveAtt" data-uid="52882865"><div class="SC_avtr "><span><i class="msi-plus"></i></span></div></div>',$(dateEle).find("input").focus()),bindFunction(dateEle);else if("de_attDiv"!==ev.target.id&&"de_eveAtt"!==$(ev.target).parent()[0].id&&"de_attDiv"!==$(ev.target).parent()[0].id&&"at"!==$(ev.target).parent()[0].id)if($("#de_attDiv")[0].childNodes.length>2){$(dateEle).find("#de_attDiv")[0].className="addInv SC_floatLabel flFLabel clearfix",$("#zcl_b").remove();var di=document.createElement("b");di.id="zcl_b",di.style="vertical-align: middle",di.innerHTML='<i class="msi-group SC_thm"></i> Invitees :',$(dateEle).find("#de_attDiv")[0].insertBefore(di,$(dateEle).find("#de_attDiv")[0].firstChild)}else $(dateEle).find("#de_attDiv")[0].className="addInv SC_floatLabel flFLabel clearfix",$(dateEle).find("#de_attDiv")[0].innerHTML='<b style="vertical-align: middle"><i class="msi-group SC_thm"></i> Invitees :</b><div class="SC_cs myInv dFill addNew" id="de_eveAtt" data-uid="52882865"><div class="SC_avtr "><span><i class="msi-plus"></i></span></div></div>'}),$(dateEle).find("#moreOpt1").on("click",function(){var desc=$(dateEle).find("#optMore1")[0].className;$(dateEle).find("#optMore1")[0].className=""==desc?"SC_dyn":"",$(dateEle).find("#moreOpt1")[0].childNodes[0].className="SC_gray SC_dyn"==$(dateEle).find("#moreOpt1")[0].childNodes[0].className?"SC_gray":"SC_gray SC_dyn",$(dateEle).find("#moreOpt1")[0].childNodes[1].className="SC_gray SC_dyn"==$(dateEle).find("#moreOpt1")[0].childNodes[1].className?"SC_gray":"SC_gray SC_dyn",$(dateEle).find("#zcl_scroll")[0].scrollTop=150}),deEveDatepicker($(dateEle).find("#de_eveDate")[0]),deEveTimepicker($(dateEle).find("#de_eveTime")[0]),$(dateEle).find("#de_canEve").on("click",function(){zmUtil.hideMenu()}),$(dateEle).find("#de_savEve").on("click",function(){ZCL_saveDetCreEvent()}),eveElem.$el=$(dateEle),eveElem}function bindFunction(dateEle){var elem=$(dateEle).find("#de_att");zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:elem[0],contactType:"org",exclude:function(){var email=[];if($("#de_attDiv")[0])for(var attl=$("#de_attDiv")[0].childNodes,i=0;i<attl.length;i++)"at"==attl[i].id&&email.push(attl[i].getElementsByTagName("SPAN")[0].id);return email},excludeMe:!0,onSelect:function(event,data){var data=data.item.attributes;dataObj.push(data);var div=$(dateEle).find("#de_attDiv"),nDiv=document.createElement("div");nDiv.className="SC_cs myInv dFill",nDiv.setAttribute("data-uid",data.zid),nDiv.setAttribute("id","at"),nDiv.innerHTML='<div class="SC_avtr"><img src='+data.profileImage+'></div><span id="'+data.id+'">'+data.firstName+'</span><i class="msi-close closePopup"></i></div>',div.prepend($(nDiv)),$(elem).val(""),$(nDiv).find(".closePopup").on("click",function(){$(this).parent("#at").remove()})}})})}function deEveDatepicker(dateDOM){!function($){if(dateDOM){var dateInpElem=dateDOM.getElementsByTagName("input")[0];$(dateDOM).picker("date",{dform:zcal.DATEFORMAT[zcal.cdata.opt.DF],refer:dateInpElem,wkst:0,mode:"popup",update:"yes",minhgt:251,customdate:"yes"}).bind()}}(ZEVENTS)}function deEveTimepicker(timeDOM){!function($){if(timeDOM){var params=ZCL_streamEve.curStartAndEndTime(),timeInpElem=timeDOM.getElementsByTagName("input")[0];timeInpElem.value=""!=timeInpElem.value?timeInpElem.value:params.ST,$(timeDOM).picker("time",{tform:"hh:mm a",type:1}).bind()}}(ZEVENTS)}function ZCL_saveDetCreEvent(){var title=$("#de_eveTitle")[0].value;if(""==title)return zmUtil.succErrMsg("e",zcal.i18n.plenttle),!1;var date=$("#eveInpDt")[0].value,st=$("#eveInpTi")[0].value,dur=$("#eveInpDu")[0].value,dtsArr=ZCL_streamEve.calcEventTime(date,st,dur),sdate=dtsArr.ST_MONTH+"/"+dtsArr.ST_DATE+"/"+dtsArr.ST_YEAR,edate=dtsArr.END_MONTH+"/"+dtsArr.END_DATE+"/"+dtsArr.END_YEAR,stime=dtsArr.ST_HOUR+dtsArr.ST_MIN,etime=dtsArr.END_HOUR+dtsArr.END_MIN,loc=$("#de_eveLoc")[0].value,desc=$("#de_eveDesc")[0].value,emails="";for(var i in dataObj)emails+=""==emails?dataObj[i].email:","+dataObj[i].email;var defcalId=zcal.cdata.defcal,cObj=zcal.getCalObj(defcalId),eventObj={EID:"",EUID:"",EPERM:cObj[12]>=2?2:1==cObj[12]?1:0,DPERM:cObj[12]>=2?2:0,SD:sdate,ST:stime,ED:edate,ET:etime,ADAY:0,LOC:loc,DESC:desc,ETZ:"",IN_ETZ:!1,CLASS:0,IMP:0,CNAME:defcalId,TRANS:1,ETSK:0,ECRM:0,ENTS:0,EMET:0,LINK:"",SUM:title,EC:-1,ATT:emails,ADD_MODE:"PP"};ZCL_detailObj(eventObj),zmUtil.hideMenu()}ZEVENTS=function(t){return new ZCALPicker(t)},ZEVENTS.count=0,ZEVENTS.obj={},ZEVENTS.template=function(ty){switch(ty){case"type1":return{_HTML:'<li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><i class="#py#" rel="PY"></i></li><li class="zcal_arr"><i class="#pm#" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="#nm#" rel="NM"></i></li><li class="zcal_arr"><i class="#ny#" rel="NY"></i></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li><li class="zcal_tmz"><span>#tz#</span></li></ul></li>',_cont:{tag:"UL",_class:"zcal_mCal"},_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b"}};case"type2":return{_HTML:'<ul class="zcal_mCal #shadow# #hover#"><li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><svg rel="PY"><polygon points="10.8,4.7 7.8,7.7 10.8,10.7 10.8,12 7.2,8.3 6.5,7.7 7.2,7 10.8,3.4"></polygon><polygon points="4.8,7.7 8.7,11.5 8.6,13.1 3.2,7.7 4,6.9 8.6,2.3 8.7,3.9"></polygon></svg></li><li class="zcal_arr"><svg  rel="PM"><polygon points="10.7,2.3 10.7,4 6.9,7.8 10.7,11.6 10.7,13.2 5.2,7.8"></polygon></svg></li><li><span >#HEADM#</span><span>#HEADY#</span></li><li class="zcal_arr"><svg rel="NM" ><polygon points="5.2,13.2 5.2,11.5 9,7.7 5.2,3.9 5.2,2.3 10.7,7.7"></polygon></svg></li><li class="zcal_arr"><svg rel="NY" ><polygon points="4.7,10.7 7.7,7.7 4.7,4.7 4.7,3.4 8.3,7 9,7.7 8.3,8.3 4.7,12"></polygon><polygon points="10.7,7.7 6.8,3.9 6.9,2.3 12.3,7.7 11.5,8.5 6.9,13.1 6.8,11.5"></polygon></svg></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></li></ul>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};case"type3":return{_HTML:'<li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr" ><i class="#py#" rel="PY"></i></li><li class="zcal_arr" ><i class="#pm#" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="#nm#" rel="NM"></i></li><li class="zcal_arr" ><i class="#ny#" rel="NY"></i></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li rel="DT" class="zcal_table">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li></ul></li>',_class:{sel:"em",dis:"u",nor:"b"},_cont:{tag:"UL",_class:"zcal_mCal"},_bsecont:{tag:"DIV",_class:"zcal_mpcal"},_patch:{tag:"DIV",_cont:"<b></b>"}};case"type4":return{_HTML:'<li class="zcl_mCaltt zcl_table"><ul><li><span>#HEADM#</span><span>#HEADY#</span></li><li class="zcl_W20"><i class="#pm#" rel="PM"></i><i class="#nm#" rel="NM"></i></li></ul></li><li class="zcl_mCaldy zcl_table"><ul>#wk<li#hgt#>#item#</li>wk#</ul></li><li class="zcl_table zcl_mCaldt" rel="DT">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li></ul></li>',_cont:{tag:"UL",_class:"zcl_mCal"},_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b"},_cust:{dysel:"zcl_sl",pm:"zcli-larrow",nm:"zcli-rarrow"}};case"type5":return{_HTML:'<div class="zcal_mCal #shadow# #hover# zcl_mCalwti"><div class="zcal_table"><ul><li class="zcal_mCalti"><div class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><i class="zci-fst" rel="PY"></i></li><li class="zcal_arr"><i class="zci-pre" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="zci-nxt" rel="NM"></i></li><li class="zcal_arr"><i class="zci-lst" rel="NY"></i></li></ul></div><div class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></div></li><li class="zcal_mTil"><i class="zci-tiupar" rel="UT"></i><div ><ul id="zcl_t" style="overflow-y:auto;height:205px">#tr<li#ti# rel="TP">#item#</li>tr#</ul></div><i class="zci-tidnar" rel="TD"></i></li></ul></div><div class="zcal_mCalbtm"><div class="SC_PUbtm"><span rel="OK">Ok</span></div></div></div>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};case"type6":return{_HTML:'<div class="zcal_mCal #shadow# #hover#"><div class="zcal_table"><ul><li><div class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><svg rel="PY"><polygon points="10.8,4.7 7.8,7.7 10.8,10.7 10.8,12 7.2,8.3 6.5,7.7 7.2,7 10.8,3.4"></polygon><polygon points="4.8,7.7 8.7,11.5 8.6,13.1 3.2,7.7 4,6.9 8.6,2.3 8.7,3.9"></polygon></svg></li><li class="zcal_arr"><svg  rel="PM"><polygon points="10.7,2.3 10.7,4 6.9,7.8 10.7,11.6 10.7,13.2 5.2,7.8"></polygon></svg></li><li><span>#HEADM#</span><span>#HEADY#</span></li><li class="zcal_arr"><svg rel="NM" ><polygon points="5.2,13.2 5.2,11.5 9,7.7 5.2,3.9 5.2,2.3 10.7,7.7"></polygon></svg></li><li class="zcal_arr"><svg rel="NY" ><polygon points="4.7,10.7 7.7,7.7 4.7,4.7 4.7,3.4 8.3,7 9,7.7 8.3,8.3 4.7,12"></polygon><polygon points="10.7,7.7 6.8,3.9 6.9,2.3 12.3,7.7 11.5,8.5 6.9,13.1 6.8,11.5"></polygon></svg></li></ul></div><div class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></div></li></ul></div><div class="zcal_mCalbtm zcal_mC_sz_cn zcal_table"><ul><li class="zcal_txl" rel="TL"><span class="zcal_mC_sz_ti">#br<input type="text" id="zcal_hr" rel="HI" value="#cuHr#" data-item="">:<input type="text" id="zcal_min" rel="MI" value="#cuMin#">:<input type="text" readonly id="zcal_ap" rel="AP" value="#apm#">br#</span></li><li><div class="SC_PUbtm"><span rel="OK">Ok</span></div></li></ul></div></div>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};case"type7":return{_HTML:'<div class="zcal_mCal #shadow# #hover# #timediv#"><div class="zcal_table"><ul><li class="#timediv#"><div class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><svg rel="PY" class="#py#"><polygon points="10.8,4.7 7.8,7.7 10.8,10.7 10.8,12 7.2,8.3 6.5,7.7 7.2,7 10.8,3.4"></polygon><polygon points="4.8,7.7 8.7,11.5 8.6,13.1 3.2,7.7 4,6.9 8.6,2.3 8.7,3.9"></polygon></svg></li><li class="zcal_arr"><svg class="#pm#" rel="PM"><polygon points="10.7,2.3 10.7,4 6.9,7.8 10.7,11.6 10.7,13.2 5.2,7.8"></polygon></svg></li><li><span rel="month_idx">#HEADM#</span><span rel="year_idx">#HEADY#</span></li><li class="zcal_arr"><svg class="#nm#" rel="NM" ><polygon points="5.2,13.2 5.2,11.5 9,7.7 5.2,3.9 5.2,2.3 10.7,7.7"></polygon></svg></li><li class="zcal_arr"><svg class="#ny#" rel="NY" ><polygon points="4.7,10.7 7.7,7.7 4.7,4.7 4.7,3.4 8.3,7 9,7.7 8.3,8.3 4.7,12"></polygon><polygon points="10.7,7.7 6.8,3.9 6.9,2.3 12.3,7.7 11.5,8.5 6.9,13.1 6.8,11.5"></polygon></svg></li></ul></div><div class="#viewclass#" id="mcvw"><div class="zcal_mCal_yr zcal_table">#ycr<ul>#yt<li rel="year_sel" class="#selclass#">#item#</li>yt#</ul>ycr#</div><div class="zcal_mCal_mth zcal_table">#mcr<ul>#mt<li rel="month_sel" class="#selclass#">#item#</li>mt#</ul>mcr#</div><div class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></div></div></li>#timerow<li class="zcal_mTil"><i class="zci-tiupar" rel="UT"></i><div ><ul id="zcl_t" style="overflow-y:auto;height:205px">#tr<li#ti# rel="TP">#item#</li>tr#</ul></div><i class="zci-tidnar" rel="TD"></i></li>timerow#</ul></div>#okrow<div class="zcal_mCalbtm"><div class="SC_PUbtm"><span rel="OK">Ok</span></div></div>okrow#</div>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};default:return}},ZEVENTS.selector=function(p){var _ele={},_p=p.trim().split(" ");if(_ele.target=(_p[0]||_p).substring(1),2==_p.length){_p[1]=_p[1].trim();var _index0=_p[1].indexOf("[");if(-1!=_index0){var _index1=_p[1].indexOf("]"),_index3=(_p[1].indexOf("."),_p[1].indexOf("="));_ele.ele=_p[1].substring(0,_index0),_ele.atr=_p[1].substring(_index0+1,_index1),_ele.atr_val=_p[1].substring(_index3+1)}else _ele.atr="#"===_p[1][0]?"id":"."==_p[1][0]?"class":"",""!=_ele.atr?(_ele.atr_val=_p[1].substring(_p[1].search(/(#|\.)/g)+1),_ele.ele=""):(_ele.ele=_p[1],_ele.atr_val="")}else _ele.ele="",_ele.atr="",_ele.atr_val="";return _ele},ZEVENTS.removeall=function(o){if(o=o?o:"picker","string"==typeof o&&"picker"==o&&ZEVENTS.obj.picker){var obj=ZEVENTS.obj.picker;for(var i in obj)ZEVENTS.remove(obj[i],o)}},ZEVENTS.remove=function(o,ty){if("object"==typeof o&&o._name){var cont=o._cont;o.clearobj(),o.clearvar(),o=null,ty=ty||"picker",delete ZEVENTS.obj[ty][cont]}},ZEVENTS.clear=function(o){"object"==typeof o&&o._name&&(o.clearobj(),ZEVENTS.obj.state=null)},ZCALPicker=function(t){return this.tar=t,this},ZCALPicker.prototype.picker=function(m,o){var tmpO,tmp=ZEVENTS.obj.picker||(ZEVENTS.obj.picker={});return o.target=this.tar,"date"==m?tmpO=new ZCALdatepickr(o):"range"==m?tmpO=new ZCALrangepickr(o):"time"==m&&(tmpO=new ZCALtimepickr(o)),tmpO?tmp[tmpO._cont]=tmpO:"",tmpO};var ZCALtimepickr=function(o){return o?(this._name="timepicker",this._type=o.type&&/^[123]$/.test(o.type)?o.type:1,this._tar="object"==typeof o.target?o.target:document.getElementById(o.target),this._tform=o.tform,o.refer?this._refer="object"==typeof o.refer?o.refer:document.getElementById(o.refer):this._tar&&(this._refer="input"==this._tar.tagName.toLowerCase()?this._tar:this._tar.getElementsByTagName("input")[0]),this.os=0,this.n="",this.tmpO="no",this._cont=(new Date).getTime()+"_"+ZEVENTS.count++,this._prevalue="",this._menu=!1,this._sel=-1,this._errfn=[],this._chgefn=[],this):null};ZCALtimepickr.prototype.on=function(mode,fn){return"change"==mode&&"function"==typeof fn?this._chgefn.push(fn):"error"==mode&&"function"==typeof fn&&this._errfn.push(fn),this},ZCALtimepickr.prototype.bind=function(){var self=this,removeElem=function(){if(self._inEl){ZCALremoveListener(self._inEl,"input",inpAction),ZCALremoveListener(self._inEl,"keydown",kdAction),ZCALremoveListener(self._inEl,"blur",blrAction),ZCALremoveListener(self._inEl,"keypress",kpAction);{self._inEl.parentNode.removeChild(self._inEl)}e1=null}if(self._ulEl){ZCALremoveListener(self._ulEl,"mousedown",timclick);{self._ulEl.parentNode.removeChild(self._ulEl)}e1=null}self._menu=!1,self._sel=-1,self._prevalue="",self._ulEl=self._inEl=null};self.clearobj=function(){ZEVENTS.obj.state=null;var ele=document.getElementById(self._cont);ele&&(ZCALremoveListener(ele,"mousedown",ulEvent),ZCALremoveListener(document,"scroll",docevehandle),ZCALremoveListener(document,"mousedown",docevehandle),ZCALremoveListener(document,"mousewheel",docevehandle),ZCALremoveListener(self._tar,"keydown",keydwnfn),ele=ele.parentNode.removeChild(ele),ele=null,self._sel=-1),self._inEl&&(self._refer.value=""!=self._refer.placeholder?self._refer.placeholder:self._inEl.value,self._refer.placeholder=self._tform,removeElem())},self.clearvar=function(){1==self._type?(ZCALremoveListener(self._tar,"focus",showTime),ZCALremoveListener(self._tar,"click",showTime),ZCALremoveListener(self._tar,"keydown",keydwnfn)):3==self._type?(ZCALremoveListener(self._refer,"keydown",trackKey),ZCALremoveListener(self._refer,"keyup",trackKey),ZCALremoveListener(self._refer,"mouseup",trackKey)):2==self._type&&ZCALremoveListener(self._refer,"focus",focusEle)};var ulEvent=function(e){var _el=e.target||event.srcElement;"li"==_el.tagName.toLowerCase()&&(self._refer.value=_el.innerHTML,checkError(),self.clearobj()),ZCALprevDef(e)},checkError=function(){var err=self._errfn,chge=self._chgefn,o="hh:mm a"==self._tform?self.get12hrTime(self._refer.value):self.get24hrTime(self._refer.value);if(o)for(var fn in chge)chge[fn].call(self._refer);else for(var fn in err)err[fn].call(self._refer)},showTime=function(e){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=self;var inEl=(e.target||e.srcElement,"input"==this.tagName.toLowerCase()?this:this.getElementsByTagName("input")[0]),val=inEl.value,tf=self._tform||inEl.getAttribute("tform"),tme=val.changeTimetoNumber(tf);self._sel=tme;var _ul=document.body.appendChild(document.createElement("ul"));_ul.style.width=(this.clientWidth<110?110:this.clientWidth)+"px",_ul.style.left=this.positionX()+"px",_ul.id=self._cont,ZCALaddListener(_ul,"mousedown",ulEvent);var _rge=(document.documentElement.clientHeight||window.innerHeight)+Math.max(document.body.scrollTop,document.documentElement.scrollTop);_ul.className="zcal_tilst "+(this.positionY()+250>_rge?"zcal_tilsbt":"zcal_tilstp");for(var txt="",j=0;48>j;j++)txt+='<li rel="'+j+'"'+(j==tme?'class="zcal_sl"':"")+">"+(j+"").changeNumbertoTime(tf)+"</li>";_ul.innerHTML=txt,_ul.scrollTop=24*tme,_ul.style.top=this.positionY()+250<_rge?this.positionY()+this.offsetHeight+"px":this.positionY()-_ul.offsetHeight+"px",ZCALprevDef(e),ZCALaddListener(document,"scroll",docevehandle=function(){self.clearobj()}),ZCALaddListener(document,"mousedown",docevehandle=function(){self.clearobj()}),ZCALaddListener(self._tar,"keydown",keydwnfn),ZCALaddListener(self._refer,"blur",docevehandle=function(){self.clearobj()})},keydwnfn=function(eve){var k=eve.which||eve.keyCode||eve.charCode,liobj=document.getElementById(self._cont).getElementsByTagName("li");38==k&&0!=self._sel?(liobj[self._sel--].className="",liobj[self._sel].className="zcal_sl",document.getElementById(self._cont).scrollTop=24*self._sel,checkError()):40==k&&self._sel!=liobj.length-1?(liobj[self._sel++].className="",liobj[self._sel].className="zcal_sl",document.getElementById(self._cont).scrollTop=24*self._sel,checkError()):13==k&&(this.value=liobj[self._sel].innerHTML,self.clearobj())},trackKey=function(eve){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=self;var o=this;eve=eve||event;var k=eve.which||eve.keyCode||eve.charCode,t="HH:mm"==(self._tform||o.getAttribute("tform"))?!0:!1;if("mouseup"==eve.type.toLowerCase()){var s=ZCALselstart(o);return self.os=2>=s?ZCALcrtesel(o,0,2):s>=3&&5>=s?ZCALcrtesel(o,3,5):s>=6&&8>=s?ZCALcrtesel(o,6,8):0,!0}if("keyup"!=eve.type.toLowerCase()||9==k){switch(!0){case 37==k:self.os=0!=self.os||t?0==self.os&&t?ZCALcrtesel(o,3,5):3==self.os?ZCALcrtesel(o,0,2):6==self.os?ZCALcrtesel(o,3,5):0:ZCALcrtesel(o,6,8);break;case 38==k:self.shiftnos(o,self.os,-1),checkError();break;case 39==k:self.os=0==self.os?ZCALcrtesel(o,3,5):3!=self.os||t?3==self.os&&t?ZCALcrtesel(o,0,2):6==self.os?ZCALcrtesel(o,0,2):0:ZCALcrtesel(o,6,8);break;case 40==k:self.shiftnos(o,self.os,1),checkError();break;case k>=48&&57>=k:self.typenos(o,k,self.os),checkError();break;case 65==k||80==k:self.typenos(o,k,self.os),checkError();break;case 9==k:if("keydown"==eve.type.toLowerCase()){if(ZCALselend(o)==o.value.length)return;self.tmpO="yes",self.os=ZCALselend(o)-ZCALselstart(o)!=2?ZCALcrtesel(o,0,2):0==self.os?ZCALcrtesel(o,3,5):3!=self.os||t?3==self.os&&t?ZCALcrtesel(o,0,2):6==self.os?ZCALcrtesel(o,0,2):0:ZCALcrtesel(o,6,8)}else"keyup"==eve.type.toLowerCase()&&"no"==self.tmpO?self.os=ZCALselend(o)-ZCALselstart(o)!=2?ZCALcrtesel(o,0,2):0==self.os?ZCALcrtesel(o,3,5):3!=self.os||t?3==self.os&&t?ZCALcrtesel(o,0,2):6==self.os?ZCALcrtesel(o,0,2):0:ZCALcrtesel(o,6,8):"keyup"==eve.type.toLowerCase()&&"yes"==self.tmpO&&(self.tmpO="no",ZCALprevDef(eve))}ZCALprevDef(eve)}},inpAction=function(){if(self._prevalue!=this.value){this.value=this.value.replace("'","").replace("&","").replace("%","").replace(".",""),self._prevalue=this.value;var o="hh:mm a"==self._tform?self.timeObj12hr(this.value):self.timeObj24hr(this.value);if(o){if(""==o[0]){var liobj=self._ulEl.getElementsByTagName("li");liobj[self._sel].className="",liobj[o[1]].className="zcal_sl"}else{self._ulEl.innerHTML=o[0];var _len=self._ulEl.getElementsByTagName("li").length;self._ulEl.style.height=24*(2>=_len?_len:4)+"px"}self._sel=o[1],self._ulEl.style.display="",self._ulEl.scrollTop=24*o[1],self._prevalue=this.value="hh:mm a"==self._tform?this.value.toUpperCase().replace(/^0/,""):this.value,self._refer.placeholder=o[2],self._refer.value=""}else self._ulEl.style.display="none",self._refer.placeholder="",self._refer.value=""}},kdAction=function(eve){var k=eve.which||eve.keyCode||eve.charCode,liobj=self._ulEl.getElementsByTagName("li");if(38==k)self._sel>0&&(liobj[self._sel--].className="",liobj[self._sel].className="zcal_sl",this.value=liobj[self._sel].innerHTML,self._refer.placeholder=liobj[self._sel].innerHTML,self._ulEl.scrollTop=24*self._sel);else{if(39==k)return""!=self._refer.placeholder&&(this.value=self._refer.placeholder.substring(0,this.value.length+1)),inpAction.call(this,eve);40==k?liobj.length-1>self._sel&&(liobj[self._sel++].className="",liobj[self._sel].className="zcal_sl",this.value=liobj[self._sel].innerHTML,self._refer.placeholder=liobj[self._sel].innerHTML,self._ulEl.scrollTop=24*self._sel):13==k&&(self._refer.value=""!=self._refer.placeholder?self._refer.placeholder:this.value,self._refer.placeholder=self._tform,checkError(),removeElem())}},kpAction=function(eve){var k=eve.which||eve.keyCode||eve.charCode;if(!/^(8|4[0689]|5[0-8]|3[7-9])$/.test(k)&&"HH:mm"==self._tform)return eve.preventDefault(),eve.stopPropagation(),!1;var startPos=this.selectionStart,endPos=this.selectionEnd;if(startPos==endPos&&endPos==this.value.length&&!/^(37|8|46)$/.test(k)){var ky=String.fromCharCode(k),obj="hh:mm a"==self._tform?self.get12hrTime(this.value+ky):self.get24hrTime(this.value+ky);obj||(eve.preventDefault(),eve.stopPropagation())}},blrAction=function(){self._refer.value=""!=self._refer.placeholder?self._refer.placeholder:this.value,self._refer.placeholder=self._tform,checkError(),removeElem()},timclick=function(eve){var elem=eve.target||eve.srcElement;"li"==elem.tagName.toLowerCase()&&(self._refer.value=elem.innerHTML,self._refer.placeHolder="",removeElem(),checkError())},focusEle=function(){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=self;var parEl=this.parentNode;self._inEl=parEl.getElementsByTagName("input")[1],self._ulEl=parEl.getElementsByTagName("ul")[0],self._inEl||(self._inEl=parEl.appendChild(document.createElement("input")),self._inEl.type="text",self._inEl.className="zcal_tiabs",ZCALaddListener(self._inEl,"input",inpAction),ZCALaddListener(self._inEl,"keydown",kdAction),ZCALaddListener(self._inEl,"blur",blrAction),ZCALaddListener(self._inEl,"keypress",kpAction)),self._ulEl||(self._ulEl=parEl.appendChild(document.createElement("ul")),ZCALaddListener(self._ulEl,"mousedown",timclick));var o="hh:mm a"==self._tform?self.timeObj12hr(this.value):self.timeObj24hr(this.value);if(o){self._ulEl.innerHTML=o[0],self._ulEl.style.display="";var _len=self._ulEl.getElementsByTagName("li").length;self._ulEl.style.height=24*(2>=_len?_len:4)+"px",self._ulEl.scrollTop=24*o[1],self._inEl.value="hh:mm a"==self._tform?this.value.toUpperCase().replace(/^0/,""):this.value,this.placeholder=o[2],this.value="",self._sel=o[1],self._prevalue=this.value}else self._inEl.value=this.value,this.value="",this.placeholder="",self._ulEl.style.display="none";self._inEl.focus()};return 1==self._type?(ZCALaddListener(self._tar,"focus",showTime),ZCALaddListener(self._tar,"click",showTime)):2==self._type?ZCALaddListener(self._refer,"focus",focusEle):3==self._type&&(ZCALaddListener(self._refer,"keydown",trackKey),ZCALaddListener(self._refer,"keyup",trackKey),ZCALaddListener(self._refer,"mouseup",trackKey)),this},ZCALtimepickr.prototype.typenos=function(o,k,s){if(6==s&&/(A|P)/gi.test(String.fromCharCode(k))){var x=String.fromCharCode(k);return _ch="A"==x?" "+ZCALtform[0]:" "+ZCALtform[1],o.value=o.value.substring(0,5)+_ch,ZCALcrtesel(o,s,s+2),!0}var _k=String.fromCharCode(k),t="HH:mm"==(this._tform||o.getAttribute("tform"))?!0:!1;""==this.n?(this.n=_k,_k="0"+_k):(_k=this.n+""+_k,this.n=""),0==s&&(!t&&parseInt(_k,10)<=12||t&&parseInt(_k,10)<=23)?o.value=_k+o.value.substring(2):3==s&&parseInt(_k,10)<=59&&(o.value=o.value.substring(0,3)+_k+o.value.substring(5));var self=this;setTimeout(function(){self.n=""},1e4),ZCALcrtesel(o,s,s+2)},ZCALtimepickr.prototype.shiftnos=function(o,s,inc){var _val=o.value.substring(s,s+2);if(0==s){var t="HH:mm"==(this._tform||o.getAttribute("tform"))?!0:!1,_int=parseInt(_val,10);t&&0==_int&&-1==inc?_int=23:t||1!=_int||-1!=inc?t&&23==_int&&1==inc?_int=0:t||12!=_int||1!=inc?_int+=inc:_int=1:_int=12,o.value=(9>=_int?"0":"")+_int+o.value.substring(2,8)}else if(3==s){var _int=parseInt(_val,10);0==_int&&-1==inc?_int=59:59==_int&&1==inc?_int=1:_int+=inc,o.value=o.value.substring(0,3)+(9>=_int?"0":"")+_int+o.value.substring(5,8)}else 6==s&&(o.value=_val==ZCALtform[0]?o.value.substring(0,5)+" "+ZCALtform[1]:o.value.substring(0,5)+" "+ZCALtform[0]);return ZCALcrtesel(o,s,s+2),"true"},ZCALtimepickr.prototype.timeObj12hr=function(s){var obj=this.get12hrTime(s),txt="";if(obj&&obj.arr){for(var i=0;i<obj.arr.length;i++)txt+="<li"+(i==obj.sel?" class='zcal_sl'":"")+">"+obj.arr[i]+"</li>";return this._menu=!1,[txt,obj.sel,obj.arr[obj.sel]]}if(obj&&obj.sel>-1){var sel="";if(this._menu)sel=0==obj.sel?"12:00 AM":obj.sel+":00 AM";else for(var i=0;24>i;i++){var val=0==i?"12:00 AM":12==i?"12:00 PM":i>12?i-12+":00 PM":i+":00 AM";i==obj.sel&&(sel=val),txt+="<li"+(i==obj.sel?" class='zcal_sl'":"")+">"+val+"</li>",txt+="<li>"+val.replace("00","30")+"</li>"}return this._menu=!0,[txt,2*obj.sel,sel]}return!1},ZCALtimepickr.prototype.get12hrTime=function(val){var mobj,r1=["^([0-9])$","^(0?[1-9]|1[012])$","^(0?[1-9]|1[012])(:)$","^(0?[1-9]|1[012])(:)([0-5])$","^(0?[1-9]|1[012])(:)([0-5][0-9])$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)([APap])$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)([APap][mM])$"],len=val.length;if(len>1&&":"==val[1]&&len++,!(len>0&&8>=len&&(mobj=val.match(new RegExp(r1[len-1])))))return 0==len?!1:!1;if(mobj=Array.prototype.slice.call(mobj,1),4>len){var s=parseInt(mobj[0],10);return{sel:s>11?0:0==s?12:s}}if(4==len)return val=0==val[0]?val.slice(1):val,{arr:[val+"0 AM",val+"5 PM",val+"0 AM",val+"5 PM"],sel:0};if(len>4){var s=val.substring(0,5).trim();s=0==s[0]?s.slice(1):s;var s1=mobj[4]?/a/i.test(mobj[4][0])?0:1:0;return{arr:[s+" AM",s+" PM"],sel:s1}}},ZCALtimepickr.prototype.timeObj24hr=function(val){var obj=this.get24hrTime(val),txt=tmp="";if(obj&&obj.arr){for(var i=0;i<obj.arr.length;i++)txt+="<li "+(i==obj.sel?"class='zcal_sl'":"")+">"+obj.arr[i]+"</li>";return this._menu=!1,[txt,obj.sel,obj.arr[obj.sel]]}if(obj&&obj.sel>-1){if(!this._menu)for(var i=0;24>i;i++)tmp=10>i?"0"+i:i,txt+="<li "+(i==obj.sel?"class='zcal_sl'":"")+" >"+tmp+":00</li>",txt+="<li>"+tmp+":30</li>";return this._menu=!0,[txt,2*obj.sel,(obj.sel<10?"0"+obj.sel:obj.sel)+":00"]}},ZCALtimepickr.prototype.get24hrTime=function(val){var mobj,r1=["^([0-2])$","^([0-1][0-9]|2[0-3])$","^([0-1][0-9]|2[0-3])(:)$","^([0-1][0-9]|2[0-3])(:)([0-5])$","^([0-1][0-9]|2[0-3])(:)([0-5][0-9])$"],len=val.length;if(!(len>0&&6>len&&(mobj=val.match(new RegExp(r1[len-1])))))return 0==len?!1:!1;if(mobj=Array.prototype.slice.call(mobj,1),2==len){var s=parseInt(mobj[0],10);return{sel:s}}if(4>len){var s=parseInt(mobj[0],10);return{sel:1==mobj[0].length&&2>=s?10*s:s}}return 4==len?{arr:[val+"0",val+"5"],sel:0}:5==len?{arr:[val],sel:0}:void 0};var ZCALrangepickr=function(o){if(o){this._name="rangepicker",o.range=o.range||["",""],o.range[0]=""!=o.range[0].trim()?new Date(o.range[0].parseDate(o.dform)):new Date(1947,8,15),o.range[1]=""!=o.range[1].trim()?new Date(o.range[1].parseDate(o.dform)):new Date(2147,8,15),o.range[1]=o.range[0].diffTo("month",o.range[1])>=0?o.range[1]:new Date(2147,8,15);var cur=new Date,diff1=o.range[0].diffTo("month",new Date),diff2=cur.diffTo("month",o.range[1]),d1=diff1>=0&&diff2>0?new Date((new Date).setDate(1)):0>=diff1?o.range[0]:0>=diff2?new Date(o.range[1].getFullYear(),o.range[1].getMonth()-1,1):"",d2=new Date(d1.getFullYear(),d1.getMonth()+1);return this._r1=new ZCALdatepickr({dform:o.dform||"MM/DD/YYYY",curdate:d1,wkst:o.wkst||0,template:"type3",_cont:(new Date).getTime()+"_"+ZEVENTS.count++,range:o.range}),this._r2=new ZCALdatepickr({dform:o.dform||"MM/DD/YYYY",curdate:d2,wkst:o.wkst||0,template:"type3",_cont:(new Date).getTime()+"_"+ZEVENTS.count++,range:o.range}),this._clkdates=[],this._selfn=[],this._tar="object"==typeof o.target?o.target:document.getElementById(o.target),this._bsecont=ZEVENTS.template("type3")._bsecont,this._patch=ZEVENTS.template("type3")._patch,this._cont=(new Date).getTime()+"_"+ZEVENTS.count++,this}};ZCALrangepickr.prototype.on=function(mode,fn){return"select"==mode&&"function"==typeof fn&&this._selfn.push(fn),this},ZCALrangepickr.prototype.bind=function(){var self=this,_el=document.createElement(self._bsecont.tag);_el.id=self._cont,_el.className=self._bsecont._class,self._tar.appendChild(_el);var mdiff=self._r1._curDate.diffTo("month",self._r2._curDate);self.clearobj=function(){ZCALremoveListener(document.getElementById(self._r1._cont),"mousedown",eventhandle),ZCALremoveListener(document.getElementById(self._r2._cont),"mousedown",eventhandle),ZCALremoveListener(_el,"selectstart",ZCALprevDef),ZCALremoveListener(_el,"dragstart",ZCALprevDef);var _tmp=_el.parentNode.removeChild(_el);_tmp=null},self.clearvar=function(){self=_el=mdiff=null};var clearEl=function(_ele){for(;_ele.firstChild;)_ele.removeChild(_ele.firstChild);return _ele},eventhandle=function(e){var ele=e.target||event.srcElement,rel=ele.getAttribute("rel"),prel=ele.parentNode.getAttribute("rel"),cur="r1"==this.rel?self._r1:self._r2,dobj=new Date(cur._curDate),_sel=!1;if("u"==ele.tagName.toLowerCase()||-1!=ele.className.indexOf("zcal_dis"))return ZCALprevDef(e),!1;if("PM"==rel||"PM"==prel)dobj=ZCALchangeMonth(dobj,-1),cur._curDate=dobj;else if("NM"==rel||"NM"==prel)dobj=ZCALchangeMonth(dobj,1),cur._curDate=dobj;else if("PY"==rel||"PY"==prel)dobj.setYear(dobj.getFullYear()-1),cur._curDate=dobj;else if("NY"==rel||"NY"==prel)dobj.setYear(dobj.getFullYear()+1),cur._curDate=dobj;else if("DT"==ele.parentNode.parentNode.getAttribute("rel")){if(ele.className&&ele.className==ZEVENTS.template(cur._template)._class.dis)return;dobj.setDate(parseInt(ele.innerHTML,10));var _len=self._clkdates.length;if(0==_len||_len>=2)self._clkdates=new Array(dobj);else if(1==_len&&self._clkdates[0].getTime()!=dobj.getTime()){var pos=dobj<self._clkdates[0]?0:1;self._clkdates.splice(pos,0,dobj),_sel=!0}}var _len=self._clkdates.length;if(self._r1._select=self._r2._select=[],2==_len){var c1=self._clkdates[0].diffTo("month",self._r1._curDate),c2=self._r1._curDate.diffTo("month",self._clkdates[1]),c3=self._clkdates[0].diffTo("month",self._r2._curDate),c4=self._r2._curDate.diffTo("month",self._clkdates[1]);c1>=0&&c2>=0&&(self._r1._select={start:c1>0?1:self._clkdates[0].getDate(),end:c2>0?new Date(self._r1._curDate.getFullYear(),self._r1._curDate.getMonth()+1,0).getDate():self._clkdates[1].getDate()}),c3>=0&&c4>=0&&(self._r2._select={start:c3>0?1:self._clkdates[0].getDate(),end:c4>0?new Date(self._r2._curDate.getFullYear(),self._r2._curDate.getMonth()+1,0).getDate():self._clkdates[1].getDate()})}else 1==_len&&0==self._clkdates[0].diffTo("month",dobj)&&(cur._select=[dobj.getDate()]);var mndiff=self._r1._curDate.diffTo("month",self._r2._curDate);if(self.resetDRange("r1"==this.rel?"r1":"r2"),clearEl(getContainer.call(self._r1)).innerHTML=self._r1.calendar(),clearEl(getPatch.call(self)).innerHTML=mndiff>1?self._patch._cont:"",clearEl(getContainer.call(self._r2)).innerHTML=self._r2.calendar(),_sel)for(var fn in self._selfn)self._selfn[fn].call({getDateRange:{from:self._clkdates[0],to:self._clkdates[1]}})};0>=mdiff&&(self._r2._curDate=new Date(new Date(self._r1._curDate.getTime()).setMonth(self._r1._curDate.getMonth()+1)));var getContainer=function(r){var _ele=document.getElementById(this._cont);if(!_ele){var _cont=ZEVENTS.template(this._template)._cont;_ele=document.createElement(_cont.tag),_ele.className=_cont._class,_ele.rel=r,_ele.id=this._cont,document.getElementById(self._cont).appendChild(_ele),ZCALaddListener(_ele,"mousedown",eventhandle)}return _ele},getPatch=function(){var _ele=document.getElementById(this._cont+"_patch");if(!_ele){var _ele=document.createElement(this._patch.tag);_ele.id=this._cont+"_patch",document.getElementById(this._cont).appendChild(_ele)}return _ele};return self.resetDRange(),getContainer.call(self._r1,"r1").innerHTML=self._r1.calendar(),getPatch.call(self).innerHTML=mdiff>1?self._patch._cont:"",getContainer.call(self._r2,"r2").innerHTML=self._r2.calendar(),ZCALaddListener(_el,"selectstart",ZCALprevDef),ZCALaddListener(_el,"dragstart",ZCALprevDef),this},ZCALrangepickr.prototype.resetDRange=function(){this._r1._edate=new Date(this._r2._curDate.getFullYear(),this._r2._curDate.getMonth(),0),this._r2._sdate=new Date(this._r1._curDate.getFullYear(),this._r1._curDate.getMonth()+1,1)};var ZCALdatepickr=function(o){return o=o?o:{},this.fullDtclk=void 0!=o.fullDtclk?o.fullDtclk:0,this._name="datepicker",this._dform=o.dform||"mm/dd/yyyy",this._wkst=o.wkst&&/^[0-7]$/g.test(o.wkst)?o.wkst:0,this._tar="object"==typeof o.target?o.target:document.getElementById(o.target),this._type=o.mode||"inline",this._titype=o.time||"",this._select=o.select||[],this._monchge=[],this._yrchge=[],this._dtclk=[],this._okclk=[],this._customdate=o.customdate||"no",this._template=o.template||("yes"==this._customdate?"type7":"inline"==this._type?"type1":"popup"==this._type&&"right"==this._titype?"type5":"popup"==this._type&&"bottom"==this._titype?"type6":"type2"),this._curDate=o.curdate||(o.today?o.today.parseDate(this._dform):new Date),this._cont=o._cont||(new Date).getTime()+"_"+ZEVENTS.count++,this._change=o.update||"yes",this._minhgt=o.minhgt||251,this._tz=o.timezone||"",this._selDate=new Date,this._curTime,this._pickerview=o.pickerview||"",o.fn&&(this.fn=o.fn),o.timerange&&(this._stime=o.timerange[0],this._etime=o.timerange[1]),o.range&&"[object String]"==Object.prototype.toString.call(o.range[0])?(this._sdate=o.range[0].parseDate(this._dform)||new Date(1947,8,15),this._edate=o.range[1].parseDate(this._dform)||new Date(2147,8,15)):o.range&&"[object Date]"==Object.prototype.toString.call(o.range[0])?(this._sdate=o.range[0],this._edate=o.range[1]):(this._sdate=null,this._edate=null),o.refer?this._refer="object"==typeof o.refer?o.refer:document.getElementById(o.refer):this._tar&&(this._refer="input"==this._tar.tagName.toLowerCase()?this._tar:this._tar.getElementsByTagName("input")[0]),this};ZCALdatepickr.prototype.on=function(mode,fn){return"monthchge"==mode&&"function"==typeof fn?this._monchge.push(fn):"yearchge"==mode&&"function"==typeof fn?this._yrchge.push(fn):"dateclick"==mode&&"function"==typeof fn?this._dtclk.push(fn):"ok"==mode&&"function"==typeof fn&&this._okclk.push(fn),this},ZCALdatepickr.prototype.updateselect=function(arr){return this._r1||(this._select=arr||this._select,document.getElementById(this._cont).innerHTML=this.calendar()),this},ZCALdatepickr.prototype.bind=function(){var self=this,_cont=ZEVENTS.template(self._template)._cont,_dn="",_ele=document.createElement(_cont.tag);_ele.id=self._cont,_ele.className=_cont._class,self.clearobj=function(){if(ZEVENTS.obj.state=null,document.getElementById(self._cont)){ZCALremoveListener(_ele,"mousedown",eventhandle),ZCALremoveListener(_ele,"selectstart",ZCALprevDef),ZCALremoveListener(_ele,"dragstart",ZCALprevDef);var _tmp=_ele.parentNode.removeChild(_ele);"popup"==self._type&&(ZCALremoveListener(document,"mousedown",docevehandle),ZCALremoveListener(document,"scroll",docevehandle),ZCALremoveListener(document,"mousewheel",docevehandle),"bottom"==self._titype&&(ZCALremoveListener(_ele,"keydown",docevekeyhandle1),ZCALremoveListener(_ele,"keyup",docevekeyhandle2))),_tmp=null}},self.hide=function(e){var hi=!0;_ele.contains(e.target)&&(hi=!1),hi&&self.clearobj()},self.clearvar=function(){self=_ele=_cont=null};var reDom=function(){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=self;var _cur=self._refer;_dn="yes",self._curDate=_cur.value.parseDate(self._dform)||new Date,_ele.innerHTML=self.calendar(_dn),ZCALaddListener(_ele,"mousedown",eventhandle),ZCALaddListener(document,"mousedown",docevehandle=function(e){self.hide(e)}),ZCALaddListener(document,"scroll",docevehandle=function(e){self.hide(e)}),ZCALaddListener(document,"mousewheel",docevehandle=function(e){self.hide(e)}),self.fn(_ele)},initpopup=function(e){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=self;var _cur=self._refer,_rge=(document.documentElement.clientHeight||window.innerHeight)+Math.max(document.body.scrollTop,document.documentElement.scrollTop),_wrge=(document.documentElement.clientWidth||window.innerWidth)+Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);document.body.appendChild(_ele),ZCALaddListener(_ele,"mousedown",eventhandle),ZCALaddListener(_ele,"selectstart",ZCALprevDef),ZCALaddListener(_ele,"dragstart",ZCALprevDef),ZCALaddListener(document,"mousedown",docevehandle=function(e){self.hide(e)}),ZCALaddListener(document,"scroll",docevehandle=function(e){self.hide(e)}),ZCALaddListener(document,"mousewheel",docevehandle=function(e){self.hide(e)}),"bottom"==self._titype?(_dn=this.parentNode.positionY()+this.parentNode.offsetHeight+self._minhgt>_rge?"no":"yes",_ele.style.top=("yes"==_dn?this.parentNode.positionY()+this.parentNode.offsetHeight-self._minhgt:this.parentNode.positionY()+this.parentNode.offsetHeight-self._minhgt)+"px"):(_dn=this.positionY()+this.offsetHeight+self._minhgt>_rge?"no":"yes",_ele.style.left=this.positionX()+(this.positionX()+260>_wrge?-260+this.offsetWidth:0)+"px",_ele.style.top=("yes"==_dn?this.positionY()+this.offsetHeight:this.positionY()-_ele.offsetHeight)+"px"),self._curDate=_cur.value.parseDate(self._dform)||new Date,_ele.innerHTML=self.calendar(_dn),_ele.style.left="bottom"==self._titype?this.parentNode.positionX()-_ele.offsetWidth+"px":_ele.style.left,_ele.style.top="bottom"==self._titype?this.parentNode.positionY()+this.parentNode.offsetHeight-_ele.offsetHeight+"px":_ele.style.top,_ele.style.top="bottom"==self._titype&&parseInt(_ele.style.top)<0?this.parentNode.positionY()+this.parentNode.offsetHeight+"px":_ele.style.top,self._refer.focus(),ZCALprevDef(e)},getpointers=function(n,o,ti,t){return 0==t?{getDates:function(){return[o,n]}}:2==t?{getDateObj:function(){return{selectDate:n,selectTime:ti}}}:{getDate:function(){return n}}},myKeyUpHandler=function(eve,id){var k=eve.which||eve.keyCode||eve.charCode;if("zcal_hr"==id){if(38!=k&&40!=k){var dateVal=document.getElementById(id).value,patt1=/^[0-9]{1,10}$/,result=(document.getElementById(id).value,patt1.test(dateVal));result?document.getElementById(id).value=dateVal>12&&24>dateVal?dateVal-12:12>dateVal?document.getElementById(id).value:(new Date).getHours()>12?"0"+(new Date).getHours()-12:"0"+(new Date).getHours():""!=dateVal&&(document.getElementById(id).value=(new Date).getHours())}}else if("zcal_min"==id&&38!=k&&40!=k){var dateVal=document.getElementById(id).value,patt1=/^[0-9]{1,10}$/,result=(document.getElementById(id).value,patt1.test(dateVal));result?(dateVal>60||dateVal.length>2)&&(document.getElementById(id).value=(new Date).getMinutes()):""!=dateVal&&(document.getElementById(id).value="00")}},myKeyPressHandler=function(eve,id){var k=eve.which||eve.keyCode||eve.charCode;if("zcal_hr"==id){var inpVal=document.getElementById(id).value;38==k?11>=inpVal?(document.getElementById(id).value=++inpVal,document.getElementById(id).value=inpVal>9?inpVal:"0"+inpVal):document.getElementById(id).value="01":40==k&&(inpVal>1&&1!=inpVal?(document.getElementById(id).value=--inpVal,document.getElementById(id).value=inpVal>9?inpVal:"0"+inpVal):document.getElementById(id).value=12)}else if("zcal_min"==id){var inpVal=document.getElementById(id).value;if(38==k)if(58>=inpVal){var inc=++inpVal;document.getElementById(id).value=10>inc?"0"+inc:inc}else document.getElementById(id).value="00";else if(40==k)if(inpVal>0&&0!=inpVal){var inc=--inpVal;document.getElementById(id).value=10>inc?"0"+inc:inc}else document.getElementById(id).value=59}else if("zcal_ap"==id){var inpVal=document.getElementById(id).value;38==k?document.getElementById(id).value="AM"==inpVal?"PM":"AM":40==k&&(document.getElementById(id).value="AM"==inpVal?"PM":"AM")}},eventhandle=function(e){e=e||event;var ele=e.target||e.srcElement,rel=ele.getAttribute("rel"),prel=ele.parentNode.getAttribute("rel"),_clk=[],t=0,dobj=new Date(self._curDate);if("u"==ele.tagName.toLowerCase()||"object"!=typeof ele.className&&-1!=ele.className.indexOf("zcal_dis")){if(1!=self.fullDtclk||"u"!=ele.tagName.toLowerCase())return ZCALprevDef(e),!1;_clk=self._dtclk,t=1;var mon=parseInt(ele.getAttribute("rel").split("Y")[0]),yr=parseInt(ele.getAttribute("rel").split("Y")[1]);dobj.setDate(parseInt(ele.innerHTML,10)),dobj.setMonth(mon),dobj.setYear(yr)}if("PY"==rel||"PY"==prel){var _clkel="PY"==rel?ele:ele.parentNode;if("object"==typeof _clkel&&"zcal_dis"==_clkel.getAttribute("class"))return;_clk=self._yrchge,dobj.setYear(dobj.getFullYear()-1)}else if("NY"==rel||"NY"==prel){var _clkel="NY"==rel?ele:ele.parentNode;if("object"==typeof _clkel&&"zcal_dis"==_clkel.getAttribute("class"))return;_clk=self._yrchge,dobj.setYear(dobj.getFullYear()+1)}else if("PM"==rel||"PM"==prel){var _clkel="PM"==rel?ele:ele.parentNode;if("object"==typeof _clkel){if("zcal_dis"==_clkel.getAttribute("class"))return;if(document.querySelector("div.zcal_vw_yr")){var yroptArr=document.querySelectorAll("li[rel=year_sel]"),styr=parseInt(yroptArr[0].querySelector("span").innerHTML)-12,etyr=parseInt(styr)+11;document.querySelector("span[rel=year_idx]").innerHTML=styr+" - "+etyr,dobj.setFullYear(styr),self._tempview="year"==self._pickerview?!1:!0,self._pickerview="year"}else document.querySelector("div.zcal_vw_mth")?(dobj.setFullYear(self._curDate.getFullYear()-1),document.querySelector("span[rel=year_idx]").innerHTML=self._curDate.getFullYear(),self._tempview="month"==self._pickerview?!1:!0,self._pickerview="month"):(_clk=self._monchge,dobj=ZCALchangeMonth(dobj,-1))}else _clk=self._monchge,dobj=ZCALchangeMonth(dobj,-1)}else if("NM"==rel||"NM"==prel){var _clkel="NM"==rel?ele:ele.parentNode;if("object"==typeof _clkel){if("zcal_dis"==_clkel.getAttribute("class"))return;if(_ele.querySelector("div.zcal_vw_yr")){var yroptArr=_ele.querySelectorAll("li[rel=year_sel]"),styr=parseInt(yroptArr[yroptArr.length-1].querySelector("span").innerHTML)+1,etyr=parseInt(styr)+11;_ele.querySelector("span[rel=year_idx]").innerHTML=styr+" - "+etyr,dobj.setFullYear(styr),self._tempview="year"==self._pickerview?!1:!0,self._pickerview="year"}else _ele.querySelector("div.zcal_vw_mth")?(dobj.setFullYear(dobj.getFullYear()+1),_ele.querySelector("span[rel=year_idx]").innerHTML=self._curDate.getFullYear(),self._tempview="month"==self._pickerview?!1:!0,self._pickerview="month"):(dobj=ZCALchangeMonth(dobj,1),_clk=self._monchge)}else dobj=ZCALchangeMonth(dobj,1),_clk=self._monchge}else if("TL"==rel||"HI"==rel||"MI"==rel||"AP"==rel)t=3;else if("DT"==ele.parentNode.parentNode.getAttribute("rel")&&"bottom"==self._titype){t=2;var d=ele.parentNode.parentNode;d.querySelector(".zcal_sl")?d.querySelector(".zcal_sl").innerHTML!=ele.innerHTML&&(d.querySelector(".zcal_sl").className="",ele.className="zcal_sl"):ele.className="zcal_sl",_clk=self._dtclk,dobj.setDate(parseInt(ele.innerHTML,10)),self._selDate=dobj}else if("month_idx"==rel&&"no"!=self._customdate)t=2,self.updateHead(_ele,ele,"month_idx");else if("year_idx"==rel&&"no"!=self._customdate)t=2,self.updateHead(_ele,ele,"year_idx");else if("month_sel"==prel||"month_sel"==rel){t="month"==self._pickerview?1:0;var clkel="month_sel"==rel?ele.childNodes[0]:ele,d=clkel.getAttribute("rel");if("zcal_dis"==clkel.parentNode.className)return;"month"==self._pickerview?(dobj.setMonth(d),_clk=self._dtclk,self.clearobj()):(_clk=self._monchge,dobj.setMonth(d),_ele.querySelector("div.zcal_mCalvw").className="zcal_mCalvw zcal_vw_dy")}else if("year_sel"==prel||"year_sel"==rel){t=2;var clkel="year_sel"==rel?ele.childNodes[0]:ele,d=parseInt(clkel.innerHTML,10);if("zcal_dis"==clkel.parentNode.className)return;"year"==self._pickerview?(dobj.setFullYear(d),_clk=self._dtclk,self.clearobj()):(_clk=self._yrchge,dobj.setFullYear(d),document.querySelector("span[rel=year_idx]").innerHTML=self._curDate.getFullYear(),self._tempview="month"==self._pickerview?!1:!0,self._pickerview="month",t=0)}else if("DT"==ele.parentNode.parentNode.getAttribute("rel"))_clk=self._dtclk,t=1,dobj.setDate(parseInt(ele.innerHTML,10));else if("OK"==rel){t=2;var hr=document.getElementById("zcal_hr").value,min=document.getElementById("zcal_min").value,ap=document.getElementById("zcal_ap").value,time=hr+":"+min+":"+ap;if(self._curTime=time,ele.parentNode.parentNode.parentNode.parentNode.parentNode.querySelectorAll(".zcal_sl").length){var date=ele.parentNode.parentNode.parentNode.parentNode.parentNode.querySelectorAll(".zcal_sl")[0].innerHTML;dobj.setDate(parseInt(date,10))}else{var date=ele.parentNode.parentNode.parentNode.parentNode.parentNode.querySelectorAll("s")[0].innerHTML;dobj.setDate(parseInt(date,10))}_clk=self._okclk,self.clearobj()}if(0==t){for(self._curDate=dobj;_ele.firstChild;)_ele.removeChild(_ele.firstChild);_ele.innerHTML=self.calendar(_dn)}1==t&&self&&"popup"==self._type&&("bottom"==self._titype?"yes"==self._change&&(self._refer.value=dobj.getDateBy(self._dform)):("yes"==self._change&&(self._refer.value=dobj.getDateBy(self._dform)),self.clearobj()));for(var fn in _clk)_clk[fn].call(getpointers(dobj,self._curDate,self._curTime,t));3!=t&&ZCALprevDef(e)};return"inline"==self._type?(self._tar.appendChild(_ele),ZCALaddListener(_ele,"mousedown",eventhandle),ZCALaddListener(_ele,"selectstart",ZCALprevDef),ZCALaddListener(_ele,"dragstart",ZCALprevDef),_ele.innerHTML=self.calendar()):"popup"==self._type&&"bottom"==self._titype?(ZCALaddListener(self._refer,"click",reDom),ZCALaddListener(_ele,"keydown",docevekeyhandle1=function(eve){myKeyPressHandler(eve,eve.target.id)}),ZCALaddListener(_ele,"keyup",docevekeyhandle2=function(eve){myKeyUpHandler(eve,eve.target.id)})):"popup"==self._type&&(ZCALaddListener(self._refer,"focus",initpopup),ZCALaddListener(self._refer,"blur",docevehandle=function(){self.clearobj()}),ZCALaddListener(self._refer,"keypress",ZCALprevDef),ZCALaddListener(self._tar,"mousedown",initpopup)),this},ZCALdatepickr.prototype.updateHead=function(_ele,elem,rel){if("month_idx"==rel){var strmth=this._sdate?this._sdate.getMonth():"",etrmth=this._edate?this._edate.getMonth():"";if(strmth&&etrmth&&strmth==etrmth)return;elem.style.display="none";var mnoptArr=_ele.querySelectorAll("li[rel=month_sel]");"zcal_dis"==mnoptArr[mnoptArr.length-1].className&&_ele.querySelector("svg[rel=nm]").setAttribute("class","zcal_dis"),"zcal_dis"==mnoptArr[0].className&&_ele.querySelector("svg[rel=pm]").setAttribute("class","zcal_dis"),_ele.querySelector("div.zcal_mCalvw")&&(_ele.querySelector("div.zcal_mCalvw").className="zcal_mCalvw zcal_vw_mth")}else if("year_idx"==rel){var yroptArr=_ele.querySelectorAll("li[rel=year_sel]"),styr=yroptArr[0].querySelector("span").innerHTML,etyr=yroptArr[yroptArr.length-1].querySelector("span").innerHTML,stryr=this._sdate?this._sdate.getFullYear():"",etryr=this._edate?this._edate.getFullYear():"";if(stryr&&etryr&&stryr==etryr)return;elem.innerHTML=styr+" - "+etyr,elem.previousSibling.style.display="none",stryr&&etryr&&(stryr>styr?_ele.querySelector("svg[rel=pm]").setAttribute("class","zcal_dis"):etyr>etryr&&_ele.querySelector("svg[rel=nm]").setAttribute("class","zcal_dis")),_ele.querySelector("div.zcal_mCalvw")&&(_ele.querySelector("div.zcal_mCalvw").className="zcal_mCalvw zcal_vw_yr")}_ele.querySelector("svg[rel=NY]").setAttribute("class","zcal_dis"),_ele.querySelector("svg[rel=PY]").setAttribute("class","zcal_dis")},ZCALdatepickr.prototype.changeDate=function(dt){var _ele=document.getElementById(this._cont);for(this._curDate=dt?dt.parseDate(this._dform):this._curDate;_ele.firstChild;)_ele.removeChild(_ele.firstChild);return _ele.innerHTML=this.calendar(""),!0},ZCALdatepickr.prototype.calendar=function(_dn){var _tpO=ZEVENTS.template(this._template),_HTML=_tpO._HTML,_class=_tpO._class,_cust=_tpO._cust;if("right"==this._titype)_HTML=_HTML.replace("#timerow",""),_HTML=_HTML.replace("timerow#",""),_HTML=_HTML.replace("#okrow",""),_HTML=_HTML.replace("okrow#","");else if("type7"==this._template){var in7=_HTML.indexOf("#timerow"),in8=_HTML.indexOf("timerow#");_HTML=_HTML.replace(_HTML.substring(in7,in8+"timerow#".length),"");var in9=_HTML.indexOf("#okrow"),in10=_HTML.indexOf("okrow#");_HTML=_HTML.replace(_HTML.substring(in9,in10+"okrow#".length),"")}var in1=_HTML.indexOf("#wk"),in2=_HTML.indexOf("wk#"),in3=_HTML.indexOf("#dr"),in4=_HTML.indexOf("dr#"),in5=_HTML.indexOf("#tr"),in6=_HTML.indexOf("tr#"),in8=_HTML.indexOf("#br"),in9=_HTML.indexOf("br#"),in_1=_HTML.indexOf("#ycr"),in_2=_HTML.indexOf("ycr#"),in_3=_HTML.indexOf("#mcr"),in_4=_HTML.indexOf("mcr#"),cont="type7"==this._template?_HTML.substring(0,in_1):_HTML.substring(0,in1);if(cont+="type7"==this._template?this.yearrow(_HTML.substring(in_1+4,in_2)):"",cont+="type7"==this._template?_HTML.substring(in_2+4,in_3):"",cont+="type7"==this._template?this.monthrow(_HTML.substring(in_3+4,in_4)):"",cont+="type7"==this._template?_HTML.substring(in_4+4,in1):"",cont="type7"==this._template?cont.replace("#viewclass#","month"==this._pickerview?"zcal_mCalvw zcal_vw_mth":"year"==this._pickerview?"zcal_mCalvw zcal_vw_yr":"zcal_mCalvw zcal_vw_dy"):cont,cont=cont.replace("#HEAD#",this._curDate.getDateBy("MMMM YYYY")).replace("#HEADM#","year"==this._pickerview||"month"==this._pickerview?"":this._curDate.getDateBy("MMMM")).replace("#HEADY#","year"==this._pickerview?this._curDate.getDateBy("YYYY")+"-"+(parseInt(this._curDate.getDateBy("YYYY"))+11):this._curDate.getDateBy("YYYY")),this._sdate&&this._edate){var syr=this._sdate.getFullYear(),smn=this._sdate.getMonth(),eyr=this._edate.getFullYear(),emn=this._edate.getMonth(),cyr=this._curDate.getFullYear(),cmn=this._curDate.getMonth(),cdt=this._curDate.getDate();cont=cont.replace("#py#",("type7"==this._template?"":"zci-fst ")+(new Date(cyr-1,cmn,cdt)>=this._sdate&&"year"!=this._pickerview&&"month"!=this._pickerview?"":"zcal_dis")).replace("#ny#",("type7"==this._template?"":"zci-lst ")+(new Date(cyr+1,cmn,cdt)<=this._edate&&"year"!=this._pickerview&&"month"!=this._pickerview?"":"zcal_dis")).replace("#pm#",("type7"==this._template?"":"zci-pre ")+("type7"==this._template&&"month"==this._pickerview&&syr>=cyr?"zcal_dis":new Date(cyr,cmn,1)>new Date(syr,smn,1)?"":"zcal_dis")).replace("#nm#",("type7"==this._template?"":"zci-nxt ")+("type7"==this._template&&"month"==this._pickerview&&cyr>=eyr?"zcal_dis":new Date("type7"==this._template&&"year"==this._pickerview?cyr+11:cyr,cmn,1)<new Date(eyr,emn,1)?"":"zcal_dis"))}else cont=cont.replace("#py#","type7"==this._template?"month"==this._pickerview||"year"==this._pickerview?"zcal_dis":"":_cust?_cust.py:"zci-fst").replace("#ny#","type7"==this._template?"month"==this._pickerview||"year"==this._pickerview?"zcal_dis":"":_cust?_cust.ny:"zci-lst").replace("#pm#","type7"==this._template?"":_cust?_cust.pm:"zci-pre").replace("#nm#","type7"==this._template?"":_cust?_cust.nm:"zci-nxt");return cont=1==this.fullDtclk?cont.replace("#hover#","zcal_mCalce"):cont.replace("#hover#",""),cont=cont.replace("#shadow#",_dn&&"yes"!=_dn?_class.shup:_class.shdwn),"type7"==this._template&&(cont=cont.replace("#timediv#","right"==this._titype?"zcl_mCalwti":"")),cont+=this.weekrow(_HTML.substring(in1+3,in2)),cont+=_HTML.substring(in2+3,in3),cont+=this.daterow(_HTML.substring(in3+3,in4)),"right"==this._titype?(cont+=_HTML.substring(in4+3,in5).replace("#tz#",this._tz),cont+=this.timerow(_HTML.substring(in5+3,in6)),cont+=_HTML.substring(in6+3,_HTML.length)):"bottom"==this._titype?(cont+=_HTML.substring(in4+3,in8).replace("#tz#",this._tz),cont+=this.setTimeValue(_HTML.substring(in8+3,in9)),cont+=_HTML.substring(in9+3,_HTML.length)):cont+=_HTML.substring(in4+3,_HTML.length).replace("#tz#",this._tz),this._tempview&&(this._pickerview=""!=this._pickerview?"":this._pickerview),cont},ZCALdatepickr.prototype.setTimeValue=function(cont){var date=new Date,txt="",hr=date.getHours()>12?date.getHours()-12:date.getHours(),curHr=10>hr?hr:hr,min=date.getMinutes()<10?"0"+date.getMinutes():date.getMinutes(),ap=date.getHours()>=12?"PM":"AM",h=curHr>9?curHr:"0"+curHr;return txt=cont.replace("#cuHr#",h).replace("#cuMin#",min).replace("#apm#",ap)},ZCALdatepickr.prototype.yearrow=function(cont){for(var txt="",_syear=this._sdate?this._sdate.getFullYear():"",_eyear=this._edate?this._edate.getFullYear():"",in5=cont.indexOf("#yt"),in6=cont.indexOf("yt#"),yr=this._curDate.getFullYear(),x=((new Date).getFullYear(),new Date,cont.substring(in5+3,in6)),cnt=0,i=0;4>i;i++){txt+=cont.substring(0,in5);for(var j=0;3>j;j++){var tag="";tag=x.replace("#item#","<span>"+(yr+cnt)+"</span>"),this._curDate.getFullYear()==yr+cnt?tag=_syear&&_eyear&&(_syear>yr+cnt||yr+cnt>_eyear)?tag.replace("#selclass#","zcal_dis"):tag.replace("#selclass#","zcal_sl_cr"):_syear&&_eyear&&(_syear>yr+cnt||yr+cnt>_eyear)&&(tag=tag.replace("#selclass#","zcal_dis")),txt+=tag,cnt++}txt+=cont.substring(in6+3,cont.length)}return txt},ZCALdatepickr.prototype.monthrow=function(cont){for(var txt="",in5=cont.indexOf("#mt"),in6=cont.indexOf("mt#"),x=cont.substring(in5+3,in6),mn=cnt=0,_yrsel=this._curDate.getFullYear(),_smonth=this._sdate?this._sdate.getMonth():"",_emonth=this._edate?this._edate.getMonth():"",_syear=this._sdate?this._sdate.getFullYear():"",_eyear=this._edate?this._edate.getFullYear():"",i=0;4>i;i++){txt+=cont.substring(0,in5);for(var j=0;3>j;j++){var tag="";tag=x.replace("#item#","<span rel="+(mn+cnt)+">"+Date.MONTH_NAMES[1][mn+cnt]+"</span>"),_syear&&_eyear&&(_yrsel==_syear||_yrsel==_eyear)&&(_smonth&&_emonth&&_yrsel==_eyear&&mn+cnt>_emonth?tag=tag.replace("#selclass#","zcal_dis"):_smonth&&_emonth&&_yrsel==_syear&&_smonth>mn+cnt&&(tag=tag.replace("#selclass#","zcal_dis"))),this._curDate.getMonth()==mn+cnt&&(tag=tag.replace("#selclass#","zcal_sl_cr")),txt+=tag,cnt++}txt+=cont.substring(in6+3,cont.length)}return txt},ZCALdatepickr.prototype.timerow=function(cont){var d1=new Date;d1.setTime((new Date).getTime());var sd,hrs,min,st,d=d1.getDate(),m=d1.getMonth(),y=d1.getFullYear();m=10>m+1?"0"+(m+1):m+1,d=10>d?"0"+d:d,sd=y+""+m+d,d1.setTime((new Date).getTime()),hrs=d1.getHours(),min=d1.getMinutes(),st=2*hrs+(min>30?2:1),st=st>46?46:st;for(var txt="",j=0;48>j;j++){var ch=!1;this._stime&&da.getFullYear()==this._selDate.getFullYear()&&da.getMonth()==this._selDate.getMonth()&&da.getDate()==this._selDate.getDate()&&(ch=!0),txt+=cont.replace("#item#",(j+"").changeNumbertoTime("hh:mm a")).replace("#ti#",j==st?' class="zcal_mCcrti"':1==ch&&st>j?' class="zcal_dis"':"")}return txt},ZCALdatepickr.prototype.weekrow=function(cont){for(var dy=new Date(this._curDate).getDay(),st=this._wkst,_tpO=ZEVENTS.template(this._template),cnt=0,txt="";7>cnt;)txt+=cont.replace("#item#",Date.WEEKS_DAYS[2][st]).replace("#hgt#",st==dy&&_tpO._cust?" class="+_tpO._cust.dysel:""),st=6>st?st+1:0,cnt++;return txt},ZCALdatepickr.prototype.daterow=function(cont){var in5=cont.indexOf("#dc"),in6=cont.indexOf("dc#"),x=cont.substring(in5+3,in6),dobj=new Date(this._curDate),today=dobj.getDate(),thisMon=dobj.getMonth(),cdte="",cmon="",txt="",hd=",",isObj=(this._type,"[object Object]"==Object.prototype.toString.call(this._select)?!0:!1);if(!isObj)for(var k=0;k<this._select.length;k++)hd+=this._select[k]+",";dobj.setDate(1);var MST=dobj.getDay(),fDay=new Date(dobj.getFullYear(),dobj.getMonth(),1),lDay=new Date(dobj.getFullYear(),dobj.getMonth()+1,0),diff=(Math.ceil((fDay.getDay()+lDay.getDate())/7),MST-this._wkst+(MST-this._wkst<0?7:0));dobj.setDate(dobj.getDate()-diff);for(var _class=ZEVENTS.template(this._template)._class,i=0;6>i;i++){txt+=cont.substring(0,in5);for(var j=0;7>j;j++){var cl="";cdte=dobj.getDate(),cmon=dobj.getMonth();var tag=_class.nor;if(cmon==thisMon&&!this._sdate&&!this._edate||cmon==thisMon&&this._sdate&&this._edate&&this._sdate<=dobj&&this._edate>=dobj){(""!=hd&&hd.indexOf(","+cdte+",")>-1||isObj&&this._select.start<=cdte&&this._select.end>=cdte)&&(tag=_class.sel);var curD=(new Date).getDate();curD==cdte&&(tag=_class.hglt),today==cdte&&today!=curD&&_class.hglt&&(cl="zcal_sl")}else tag=_class.dis;txt+=x.replace(/#tag#/g,tag).replace("#cl#","class="+cl).replace("#item#",cdte).replace("#month#",dobj.getMonth()).replace("#year#",dobj.getFullYear()),dobj.setDate(cdte+1)}txt+=cont.substring(in6+3,cont.length)}return txt},Element.prototype.positionX=function(){var curleft=0,obj=this;if("function"==typeof obj.getBoundingClientRect){var box=obj.getBoundingClientRect();curleft=box.left+(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}else if(obj.offsetParent)for(;obj.offsetParent;)curleft+=obj.offsetLeft,obj=obj.offsetParent;else obj.x&&(urleft+=obj.x);return curleft},Element.prototype.positionY=function(){var curtop=0,obj=this;if("function"==typeof obj.getBoundingClientRect){var box=obj.getBoundingClientRect();curtop=box.top+(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)}else if(obj.offsetParent)for(;obj.offsetParent;)curtop+=obj.offsetTop,obj=obj.offsetParent;else obj.y&&(curtop+=obj.y);return curtop},String.prototype.trim=function(){var x=this;return x=x.replace(/^\s*(.*)/,"$1"),x=x.replace(/(.*?)\s*$/,"$1")},String.prototype.changeNumbertoTime=function(f){var a,i,j=parseInt(this,10);return"hh:mm a"==f?(i=j>24?j-24:j,i=0==i||1==i?12:parseInt(i/2,10),a=j>23?" "+ZCALtform[1]:" "+ZCALtform[0]):(i=parseInt(j/2,10),a=""),(10>i?"0":"")+i+":"+(j%2==1?"30":"00")+a},String.prototype.changeTimetoNumber=function(f){if(this.indexOf(":")<0)return 0;var o=this.split(":");if(o[0]=parseInt(o[0],10),"hh:mm a"==f){var sp=o[1].split(" ");sp[1]==ZCALtform[1]&&12!=o[0]?o[0]+=12:sp[1]==ZCALtform[0]&&12==o[0]&&(o[0]=0),o[1]=sp[0]}return o[1]=parseInt(o[1],10),2*o[0]+(30==o[1]?1:0)},String.prototype.parseDate=function(format){var findMKey=function(str,obj){for(var i in obj)if(str.toLowerCase().trim()==obj[i].toLowerCase())return parseInt(i,10)+1;return!1};if(!format||""==format.trim())return!1;if(this&&""==this.trim())return!1;var input=this,parts=input.match(/(\d+)|([a-zA-Z]+)/g),i=0,fmt={},fparts=format.toLowerCase().match(/([a-z]+)/g);if(3!=fparts.length||3!=parts.length)return!1;for(var i in fparts)"d"==fparts[i]||"m"==fparts[i]?fparts[i]+=fparts[i]:"mmm"==fparts[i]?(parts[i]=findMKey(parts[i],Date.MONTH_NAMES[1]),fparts[i]="mm"):"mmmm"==fparts[i]?(parts[i]=findMKey(parts[i],Date.MONTH_NAMES[0]),fparts[i]="mm"):"yy"==fparts[i]&&(parts[i]=parts[i]>=70?1900+parseInt(parts[i],10):2e3+parseInt(parts[i],10),fparts[i]="yyyy"),fmt[fparts[i]]=parts[i];return new Date(fmt.yyyy,fmt.mm-1,fmt.dd)},Date.MONTH_NAMES=new Array(["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),Date.WEEKS_DAYS=new Array(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["S","M","T","W","T","F","S"]),ZCALtform=["am","pm"],Date.prototype.getDaysOfMonth=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()},Date.prototype.getDateBy=function(format){var LZ=function(x){return(0>x||x>9?"":"0")+x};if(""!=format.trim()){format+="";var result="",i_format=0,c="",token="",y=this.getYear()+"",M=this.getMonth()+1,d=this.getDate(),E=this.getDay();y.length<4&&(y=""+(+y+1900));var value={};for(value.YYYY=y,value.YY=y.substring(2,4),value.M=M,value.MM=LZ(M),value.MMMM=Date.MONTH_NAMES[0][M-1],value.MMM=Date.MONTH_NAMES[1][M-1],value.D=d,value.DD=LZ(d),value.E=Date.WEEKS_DAYS[1][E],value.EE=Date.WEEKS_DAYS[0][E];i_format<format.length;){for(c=format.charAt(i_format),token="";format.charAt(i_format)==c&&i_format<format.length;)token+=format.charAt(i_format++);result+=null!=value[token.toUpperCase()]?value[token.toUpperCase()]:token}return result}},Date.prototype.getTimeBy=function(f){function ii(i,len){var s=i+"";for(len=len||2;s.length<len;)s="0"+s;return s}var H=this.getHours();f=f.replace(/(^|[^\\])HH+/g,"$1"+ii(H)),f=f.replace(/(^|[^\\])H/g,"$1"+H);var h=H>12?H-12:0==H?12:H;f=f.replace(/(^|[^\\])hh+/g,"$1"+ii(h)),f=f.replace(/(^|[^\\])h/g,"$1"+h);var m=this.getMinutes();f=f.replace(/(^|[^\\])mm+/g,"$1"+ii(m)),f=f.replace(/(^|[^\\])m/g,"$1"+m);var s=this.getSeconds();f=f.replace(/(^|[^\\])ss+/g,"$1"+ii(s)),f=f.replace(/(^|[^\\])s/g,"$1"+s);var T=12>H?"AM":"PM";f=f.replace(/(^|[^\\])TT+/g,"$1"+T),f=f.replace(/(^|[^\\])T/g,"$1"+T.charAt(0));var t=T.toLowerCase();f=f.replace(/(^|[^\\])tt+/g,"$1"+t),f=f.replace(/(^|[^\\])t/g,"$1"+t.charAt(0));var tz=-this.getTimezoneOffset(),K=tz?tz>0?"+":"-":"Z";tz=Math.abs(tz);var tzHrs=Math.floor(tz/60),tzMin=tz%60;return K+=ii(tzHrs)+":"+ii(tzMin),f=f.replace(/(^|[^\\])K/g,"$1"+K)},Date.prototype.diffTo=function(t,d2){var d1=this;return d2=d2||new Date,"days"==t?parseInt((d2.getTime()-d1.getTime())/864e5,10):"month"==t?d2.getMonth()-d1.getMonth()+12*(d2.getFullYear()-d1.getFullYear()):"year"==t?d2.getFullYear()-d1.getFullYear():void 0};var ZCALaddListener=document.addEventListener?function(_ele,event,_handle,bble){"mousewheel"==event&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(event="DOMMouseScroll"),_ele.addEventListener(event,_handle,Boolean(bble))}:function(_ele,event,_handle){_ele.attachEvent("on"+event,_handle)},ZCALremoveListener=document.removeEventListener?function(_ele,event,_handle,bble){"mousewheel"==event&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(event="DOMMouseScroll"),_ele.removeEventListener(event,_handle,Boolean(bble))}:function(_ele,event,_handle){_ele.removeEventListener("on"+event,_handle)},ZCALprevDef=function(ev){ev=ev||event,ev.stopPropagation?(ev.preventDefault(),ev.stopPropagation()):(ev.cancelBubble=!0,ev.returnValue=!1)};ZCALcrtesel=function(field,start,end){if(field.createTextRange){field.focus();var selRange=field.createTextRange();selRange.collapse(!0),selRange.moveStart("character",start),selRange.moveEnd("character",end-start),selRange.select()}else field.setSelectionRange?(field.focus(),field.setSelectionRange(start,end)):"undefined"!=typeof field.selectionStart&&(field.focus(),field.selectionStart=start,field.selectionEnd=end);return start},ZCALselstart=function(o){if(document.selection){var r=document.selection.createRange().duplicate();return r.moveEnd("character",o.value.length),""==r.text?o.value.length:o.value.lastIndexOf(r.text)}return o.selectionStart},ZCALselend=function(o){if(document.selection){var r=document.selection.createRange().duplicate();return r.moveStart("character",-o.value.length),r.text.length}return o.selectionEnd},ZCALchangeMonth=function(dte,i){var tmp=new Date(dte.getFullYear(),dte.getMonth()+i,1),d1=dte.getDate(),d2=new Date(tmp.getFullYear(),tmp.getMonth()+1,0).getDate();return tmp.setDate(d2>=d1?d1:d2),tmp};var ZCL_RQ=[],ZCL_URL=[],ZCL_LOGIN_STATE=!0;ZCL_uXHR=function(u,f){return u="/mail"+u,rt=ZCL_RQ.length,ZCL_RQ[rt]=ZCL_GetHTTPTransport(),ZCL_URL[rt]=u,"function"==typeof f?(ZCL_RQ[rt].zcal_callback=f,ZCL_RQ[rt].zcal_reqindex=rt,ZCL_RQ[rt].onreadystatechange=function(){var callback=this.zcal_callback,rt=this.zcal_reqindex;if(4==this.readyState){var ret=this.getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");-1!=ret?callback(this.responseXML,ZCL_URL[rt]):callback(this,ZCL_URL[rt]),ZCL_RQ[rt]=null}}):ZCL_RQ[rt].onreadystatechange=new Function("{			if( ZCL_RQ["+rt+"].readyState == 4 ) { 				ZCL_XHRInclude(ZCL_RQ["+rt+"],ZCL_URL["+rt+"]);				var ret = ZCL_RQ["+rt+'].getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");				'+f+"((ret !=-1 ? ZCL_RQ["+rt+"].responseXML:ZCL_RQ["+rt+"]) ,ZCL_URL["+rt+"]);ZCL_RQ["+rt+"]=null;}}"),ZCL_RQ[rt].open("GET",u,!0),ZCL_RQ[rt].setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),ZCL_RQ[rt].send(null),!0},ZCL_GetHTTPTransport=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){throw new Exception("Browser not supported")}}},ZCL_formSubmit=function(obj,action,method){if(!ZCL_$("zcl_tarFrame")){var tarFrame=_zm.getDOM(["IFRAME",{attrs:{id:"zcl_tarFrame",name:"zcl_tarFrame",style:"display:none",width:"0",height:"0",frameborder:"0"}}]);document.body.appendChild(tarFrame)}var formObj=_zm.getDOM(["FORM",{attrs:{id:"dwnldForm",name:"dwnldForm",style:"display:none",target:"zcl_tarFrame",method:method||"post",action:"/mail"+action+"?frameorigin="+window.location.protocol+"//"+window.location.hostname}}]);for(var i in obj)formObj.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:i,value:obj[i]}}]));var csr=ZCL_getCookie("aprmjrnpkcrkks");formObj.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:"mstpcrdhkur",value:csr}}])),document.body.appendChild(formObj),formObj.submit(),formObj.parentNode.removeChild(formObj)},ZCL_getCookie=function(name){name=new RegExp("^"+name+"=");for(var ckarr=document.cookie.split(";"),i=0;i<ckarr.length;i++){var ck=ckarr[i].trim();if(name.test(ck))return ck.replace(name,"")}return null};var loadZcalSearch=function(){ZCL_uXHR("/ncal/loadjs.do",function(res){var resObj=JSON.parse(res.responseText),s=document.createElement("script");s.type="text/javascript",s.src="//"+resObj[1].jsPath+resObj[1].search.js[0],document.head.appendChild(s)})};loadZcalSearch();var ZCL_streamEve={entId:"",dataObj:{},RQ:new Array,URL:new Array,LOGIN_STATE:!0,callback:"",timeObj:new Object,curTimeGMT:"",timeIntVl:"",eventExpireIntvl:"",grpId:"",isreq:!1,timeIncDur:12e4,chckEventExpDur:3e5,allAttnElem:"",parentDOM:"",remUserID:"",remStTime:"",curAttendeeList:[],isAttReqInvoked:!0,initEventTBox:function(type,groupId,callFunc){var htmldata1='<textarea  id="eventTitle" placeholder="Event title, @attendees"></textarea>',htmldata2='<span id="eventDate_span"><i class="msi-calendar"></i><input type="text"  placeholder="Date" id="eventDate"></span><i class="msi-clock"></i><span style="border:none;" class="zcal_time zcal_nbr" id="eventTime_span"><input type="text" placeholder="Time" id="eventTime" ></span><i class="msi-duration"></i><span class="zcal_time zcal_nbr" id="eventDur_span"><input onclick="ZCL_streamEve.setEventDurDropdwn(event,this)" readonly type="text" value="00:30 Min" id="eventDur" placeholder="Duration"></ul></span><i class="msi-location"></i><input type="text" placeholder="Choose Location" id="eventLoc">',frag=document.createDocumentFragment(),divElem1=document.createElement("div");divElem1.innerHTML=htmldata1,frag.appendChild(divElem1);var divElem2=document.createElement("div");divElem2.className="Sevent_data",divElem2.innerHTML=htmldata2,frag.appendChild(divElem2),callFunc(frag,ZCL_streamEve.eventAddPublish),ZCL_streamEve.initDateTimePicker(divElem2.firstChild,divElem2.childNodes[2]),divElem1.firstChild&&ZCL_streamEve.setMention(divElem1.firstChild)},curStartAndEndTime:function(){var am="am",pm="pm",hrTime=["12:00 "+am,"12:30 "+am,"01:00 "+am,"01:30 "+am,"02:00 "+am,"02:30 "+am,"03:00 "+am,"03:30 "+am,"04:00 "+am,"04:30 "+am,"05:00 "+am,"05:30 "+am,"06:00 "+am,"06:30 "+am,"07:00 "+am,"07:30 "+am,"08:00 "+am,"08:30 "+am,"09:00 "+am,"09:30 "+am,"10:00 "+am,"10:30 "+am,"11:00 "+am,"11:30 "+am,"12:00 "+pm,"12:30 "+pm,"01:00 "+pm,"01:30 "+pm,"02:00 "+pm,"02:30 "+pm,"03:00 "+pm,"03:30 "+pm,"04:00 "+pm,"04:30 "+pm,"05:00 "+pm,"05:30 "+pm,"06:00 "+pm,"06:30 "+pm,"07:00 "+pm,"07:30 "+pm,"08:00 "+pm,"08:30 "+pm,"09:00 "+pm,"09:30 "+pm,"10:00 "+pm,"10:30 "+pm,"11:00 "+pm,"11:30 "+pm],params=new Array,d1=new Date,hrs=d1.getHours(),min=d1.getMinutes(),st=2*hrs+(min>30?2:1);return st=st>46?46:st,params.ST=hrTime[st],params.ET=hrTime[st+1],params},initDateTimePicker:function(dateElem,timeElem){!function($){if(dateElem){var curDate=(new Date).getDateBy("MM/dd/yyyy"),dateInpElem=dateElem.getElementsByTagName("input")[0];dateInpElem.value=curDate,$(dateElem).picker("date",{dform:"MM/DD/YYYY",refer:dateInpElem,wkst:0,range:[curDate,""],mode:"popup",update:"yes",minhgt:251}).bind()}if(timeElem){var params=ZCL_streamEve.curStartAndEndTime(),timeInpElem=timeElem.getElementsByTagName("input")[0];timeInpElem.value=params.ST,$(timeElem).picker("time",{tform:"hh:mm a",type:1}).bind()}}(ZEVENTS)},setEventDurDropdwn:function(e,elem){if(ZCL_$("eventDur_span")||ZCL_$("SCeventDur_span")||ZCL_$("de_eveDur")){var durArr=["00:30 Min","01:00 Hr","01:30 Hr","02:00 Hr","02:30 Hr","03:00 Hr","03:30 Hr","04:00 Hr","04:30 Hr","05:00 Hr"],_el=e.target||e.srcElement,inEl="input"==elem.tagName.toLowerCase()?elem:elem.getElementsByTagName("input")[0],val=inEl.value,_ul=document.body.appendChild(document.createElement("ul"));_ul.style.width=(elem.clientWidth<110?110:elem.clientWidth)+"px",_ul.style.left=elem.positionX()+"px",_ul.id="SC_eventDur"==_el.id?"SCeventDur_ul":"eventDur_ul",ZCALaddListener(_ul,"mousedown",ZCL_streamEve.ulEvent);var _rge=(document.documentElement.clientHeight||window.innerHeight)+Math.max(document.body.scrollTop,document.documentElement.scrollTop);_ul.className="zcal_tilst "+(elem.positionY()+250>_rge?"zcal_tilsbt":"zcal_tilstp");for(var txt="",i=0;i<durArr.length;i++)txt+='<li rel="'+i+'"'+(durArr[i]==val?'class="zcal_sl"':"")+">"+durArr[i]+"</li>";_ul.innerHTML=txt,_ul.style.top=elem.positionY()+250<_rge?elem.positionY()+elem.offsetHeight+"px":elem.positionY()-_ul.offsetHeight+"px",ZCALaddListener(document,"mousedown",docevehandle=function(eve){ZCL_streamEve.selectEventDuration(eve,_el.id)}),ZCALaddListener(document,"keydown",docevekeyhandle=function(eve){ZCL_streamEve.myKeyPressHandler(eve,_el.id)}),ZCALaddListener(elem,"blur",docevehandle=function(eve){ZCL_streamEve.selectEventDuration(eve,_el.id)})}},ulEvent:function(e){var _el=e.target||e.srcElement;"li"==_el.tagName.toLowerCase()&&($("#eveInpDu")[0].value=_el.innerHTML,$("#eventDur_ul").remove()),ZCALprevDef(e)},selectEventDuration:function(event,id){var val=event.target.innerHTML,x=val.trim().toLowerCase();/^(0[0-5]):(00|30)\s*(hr|min)$/.test(x)&&(ZCL_$(id).value=event.target.innerHTML),ZCALremoveListener(document,"mousedown",docevehandle),ZCALremoveListener(document,"keydown",docevekeyhandle),ZCALremoveListener(document,"blur",docevehandle),"SC_eventDur"==id?$("#SCeventDur_ul").remove():"eventDur"==id?$("#eventDur_ul").remove():"eveInpDu"==id&&$("#eventDur_ul").remove()},myKeyPressHandler:function(eve,id){var liobj,liElems,k=eve.which||eve.keyCode||eve.charCode;"eveInpDu"==id?(liobj=document.getElementById("eventDur_ul").getElementsByTagName("li"),liElems=ZCL_$("eventDur_ul").childNodes):(liobj="eventDur"==id?document.getElementById("eventDur_ul").getElementsByTagName("li"):document.getElementById("SCeventDur_ul").getElementsByTagName("li"),liElems="eventDur"==id?ZCL_$("eventDur_ul").childNodes:ZCL_$("SCeventDur_ul").childNodes);for(var inElem=ZCL_$(id),relVal="",i=0;i<liElems.length;i++)if("zcal_sl"==liElems[i].getAttribute("class")){relVal=liElems[i].getAttribute("rel");break}(27==k||13==k)&&("eveInpDu"==id?$("#eventDur_ul").remove():"eventDur"==id?ZCL_$("eventDur_ul").remove():ZCL_$("SCeventDur_ul").remove(),ZCALremoveListener(document,"mousedown",docevehandle),ZCALremoveListener(document,"keydown",docevekeyhandle)),38==k&&0!=relVal?(liobj[relVal--].className="",liobj[relVal].className="zcal_sl",inElem.value=liobj[relVal--].innerHTML):40==k&&relVal!=liobj.length-1&&(liobj[relVal++].className="",liobj[relVal].className="zcal_sl",inElem.value=liobj[relVal++].innerHTML)},eventPublish:function(groupid,callbackfunc){var finalObj={};ZCL_streamEve.callback=callbackfunc;var eventParams=ZCL_streamEve.getEventParams(groupid);if(eventParams.ERR_ARR)finalObj.ERROR={},finalObj.ERROR.message=eventParams.ERR_ARR[0],ZCL_streamEve.callback(finalObj);else{var urlParams="sum="+encodeURIComponent(eventParams.TITLE)+"&sday="+eventParams.ST_DATE+"&smonth="+eventParams.ST_MONTH+"&syear="+eventParams.ST_YEAR+"&shour="+eventParams.ST_HOUR+"&smin="+eventParams.ST_MIN+"&eday="+eventParams.END_DATE+"&emonth="+eventParams.END_MONTH+"&eyear="+eventParams.END_YEAR+"&ehour="+eventParams.END_HOUR+"&emin="+eventParams.END_MIN+"&loc="+encodeURIComponent(eventParams.LOCATION)+"&zgid="+groupid+"&att="+eventParams.ATTN;ZCL_XHR("/cal/stream/api/private/json/addEvent?"+urlParams,"ZCL_streamEve.afterSubmit")}},eventAddPublish:function(groupObj,eveDOMElem,callbackfunc){var finalObj={};ZCL_streamEve.callback=callbackfunc;var groupid=groupObj.gid,lckValue=groupObj.lckInv?groupObj.lckInv:!1,eventParams=ZCL_streamEve.getEventDOMParams(groupid,eveDOMElem);if(eventParams.ERR_ARR)finalObj.ERROR={},finalObj.ERROR.message=eventParams.ERR_ARR[0],ZCL_streamEve.callback(finalObj);else{var urlParams="sum="+encodeURIComponent(eventParams.TITLE)+"&sday="+eventParams.ST_DATE+"&smonth="+eventParams.ST_MONTH+"&syear="+eventParams.ST_YEAR+"&shour="+eventParams.ST_HOUR+"&smin="+eventParams.ST_MIN+"&eday="+eventParams.END_DATE+"&emonth="+eventParams.END_MONTH+"&eyear="+eventParams.END_YEAR+"&ehour="+eventParams.END_HOUR+"&emin="+eventParams.END_MIN+"&loc="+encodeURIComponent(eventParams.LOCATION)+"&zgid="+groupid+"&att="+eventParams.ATTN+"&lckInv="+lckValue;if(void 0!=groupObj.inv_allMem){var sendInv=groupObj.inv_allMem;urlParams+="&inv_allMem="+sendInv}ZCL_XHR("/cal/stream/api/private/json/addEvent?"+urlParams,"ZCL_streamEve.afterSubmit")}},afterSubmit:function(xml){var finalObj={},resultJson=ZCL_streamEve.evl(1,xml.responseText),finalJson=resultJson.response.result;resultJson.response.error?(finalObj.ERROR={},finalObj.ERROR.message="err_nostreamadd"==resultJson.response.error?"Problem in adding event":resultJson.response.error.message?resultJson.response.error.message:resultJson.response.error):(finalObj.ENTITY_ID=finalJson.ENTITY_ID,finalObj.GROUP_ID=finalJson.GROUP_ID),ZCL_streamEve.callback(finalObj)},evl:function(){if(!(arguments.length<2)){if(1==arguments[0])return JSON.parse(arguments[1]);if(2==arguments.length)return window[arguments[1]].apply(this);var args=Array.prototype.slice.call(arguments,2);return window[arguments[1]].apply(this,args)}},getEventParams:function(grpId){var paramsArr=new Array,eventDate=ZCL_$("eventDate").value,stTime=ZCL_$("eventTime").value,duration=ZCL_$("eventDur").value,title=ZCL_$("eventTitle").parentNode.firstChild.innerHTML.split("<b")[0],location=ZCL_$("eventLoc").value,mentObj=zmMention.getMentions($("#eventTitle")),mentEmails=ZCL_streamEve.getMentionEmails(mentObj),isMyStrmView=zmail.zuid==grpId?!0:!1,errArr=ZCL_streamEve.validateEventParams(eventDate,stTime,title,mentEmails,isMyStrmView),keys=Object.keys(errArr);return 0==keys.length?(paramsArr=ZCL_streamEve.calcEventTime(eventDate,stTime,duration),paramsArr.TITLE=title,paramsArr.LOCATION=location,paramsArr.ATTN=mentEmails):paramsArr.ERR_ARR=errArr,paramsArr},getEventDOMParams:function(grpId,eveDOMElem){var paramsArr=new Array,eventDate=eveDOMElem.lastChild.firstChild.lastChild.value,stTime=eveDOMElem.lastChild.childNodes[2].lastChild.value,duration=eveDOMElem.lastChild.childNodes[4].lastChild.value,location=eveDOMElem.lastChild.lastChild.value,title=eveDOMElem.firstChild.firstChild.lastChild.parentNode.firstChild.innerHTML.split("<b")[0];title=title.trim();var mentObj=zmMention.getMentions(eveDOMElem.firstChild.firstChild.getElementsByTagName("TEXTAREA")),mentEmails=ZCL_streamEve.getMentionEmails(mentObj),errArr=ZCL_streamEve.validateEventParams(eventDate,stTime,title,mentEmails,isMyStrmView),isMyStrmView=zmail.zuid==grpId?!0:!1,keys=Object.keys(errArr);return 0==keys.length?(paramsArr=ZCL_streamEve.calcEventTime(eventDate,stTime,duration),paramsArr.TITLE=title,paramsArr.LOCATION=location,paramsArr.ATTN=mentEmails):paramsArr.ERR_ARR=errArr,paramsArr},getMentionEmails:function(mentObj){var emails="";for(var i in mentObj)emails+=""==emails?mentObj[i].eid:","+mentObj[i].eid;return emails},validateEventParams:function(evtDate,startTime,title,mentEmails,isMyStrmView){var errArr=new Array;if(""==title?errArr.push(" Title is mandatory"):title.length>255&&errArr.push("Event title cannot exceed 255 characters"),""==evtDate)errArr.push("Date is mandatory");else if(/^\d{2}\/\d{2}\/\d{4}$/.test(evtDate)){var curDate=(new Date).getDateBy("MM/dd/yyyy"),inpDate=Date.parse(evtDate);curDate>inpDate&&errArr.push("The date is earlier than today")}else errArr.push("Invalid date format");return""==startTime?errArr.push("Time is mandatory"):/^(0[1-9]|1[0-2]|[1-9]):[0-5][0-9]\s*([ap]m|[AP]M)$/.test(startTime.toLowerCase())||errArr.push("Invalid time format"),isMyStrmView&&""==mentEmails&&errArr.push("Select a group or mention/tag someone in the event"),errArr},calcEventTime:function(eventDate,stTime,duration){var stTime=ZCL_streamEve.parseTime(stTime),stDate=eventDate.split("/"),durFinal=duration.split(" ")[0],durHr=parseInt(durFinal.split(":")[0]),durMin=parseInt(durFinal.split(":")[1]),d1=new Date(Date.parse(eventDate));d1.setHours(stTime.HH),d1.setMinutes(stTime.mm),d1.setSeconds(0,0);var d2=new Date(Date.parse(eventDate));d2.setHours(d1.getHours()+durHr),d2.setMinutes(d1.getMinutes()+durMin),d2.setSeconds(0,0);var day=d2.getDate(),month=d2.getMonth()+1,dayStr=10>day?"0"+day:day+"",monStr=10>month?"0"+month:month,entime=(monStr+"/"+dayStr+"/"+d2.getFullYear(),ZCL_streamEve.parseTime((d2.getHours()<10?"0"+d2.getHours():d2.getHours())+":"+d2.getMinutes())),timeDateArr=new Array;return timeDateArr.END_HOUR=entime.HH,timeDateArr.END_MIN=entime.mm,timeDateArr.ST_HOUR=stTime.HH,timeDateArr.ST_MIN=stTime.mm,timeDateArr.ST_MONTH=stDate[0],timeDateArr.ST_DATE=stDate[1],timeDateArr.ST_YEAR=stDate[2],timeDateArr.END_MONTH=monStr,timeDateArr.END_DATE=dayStr,timeDateArr.END_YEAR=d2.getFullYear(),timeDateArr},correctTimeFormat:function(val){return 1==val.length?val="000"+val:2==val.length?val="00"+val:3==val.length&&(val="0"+val),val},addEventAttendee:function(eids){var urlParams="ckey="+ckey+"&ekey="+ekey+"att="+eids;ZCL_XHR("/cal/stream/api/private/json/addAttendee?"+urlParams)},updateAttStatusFrmNotification:function(elem,ckey){var ulId=elem.parentNode.getAttribute("eveid"),innHtml=elem.innerHTML,sts=0;"Yes"==innHtml?sts=1:"No"==innHtml?sts=2:"MayBe"==innHtml&&(sts=3);var urlParams="ckey="+ckey+"&ekey="+ulId+"&status="+sts;ZCL_XHR("/cal/stream/api/private/json/updateAttStatus?"+urlParams,"ZCL_streamEve.afterUpdateAttnFrmNoti")},updateAttendeeStatus:function(elem,ckey){var ulId=elem.parentNode.getAttribute("eveid"),innHtml=elem.innerHTML,sts=0;"Yes"==innHtml?sts=1:"No"==innHtml?sts=2:"Maybe"==innHtml&&(sts=3);var urlParams="ckey="+ckey+"&ekey="+ulId+"&status="+sts;ZCL_XHR("/cal/stream/api/private/json/updateAttStatus?"+urlParams,"ZCL_streamEve.afterUpdateAttn")},afterUpdateAttnFrmNoti:function(xml){var resultJson=ZCL_streamEve.evl(1,xml.responseText),result=resultJson.response.result,status=result.status,message=result.message;if(1==status){for(var eveSts=(result.eventKey,result.eventstatus),ulElems=document.querySelectorAll('[eveid="'+result.eventKey+'"]'),i=0;i<ulElems.length;i++){var liElemId=ulElems[i].getAttribute("eveid");if(result.eventKey==liElemId)for(var liElems=ulElems[i].childNodes,j=0;j<liElems.length;j++)j==eveSts-1?liElems[j].className="sel":liElems[j].removeAttribute("class")}zmUtil.succErrMsg("s",message)}else if(-1!=message.indexOf("Event is expired")){for(var ulElems=document.querySelectorAll('[eveid="'+result.eventKey+'"]'),i=0;i<ulElems.length;i++){var liElemId=ulElems[i].getAttribute("eveid");if(ulElems[i].className="eventExpired",result.eventKey==liElemId)for(var liElems=ulElems[i].childNodes,j=0;j<liElems.length;j++)liElems[j].removeAttribute("onclick")}zmUtil.succErrMsg("e",message)}else zmUtil.succErrMsg("e",message)},getAllAttendee:function(elem,ckey,ekey){ZCL_streamEve.allAttnElem=elem;var urlParams="ckey="+ckey+"&ekey="+ekey;ZCL_streamEve.isAttReqInvoked&&(ZCL_streamEve.isAttReqInvoked=!1,ZCL_XHR("/cal/stream/api/private/json/getAllAttendeeStatus?"+urlParams,"ZCL_streamEve.afterGetAllAttn"))},getAttendeesHtml:function(orgCont,finalJson,addBy){{var ulEle=$("<ul class='SC_Phr SC_P2r'/>");new Array}for(var i in finalJson){var status=finalJson[i].STS,attZuid=finalJson[i].ATT_ZUID+"",photo="undefined"!=attZuid?orgCont[attZuid].photo:zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"),liDOM=_zm.getDOM(["LI",{child:[["DIV",{child:[["text","&nbsp;&nbsp;"+orgCont[attZuid].eid],["SPAN",{child:[["text","&nbsp;&nbsp;"+status]]}]]}],["IMG",{attrs:{src:photo}}]]}]);ulEle.append(liDOM),delete orgCont[attZuid]}for(var j in orgCont){var sts=j==addBy?"Yes":"Pending",liDOM=_zm.getDOM(["LI",{child:[["DIV",{child:[["text","&nbsp;&nbsp;"+orgCont[j].eid],["SPAN",{child:[["text","&nbsp;&nbsp;"+sts]]}]]}],["IMG",{attrs:{src:orgCont[j].photo}}]]}]);ulEle.append(liDOM)}return ulEle},ParseByDB:function(x){var y1=x.substring(0,2),y2=x.substring(2,4);y1=parseInt(y1,10);var tmp=(0==y1?"12|am":12==y1?"12|pm":12>y1?y1+"|am":y1-12+"|pm").split("|"),value={};return value.HH=10>y1?"0"+y1:y1,value.hh=tmp[0]<10?"0"+tmp[0]:tmp[0],value.mm=y2.length<2?"0"+y2:y2,value.a=tmp[1],value},parseTime:function(val){var x=val.trim().toLowerCase();if(/^(20|21|22|23|[01]\d|\d)(([:][0-5]\d){1,2})$/.test(x))return ZCL_streamEve.ParseByRT(x);if(/^(0[1-9]|1[0-2]|[1-9]):[0-5][0-9]\s*([ap]m|[AP]M)$/.test(x))return ZCL_streamEve.ParseByAm(x);if(/^(20|21|22|23|[01]\d|\d)[0-5][0-9]$/.test(x))return ZCL_streamEve.ParseByDB(x);if(x=x.replace(/\D/gi,""),isNaN(x))return{HH:"08",hh:"08",mm:"00",a:"am"};var len=x.length;return x=1==len?x+"000":2==len?x+"00":3==len?x+"0":len>4?x.substring(0,4):x,/^(20|21|22|23|[01]\d|\d)[0-5][0-9]$/.test(x)?ZCL_streamEve.ParseByDB(x):{HH:"08",hh:"08",mm:"00",a:"am"}},ParseByRT:function(x){var y=x.split(":");y[0]=parseInt(y[0],10);var tmp=(0==y[0]?"12|am":12==y[0]?"12|pm":y[0]<12?y[0]+"|am":y[0]-12+"|pm").split("|"),value={};return value.HH=y[0]<10?"0"+y[0]:y[0],value.hh=tmp[0]<10?"0"+tmp[0]:tmp[0],value.mm=y[1],value.a=tmp[1],value},ParseByAm:function(x){var y=x.split(/:|\s+/);y.length<3&&(y[2]=y[1].substring(2,4),y[1]=y[1].substring(0,2)),y[0]=parseInt(y[0],10);var value={};return value.hh=y[0]<10?"0"+y[0]:y[0],value.mm=y[1],value.a=y[2],value.HH=12==y[0]&&"am"==value.a?"00":"pm"==value.a&&12!=y[0]?y[0]+12:y[0]<10?"0"+y[0]:y[0],value},setMention:function(elem){var content="org",fillObj={contentArray:content,compare:["fn","ln","nn","eid"],LType:"3",OType:"3",drag:!1};zmAutoFill.setAutofill(fillObj,$(elem))},eventDelete:function(eveJson){var url="/cal/stream/api/private/json/deleteEvent?eKey="+eveJson.eventUID+"&cKey="+eveJson.calUID+"&zmstreamweb=true";ZCL_XHR(url,"ZCL_streamEve.afterDelEvent")},clearETBox:function(){zmMention.clearMention($("#eventTitle"));var params=ZCL_streamEve.curStartAndEndTime();ZCL_$("eventDate").value=(new Date).getDateBy("MM/dd/yyyy"),ZCL_$("eventTime").value=params.ST,ZCL_$("eventDur").value="00:30 Min",ZCL_$("eventTitle").value="",ZCL_$("eventLoc").value=""},clearETBoxDOM:function(eveDOMElem){zmMention.clearMention(eveDOMElem.firstChild.firstChild.lastChild);var params=ZCL_streamEve.curStartAndEndTime();eveDOMElem.lastChild.firstChild.lastChild.value=(new Date).getDateBy("MM/dd/yyyy"),eveDOMElem.lastChild.childNodes[2].lastChild.value=params.ST,eveDOMElem.lastChild.childNodes[4].lastChild.value="00:30 Min",eveDOMElem.lastChild.lastChild.value="",eveDOMElem.firstChild.firstChild.lastChild=""},afterDelEvent:function(xml){var resultJson=ZCL_streamEve.evl(1,xml.responseText),eventKey=resultJson.response.result.eKey;delete ZCL_streamEve.timeObj[eventKey]},eventExpired:function(evetime,curTime){var isExpired=curTime>evetime?!0:!1;return isExpired},setTimeIntrvl:function(eveJson,isExpired){var timeObjKeys=Object.keys(ZCL_streamEve.timeObj);if(-1==timeObjKeys.indexOf(eveJson.events.eventUID)&&!isExpired){var eDate=eveJson.events.endDateTime?eveJson.events.endDateTime:eveJson.events.endDate,sDate=eveJson.events.startDateTime?eveJson.events.startDateTime:eveJson.events.startDate,eveDT=new Array;eveDT[0]=parseInt(sDate),eveDT[1]=parseInt(eDate),ZCL_streamEve.timeObj[eveJson.events.eventUID]=eveDT}""!=ZCL_streamEve.curTimeGMT||ZCL_streamEve.isreq||(ZCL_streamEve.isreq=!0,ZCL_streamEve.getCurrentSerTime()),""==ZCL_streamEve.timeIntVl&&(ZCL_streamEve.eventExpireIntvl=setInterval(ZCL_streamEve.checkEventExpire,ZCL_streamEve.chckEventExpDur))},getCurrentSerTime:function(){var url="/cal/stream/api/private/json/getcurtime?";ZCL_XHR(url,"ZCL_streamEve.aftergetcurtime")},aftergetcurtime:function(xml){var resultJson=ZCL_streamEve.evl(1,xml.responseText);""==ZCL_streamEve.curTimeGMT&&(ZCL_streamEve.curTimeGMT=resultJson.response.result.CUR_TIME,ZCL_streamEve.timeIntVl=setInterval(ZCL_streamEve.incCurTime,ZCL_streamEve.timeIncDur))},incCurTime:function(){var d=(ZCL_streamEve.curTimeGMT,new Date);d.setTime(ZCL_streamEve.curTimeGMT),d.setMinutes(d.getMinutes()+2),ZCL_streamEve.curTimeGMT=d.getTime()},clearTimeIntrvl:function(){ZCL_streamEve.curTimeGMT="",ZCL_streamEve.timeObj={},clearInterval(ZCL_streamEve.eventExpireIntvl),clearInterval(ZCL_streamEve.timeIntVl),ZCL_streamEve.eventExpireIntvl="",ZCL_streamEve.timeIntVl="",ZCL_streamEve.isreq=!1},streamEveNotificationPreview:function(eveObj,eveParentDOMElem){if("object"==typeof eveObj.summary)var eveVal=ZCL_streamEve.evl(1,eveObj.summary[0]);else var eveVal=ZCL_streamEve.evl(1,eveObj.summary);var urlParams="eKey="+eveVal.eKey+"&cKey="+eveVal.cKey;ZCL_streamEve.remUserID=eveVal.userZUID,ZCL_streamEve.parentDOM=eveParentDOMElem,ZCL_streamEve.remStTime=eveVal.st,ZCL_XHR("/cal/stream/api/private/json/eventDetails?"+urlParams,"ZCL_streamEve.constStrmEvePreview")},constStrmEvePreview:function(xml){var resultJson=ZCL_streamEve.evl(1,xml.responseText),eventJSON=resultJson.response.result.events.event,curTime=resultJson.response.result.events.curTime,isExpired=!1,isRep=eventJSON.ISRECUR,sDate=eventJSON.SD,sTime=eventJSON.ST,sHour=(sDate.substring(0,4),sDate.substring(6,8),sTime.substring(0,2)),sMin=sTime.substring(3,5),stmp=sTime.substring(6,8),smonth=parseInt(sDate.substring(4,6));smonth-=1;var todayD=new Date,sDateObj=new Date(eventJSON.STMILLIS);if(eventJSON.ETMILLIS<curTime&&0==isRep)isExpired=!0;else if(1==isRep){if(repObj=eventJSON.REPEAT,void 0!=repObj.UNTIL){var repUntil=repObj.UNTIL;isExpired=curTime>repUntil?!0:!1}else isExpired=!1;var tempD=ZCL_streamEve.remStTime;sDateObj=new Date(tempD)}else isExpired=!0;var eDate=eventJSON.ED,eTime=eventJSON.ET,eyear=eDate.substring(0,4),edate=eDate.substring(6,8),eHour=eTime.substring(0,2),eMin=eTime.substring(3,5),emonth=parseInt(eDate.substring(4,6)),isAllDay=eventJSON.ALLDAY,repObj={};emonth-=1;var eDateObj=new Date(eyear,emonth,edate);eDateObj.setHours(eHour),eDateObj.setMinutes(eMin);var ddStr,dayofWeekDic={1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",0:"Sunday"},monthofYearDic={0:"JAN",1:"FEB",2:"MAR",3:"APR",4:"MAY",5:"JUN",6:"JUL",7:"AUG",8:"SEP",9:"OCT",10:"NOV",11:"DEC"},dayOfWeek=dayofWeekDic[sDateObj.getDay()+""],domElem=ZCL_streamEve.parentDOM;ddStr="0"==isAllDay?dayOfWeek+"&nbsp;&nbsp;at&nbsp;&nbsp;"+sHour+"&nbsp;:&nbsp;"+sMin+"&nbsp;&nbsp;"+stmp:dayOfWeek;var totalAttendees=eventJSON.ATTENDEE_DETAILS.length,postDiv=domElem.appendChild(document.createElement("div"));postDiv.className="SCS_post";var postWraDiv=postDiv.appendChild(document.createElement("div"));postWraDiv.className="SCS_postWra";var postMsgDiv=postWraDiv.appendChild(document.createElement("div"));postMsgDiv.className="postMsg";var titleSpan=postMsgDiv.appendChild(document.createElement("span"));titleSpan.className="zmsEventExpired";var ttlHeader=titleSpan.appendChild(document.createElement("h3"));ttlHeader.innerHTML=eventJSON.SUM;var eBodyDiv=postMsgDiv.appendChild(document.createElement("div"));eBodyDiv.className="zmsEventPost";var eBodyWrap=eBodyDiv.appendChild(document.createElement("div"));eBodyWrap.className="zmsEventWra";var eAttDiv=eBodyDiv.appendChild(document.createElement("div"));eAttDiv.className="zmsEventAtt";var eAttCnt=eAttDiv.appendChild(document.createElement("div"));eAttCnt.innerHTML='<span class="SC_thm">&nbsp;&nbsp;'+totalAttendees+"&nbsp;&nbsp;</span>Invited";var eCal=eBodyWrap.appendChild(document.createElement("div"));eCal.className="zmsEventCal zmEventInfo zmEvExp";var eCalMon=eCal.appendChild(document.createElement("span"));eCalMon.innerHTML=monthofYearDic[sDateObj.getMonth()+""];var eCalDate=eCal.appendChild(document.createElement("span"));if(eCalDate.innerHTML=sDateObj.getDate(),isExpired&&totalAttendees>0){var expTag=eCal.appendChild(document.createElement("div"));expTag.className="zmEventTag",expTag.innerHTML="<span>Expired</span>"}var eInfo=eBodyWrap.appendChild(document.createElement("div"));eInfo.className="zmsEventDtl";var eDtInfo=eInfo.appendChild(document.createElement("div")),clkIcon=eDtInfo.appendChild(document.createElement("i"));clkIcon.className="msi-clock";var timeElem=eDtInfo.appendChild(document.createElement("strong"));timeElem.innerHTML=ddStr;var dy=document.createElement("div");dy.className="greyText",sDateObj.getFullYear()==todayD.getFullYear()&&sDateObj.getMonth()==todayD.getMonth()&&sDateObj.getDate()==todayD.getDate()&&(dy.innerHTML="Today",eDtInfo.appendChild(dy));var date1_tomorrow=new Date(todayD.getFullYear(),todayD.getMonth(),todayD.getDate()+1);date1_tomorrow.getFullYear()==sDateObj.getFullYear()&&date1_tomorrow.getMonth()==sDateObj.getMonth()&&date1_tomorrow.getDate()==sDateObj.getDate()&&(dy.innerHTML="Tomorrow",eDtInfo.appendChild(dy));var date1_overmorrow=new Date(todayD.getFullYear(),todayD.getMonth(),todayD.getDate()+2);date1_overmorrow.getFullYear()==sDateObj.getFullYear()&&date1_overmorrow.getMonth()==sDateObj.getMonth()&&date1_overmorrow.getDate()==sDateObj.getDate()&&(dy.innerHTML="2 Days from now",eDtInfo.appendChild(dy));var date1_ThreeDaysFromNow=new Date(todayD.getFullYear(),todayD.getMonth(),todayD.getDate()+3);if(date1_ThreeDaysFromNow.getFullYear()==sDateObj.getFullYear()&&date1_ThreeDaysFromNow.getMonth()==sDateObj.getMonth()&&date1_ThreeDaysFromNow.getDate()==sDateObj.getDate()&&(dy.innerHTML="3 Days from now",eDtInfo.appendChild(dy)),eventJSON.ATTENDEE_DETAILS.length>0){for(var yesCount=0,noCount=0,maybeCount=0,pendingCnt=0,cnt=eventJSON.ATTENDEE_DETAILS.length,calUID=eventJSON.CKEY,hasupdOpt=!1,curUserStst=0,a=0;cnt>a;a++){var attObj=eventJSON.ATTENDEE_DETAILS[a],attSts=parseInt(attObj.STATUS);pendingCnt=0==attSts?pendingCnt+1:pendingCnt,yesCount=1==attSts?yesCount+1:yesCount,noCount=2==attSts?noCount+1:noCount,maybeCount=3==attSts?maybeCount+1:maybeCount;var curUserId=void 0!=attObj.ZUID?attObj.ZUID:attObj.zuid;curUserId==ZCL_streamEve.remUserID&&(hasupdOpt=!0,curUserStst=attSts)}var eStsUpdDiv=eInfo.appendChild(document.createElement("div"));eStsUpdDiv.className="zmsEventAction";var preStr="Are you attending ?";preStr+=isExpired?'<ul eveid="'+eventJSON.EUID+'" class="zmsEventExpired">':'<ul eveid="'+eventJSON.EUID+'" class="zmsEvent">';var updFunc=isExpired?"":"ZCL_streamEve.updateAttStatusFrmNotification(this,'"+calUID+"')";0==curUserStst?preStr+='<li onclick="'+updFunc+'">Yes</li><li onclick="'+updFunc+'">No</li><li onclick="'+updFunc+'">Maybe</li>':1==curUserStst?preStr+='<li class="sel">Yes</li><li onclick="'+updFunc+'">No</li><li onclick="'+updFunc+'">Maybe</li>':2==curUserStst?preStr+='<li onclick="'+updFunc+'">Yes</li><li class="sel">No</li><li onclick="'+updFunc+'">Maybe</li>':3==curUserStst&&(preStr+='<li onclick="'+updFunc+'">Yes</li><li onclick="'+updFunc+'">No</li><li class="sel">Maybe</li>'),preStr+="</ul>",eStsUpdDiv.innerHTML=preStr;var eAttStsCnt=eAttDiv.appendChild(document.createElement("div"));eAttStsCnt.innerHTML='<span class="SC_thm">&nbsp;&nbsp;'+yesCount+'&nbsp;&nbsp;</span>Yes<span class="SC_SDot"></span><span class="SC_thm">&nbsp;&nbsp;'+noCount+'&nbsp;&nbsp;</span>No<span class="SC_SDot"></span><span class="SC_thm">&nbsp;&nbsp;'+maybeCount+"&nbsp;&nbsp;</span>Maybe"}},getEventElem:function(eveJson){var eDate=eveJson.events.endDateTime?eveJson.events.endDateTime:eveJson.events.endDate,isExpired=!1;isExpired=""!=ZCL_streamEve.curTimeGMT?ZCL_streamEve.eventExpired(eDate,ZCL_streamEve.curTimeGMT):ZCL_streamEve.eventExpired(eDate,eveJson.events.currTimeGMT),ZCL_streamEve.setTimeIntrvl(eveJson,isExpired);var isgrp=zmCont.isGroup(eveJson.gnrl.group.id),totalCnt=eveJson.events.attendees?eveJson.events.attendees.length:0,inviteeCnt=-1;if(isgrp){var grp=zmCont.getGroup(eveJson.gnrl.group.id);inviteeCnt=parseInt(eveJson.act.invitees)+parseInt(grp.members.length),inviteeCnt=inviteeCnt>1?inviteeCnt-1:inviteeCnt}else inviteeCnt=parseInt(eveJson.act.invitees);var dateTimeArr=ZCL_streamEve.consDateTime(eveJson),html1="<h3>"+eveJson.cntnt.title+"</h3>";if(isExpired)var html2='<div class="zmsEventPost zmsEventExpired">';else var html2='<div class="zmsEventPost">';html2+='<div class="zmsEventWra">',isExpired&&totalCnt>0?(html2+='<div class="zmsEventCal zmEventInfo zmEvExp" expTagEId = "'+eveJson.events.eventUID+'">',html2+="<span>"+dateTimeArr.MOY+"</span><span>"+dateTimeArr.DOM+'</span><div class="zmEventTag"><span>Expired</span></div></div>'):(html2+='<div class="zmsEventCal zmEventInfo" expTagEId = "'+eveJson.events.eventUID+'">',html2+="<span>"+dateTimeArr.MOY+"</span><span>"+dateTimeArr.DOM+'</span><div class="zmEventTag"><span></span></div></div>'),html2+='<div class="zmsEventDtl" id="zcl_eveDtl_'+eveJson.events.eventUID+'" ><div>',html2+='<i class="msi-clock"></i>',html2+="<strong>"+dateTimeArr.DOW+" at "+dateTimeArr.STH+":"+dateTimeArr.STM+" "+dateTimeArr.STA+"</strong>",html2+=eveJson.events.timezone&&""!=eveJson.events.timezone?'<span class="SC_SDot"></span><strong>&nbsp;'+eveJson.events.timezone+'</strong><span class="SC_SDot"></span>':"",html2+=void 0!=dateTimeArr.dayTxt?'<div class="greyText" id="zcl_dayTxt"  >'+dateTimeArr.dayTxt+"</div>":"",html2+="</div>";var locHtml=""!=eveJson.events.location?'<div><i class="msi-location"></i>'+eveJson.events.location+"</div>":"";html2+=locHtml;var yesSts=0,noSts=0,maybeSts=0,pendingSts=0;if(eveJson.events.attendees){var attArr=eveJson.events.attendees;totalCnt=attArr.length;for(var att=0;att<attArr.length;att++){var attObj=attArr[att];yesSts="Yes"==attObj.STS?yesSts+1:yesSts,noSts="No"==attObj.STS?noSts+1:noSts,maybeSts="Maybe"==attObj.STS?maybeSts+1:maybeSts,pendingSts="Pending"==attObj.STS?pendingSts+1:pendingSts}for(var i in eveJson.events.attendees)eveJson.events.attendees[i].ATT_ZUID==zmail.zuid&&totalCnt>0&&(html2+=isExpired?'<div class="zmsEventAction"> Are you attending ? <ul eveid="'+eveJson.events.eventUID+'" class="zmsEventExpired">':'<div class="zmsEventAction"> Are you attending ? <ul eveid="'+eveJson.events.eventUID+'" >',html2+=ZCL_streamEve.setEventStatus(eveJson.events.status,eveJson.events.calUID,eveJson.gnrl.owner,isExpired),html2+="</ul></div>");if(html2+="</div></div>",totalCnt>0){var attPopUpFunc="ZCL_streamEve.getAllAttendee(this,'"+eveJson.events.calUID+"','"+eveJson.events.eventUID+"')";html2+='<div class="zmsEventAtt" zclAttAllEId="'+eveJson.events.eventUID+'" >',html2+='<div id="zms_zcl_invAll" onclick = '+attPopUpFunc+'><span><span class="SC_thm" >'+totalCnt+"</span> Invited</span></div>",html2+='<div zclAttByStsEId="'+eveJson.events.eventUID+'" >',yesSts>0?html2+=1==eveJson.events.status?'<span id="acceptList" onclick='+attPopUpFunc+' ><span class="SC_thm" cuSts=true id="zcl_sts_1" >'+yesSts+'</span>&nbsp;&nbsp;Yes</span><span class="SC_SDot"></span>':'<span id="acceptList"  onclick = '+attPopUpFunc+'><span class="SC_thm" cuSts=false id="zcl_sts_1" >'+yesSts+'</span>&nbsp;&nbsp;Yes</span><span class="SC_SDot"></span>':"",noSts>0?html2+=2==eveJson.events.status?'<span id="declinedList" onclick = '+attPopUpFunc+'><span class="SC_thm" cuSts=true  id="zcl_sts_2">'+noSts+'</span>&nbsp;&nbsp;No</span><span class="SC_SDot"></span>':'<span id="declinedList" onclick = '+attPopUpFunc+'><span class="SC_thm" cuSts=false id="zcl_sts_2">'+noSts+'</span>&nbsp;&nbsp;No</span><span class="SC_SDot"></span>':"",maybeSts>0?html2+=3==eveJson.events.status?'<span id="maybeList" onclick = '+attPopUpFunc+'><span class="SC_thm" cuSts=true id="zcl_sts_3" >'+maybeSts+'</span>&nbsp;&nbsp;Maybe</span><span class="SC_SDot"></span>':'<span id="maybeList" onclick = '+attPopUpFunc+'><span class="SC_thm" cuSts=false id="zcl_sts_3" >'+maybeSts+'</span>&nbsp;&nbsp;Maybe</span><span class="SC_SDot"></span>':"",pendingSts>0?html2+=0==eveJson.events.status?'<span id="pendingList" onclick = '+attPopUpFunc+'><span class="SC_thm" cuSts=true id="zcl_sts_0">'+pendingSts+"</span>&nbsp;&nbsp;pending</span>":'<span id="pendingList" onclick = '+attPopUpFunc+'><span class="SC_thm" cuSts=false id="zcl_sts_0">'+pendingSts+"</span>&nbsp;&nbsp;Pending</span>":"",html2+="</div>",html2+="</div>"}}html2+="</div>",html2+="</div>";var frag=document.createDocumentFragment(),spanElem=document.createElement("span");isExpired&&(spanElem.className="zmsEventExpired"),spanElem.innerHTML=html1,frag.appendChild(spanElem);var divElem=document.createElement("div");return divElem.className="Sevent_list",divElem.innerHTML=html2,frag.appendChild(divElem),frag},clSrchAtt:function(){var srAttElem=ZCL_$("zmsSrchAttList");srAttElem.innerHTML="",srAttElem.style.display="block",ZCL_$("SC_PUcen_ZCL_AttList").childNodes[0].childNodes.length>0?(ZCL_$("SC_PUcen_ZCL_Srch").style.display="none",ZCL_$("zcl_msgcontent").style.display="none",ZCL_$("SC_PUcen_ZCL_AttList").style.display="block"):(ZCL_$("SC_PUcen_ZCL_Srch").style.display="block",ZCL_$("zcl_msgcontent").innerHTML="No entries yet",ZCL_$("zcl_msgcontent").style.display="block",ZCL_$("SC_PUcen_ZCL_AttList").style.display="none")},showAttMsg:function(msgContent){void 0!=ZCL_$("SC_PUcen_ZCL_AttList")&&(ZCL_$("SC_PUcen_ZCL_AttList").style.display="none");var msgDiv=ZCL_$("zcl_msgcontent"),srAttElem=ZCL_$("zmsSrchAttList");void 0!=srAttElem&&(srAttElem.style.display="none"),ZCL_$("SC_PUcen_ZCL_Srch").style.display="block",msgDiv.style.display="block",msgDiv.innerHTML=msgContent},searchAtt:function(n,e){var txt=n.value.trim(),ulObj=ZCL_$("zcl_attStsTab"),cTb=ulObj.getAttribute("cTab"),shwOnlySts="";if("zcl_all"==cTb?shwOnlySts="":"zcl_yes"==cTb?shwOnlySts="msi-like":"zcl_no"==cTb?shwOnlySts="msi-no":"zcl_myb"==cTb?shwOnlySts="msi-maybe":"zcl_pending"==cTb&&(shwOnlySts="msi-pending"),"keydown"==e.type&&9==e.keyCode&&""==txt)return ZCL_streamEve.clSrchAtt(),0;if("blur"==e.type&&(e.target.parentNode.className="SC_sch"),"focus"==e.type&&(e.target.parentNode.className="SC_sch inputFocus"),8==e.keyCode&&ZCL_streamEve.clSrchAtt(),""==txt)return ZCL_streamEve.clSrchAtt(),0;if(""!=txt){if(27==e.keyCode)return ZCL_streamEve.clSrchAtt(),n.value="",0;var stWithTxt=n.value.charAt(0),tempObj=ZCL_streamEve.curAttendeeList.emlList,msgContent="No matches for this search. Try again",view=ZCL_$("SC_PUcen_ZCL_Srch");if(void 0!=tempObj[stWithTxt]){var tempArr=tempObj[stWithTxt];if(tempArr.length>0){var cnt=0,ulEle=ZCL_$("zmsSrchAttList");ulEle.innerHTML="";for(var i=0;i<tempArr.length;i++){var tempEml=tempArr[i].email,userObj=tempArr[i];if(tempEml.startsWith(txt)&&(shwOnlySts==tempArr[i].stsclass||""==shwOnlySts)){cnt++;var liDom=_zm.getDOM(["LI",{child:[["DIV",{attrs:{"class":"SC_avtr"},child:[["IMG",{attrs:{src:userObj.photo}}]]}],["text","&nbsp;&nbsp;"+userObj.email],["SPAN",{child:[["i",{attrs:{"class":userObj.stsclass}}]]}]]}]);ulEle.appendChild(liDom)}}return ulEle.childNodes.length>0?(ZCL_$("SC_PUcen_ZCL_AttList").style.display="none",cnt>8&&(view.style.height="400px"),view.appendChild(ulEle),view.style.display="block",0):(ZCL_streamEve.showAttMsg(msgContent),0)}return ZCL_streamEve.showAttMsg(msgContent),0}return ZCL_streamEve.showAttMsg(msgContent),0}return 0},addEml:function(userObj){var email=userObj.email,stChar=email.charAt(0),tempObj=ZCL_streamEve.curAttendeeList.emlList;if(void 0!=tempObj[stChar]){var tempArr=tempObj[stChar];tempArr.length>0?tempArr[tempArr.length]=userObj:(tempArr=new Array,tempArr[0]=userObj),tempObj[stChar]=tempArr}else{var tempArr=new Array;tempArr[0]=userObj,tempObj[stChar]=tempArr}},getAttendeesHtml:function(orgCont,finalJson,addBy,attEle){{var attListDiv=$("<div class='SC_PUcen' id='SC_PUcen_ZCL_AttList'>"),cnt=0,ulEle=$("<ul class='zmsEventList zmListReset' id='zmsattList'>");new Array}ZCL_streamEve.curAttendeeList.acceptList=new Array,ZCL_streamEve.curAttendeeList.declinedList=new Array,ZCL_streamEve.curAttendeeList.maybeList=new Array,ZCL_streamEve.curAttendeeList.pendingList=new Array,ZCL_streamEve.curAttendeeList.all=new Array,ZCL_streamEve.curAttendeeList.emlList={};for(var i in finalJson){var status=finalJson[i].STS,attZuid=finalJson[i].ATT_ZUID+"",attStsCls="";Object.keys(orgCont).length>0&&orgCont.hasOwnProperty(attZuid)&&(finalJson[i].photo="undefined"!=attZuid?orgCont[attZuid].photo:zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"),finalJson[i].email=finalJson[i].AID,"Yes"==status?(attStsCls="msi-like",finalJson[i].stsclass=attStsCls,ZCL_streamEve.curAttendeeList.acceptList[ZCL_streamEve.curAttendeeList.acceptList.length]=finalJson[i]):"No"==status?(attStsCls="msi-unlike",finalJson[i].stsclass=attStsCls,ZCL_streamEve.curAttendeeList.declinedList[ZCL_streamEve.curAttendeeList.declinedList.length]=finalJson[i]):"Maybe"==status?(attStsCls="msi-maybe",finalJson[i].stsclass=attStsCls,ZCL_streamEve.curAttendeeList.maybeList[ZCL_streamEve.curAttendeeList.maybeList.length]=finalJson[i]):"Pending"==status&&(attStsCls="msi-pending",finalJson[i].stsclass=attStsCls,ZCL_streamEve.curAttendeeList.pendingList[ZCL_streamEve.curAttendeeList.pendingList.length]=finalJson[i]),ZCL_streamEve.addEml(finalJson[i]),ZCL_streamEve.curAttendeeList.all[ZCL_streamEve.curAttendeeList.all.length]=finalJson[i])}var selectedSts="zms_zcl_invAll"==addBy?finalJson:ZCL_streamEve.curAttendeeList[addBy],ulObj=ZCL_$("zms_attView").childNodes[0].childNodes[1];ZCL_$("zcl_attSearch").value="","acceptList"==addBy?(finalJson=ZCL_streamEve.curAttendeeList.acceptList,attStsCls="msi-like",ulObj.setAttribute("cTab","zcl_yes")):"declinedList"==addBy?(finalJson=ZCL_streamEve.curAttendeeList.declinedList,attStsCls="msi-unlike",ulObj.setAttribute("cTab","zcl_no")):"maybeList"==addBy?(finalJson=ZCL_streamEve.curAttendeeList.maybeList,attStsCls="msi-maybe",ulObj.setAttribute("cTab","zcl_myb")):"pendingList"==addBy?(finalJson=ZCL_streamEve.curAttendeeList.pendingList,attStsCls="msi-pending",ulObj.setAttribute("cTab","zcl_pending")):"zms_zcl_invAll"==addBy&&(finalJson=ZCL_streamEve.curAttendeeList.all,attStsCls="all",ulObj.setAttribute("cTab","zcl_all"));for(var k in selectedSts){var attStsCls=selectedSts[k].stsclass,attZuid=selectedSts[k].ATT_ZUID+"";if(Object.keys(orgCont).length>0&&orgCont.hasOwnProperty(attZuid)){var attEmailId=void 0!=selectedSts[k].ATT_ZUID&&""!=orgCont[attZuid].eid?orgCont[attZuid].eid:selectedSts[k].email,photo=void 0!=selectedSts[k].ATT_ZUID?orgCont[attZuid].photo:zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"),liDom=_zm.getDOM(["LI",{child:[["DIV",{attrs:{"class":"SC_avtr"},child:[["IMG",{attrs:{src:photo}}]]}],["text","&nbsp;&nbsp;"+attEmailId],["SPAN",{child:[["i",{attrs:{"class":attStsCls}}]]}]]}]);ulEle.append(liDom),cnt++,delete orgCont[attZuid]}}attListDiv.append(ulEle),attEle.append(attListDiv);var srchDiv=document.createElement("div");srchDiv.id="SC_PUcen_ZCL_Srch",srchDiv.setAttribute("class","SC_PUcen");var msgDiv=document.createElement("div");msgDiv.id="zcl_msgcontent",msgDiv.setAttribute("class","SC_nmsg"),msgDiv.style.display="none";var msgTxt="No matches for this search. Try again";msgDiv.innerHTML=msgTxt;var srchList=document.createElement("ul");if(srchList.id="zmsSrchAttList",srchList.setAttribute("class","zmsEventList"),srchDiv.appendChild(msgDiv),srchDiv.appendChild(srchList),srchDiv.setAttribute("display","none"),attEle.append(srchDiv),cnt>8)attListDiv.height(400);else if(0==cnt){var msg="No entries yet";ZCL_streamEve.showAttMsg(msg)}return attListDiv},afterGetAllAttn:function(xml){var resultJson=ZCL_streamEve.evl(1,xml.responseText),result=resultJson.response.result,respObj=result.response,spanElem=ZCL_streamEve.allAttnElem,grpId=spanElem.getAttribute("attrgrpid"),addBy=spanElem.id,zuids=(zmCont.isGroup(grpId),""),cnt=0,yesCnt=0,noCnt=0,mybCnt=0,penCnt=0,emailid="";for(var j in respObj)""==zuids?zuids=respObj[j].ATT_ZUID+"":zuids+=","+respObj[j].ATT_ZUID,yesCnt="Yes"==respObj[j].STS?yesCnt+1:yesCnt,noCnt="No"==respObj[j].STS?noCnt+1:noCnt,mybCnt="Maybe"==respObj[j].STS?mybCnt+1:mybCnt,penCnt="Pending"==respObj[j].STS?penCnt+1:penCnt,cnt++;for(var i in respObj)""==emailid?emailid=respObj[i].AID+"":emailid+=","+respObj[i].AID;if(ZCL_streamEve.isAttReqInvoked=!0,cnt>0){var attEle;ZCL_$("zms_attView")?$("#zms_attView").innerHTML="":$("body").append("<div id='zms_attView' class='SU_PU'/>"),attEle=$("#zms_attView");var zuidArr=[];for(var n in respObj)respObj[n].hasOwnProperty("ATT_ZUID")&&zuidArr.push(respObj[n].ATT_ZUID.toString());var conObj,obj={promise:!0,zuid:zuidArr},defObj=zmail.ContactBook.get(obj);defObj.done(function(res){conObj=res});var orgCont={};for(var i in conObj){var zid=conObj[i].attrs.zid;orgCont[zid]=conObj[i].attrs}var attHeaderHtml=$("<div class='SC_PUtt'>"),hm="",hm="<div class='SC_sch'><i class='msi-search'></i><input id='zcl_attSearch' onfocus=ZCL_streamEve.searchAtt(this,event)  onkeyup=ZCL_streamEve.searchAtt(this,event) onblur = ZCL_streamEve.searchAtt(this,event) type='text' placeholder='Search Guest'  style='width:380px;'></div>";hm+="<ul class='SCS_tab' id='zcl_attStsTab' cTab='zcl_all' >",hm+="zms_zcl_invAll"==addBy?"<li class='stSel' onclick=ZCL_streamEve.showList('all',this) id='zcl_selall' >Invited(&nbsp;"+cnt+"&nbsp;)</li>":"<li onclick=ZCL_streamEve.showList('all',this) id='zcl_selall' >Invited(&nbsp;"+cnt+"&nbsp;)</li>",hm+=0==yesCnt?"":"acceptList"==addBy?"<li onclick=ZCL_streamEve.showList('yes',this) class='stSel' id='zcl_selyes'>Yes(&nbsp;"+yesCnt+"&nbsp;)</li>":"<li onclick=ZCL_streamEve.showList('yes',this) id='zcl_selyes'>Yes(&nbsp;"+yesCnt+"&nbsp;)</li>",hm+=0==noCnt?"":"declinedList"==addBy?"<li onclick=ZCL_streamEve.showList('no',this) class='stSel' id='zcl_selno'>No(&nbsp;"+noCnt+"&nbsp;)</li>":"<li onclick=ZCL_streamEve.showList('no',this) id='zcl_selno'>No(&nbsp;"+noCnt+"&nbsp;)</li>",hm+=0==mybCnt?"":"maybeList"==addBy?"<li onclick=ZCL_streamEve.showList('maybe',this) class='stSel' id='zcl_selmyb'>Maybe(&nbsp;"+mybCnt+"&nbsp;)</li> ":"<li onclick=ZCL_streamEve.showList('maybe',this) id='zcl_selmyb'>Maybe(&nbsp;"+mybCnt+"&nbsp;)</li> ",hm+=0==penCnt?"":"pendingList"==addBy?"<li onclick=ZCL_streamEve.showList('pending',this) class='stSel' id='zcl_selpnd'>Pending(&nbsp;"+penCnt+"&nbsp;)</li>":"<li onclick=ZCL_streamEve.showList('pending',this) id='zcl_selpnd'>Pending(&nbsp;"+penCnt+"&nbsp;)</li>",hm+="</ul>",attHeaderHtml.append(hm),attEle.append(attHeaderHtml),ZCL_streamEve.getAttendeesHtml(orgCont,respObj,addBy,attEle);{Dialog.new({title:"Invitees",$content:attEle,defaultCloseIcon:!0,closeAction:function(){ZCL_streamEve.cleanStrmCalInfo()}})}}},cleanStrmCalInfo:function(){ZCL_streamEve.curAttendeeList={}},constrctAttList:function(finalJson){{var ulEle=$("<ul class='zmsEventList zmListReset'  id='zmsattList'>");new Array}for(var i in finalJson){var attStsCls=(finalJson[i].STS,finalJson[i].ATT_ZUID+"",finalJson[i].stsclass),liDom=_zm.getDOM(["LI",{child:[["DIV",{attrs:{"class":"SC_avtr"},child:[["IMG",{attrs:{src:finalJson[i].photo}}]]}],["text","&nbsp;&nbsp;"+finalJson[i].email],["SPAN",{child:[["i",{attrs:{"class":attStsCls}}]]}]]}]);ulEle.append(liDom)}return ulEle},showList:function(attSts,ele){var finalJson;ZCL_streamEve.clSrchAtt(),ZCL_$("SC_PUcen_ZCL_Srch").style.display="none",ZCL_$("SC_PUcen_ZCL_AttList").style.display="block";var ulObj=ZCL_$("zms_attView").childNodes[0].childNodes[1];ZCL_$("zcl_attSearch").value="","yes"==attSts?(finalJson=ZCL_streamEve.curAttendeeList.acceptList,attStsCls="msi-like",ulObj.setAttribute("cTab","zcl_yes")):"no"==attSts?(finalJson=ZCL_streamEve.curAttendeeList.declinedList,attStsCls="msi-unlike",ulObj.setAttribute("cTab","zcl_no")):"maybe"==attSts?(finalJson=ZCL_streamEve.curAttendeeList.maybeList,attStsCls="msi-maybe",ulObj.setAttribute("cTab","zcl_myb")):"pending"==attSts?(finalJson=ZCL_streamEve.curAttendeeList.pendingList,attStsCls="msi-pending",ulObj.setAttribute("cTab","zcl_pending")):"all"==attSts&&(finalJson=ZCL_streamEve.curAttendeeList.all,attStsCls="all",ulObj.setAttribute("cTab","zcl_all"));var zuids="";for(var j in finalJson)""==zuids?zuids=finalJson[j].ATT_ZUID+"":zuids+=","+finalJson[j].ATT_ZUID;for(var orgCont=zmCont.getOrgContacts(zuids),liArr=ZCL_$("zms_attView").childNodes[0].childNodes[1].getElementsByTagName("li"),item=0;item<liArr.length;item++){var liObj=liArr[item];liObj.className=liObj.id!=ele.id?"":"stSel"}var view=ZCL_$("zms_attView").childNodes[1];view.innerHTML="";var attHtml=ZCL_streamEve.constrctAttList(finalJson,orgCont),attEle=$("#SC_PUcen_ZCL_AttList"),cnt=finalJson.length;if(cnt>8)attEle.height(400);else if(0==cnt){var msg="No entries yet";ZCL_streamEve.showAttMsg(msg)}attEle.append(attHtml)},afterUpdateAttn:function(xml){var resultJson=ZCL_streamEve.evl(1,xml.responseText),result=resultJson.response.result,status=result.status,message=result.message,usts=result.eventstatus,tmpCnt=1;if("1"==status){for(var ulElems=document.querySelectorAll('[eveid="'+result.eventKey+'"]'),i=0;i<ulElems.length;i++){var liElemId=ulElems[i].getAttribute("eveid");if(result.eventKey==liElemId)for(var liElems=ulElems[i].childNodes,j=0;j<liElems.length;j++)tmpCnt==result.eventstatus?liElems[j].className="sel":liElems[j].removeAttribute("class"),tmpCnt++}for(var divElems=document.querySelectorAll('[zclAttByStsEId="'+result.eventKey+'"'),ele=0;ele<divElems.length;ele++)for(var spanElems=divElems[ele].childNodes,sEle=0;sEle<spanElems.length;sEle++)if(spanElems[sEle].childNodes.length>0){var spanChild=spanElems[sEle].childNodes[0],aVal=spanChild.getAttribute("custs");"false"==aVal&&spanChild.id=="zcl_sts_"+usts?(spanChild.innerHTML=parseInt(spanChild.innerHTML)+1,spanChild.setAttribute("custs",!0)):0!=parseInt(spanChild.innerHTML)&&"true"==spanChild.getAttribute("custs")&&(spanChild.innerHTML=parseInt(spanChild.innerHTML)-1,spanChild.setAttribute("custs",!1))}zmUtil.succErrMsg("s",message)}else if(-1!=message.indexOf("Event is expired")){for(var ulElems=document.querySelectorAll('[eveid="'+result.eventKey+'"]'),i=0;i<ulElems.length;i++){var liElemId=ulElems[i].getAttribute("eveid");if(ulElems[i].className="eventExpired",result.eventKey==liElemId)for(var liElems=ulElems[i].childNodes,j=0;j<liElems.length;j++)liElems[j].removeAttribute("onclick")}zmUtil.succErrMsg("e",message)}else zmUtil.succErrMsg("e",message)},setEventStatus:function(status,calUID,isOwner,isExpired){var html="",style="sel",updFunc=isExpired?"":"ZCL_streamEve.updateAttendeeStatus(this,'"+calUID+"')";return html+="-1"==status&&isOwner||"1"==status?'<li class="'+style+'" onclick="'+updFunc+'">Yes</li>':'<li onclick="'+updFunc+'">Yes</li>',html+="2"==status?'<li class="'+style+'" onclick="'+updFunc+'">No</li>':'<li onclick="'+updFunc+'">No</li>',html+="3"==status?'<li class="'+style+'" onclick="'+updFunc+'">Maybe</li>':'<li onclick="'+updFunc+'">Maybe</li>'},get_whole_values:function(base_value,time_fractions){for(time_data=[base_value],i=0;i<time_fractions.length;i++)time_data.push(parseInt(time_data[i]/time_fractions[i])),time_data[i]=time_data[i]%time_fractions[i];return time_data},millisToTime:function(duration){var seconds=parseInt(duration/1e3%60),minutes=parseInt(duration/6e4%60),hours=parseInt(duration/36e5%24),days=parseInt(duration/864e5),hoursDays=parseInt(24*days);return hours+=hoursDays,hours=10>hours?"0"+hours:hours,minutes=10>minutes?"0"+minutes:minutes,seconds=10>seconds?"0"+seconds:seconds,hours+":"+minutes+":"+seconds},checkEventExpire:function(){for(var keys=Object.keys(ZCL_streamEve.timeObj),i=0;i<keys.length;i++){var eveId=keys[i],ulElems=document.querySelectorAll('[eveid="'+eveId+'"]');if(ulElems.length>0){var eveTime=ZCL_streamEve.timeObj[eveId];if(eveTime[1]<ZCL_streamEve.curTimeGMT){for(var ulElems=document.querySelectorAll('[eveid="'+eveId+'"]'),isAtt=!1,j=0;j<ulElems.length;j++){var liElemId=ulElems[j].getAttribute("eveid");if(ulElems[j].className="zmsEventExpired",eveId==liElemId)for(var liElems=ulElems[j].childNodes,k=0;k<liElems.length;k++)liElems[k].removeAttribute("onclick"),isAtt=!0;delete ZCL_streamEve.timeObj[eveId]}if(isAtt){var expTagDiv=document.querySelectorAll('[expTagEId="'+eveId+'"]');expTagDiv[0].className="zmsEventCal zmEventInfo zmEvExp",expTagDiv[0].childNodes[2].childNodes[0].innerHTML="Expired"}var sTime=new Date(eveTime[0]),eTime=new Date(eveTime[1]),strTime=ZCL_streamEve.getCurrDateDispStr(sTime,eTime,ZCL_streamEve.curTimeGMT),dayTxtDiv=document.getElementById("zcl_eveDtl_"+eveId);dayTxtDiv.childNodes[0].childNodes[5].innerHTML=strTime}else{var sTime=new Date(eveTime[0]),eTime=new Date(eveTime[1]),strTime=ZCL_streamEve.getCurrDateDispStr(sTime,eTime,ZCL_streamEve.curTimeGMT),dayTxtDiv=document.getElementById("zcl_eveDtl_"+eveId);dayTxtDiv.childNodes[0].childNodes[5].innerHTML=strTime}}else delete ZCL_streamEve.timeObj[eveId]}var keys=Object.keys(ZCL_streamEve.timeObj);0==keys.length&&ZCL_streamEve.clearTimeIntrvl()},consDateTime:function(eveJson){var stDate="",eDate="",datePtrn=/((19|20)[0-9][0-9])(0[1-9]|1[0-2])(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/,dayofWeekDic={1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",0:"Sunday"},monthofYearDic={0:"JAN",1:"FEB",2:"MAR",3:"APR",4:"MAY",5:"JUN",6:"JUL",7:"AUG",8:"SEP",9:"OCT",10:"NOV",11:"DEC"},dayOfWeek="",monOfYear="",dayOfMonth="",sDateObj=new Date,eDateObj=new Date;if(datePtrn.test(eveJson.events.startDate)&&datePtrn.test(eveJson.events.endDate)||datePtrn.test(eveJson.events.startDateTime)&&datePtrn.test(eveJson.events.endDateTime)){var sDate=datePtrn.test(eveJson.events.startDateTime)?eveJson.events.startDateTime:eveJson.events.startDate,eDate=datePtrn.test(eveJson.events.endDateTime)?eveJson.events.endDateTime:eveJson.events.endDate,syear=sDate.substring(0,4),sdate=sDate.substring(6,8),smonth=sDate.substring(4,6);stDate=sdate+"/"+smonth+"/"+syear;var eyear=eDate.substring(0,4),edate=eDate.substring(6,8),emonth=eDate.substring(4,6);eDate=edate+"/"+emonth+"/"+eyear;var sd=new Date;sd.setTime(sDate),sDateObj=new Date(syear,smonth-1,sdate),eDateObj=new Date(eyear,emonth-1,edate)}else{var sDate=eveJson.events.startDateTime?eveJson.events.startDateTime:eveJson.events.startDate,eDate=eveJson.events.endDateTime?eveJson.events.endDateTime:eveJson.events.endDate,sd=new Date;sd.setTime(sDate);var sdate=sd.getDate(),smonth=sd.getMonth()+1,syear=sd.getFullYear();sdate=10>sdate?"0"+sdate:sdate,smonth=10>smonth?"0"+smonth:smonth,stDate=sdate+"/"+smonth+"/"+syear;var ed=new Date;ed.setTime(eDate);var edate=ed.getDate(),emonth=ed.getMonth()+1,eyear=ed.getFullYear();edate=10>edate?"0"+edate:edate,emonth=10>emonth?"0"+emonth:emonth,eDate=edate+"/"+emonth+"/"+eyear,sDateObj=new Date(syear,smonth-1,sdate),eDateObj=new Date(eyear,emonth-1,edate)}var sTime=ZCL_streamEve.correctTimeFormat(eveJson.events.startTime),eTime=ZCL_streamEve.correctTimeFormat(eveJson.events.endTime),stTime=ZCL_streamEve.parseTime(sTime),etTime=ZCL_streamEve.parseTime(eTime),finalStTime=stTime.hh+":"+stTime.mm+" "+stTime.a,finalEtime=etTime.hh+":"+etTime.mm+" "+etTime.a,finalDate="",time="";sDateObj.setHours(stTime.HH),sDateObj.setMinutes(stTime.mm),dayOfWeek=dayofWeekDic[sDateObj.getDay()+""],monOfYear=monthofYearDic[sDateObj.getMonth()+""],dayOfMonth=sDateObj.getDate(),eDateObj.setHours(etTime.HH),eDateObj.setMinutes(etTime.mm),stDate==eDate||eveJson.events.allDay?stDate!=eDate||eveJson.events.allDay?stDate!=eDate&&eveJson.events.allDay?finalDate=stDate+"&nbsp;to&nbsp;"+eDate:stDate==eDate&&eveJson.events.allDay&&(finalDate=stDate):(finalDate=stDate,time=finalStTime+"&nbsp;to&nbsp;"+finalEtime):(finalDate=stDate+"&nbsp;to&nbsp;"+eDate,time=finalStTime+"&nbsp;to&nbsp;"+finalEtime);var params=new Array;params.DATE=finalDate,params.TIME=time,params.DOW=dayOfWeek,params.MOY=monOfYear,params.DOM=dayOfMonth,params.STH=stTime.hh,params.STM=stTime.mm,params.STA=stTime.a;var todayD=new Date;if(sDateObj.getFullYear()==todayD.getFullYear()&&sDateObj.getMonth()==todayD.getMonth()&&sDateObj.getDate()==todayD.getDate()){var curTime=""!=ZCL_streamEve.curTimeGMT?ZCL_streamEve.curTimeGMT:eveJson.events.currTimeGMT;params.dayTxt=ZCL_streamEve.getCurrDateDispStr(sDateObj,eDateObj,curTime)}var date1_tomorrow=new Date(todayD.getFullYear(),todayD.getMonth(),todayD.getDate()+1);date1_tomorrow.getFullYear()==sDateObj.getFullYear()&&date1_tomorrow.getMonth()==sDateObj.getMonth()&&date1_tomorrow.getDate()==sDateObj.getDate()&&(params.dayTxt="Tomorrow");var date1_overmorrow=new Date(todayD.getFullYear(),todayD.getMonth(),todayD.getDate()+2);date1_overmorrow.getFullYear()==sDateObj.getFullYear()&&date1_overmorrow.getMonth()==sDateObj.getMonth()&&date1_overmorrow.getDate()==sDateObj.getDate()&&(params.dayTxt="2 Days from now");var date1_ThreeDaysFromNow=new Date(todayD.getFullYear(),todayD.getMonth(),todayD.getDate()+3);return date1_ThreeDaysFromNow.getFullYear()==sDateObj.getFullYear()&&date1_ThreeDaysFromNow.getMonth()==sDateObj.getMonth()&&date1_ThreeDaysFromNow.getDate()==sDateObj.getDate()&&(params.dayTxt="3 Days from now"),params},getCurrDateDispStr:function(sTime,eTime,curTime){var cTime=new Date(curTime),strTime="";if(eTime>=cTime&&cTime>=sTime){var bTime=ZCL_streamEve.millisToTime(cTime-sTime),bTimeArr=bTime.split(":");if(strTime="Started before ","00"!=bTimeArr[0]&&(strTime+=parseInt(bTimeArr[0])+" hours"),"00"!=bTimeArr[1]){var minStr=parseInt(bTimeArr[1])+" minutes";strTime+=""!=strTime?" "+minStr:minStr}}else if(cTime.getDate()==sTime.getDate()&&sTime>=cTime){var aTime=ZCL_streamEve.millisToTime(sTime-cTime),aTimeArr=aTime.split(":");if(strTime="Starts in ","00"!=aTimeArr[0]&&(strTime+=parseInt(aTimeArr[0])+" hours"),"00"!=aTimeArr[1]){var minStr=parseInt(aTimeArr[1])+" minutes";strTime+=""!=strTime?" "+minStr:minStr}}else if(cTime.getDate()==eTime.getDate()&&cTime>=eTime){var aTime=ZCL_streamEve.millisToTime(cTime-eTime),aTimeArr=aTime.split(":"),min=0==eTime.getMinutes()?"":":"+eTime.getMinutes(),hour=0==eTime.getHours()?12+min+" am":12==eTime.getHours()?eTime.getHours()+" "+min+" pm":eTime.getHours()>12?eTime.getHours()-12+" "+min+" pm":eTime.getHours()+" "+min+" am";strTime="Event ended at ",strTime+=""!=strTime?hour:hour}else strTime="Today";return strTime},Sm_ComposeEventBoxcon:function(dom,cmpId){var div=$(dom),smartCom=$('<div class="Sevent_update SC_e" id="ScEvent_'+cmpId+'">');smartCom.append('<div class="Sevent_data"><span id="scDate_span"><i class="msi-calendar"></i><input type="text" placeholder="Date" id = "SC_eventDate"></span><i class="msi-clock"></i><span style="border:none;" class="zcal_time zcal_nbr" id="scTime"><input type="text" placeholder="Time" id="SC_eventTime"></span><i class="msi-duration"></i><span class="zcal_time zcal_nbr" id="SCeventDur_span"><input onclick="ZCL_streamEve.setEventDurDropdwn(event,this)" type="text" value="00:30 Min" id="SC_eventDur" placeholder="Duration"></span><i class="msi-location"></i><input type="text" placeholder="Choose Location" id="SC_eventLoc"></div>'),div.find(".zmScContent").after(smartCom),ZCL_streamEve.initDateTimePicker(smartCom[0].firstChild.firstChild,smartCom[0].firstChild.childNodes[2])},Sm_ComposeAddStreamEvent:function(dataObj){ZCL_streamEve.dataObj=dataObj;var emails="";for(var i in dataObj.attendees)emails+=""==emails?dataObj.attendees[i]:","+dataObj.attendees[i];var paramsArr=new Array,eventDate=ZCL_$("SC_eventDate").value,stTime=ZCL_$("SC_eventTime").value,duration=ZCL_$("SC_eventDur").value,location=ZCL_$("SC_eventLoc").value;paramsArr=ZCL_streamEve.calcEventTime(eventDate,stTime,duration);var urlParams="sum="+encodeURIComponent(dataObj.title)+"&sday="+paramsArr.ST_DATE+"&smonth="+paramsArr.ST_MONTH+"&syear="+paramsArr.ST_YEAR+"&shour="+paramsArr.ST_HOUR+"&smin="+paramsArr.ST_MIN+"&eday="+paramsArr.END_DATE+"&emonth="+paramsArr.END_MONTH+"&eyear="+paramsArr.END_YEAR+"&ehour="+paramsArr.END_HOUR+"&emin="+paramsArr.END_MIN+"&loc="+encodeURIComponent(location)+"&zgid="+dataObj.groupId+"&att="+emails+"&lckInv="+dataObj.lckInv;if(void 0!=dataObj.inv_allMem){var sendInv=dataObj.inv_allMem;urlParams+="&inv_allMem="+sendInv}ZCL_XHR("/cal/stream/api/private/json/addEvent?"+urlParams,"ZCL_streamEve.afterSubEvent")},afterSubEvent:function(xml){{var resultJson=ZCL_streamEve.evl(1,xml.responseText);resultJson.response.result}"success"==resultJson.response.result.status?ZCL_streamEve.dataObj.onSuccess():(Errmsg="err_nostreamadd"==resultJson.response.error?"Problem in adding event":resultJson.response.error.message?resultJson.response.error.message:resultJson.response.error,ZCL_streamEve.dataObj.onFailure(Errmsg))}};ZCL_dputDate=function(s){var df=zcal.DATEFORMAT[zcal.cdata.opt.DF],dd=s.substring(6,8),MM=s.substring(4,6),yyyy=s.substring(0,4);return df.replace("dd",dd).replace("MM",MM).replace("yyyy",yyyy)};var dataObj=[],ZCL_groupPolicy={parentDOM:"",type:"0",grpId:"",idArr:["zclApprEveCre","zclCalShPri","zclSndInv","zclRestOvrlpEve","zclGrpNtfy"],constGroupPolicy:function(xml){var respon=ZCL_streamEve.evl(1,xml.responseText),optnArr=(respon.message.adminOptions.RESTRICT_OVERLAP,respon.message.adminOptions.INVITATION_NONGROUP,respon.message.adminOptions.APPROVAL_CREATION,respon.message.adminOptions.APPROVAL_CAL_SUBS,respon.message.adminOptions.GROUP_NOTIFY,[respon.message.adminOptions.APPROVAL_CREATION,respon.message.adminOptions.APPROVAL_CAL_SUBS,respon.message.adminOptions.INVITATION_NONGROUP,respon.message.adminOptions.RESTRICT_OVERLAP,respon.message.adminOptions.GROUP_NOTIFY]),zcl_orgGP='{"APPROVAL_CREATION":[{"0":"'+zcal.i18n.allow_label+'"},{"1":"'+zcal.i18n.needappr+'"}],"APPROVAL_CAL_SUBS":[{"1":"'+zcal.i18n.yes+'"},{"0":"'+zcal.i18n.no+'"},{"2":"'+zcal.i18n.needappr+'"}],"INVITATION_NONGROUP":[{"3":"'+zcal.i18n.allow_label+'"},{"1":"'+zcal.i18n.onlymem+'"},{"2":"'+zcal.i18n.orgmem+'"}],"RESTRICT_OVERLAP":[{"0":"'+zcal.i18n.allow_label+'"},{"1":"'+zcal.i18n.dontallow_label+'"}],"GROUP_NOTIFY":[{"1":"'+zcal.i18n.yes+'"},{"0":"'+zcal.i18n.no+'"}]}',zcl_perGP='{"APPROVAL_CREATION":[{"0":"'+zcal.i18n.allow_label+'"},{"1":"'+zcal.i18n.needappr+'"}],"APPROVAL_CAL_SUBS":[{"1":"'+zcal.i18n.yes+'"},{"0":"'+zcal.i18n.no+'"},{"2":"'+zcal.i18n.needappr+'"}],"INVITATION_NONGROUP":[{"3":"'+zcal.i18n.allow_label+'"},{"1":"'+zcal.i18n.onlymem+'"}],"RESTRICT_OVERLAP":[{"0":"'+zcal.i18n.allow_label+'"},{"1":"'+zcal.i18n.dontallow_label+'"}],"GROUP_NOTIFY":[{"1":"'+zcal.i18n.yes+'"},{"0":"'+zcal.i18n.no+'"}]}',zcl_dispNames='{"RESTRICT_OVERLAP":"'+zcal.i18n.restoverlap+'","INVITATION_NONGROUP":"'+zcal.i18n.sendinvi+'","APPROVAL_CREATION":"'+zcal.i18n.apprevent+'","APPROVAL_CAL_SUBS":"'+zcal.i18n.calsharingpriv+'","GROUP_NOTIFY":"'+zcal.i18n.groupnotify+'"}',zcl_opVal="0"==ZCL_groupPolicy.type?ZCL_Evl("1",zcl_perGP):ZCL_Evl("1",zcl_orgGP);zcl_dispNames=ZCL_Evl("1",zcl_dispNames);var zcl_keyList=Object.keys(zcl_opVal),parntDiv=ZCL_groupPolicy.parentDOM;parntDiv.innerHTML="";var grpSetDiv=parntDiv.appendChild(document.createElement("div"));for(grpSetDiv.className="zmTableCss",i=0;i<zcl_keyList.length;i++){var _rwDiv=grpSetDiv.appendChild(document.createElement("div"));_rwDiv.className="zmTableTr",_rwDiv.id=ZCL_groupPolicy.idArr[i],_rwDiv.setAttribute("rel",optnArr[i]);var _clDiv=_rwDiv.appendChild(document.createElement("div"));_clDiv.className="zmTableTd",_clDiv.innerHTML=0==i?"<label>"+zcl_dispNames[zcl_keyList[i]]+"*</label>":"<label>"+zcl_dispNames[zcl_keyList[i]]+"</label>";var zcl_opObj=zcl_opVal[zcl_keyList[i]],_clOpDiv=_rwDiv.appendChild(document.createElement("div"));_clOpDiv.className="zmTableTd";var _rdOpDiv=_clOpDiv.appendChild(document.createElement("div"));for(_rdOpDiv.className="zmRadioInline zmNoBdr",k=0;k<zcl_opObj.length;k++){var radioObj=zcl_opObj[k],optnKeyList=Object.keys(radioObj),_div=_rdOpDiv.appendChild(document.createElement("div"));_div.className="zmRadioEle zmRadioInlineEle",_div.setAttribute("onclick","ZCL_groupPolicy.zcl_chgRadio(this, '"+optnKeyList[0]+"')");var _inp=_div.appendChild(document.createElement("input"));"zclApprEveCre"==ZCL_groupPolicy.idArr[i]?_inp.checked=0==optnArr[i]&&0==k||1==optnArr[i]&&1==k?!0:!1:"zclCalShPri"==ZCL_groupPolicy.idArr[i]?_inp.checked=0==optnArr[i]&&1==k||1==optnArr[i]&&0==k||2==optnArr[i]&&2==k?!0:!1:"zclSndInv"==ZCL_groupPolicy.idArr[i]?_inp.checked="0"==ZCL_groupPolicy.type?(1==optnArr[i]||4==optnArr[i])&&1==k||3==optnArr[i]&&0==k?!0:!1:(1==optnArr[i]||4==optnArr[i])&&1==k||3==optnArr[i]&&0==k||2==optnArr[i]&&2==k?!0:!1:"zclRestOvrlpEve"==ZCL_groupPolicy.idArr[i]?_inp.checked=0==optnArr[i]&&0==k||1==optnArr[i]&&1==k?!0:!1:"zclGrpNtfy"==ZCL_groupPolicy.idArr[i]&&(_inp.checked="1"==optnArr[i]&&0==k||"0"==optnArr[i]&&1==k?!0:!1),_inp.type="radio";var _lbl=_div.appendChild(document.createElement("label"));_lbl.innerHTML="<i class='msi-tick'></i>"+radioObj[optnKeyList[0]]}}var msgDiv=parntDiv.appendChild(document.createElement("div"));msgDiv.className="zmParaTxt",msgDiv.innerHTML="<p>* "+zcal.i18n.setting_msg+"</p>"},getGroupPolicy:function(grpJson,parentDOMElem){ZCL_groupPolicy.grpId=grpJson.grpId+"",ZCL_groupPolicy.type=grpJson.type+"",ZCL_groupPolicy.parentDOM=parentDOMElem;{var url="/cal/adminSet.do?mode=fetch&space_id="+ZCL_groupPolicy.grpId+"&type=0";ZCL_XHR(url,"ZCL_groupPolicy.constGroupPolicy")}},zcl_chgRadio:function(rad,slVal){var liEle=rad.parentNode,divEle=liEle.parentNode;divEle.parentNode.setAttribute("rel",slVal);for(var inpChild=divEle.parentNode.querySelectorAll("input"),i=0;i<inpChild.length;i++){var inpObj=inpChild[i];inpObj.checked=!1}rad.querySelectorAll("input")[0].checked=!0,ZCL_groupPolicy.updateGroupPolicy()},updateGroupPolicy:function(){var grpId=ZCL_groupPolicy.grpId,Obj=(ZCL_groupPolicy.type,{}),d=ZCL_groupPolicy.parentDOM.querySelectorAll("div.zmTableTr");Obj.APPROVAL_CREATION=d[0].getAttribute("rel"),Obj.APPROVAL_CAL_SUBS=d[1].getAttribute("rel"),Obj.INVITATION_NONGROUP=d[2].getAttribute("rel"),Obj.RESTRICT_OVERLAP=d[3].getAttribute("rel"),Obj.GROUP_NOTIFY=d[4].getAttribute("rel");var url="/cal/adminSet.do?mode=update&type=0&space_id="+grpId+"&optObj="+encodeURIComponent(JSON.stringify(Obj));ZCL_XHR(url,"ZCL_groupPolicy.zcl_retSvGroup")},zcl_retSvGroup:function(xml){var res=ZCL_streamEve.evl(1,xml.responseText);"UPDATED_SUCCESSFULLY"==res.message}};