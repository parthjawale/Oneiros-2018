"use strict";define([],function(a){var b=a("zmail.Core.Namespaces"),c=zmail.Utils.DOM,d=b.create("zmail.fileUploader"),e=function(){var a={isAjaxable:!1,isUploadStatusNotifiable:!1,isProgessNotifiable:!1},b=new XMLHttpRequest;return window.FormData&&(a.isAjaxable=!0),"upload"in b&&(a.isUploadStatusNotifiable=!0,"onprogress"in b.upload&&(a.isProgessNotifiable=!0)),a}(),f=function(a){var b=c.element(zdom("form",{method:"POST"}));return a=a||[],a.forEach(function(a){var d=a.$el;d||(d=c.element(zdom("input",{type:"hidden"})),d.attr("name",a.name),d.val(a.value)),c.mount(d,b)}),b},g=function(a){var b=new FormData;return a=a||[],a.forEach(function(a){a.optional?b.append(a.name,a.value,a.optional):b.append(a.name,a.value)}),b},h=function(a){var b,d=$.Deferred(),e=c.element(document.body),g=c.element(zdom("iframe",{style:{display:"none"}})),h=g[0],i=f(a.payloads||[]),j=i[0],k="asyncUpld"+(new Date).getTime();return c.mount(g,e),b=h.contentWindow&&h.contentWindow.document||h.contentDocument||h.document,h.name=k,j.target=h.name,j.action=a.url||[],j.enctype="multipart/form-data",j.encoding="multipart/form-data",g.on("load",function(){var a=b.body,c=a.innerText||a.textContent,e=$.parseJSON(c)||[],f=Number(e[0]);1===f?d.resolve(e):d.reject(e),g.remove(),i.remove()}),c.mount(i,e),j.submit(),d.promise()},i=function(a,b){var c=g(a.payloads),d={},f={url:a.url,type:"POST",data:c,processData:!1,contentType:!1};return b.setSessionId===!0&&zmail.isWSEnabled&&zmail._ws&&zmail._ws.getSessionId()&&(d.sId=zmail._ws.getSessionId()),f.headers=d,e.isProgessNotifiable&&"function"==typeof a.onProgressHandler&&(f.xhr=function(){var b=$.ajaxSettings.xhr();return b.upload.onprogress=a.onProgressHandler,b}),$.ajax(f).done(function(a){window.console.log(a)}).done(function(a){})},j=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.isAjaxable?i(a,b):h(a)};return d.flags=e,d.upload=j,d}),define([],function(a,b){var c=a("_"),d=a("zmail.Utils.DOM"),e=function(a,b,c,d){for(;b<c;b++)a[b]=d},f=function(a){for(var b=0,c=a[0],d=a.length,e=1;e<d;e++)c>a[e]&&(c=a[e],b=e);return{index:b,value:c}},g=function(a){a.$container=d.element(a.container),a.containerSize=a.containerSize||a.$container.width(),a.containerPadding=a.containerPadding||0,a.childrenSelector=a.childrenSelector||"",a.children=a.children||a.$container.find(a.childrenSelector),a.childrenWidth=Number(a.childrenWidth),a.childrenVMargin=Number(a.childrenVMargin)||0,a.childrenHMargin=Number(a.childrenHMargin)||0,a.leftUnit="px",a.topUnit="px",a.heights=[],a.containerSize-=a.containerPadding,a.columns=a.columns||Math.floor(a.containerSize/(a.childrenWidth+a.childrenHMargin))||1,e(a.heights,0,a.columns,0),a.extraWidth=Math.floor(a.containerSize-(a.columns*a.childrenWidth+(a.columns-1)*a.childrenHMargin)),a.extraWidth>a.childrenWidth+a.childrenHMargin&&(a.columns+=1,a.heights.push(0),a.extraWidth=Math.floor(a.containerSize-(a.columns*a.childrenWidth+(a.columns-1)*a.childrenHMargin))),a.beforeLayout&&a.beforeLayout(a),c(a.children).each(function(b){b=d.element(b);var c=f(a.heights),e=c.index,g=e*a.childrenWidth+e*a.childrenHMargin,h=c.value;a.centerAlign&&(g+=a.extraWidth/2),b.css({left:g+a.leftUnit,top:h+a.topUnit}),a.heights[e]+=b.outerHeight()+a.childrenVMargin}),a.afterLayout&&a.afterLayout(a)};return zmail.masonry=g,zmail.masonry}),define([],function(a){var b=a("_"),c=a("zmail.Core.Namespaces"),d=c.create("zmshCut"),e={"shift+1":"!","shift+2":"@","shift+3":"#","shift+4":"$","shift+5":"%","shift+6":"^","shift+7":"&","shift+8":"","shift+9":"(","shift+0":")","shift+openBracket":"{","shift+closeBracket":"}","shift+backSlash":"|","shift+backtick":"~","shift+singleQuote":'"',"shift+semiColon":":","shift+equalTo":"+","shift+minus":"_",upArrow:"↑",downArrow:"↓",leftArrow:"←",rightArrow:"→",forwardSlash:"/",backSlash:"\\",openBracket:"[",closeBracket:"]",backtick:"`",singleQuote:"'",semiColon:";",period:".",comma:",",equalTo:"=",minus:"-",ctrl:"<Ctrl>",shift:"<Shift>",enter:"<Enter>","delete":"<Delete>",esc:"<Esc>"},f=function(a){return e[a]||a.toLowerCase()},g=function(a,b){return e[a+b]},h=function(a){var b,c=a.split("+"),d=c.length,e=[],h="";for(b=0;b<d;b++)h=g(c[b],c[b+1]),h?(e.push(h),b+=1):e.push(f(c[b]));return e},i=function(a){var c=a.split("/"),d=[];return c.forEach(function(a){d.push(h(a))}),b.flatten(d)},j=function(a,c){var e,f=d[a];return b.isArray(f)&&(e=b(f).find(function(a){return a.uid===c})),e&&e.keyStr};return d.getReadableText=i,d.getKeyString=j,d}),define([],function(a){var b=a("zmail.Core.Namespaces"),c=b.create("zmail.attachmentReminder"),d=function(a,b){this.message=a,this.object=b},e=function(a,b){for(var c="",d=0,e=a.length;d<e;d++){var f=a[d];f&&(c&&(c+=b),c+=f)}return c},f={pronoun:["i","we"],auxVerb:["'ve"," have"],actionVerb:["find","see","download","check","go through","refer"],article:["the","my"],mainActionVerb:["attached","included","enclosed"],adVerb:["here","hereby","herewith","herein"],mainNoun:["attachments?"],noun:["files?","images?","pictures?","photos?","resumes?","copy","copies","docs?","documents?","papers?","emails?","spreadsheets?","pdfs?"],prepositions:["in","this"]},g=!1,h=null,i=["attachments? has","attached it for your reference","PFA"],j=!1,k=null,l=function(){return!j&&k||(j=!1,k=new RegExp("\\s(?:"+e(i,"|")+")\\s","i")),k},m=function(){var a="|";if(g||!h){g=!1;var b,c=f;b="(?:",b+="(?:",b+="(?:",b+="(?:\\b(?:"+e(c.pronoun,a)+"))",b+="(?:\\s*(?:"+e(c.auxVerb,a)+"))?",b+=")",b+="|",b+="(?:",b+="(?:\\b(?:"+e(c.actionVerb,a)+"))",b+="(?:\\s+(?:"+e(c.prepositions,a)+"))?",b+="(?:\\s+(?:"+e(c.article,a)+"))?",b+=")",b+=")",b+="(?:\\b\\s*(?:"+e(c.mainNoun,a)+"|"+e(c.mainActionVerb,a)+")\\b)",b+="(?:\\s+(?:"+e(c.article,a)+"))?",b+="(?:\\s+(?:"+e(c.noun,a)+")\\b)?",b+=")",b+="|",b+="(?:",b+="(?:\\b\\s*(?:"+c.mainActionVerb.join("|")+")\\b)",b+="(?:it)?",b+="(?:",b+="(?:\\s+(?:"+e(c.adVerb,a)+")\\b)",b+="|",b+="(?:",b+="(?:\\s+(?:"+e(c.prepositions,a)+"))?",b+="(?:\\s+(?:this|"+e(c.article,a)+"))?",b+="(?:\\s+(?:"+e(c.noun,a)+")\\b)",b+=")",b+=")",b+=")",b+="|",b+="(?:",b+="(?:",b+="(?:\\b(?:"+e(c.noun,a)+")\\b)",b+="|",b+="(?:\\b(?:"+e(c.adVerb,a)+")\\b)",b+=")",b+="(?:\\s*(?:"+e(c.mainActionVerb,a)+")\\b)",b+=")",h=new RegExp(b,"i")}return h},n=function(a){for(var b=[],c=/[|`~!@#$%^&*()\-_+={}[\]\\:;",<>\/]/,d=null,e=0,f=a.length;e<f;e++)d=c.exec(a[e]),d&&b.push(d);return b},o=function(a){var b=[];for(var c in a){var d=n(a[c]);d.length&&b.push(d)}return b};return Object.defineProperty(c,"filter",{get:function(){return f},set:function(a){var b=o(a);if(b.length)throw new d("Filter contains special characters",b);f=a,g=!0},enumerable:!0,configurable:!0}),Object.defineProperty(c,"userPhrases",{get:function(){return i},set:function(a){var b=n(a);if(b.length)throw new d("User phrases contains special characters",b);i=a,j=!0},enumerable:!0,configurable:!0}),c.isFileNeedToAttach=function(a){var b=null;return b=m().exec(a),!b&&i.length&&(b=l().exec(" "+a+" ")),b},zmail.win.zmAttReminder=c,c}),define([],function(a){var b=a("_"),c=a("$.when"),d=a("$.Deferred"),e=function f(a){return this instanceof f?(b.extend(this,this.defaults(),a),void(this.setResult=this.setResult.bind(this))):new f(a)};return e.prototype={defaults:function(){return{pageSize:10,pageNo:0,pending:0,threshold:30,hasMoreToFetch:!0,query:void 0,expected:0,result:[],provider:function(a){return a.result}}},isFirstPage:function(){return 1===this.pageNo},resetPage:function(){return this.pageNo=0,this.hasMoreToFetch=!0,this},reset:function(){return this.resetPage(),this.pending=0,this.query=void 0,this.expected=0,this.result=[],this},getPageSize:function(){return b.result(this,"pageSize")},setResult:function(a){return this.result=a||[],this.hasMoreToFetch=this.result.length>=this.expected,this},isQueryChanged:function(a){return void 0!==a&&this.query!==a},setQuery:function(a){return this.isQueryChanged(a)&&(this.reset(),this.query=a),this},setPending:function(a){return this.pending=this.getPageSize()-a.length,this},setNextPage:function(){return this.pageNo+=1,this},getLastServedIndex:function(){var a=this.getPageSize()*this.pageNo;return a-=this.pending,a=a<0?0:a},getEndIndex:function(a){var b=a+this.getPageSize();return this.endIndex>this.result.length&&(b=this.result.length-1),b=b<=0?1:b},getResultSubSet:function(){var a=this.getLastServedIndex();return this.result.slice(a,this.getEndIndex(a))},fetch:function(){return b.isFunction(this.provider)?(this.expected=(this.pageNo+1)*this.getPageSize(),c(this.provider(this)).then(this.setResult)):c(this.provider).then(this.setResult)},isMoreThanThreshold:function(a){var b=a.length/this.getPageSize()*100;return b>=this.threshold},next:function(a){this.setQuery(a);var b=new d,c=this.getResultSubSet();if(this.hasMoreToFetch&&!this.isMoreThanThreshold(c)){var e=this;this.fetch().then(function(){c=e.getResultSubSet(),e.setNextPage().setPending(c),b.resolve(c,e.isFirstPage())},b.reject)}else this.setNextPage().setPending(c),b.resolve(c,this.isFirstPage());return b.promise()}},zmail.Paginator=e,zmail.Paginator}),define([],function(a,b){var c=a("_"),d=function e(a){return this instanceof e?(c.extend(this,this.defaults(),a),this.resetIndex(),void delete this.defaults):new e(a)};return d.prototype={defaults:function(){return{list:[],startIndex:-1,index:-1}},add:function(a){return this.list&&this.list.push(a),this},remove:function(a){if(this.list){var b=this.list.indexOf(a);b!==-1&&(this.list.splice(b,1),this.index===b&&this.resetIndex())}return this},set:function(a){return c.extend(this,a),this},getIndexOf:function(a){return this.list.indexOf(a)},setIndexOf:function(a){var b=this.getIndexOf(a);return b!==-1?this.index=b:this.resetIndex(),this},resetIndex:function(){return this.index=this.startIndex,this},reset:function(){return this.list=void 0,this.resetIndex()},value:function(){return this.list[this.index]},skip:function(a,b){return!1},next:function(){return this.list&&(this.index+=1,this.index>=this.list.length&&(this.index=0),this.skip(this.value(),this.index))?this.next():this},previous:function(){return this.list&&(this.index-=1,this.index<0&&(this.index=this.list.length-1),this.skip(this.value(),this.index))?this.previous():this},traverse:function(a){return a===-1?this.previous():this.next()},first:function(){return this.list&&this.list.length>0&&(this.index=0),this},last:function(){return this.list&&this.list.length>0&&(this.index=this.list.length-1),this}},zmail.Traverser=d,zmail.Traverser});