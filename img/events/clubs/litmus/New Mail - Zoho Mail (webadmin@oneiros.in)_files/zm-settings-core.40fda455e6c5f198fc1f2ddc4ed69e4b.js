"use strict";_defineSettingsModule("Categories",function(a,b){var c="all",d=zmText.get("zm-settings-core","category"),e={title:d.labels.allCategory},f=b("Platform.Components"),g=f.CategoryManager,h=g.create(c,{props:{title:e.title},attributes:{"default":!0}});a.All=h},"MailSuite"),_defineSettingsModule("Categories",function(a,b){var c="general",d=zmText.get("zm-settings-core","category"),e={title:d.labels.generalCategory},f=b("Platform.Components"),g=f.CategoryManager,h=g.create(c,{props:{title:e.title}});a.General=h},"MailSuite"),_defineSettingsModule("Categories",function(a,b){var c="mail",d=zmText.get("zm-settings-core","category"),e={title:d.labels.mailCategory},f=b("Platform.Components"),g=f.CategoryManager,h=g.create(c,{props:{title:e.title}});a.Mail=h},"MailSuite"),_defineSettingsModule("Categories",function(a,b){var c="groups",d=zmText.get("zm-settings-core","category"),e={title:d.labels.groupsCategory},f=b("Platform.Components"),g=f.CategoryManager,h=g.create(c,{props:{title:e.title}});a.General=h},"MailSuite"),_defineSettingsModule("Categories",function(a,b){},"MailSuite"),_defineSettingsModule("Utils",function(a){var b=zmail.urls.accURL,c=function(a){setTimeout(function(){window.open(a)},0)},d={openPersonalInfoPage:function(){c(b+"/u/h#profile/personal","_blank")},openActivityHistoryPage:function(){c(b+"/u/h#sessions/useractivityhistory","_blank")},openActiveSessionsPage:function(){c(b+"/u/h#sessions/useractivesessions","_blank")},openSecurityQuestionPage:function(){c(b+"/u/h#security/security_qa","_blank")},openChangePasswordPage:function(){c(b+"/u/h#security/security_pwd","_blank")}};a.Actions=d},"MailSuite.Settings.Account"),_defineSettingsModule("Cards",function(a,b){var c="account-settings",d="general",e=zmText.get("zm-settings-core","accountSettings"),f={cardTitle:e.card.title},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!1,title:f.cardTitle},attributes:{category:d},searchCommand:{on:"goto",callback:function(){var a=this,b=zmail.Settings.SearchCommandIntegrator;b.showAutoFill(a.getDependentCommands())}}});a.Account=i},"MailSuite"),function(a){var b="account-settings",c={PERSONAL_INFO:"personal-info",ACTIVITY_HISTORY:"activity-history",ACTIVE_SESSIONS:"active-sessions",SECURITY_QUESTIONS:"security-questions",CHANGE_PASSWORD:"change-password"},d=zmText.get("zm-settings-core","accountSettings"),e={cardItem:{title:d.cardItems.labels}},f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Account.Utils"),i=h.Actions,j=f.SettingCardItemManager,k=g.SettingCardItem,l=k.Types,m=function(a,b){b=b||{},j.create(a,b)};m(c.PERSONAL_INFO,{props:{loadFrameworkOnCommandExecution:!1,title:e.cardItem.title.personalInfo},attributes:{type:l.Action,card:b},primaryAction:function(){i.openPersonalInfoPage()}}),m(c.ACTIVITY_HISTORY,{props:{loadFrameworkOnCommandExecution:!1,title:e.cardItem.title.activityHistory},attributes:{type:l.Action,card:b},primaryAction:function(){i.openActivityHistoryPage()}}),m(c.ACTIVE_SESSIONS,{props:{loadFrameworkOnCommandExecution:!1,title:e.cardItem.title.activeSessions},attributes:{type:l.Action,card:b},primaryAction:function(){i.openActiveSessionsPage()}}),m(c.SECURITY_QUESTIONS,{props:{loadFrameworkOnCommandExecution:!1,title:e.cardItem.title.securityQuestions},attributes:{type:l.Action,card:b},primaryAction:function(){i.openSecurityQuestionPage()}}),m(c.CHANGE_PASSWORD,{props:{loadFrameworkOnCommandExecution:!1,title:e.cardItem.title.changePassword},attributes:{type:l.Action,card:b},primaryAction:function(){i.openChangePasswordPage()}})}(zmail.Settings.Modules["import"]),function(a){var b="account-settings",c={PERSONAL_INFO:"personal-info",ACTIVITY_HISTORY:"activity-history",ACTIVE_SESSIONS:"active-sessions",SECURITY_QUESTION:"security-question",CHANGE_PASSWORD:"change-password"},d=zmText.get("zm-settings-core","accountSettings"),e=d.quickNavigatorItems.labels,f=a("Platform.Components"),g=a("MailSuite.Settings.Account.Utils"),h=f.QuickNavigatorSectionManager,i=f.QuickNavigatorItemManager,j=g.Actions;h.create(b,{props:{title:e.sectionTitle},state:{selected:!1}}),i.create(c.PERSONAL_INFO,{props:{title:e.personalInfoTitle},attributes:{section:b},openAction:function(){j.openPersonalInfoPage()}}),i.create(c.ACTIVITY_HISTORY,{props:{title:e.activityHistoryTitle},attributes:{section:b},openAction:function(){j.openActivityHistoryPage()}}),i.create(c.ACTIVE_SESSIONS,{props:{title:e.activeSessionsTitle},attributes:{section:b},openAction:function(){j.openActiveSessionsPage()}}),i.create(c.SECURITY_QUESTION,{props:{title:e.securityQuestionTitle},attributes:{section:b},openAction:function(){j.openSecurityQuestionPage()}}),i.create(c.CHANGE_PASSWORD,{props:{title:e.changePasswordTitle},attributes:{section:b},openAction:function(){j.openChangePasswordPage()}})}(zmail.Settings.Modules["import"]),_defineSettingsModule("Pages",function(a,b){var c="general-settings",d=b("Platform.Components"),e=b("Platform.Entities"),f=zmText.get("zm-settings-core","generalSettings"),g={title:f.page.title},h=d.SettingPageManager,i=e.SettingPage,j=i.Types,k=h.create(c,{props:{title:g.title},attributes:{type:j.Title,category:"general",card:c,pageCSSClass:"general-settings-page",appContainer:!0}});a.General=k},"MailSuite"),_defineSettingsModule("Cards",function(a,b){var c="general-settings",d="general",e="general-settings",f=zmText.get("zm-settings-core","generalSettings"),g={cardTitle:f.card.title,searchCommandTitle:f.card.searchCommandTitle},h=b("Platform.Components"),i=h.SettingCardManager,j=i.create(c,{props:{openable:!0,title:g.cardTitle},state:{hidden:!1},attributes:{category:d},searchCommand:{title:g.searchCommandTitle},openAction:i.CardActions.OpenPageAction(e)});a.General=j},"MailSuite"),_defineSettingsModule("Persister",function(a,b){var c=b("Platform.System.Utils"),d=function(){var a=c.makeDeferred(),d=b("MailSuite.Settings.General"),e=d.StartupAction,f=d.StartupApp,g=d.MailAppStartup,h={},i=e.Constants.MODES;h[i.NEW_SESSION]="none",h[i.RESTORE_SESSION]="restore",h[i.NEW_SESSION_WITH_TARGET]="app";var j=e.Setting.get(),k=f.Setting.get(),l=h[j];if(j===i.NEW_SESSION_WITH_TARGET&&(l=l+"-"+k,k===f.Constants.MODES.MAIL)){var m=g.Setting.get();l=l+"-"+m,zmail.mailOpt.isFol="inbox"===m?1:0,zmAjq.XHR({u:zmail.conPath+"/userSettings.do",p:{mode:"viewVO",settings:JSON.stringify({defaultFolder:zmail.mailOpt.isFol})},t:"post",fn:function(b){a.resolve({success:!0,response:b})},efn:function(b){a.reject({success:!1,response:b})}})}return zmAdHocSettings.setLPageType(l),a.resolve(),a.promise()};a.save=d},"MailSuite.Settings.StartupSetting"),_defineSettingsModule("StartupAction",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f=b("MailSuite.Settings.StartupSetting.Persister"),g="startup-action",h="restore-session",i="new-session-with-target",j=function(){return[i,h]},k=function(){return{NEW_SESSION_WITH_TARGET:i,RESTORE_SESSION:h}},l={MODES:k()},m=d.create(g,{props:{defaultValue:i,options:j()},type:"option",category:"general",persister:{errors:function(a){return"Error occurred (E"+a+")"},fetch:function(){var a=e.makeDeferred(),b=zmAdHocSettings.getLPageType(),c="app-mail-"+("1"===String(zmail.mailOpt.isFol)?"inbox":"unread");switch(b=(b||"").split("-"),b[0]){case"restore":"restore"!==b[0]||_zm._isPrivilegedUser()?b=h:(b=i,zmAdHocSettings.setLPageType(c));break;case"app":b=i;break;default:b=i,zmAdHocSettings.setLPageType(c)}return a.resolve(b),a.promise()},save:function(){var a=e.makeDeferred();return f.save(),a.resolve(),a.promise()}}});a.Setting=m,a.Constants=l},"MailSuite.Settings.General"),_defineSettingsModule("mailTo",function(a,b){var c,d=b("Platform.Components"),e=d.SettingManager,f="mail-to";c=e.create(f,{props:{defaultValue:!1},attributes:{category:"general"}}),a.Setting=c},"MailSuite.Settings.General"),_defineSettingsModule("StartupApp",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f=b("MailSuite.Settings.StartupSetting.Persister"),g="startup-app",h="mail",i="calendar",j="tasks",k="notes",l="contacts",m="bookmarks",n="streams",o=function(){return[h,i,j,k,n,l,m]},p=function(){return{MAIL:h,CALENDAR:i,TASKS:j,NOTES:k,CONTACTS:l,BOOKMARKS:m,STREAMS:n}},q=function(){var a={},b=p();return Object.keys(b).forEach(function(c){a[b[c]]=c}),a},r={MODES:p(),REVERSE_MODES:q(),ORDER:o()},s=e.create(g,{props:{defaultValue:h,options:o()},type:"option",category:"general",persister:{errors:function(a){return"Error occurred (E"+a+")"},fetch:function(){var a=d.makeDeferred(),b=zmAdHocSettings.getLPageType();return b=(b||"").split("-"),"app"===b[0]&&b[1]&&r.REVERSE_MODES[b[1]]?a.resolve(b[1]):a.resolve(h),a.promise()},save:function(){var a=d.makeDeferred();return f.save(),a.resolve(),a.promise()}}});a.Setting=s,a.Constants=r},"MailSuite.Settings.General"),_defineSettingsModule("MailAppStartup",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f=b("MailSuite.Settings.StartupSetting.Persister"),g="mail-app-startup",h=d.create(g,{props:{defaultValue:"unread"},type:"default",category:"general",persister:{errors:function(a){return"Error occurred (E"+a+")"},fetch:function(){var a=e.makeDeferred(),b=zmAdHocSettings.getLPageType(),c="1"===String(zmail.mailOpt.isFol)?"inbox":"unread";return b=(b||"").split("-"),"app"===b[0]&&"mail"===b[1]?(b.shift(),b.shift(),b=b.join("-"),b!==c&&(b=c,zmAdHocSettings.setLPageType("app-mail-"+c))):b=c,a.resolve(b),a.promise()},save:function(){var a=e.makeDeferred();return f.save(),a.resolve(),a.promise()}}});a.Setting=h},"MailSuite.Settings.General"),_defineSettingsModule("TrashCleanup",function(a,b){var c=b("Platform.Components"),d=b("Platform.Validators.Basic"),e=b("Platform.System.Utils"),f=b("Platform.UI.Utils"),g=c.SettingManager,h={range:{max:180,min:1}},i="trash-cleanup",j={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+i,a),b.resolve(zmail.userOptions.trashCleanupDays),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+i,a,b);var d={settings:JSON.stringify({trashCleanupDays:a}),mode:"commonVO"},g={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.trashCleanupDays=b.value,c.resolve(b.value);var d=zmText.get("zm-settings-app-generalsettings","trashcleanup");f.showSuccessMessage(d.succ)},p:d,csr:"s",ep:g}),c.promise()}},k=g.create(i,{props:{defaultValue:-1},persister:j,validations:[{validator:d.RangeValidator,opts:h.range}],type:"default",category:"compose"});k.initialize(),a.Setting=k,a.Constants=h},"MailSuite.Settings.General"),_defineSettingsModule("UIFontFamily",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="lato",g="pt-sans",h="arial",i="ui-font-family",j=function(){return["lato","pt-sans","arial"]},k=function(){return{LATO:f,PT_SANS:g,ARIAL:h}},l={FONTS:k(),ADHOC_VALUE_MAP:{Lato:f,"PT Sans":g,Arial:h},ADHOC_VALUE_REVERSE_MAP:{}};l.ADHOC_VALUE_REVERSE_MAP[f]="Lato",l.ADHOC_VALUE_REVERSE_MAP[g]="PT Sans",l.ADHOC_VALUE_REVERSE_MAP[h]="Arial";var m=e.create(i,{props:{defaultValue:f,options:j()},persister:{errors:function(a){return"Error occurred ( E-"+a+")"},fetch:function(){var a=zmAdHocSettings.getFont(),b=d.makeDeferred();return b.resolve(l.ADHOC_VALUE_MAP[a]),b.promise()},save:function(a){var b=d.makeDeferred();return zmAdHocSettings.setFont(l.ADHOC_VALUE_REVERSE_MAP[a]),b.resolve(),b.promise()}},type:"option",category:"general"});a.Setting=m,a.Constants=l},"MailSuite.Settings.General"),_defineSettingsModule("UIFontSize",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e="ui-font-size",f=d.create(e,{props:{defaultValue:10},type:"default",category:"general"});a.Setting=f},"MailSuite.Settings.General"),_defineSettingsModule("UITheme",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="ui-theme",g="blue-light",h="blue-dark",i="green-light",j="green-dark",k="yellow-light",l="yellow-dark",m="red-light",n="red-dark",o="black-light",p="vintage-white",q=function(){return{COBALT_BLUE_LIGHT:g,COBALT_BLUE_DARK:h,FERN_GREEN_LIGHT:i,FERN_GREEN_DARK:j,TANGERINE_YELLOW_LIGHT:k,TANGERINE_YELLOW_DARK:l,CARDINAL_RED_LIGHT:m,CARDINAL_RED_DARK:n,OBSIDIAN_BLACK_LIGHT:o,VINTAGE_WHITE_LIGHT:p}},r=function(){var a=q(),b=Object.keys(a);return b.map(function(b){return a[b]})},s={THEMES:q(),ADHOC_THEME_MAP:{theme1:h,theme2:j,theme3:i,theme4:g,theme5:n,theme6:m,theme7:l,theme8:k,theme9:o,theme10:p}},t=e.create(f,{props:{defaultValue:s.THEMES.COBALT_BLUE_DARK,options:r()},persister:{errors:function(a){return"Error occurred ( E-"+a+" )"},fetch:function(){var a=zmAdHocSettings.getTheme(),b=d.makeDeferred();return b.resolve(s.ADHOC_THEME_MAP[a]),b.promise()},save:function(a){var b=d.makeDeferred();return a=Object.keys(s.ADHOC_THEME_MAP).filter(function(b){return s.ADHOC_THEME_MAP[b]===a}),a=a[0],zmAdHocSettings.setTheme(a),b.resolve(),b.promise()}},type:"option",category:"general"});a.Setting=t,a.Constants=s},"MailSuite.Settings.General"),_defineSettingsModule("UserLang",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="ui-user-lang",g={SUPPORTED_LANGUAGES:_.map(zmText.languageConfig,function(a){return a.code})},h=function(a){var b=g.SUPPORTED_LANGUAGES.indexOf(a);return b>-1},i=e.create(f,{props:{defaultValue:"en"},persister:{errors:function(a){return"Error occurred ( E-"+a+")"},fetch:function(){var a=d.makeDeferred(),b=zmail.user.lang;return a.resolve(b),a.promise()},save:function(a){var b=d.makeDeferred(),c={},e={};return h(a)?(c.mode="userProfileInfoVO",a&&(e.lang=a),c.settings=JSON.stringify({lang:a}),zmAjq.XHR({u:"/zm/userSettings.do",t:"POST",fn:function(a,c){zmail.user.lang=c.lang,b.resolve(c.lang)},p:c,csr:"s",ep:e})):b.reject(400),b.promise()}},category:"general"});i.initialize(),a.Setting=i,a.Constants=g},"MailSuite.Settings.General"),_defineSettingsModule("MailSoundNotifier",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="mail-sound-notifier",g=function(){return zmComponent.soundNotifier._allowedValues},h=e.create(f,{props:{defaultValue:0,options:g()},persister:{errors:function(a){return"Error occurred ( E-"+a+" )"},fetch:function(){var a=zmAdHocSettings.getMailSoundNotifier(),b=d.makeDeferred();return b.resolve(Number(a)),b.promise()},save:function(a){var b=d.makeDeferred();return a=String(a),zmAdHocSettings.setMailSoundNotifier(a),b.resolve(),b.promise()}},type:"option",category:"general"}),i=function(){h.initialize(),zmAdHocSettings.subscribeMailSoundNotifierChange(function(a,b){h.set(Number(b.value))})};i(),a.Setting=h},"MailSuite.Settings.General"),_defineSettingsModule("UserCountry",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="ui-user-country",g={},h=e.create(f,{props:{defaultValue:"US"},persister:{errors:function(a){return"Error occurred ( E-"+a+")"},fetch:function(){var a=d.makeDeferred(),b=zmail.user.countrycode;return a.resolve(b),a.promise()},save:function(a){var b=d.makeDeferred(),c={},e={};return c.mode="userProfileInfoVO",a&&(e.country=a),c.settings=JSON.stringify({country:a}),zmAjq.XHR({u:"/zm/userSettings.do",t:"POST",fn:function(a,c){zmail.user.countrycode=c.country,b.resolve(c.country)},p:c,csr:"s",ep:e}),b.promise()}},category:"general"});h.initialize(),a.Setting=h,a.Constants=g},"MailSuite.Settings.General"),_defineSettingsModule("ViewState",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="conversation-view",g="off",h="acrossFolder",i=function(){return[0,2]},j=function(){return[2]},k=function(){return{0:g,2:h}},l={ALLOWED_VALUES:i(),MODE_MAP:k(),ENABLED_MODES:j()},m={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=d.makeDeferred();return d.debugLog("fetching mail-setting "+f,a),1===zmail.folviewThread&&(zmail.folviewThread=2),b.resolve(zmail.folviewThread),b.promise()},save:function(a,b){var c=d.makeDeferred();return d.debugLog("saving "+f,a,b),zmList.setListingType(a).done(function(b){1===b[0]&&"success"===_zm.getProperty(b[1],"result")?c.resolve(a):c.reject()}),c.promise()}},n=e.create(f,{props:{defaultValue:zmail.userOptions.composeView,options:i()},persister:m,type:"option",category:"conversation"});n.initialize(),a.Setting=n,a.Constants=l},"MailSuite.Settings.Conversation"),_defineSettingsModule("SortOrder",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="conversation-view",g="latestOnTop",h="oldestOnTop",i=function(){return[0,1]},j=function(){return{0:g,1:h}},k={ALLOWED_VALUES:i(),MODE_MAP:j()},l={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=d.makeDeferred();return d.debugLog("fetching mail-setting "+f,a),b.resolve(zmail.convSortOrder),b.promise()},save:function(a,b){var c=d.makeDeferred();return d.debugLog("saving "+f,a,b),zmList.setConversationOrder(a).done(function(){c.resolve(a)}),c.promise()}},m=e.create(f,{props:{defaultValue:zmail.convSortOrder,options:i()},persister:l,type:"option",category:"conversation"});m.initialize(),a.Setting=m,a.Constants=k},"MailSuite.Settings.Conversation"),function(a){var b,c,d="general-settings",e={FONT_FAMILY:"font-family",THEME:"ui-theme",STARTUP_ACTION:"startup-action",DISPLAY_LANGUAGE:"display-language",SOUND_NOTIFIER:"sound-alerts",MAILTO_HANDLER:"mailto-handler"},f=zmText.get("zm-settings-core","generalSettings"),g=f.cardItems,h=a("Platform.Components"),i=a("Platform.Entities"),j=a("MailSuite.Settings.General"),k=j.UIFontFamily,l=j.UITheme,m=j.StartupAction,n=j.StartupApp,o=j.UserLang,p=j.MailSoundNotifier,q=j.mailTo,r=h.SettingCardItemManager,s=i.SettingCardItem,t=s.Types,u=k.Setting,v=l.Setting,w=o.Setting,x=p.Setting,y=m.Setting,z=n.Setting,A=q.Setting,B=k.Constants.FONTS,C=l.Constants.THEMES,D=m.Constants.MODES,E=function(a,b){for(var c in b)if(b[c]===a)return c},F=function(a){a=a||u.get();var b=E(a,B);return g.fontFamily.fontNames[b]},G=r.create(e.FONT_FAMILY,{props:{title:g.fontFamily.cardItem.title,value:F()},attributes:{type:t.LabelValue,card:d},searchCommand:{title:g.fontFamily.searchCommand.title},primaryAction:function(){var a=r.CardItemActions.OpenPageAction("general-settings",{showSection:"ui-font"});a()}}),H=function(a){a=a||v.get();var b=E(a,C);return g.uiTheme.themeNames[b]},I=r.create(e.THEME,{props:{title:g.uiTheme.cardItem.title,value:H()},attributes:{type:t.LabelValue,card:d},primaryAction:function(){var a=r.CardItemActions.OpenPageAction("general-settings",{showSection:"ui-theme"});a()}}),J=function(a){a=a||w.get();var b=_zm.getProperty(zmText.languageConfig,a);return b?b.displayText:"English"},K=r.create(e.DISPLAY_LANGUAGE,{props:{title:g.displayLanguage.cardItem.title,value:J()},attributes:{type:t.LabelValue,card:d},primaryAction:function(){var a=r.CardItemActions.OpenPageAction("general-settings",{showSection:"display-language"});a()}}),L=function(a){return a=a||x.get(),a?zmComponent.soundNotifier.soundCodesMap[a]:g.soundNotifier.options.none},M=r.create(e.SOUND_NOTIFIER,{props:{title:g.soundNotifier.cardItem.title,value:L()},attributes:{type:t.LabelValue,card:d},primaryAction:function(){var a=r.CardItemActions.OpenPageAction("general-settings",{showSection:"sound-alerts"});a()}}),N=function(a){a=a||y.get();var b=E(a,D),c=g.startupAction.modes[b];return"new-session-with-target"===a&&(c=zmText.applyArgs(c,{appName:g.startupAction.appName[z.get()]})),c},O=r.create(e.STARTUP_ACTION,{props:{title:g.startupAction.cardItem.title,value:N()},attributes:{type:t.LabelValue,card:d},primaryAction:function(){var a=r.CardItemActions.OpenPageAction("general-settings",{showSection:"startup-action"});a()}});navigator.registerProtocolHandler&&(c=function(a){return""},b=r.create(e.MAILTO_HANDLER,{props:{title:g.MailToHandler.cardItem.title,value:c()},attributes:{type:t.LabelValue,card:d},primaryAction:function(){var a=r.CardItemActions.OpenPageAction("general-settings",{showSection:"mailto-handler"});a()}}));var P=function(){u.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&G.setProp({value:F(a.changed.value)})}),v.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&I.setProp({value:H(a.changed.value)})}),y.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&O.setProp({value:N()})}),z.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&O.setProp({value:N()})}),zmail.Settings.Events.on("initialized",function(){O.setProp({value:N()})}),w.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&K.setProp({value:J(a.changed.value)})}),x.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&M.setProp({value:L(a.changed.value)})}),navigator.registerProtocolHandler&&A.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&b.setProp({value:c("Disable")})})};P()}(zmail.Settings.Modules["import"]),function(a){var b="general-settings",c={ON_STARTUP:"startup-action",FONT:"ui-display-font",THEME:"ui-theme",SECURE_FILES:"secure-download"},d=zmText.get("zm-settings-core","generalSettings"),e=d.pageItems,f=a("Platform.Components"),g=a("Platform.Entities"),h=g.SettingPageSection,i=h.Types,j=f.SettingPageSectionManager;j.create(c.ON_STARTUP,{props:{title:e.startupAction.sectionTitle},attributes:{page:b,type:i.Title}}),j.create(c.FONT,{props:{title:e.font.sectionTitle},attributes:{page:b,type:i.Title}}),j.create(c.THEME,{props:{title:e.theme.sectionTitle},attributes:{page:b,type:i.Title}})}(zmail.Settings.Modules["import"]),_defineSettingsModule("GeneralSettings",function(a,b){var c,d=b("Platform.Components"),e=d.SettingAppManager,f=b("Platform.System.Utils"),g="general-settings",h="general-settings",i="zm-settings-app-generalsettings",j="MailSuite.Apps.GeneralSettings.AppCore",k=function(){return zmAppLoader.load(i)},l=function(){return b(j)},m=function(){var a=f.makeDeferred();return k().then(function(){l().initialize({process:a})},function(){f.debugLog("Module load failed !!!"),a.reject()}),a.promise()},n=function(){var a=f.makeDeferred();return k().done(function(){l().uninitialize({process:a})}),a.promise()},o=function(){var a=l();return a.getSettingsAppView()},p=function(){var a=l(),b=Array.prototype.slice.call(arguments);return a?a.handleContainerEvent.apply(this,b):null},q=function(){c=e.create(g,{attributes:{page:h,isReactApp:!0},initialize:m,uninitialize:n,getView:o,handleContainerEvent:p})},r=function(){q(),a.App=c};r()},"MailSuite.Apps"),function(a){var b="general-settings",c={FONT_FAMILY:"font-family",THEMES:"ui-theme",STARTUP_ACTION:"startup-action"},d=zmText.get("zm-settings-core","generalSettings"),e=d.quickNavigatorItems,f="general-settings",g={ON_STARTUP:"startup-action",FONT:"ui-font",THEME:"ui-theme"},h=a("Platform.Components"),i=h.QuickNavigatorSectionManager,j=h.QuickNavigatorItemManager;i.create(b,{props:{title:e.sectionTitle},state:{selected:!1}}),j.create(c.FONT_FAMILY,{props:{title:e.fontFamilyTitle,linkedPage:f,linkedPageSection:g.FONT,selectable:!0},attributes:{section:b}}),j.create(c.THEMES,{props:{title:e.uiThemeTitle,linkedPage:f,linkedPageSection:g.THEME,selectable:!0},attributes:{section:b}})}(zmail.Settings.Modules["import"]),_defineSettingsModule("keyboardshortcuts",function(a,b){var c,d,e,f,g=b("Platform.Components"),h=b("Platform.Entities"),i=b("Platform.System.Utils"),j=b("Platform.System.Base"),k=j.Entity,l=k.Events,m=g.SettingManager,n=g.SettingCardManager,o=g.SettingCardItemManager,p=g.SettingPageManager,q=g.SettingAppManager,r=h.SettingPage,s=h.SettingCardItem,t=r.Types,u=s.Types,v=zmText.get("zm-settings-core","keyboardShortcuts"),w=v,x={CARD_ID:"keyboardshortcuts",PAGE_ID:"keyboardshortcuts",APP_ID:"sa-keyboardshortcuts",CATEGORY_ID:"general",APPCORE_MODULE_ID:"zm-settings-app-keyboardshortcuts",SHORTCUT_TOGGLESTATUS_SETTING_ID:"keyboardshorctus-toggle",ROLLING_SHORTCUT_CARDITEM:"keyboardshortctus-rollingtext"},y=function(a){d.getProp("toggleSwitchActive")!==a&&(d.setProp({toggleSwitchActive:a}),zmail.mailOpt.isKey=a?1:0)},z=function(){var a=zmshCut["default"].length,b=_.random(a-1),c=zmshCut["default"][b],d=zmshCut.getKeyString("default",c.uid),e=zmshCut.getReadableText(d).join("$$");return{title:c.displayName,displayText:e}},A={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=i.makeDeferred();return i.debugLog("fetching mail-setting "+x.SHORTCUT_TOGGLESTATUS_SETTING_ID,a),b.resolve(zmail.mailOpt.isKey),b.promise()},save:function(a,b){var c=i.makeDeferred();i.debugLog("saving mail-setting "+x.SHORTCUT_TOGGLESTATUS_SETTING_ID,a,b);var d={},e={};return e.status=a?1:0,d.mode="enable",d.status=a?"enable":"disable",zmAjq.XHR({u:"/zm/zmShortcuts.do",t:"POST",fn:function(a,b){c.resolve(b.status),zmsDialog.confirm(v.refresh,{onOk:function(){document.location.reload(!0)}})},p:d,csr:"s",ep:e}),c.promise()}},B=function(){n.create(x.CARD_ID,{props:{title:w.title,openable:!0},attributes:{category:x.CATEGORY_ID},openAction:n.CardActions.OpenPageAction(x.PAGE_ID)})},C=function(){d=p.create(x.PAGE_ID,{props:{title:w.title,showTitle:!1,toggleSwitchOnText:w.toggleSwitchText.ON,toggleSwitchOffText:w.toggleSwitchText.OFF,toggleSwitchActive:zmail.mailOpt.isKey},attributes:{type:t.TitleToggleSwitch,card:x.PAGE_ID,category:"general",appContainer:!0,pageCSSClass:"kb-shortcuts-setting-app"}})},D=function(){var a,c,d=p.get(x.PAGE_ID),e=b("Platform.UI.Components"),f=e.ToggleSwitch,g=!1;a=b("MailSuite.App.Core.Framework.Sections.Category");var h=a.breadcrumbSection();c=new f,c.init({props:{onText:"ON",offText:"OFF"},state:{on:zmail.mailOpt.isKey}}),c.addTo(h,{targetView:"Lcomponent"});var i=function(){var a=c.getState();g=!0,d.setProp({toggleSwitchActive:a.on})},j=function(a){a=a||{};var b=a.changed||{};for(var d in b)switch(d){case"toggleSwitchOnText":c.setProp({onText:b.toggleSwitchOnText});break;case"toggleSwitchOffText":c.setProp({offText:b.toggleSwitchOffText});break;case"toggleSwitchActive":g||c.setState({on:b.toggleSwitchActive}),g=!1}};c.on(f.Events.stateChanged,i),d.on(l.propsChange,j)},E=function(){return zmAppLoader.load(x.APPCORE_MODULE_ID)},F=function(){var a=i.makeDeferred();return E().then(function(){zmail.Settings.Apps.keyboardshortcuts.initializeData(),a.resolve()},function(){a.reject()}),a.promise()},G=function(){var a=i.makeDeferred();return E().then(function(){zmail.Settings.Apps.keyboardshortcuts.clearTrace(),a.resolve()}),a.promise()},H=function(){var a=null;return a=zmail.Settings.Apps.keyboardshortcuts.getView()},I=function(){q.create(x.APP_ID,{attributes:{page:x.PAGE_ID,isReactApp:!0},initialize:F,uninitialize:G,getView:H,handleContainerEvent:function(a,c){var d=b("Apps.keyboardshortcuts");d&&d.handleContainerEvent(a,c),"active"===a&&D()}})},J=function(){var a=z();f=o.create(x.ROLLING_SHORTCUT_CARDITEM,{props:{addToSearch:!1,title:a.title,value:a.displayText},attributes:{type:u.RollingText,card:x.CARD_ID},primaryAction:o.CardItemActions.OpenPageAction(x.PAGE_ID)})},K=function(){var a=function(){var a=m.get(x.SHORTCUT_TOGGLESTATUS_SETTING_ID),b=a.get()!==!0;a.set(b)};c=m.create(x.SHORTCUT_TOGGLESTATUS_SETTING_ID,{props:{defaultValue:!1},category:x.CATEGORY_ID,type:"boolean",persister:A,cardItem:{props:{title:w.title},attributes:{type:u.LabelAction,card:x.CARD_ID},transformer:function(a,b){return b=b||{},"props"===a&&b.hasOwnProperty("value")&&(b.value=b.value===!0?w.enabled:w.disabled),b},primaryAction:o.CardItemActions.OpenPageAction(x.PAGE_ID),secondaryAction:a,searchCommand:{title:w.searchCommandTitle,callback:function(){a()}}}}),c.initialize()},L=function(){clearTimeout(e)},M=function(){L(),e=setInterval(function(){var a=z();a.title&&a.displayText&&(f.setProp({title:a.title}),f.setProp({value:a.displayText}))},5e3)},N=function(){c.props.on("change",function(a){d.setProp({toggleSwitchActive:a.changed.value})}),d.props.on("change:toggleSwitchActive",function(a){var b=a.changed.toggleSwitchActive;c.set(b)}),$.subscribe("/zm-settings/mailsuite-app/opened",function(){M()}),$.subscribe("/zm-settings/mailsuite-app/closed",function(){L()})},O=function(){B(),K(),J(),C(),I(),N(),a.pageRef=d,a.toggleActiveStatus=y};O()},"Apps"),_defineSettingsModule("Pages",function(a,b){var c="mail-view-options",d=b("Platform.Components"),e=b("Platform.Entities"),f=zmText.get("zm-settings-core","mailViewOptions"),g=f.page,h=d.SettingPageManager,i=e.SettingPage,j=i.Types,k=h.create(c,{props:{title:g.title},attributes:{type:j.Title,card:c,category:"mail",pageCSSClass:"mail-view-options-page",appContainer:!0}});a.MailViewOptions=k},"MailSuite"),_defineSettingsModule("Pages",function(a,b){var c="event-mail-action",d=b("Platform.Components"),e=b("Platform.Entities"),f=zmText.get("zm-settings-core","eventMailAction"),g=f.page,h=d.SettingPageManager,i=e.SettingPage,j=i.Types,k=h.create(c,{props:{title:g.title},attributes:{type:j.Title,pageCSSClass:"event-mail-action-page",category:"mail",card:c,appContainer:!0}});a.EventMailAction=k},"MailSuite"),_defineSettingsModule("Cards",function(a,b){var c="mail-view-options",d="mail",e="mail-view-options",f=zmText.get("zm-settings-core","mailViewOptions"),g=f.card,h=b("Platform.Components"),i=h.SettingCardManager,j=i.create(c,{props:{openable:!0,title:g.title},state:{hidden:!1},attributes:{category:d},openAction:i.CardActions.OpenPageAction(e)});a.MailViewOptions=j},"MailSuite"),_defineSettingsModule("Persister",function(a,b){var c=b("Platform.System.Utils"),d=b("Platform.Components"),e=b("MailSuite.Settings.Mail"),f=d.SettingManager,g={SettingID:{MailReadingPane:"mail-reading-pane",ReadReceipt:"mail-read-receipt",LoadExternalImage:"load-external-image",TimeFormat:"display-time-format",FolderListSortMode:"folder-list-sort-mode",TagListSortMode:"tag-list-sort-mode",summarySubjectMode:"subject-and-summary"}},h=function(a){a=a||{};var b=c.makeDeferred();return zmAjq.XHR({u:a.url,p:a.data,t:"post",fn:function(a){b.resolve({success:!0,response:a})},efn:function(a){b.reject({success:!1,response:a})}}),b.promise()},i=function(){return zmail.conPath+"/userSettings.do"},j=function(a){var b=null,c=e.ReadingPane.Constants.MODES;switch(a){case c.VERTICAL:b=0;break;case c.TAB:b=2;break;case c.WINDOW:b=1;break;case c.HORIZONTAL:b=4}return b},k=function(a){var b=null,c=e.ReadReceipt.Constants.MODES;switch(a){case c.ALWAYS:b=0;break;case c.ASK_USER:b=1;break;case c.NEVER:b=2}return b},l=function(a){var b=null,c=e.LoadExternalImage.Constants.MODES;switch(a){case c.ALWAYS:b=0;break;case c.CONTACTS:b=1;break;case c.ASK_USER:b=2}return b},m=function(a){var b=null,c=e.DisplayTimeFormat.Constants.MODES;switch(a){case c.TWELVE_HOUR:b=!1;break;case c.TWENTY_FOUR_HOUR:b=!0}return b},n=function(a){var b=null,c=e.FolderListSortMode.Constants.MODES;switch(a){case c.ALPHABETICAL:b=1;break;case c.USER_PREFERENCE:b=0}return b},o=function(a){var b=null,c=e.TagListSortMode.Constants.MODES;switch(a){case c.ALPHABETICAL:b=1;break;case c.USER_PREFERENCE:b=0}return b},p=function(a){var b=null,c=e.SubjectAndSummary.Constants.MODES;switch(a){case c.SUBSUM:b=1;break;case c.SUBONLY:b=0}return b},q=function(a){var b=a.getAttribute("id"),c=g.SettingID,d=a.get(),e={mode:"viewVO",settings:{}};switch(b){case c.MailReadingPane:e.settings.mailView=j(d);break;case c.ReadReceipt:e.settings.askReceiptOnRead=k(d);break;case c.LoadExternalImage:e.settings.loadExternalImages=l(d);break;case c.TimeFormat:e.settings.isRailTime=m(d);break;case c.FolderListSortMode:e.settings.sortFolders=n(d);break;case c.TagListSortMode:e.settings.sortTags=o(d);break;case c.summarySubjectMode:e.settings.showSummary=p(d)}return e.settings=JSON.stringify(e.settings),e},r=function(a){var b=c.makeDeferred(),d=a;if(a=a||this,"string"==typeof a&&(a=f.get(a)),!a)return b.reject(),b.promise();if("comment-box-hide-mode"===d)return zmAdHocSettings.setCommentBoxView("show"===a.get()?"on":"off"),b.resolve(),b.promise();var e=i(),g=q(a);
return h({url:e,data:g}).done(function(a){b.resolve(a.response)}).fail(function(a){b.reject(a.response)}),b.promise()};a.save=r},"MailSuite.Settings.Mail"),_defineSettingsModule("ReadReceipt",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Settings.Mail.Persister"),e=b("Platform.System.Utils"),f=c.SettingManager,g="mail-read-receipt",h="always",i="never",j="ask",k=function(){return[h,i,j]},l=function(){return{ALWAYS:h,NEVER:i,ASK_USER:j}},m={MODES:l(),VALUE_MAP:{always:0,never:2,ask:1},VALUE_REVERSE_MAP:{0:h,1:j,2:i}},n=f.create(g,{props:{defaultValue:j,options:k()},persister:{errors:function(a){return"Error occurred ( E"+a+")"},fetch:function(){var a=e.makeDeferred(),b=m.VALUE_REVERSE_MAP[zmail.mailOpt.askReceipt];return a.resolve(b),a.promise()},save:function(){var a=e.makeDeferred();return d.save(g).done(a.resolve).fail(a.fail),a.resolve(),a.promise()}},type:"option",category:"mail"}),o=function(){n.on("props.change",function(a){if(a=a||{},a.changed.hasOwnProperty("value")){var b=m.VALUE_MAP[a.changed.value];zmail.mailOpt=zmail.mailOpt||{},zmail.mailOpt.askReceipt=m.VALUE_MAP[a.changed.value],$.publish("SETTINGS_ASK_RECEIPT_ON_READ",b)}})};o(),a.Setting=n,a.Constants=m},"MailSuite.Settings.Mail"),_defineSettingsModule("ReadingPane",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=b("MailSuite.Settings.Mail.Persister"),f=c.SettingManager,g="mail-reading-pane",h="vertical",i="tab",j="window",k="horizontal",l=function(){return[h,i,j,k]},m=function(){return{VERTICAL:h,HORIZONTAL:k,TAB:i,WINDOW:j}},n={MODES:m(),VALUE_MAP:{0:h,4:k,1:j,2:i},VALUE_REVERSE_MAP:{vertical:0,window:1,tab:2,horizontal:4}},o=f.create(g,{props:{defaultValue:h,options:l()},persister:{errors:function(a){return"Error occurred ( E"+a+")"},fetch:function(){var a=d.makeDeferred(),b=n.VALUE_MAP[zmail.userOptions.mailView];return a.resolve(b),a.promise()},save:function(){var a=d.makeDeferred();return e.save(g).done(a.resolve).fail(a.fail),a.resolve(),a.promise()}},type:"option",category:"mail"});o.initialize();var p=function(){o.on("props.change",function(a){if(a=a||{},a.changed.hasOwnProperty("value")){var b=n.VALUE_REVERSE_MAP[a.changed.value];zmail.userOptions=zmail.userOptions||{},zmail.userOptions.mailView=b,0!==b&&4!==b||zmAdHocSettings.setMailPreviewSize("63"),$.publish("SETTINGS_MAIL_VIEW",b)}})};p(),a.Setting=o,a.Constants=n},"MailSuite.Settings.Mail"),_defineSettingsModule("SubjectAndSummary",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Settings.Mail.Persister"),e=b("Platform.System.Utils"),f=c.SettingManager,g="subject-and-summary",h="Subject and Summary",i="Subject Only",j=function(){return[h,i]},k=function(){return{SUBSUM:h,SUBONLY:i}},l={MODES:k(),VALUE_MAP:{0:h,1:i},VALUE_REVERSE_MAP:{"Subject and Summary":0,"Subject Only":1}},m=f.create(g,{props:{defaultValue:h,options:j()},persister:{errors:function(a){return"Error Occured + Erroe Code = "+a},fetch:function(a){var b=e.makeDeferred();e.debugLog("fetching Mail Setting"+g,a);var c,d=zmail.mailOpt.isshowSummary;c=d?0:1;var f=l.VALUE_MAP[c];return b.resolve(f),b.promise()},save:function(){var a=e.makeDeferred();return d.save(g).done(a.resolve).fail(a.fail),a.promise()}}}),n=function(){m.on("props.change",function(a){if(a=a||{},a.changed.hasOwnProperty("value")){var b=l.VALUE_REVERSE_MAP[a.changed.value],c=!1;0===b&&(c=!0),zmail.mailOpt.isshowSummary=c}})};n(),a.Setting=m,a.Constants=l},"MailSuite.Settings.Mail"),_defineSettingsModule("LoadExternalImage",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Settings.Mail.Persister"),e=b("Platform.System.Utils"),f=c.SettingManager,g="load-external-image",h="always",i="contacts",j="ask",k=function(){return[h,i,j]},l=function(){return{ALWAYS:h,CONTACTS:i,ASK_USER:j}},m={MODES:l(),VALUE_MAP:{0:h,1:i,2:j},VALUE_REVERSE_MAP:{always:0,contacts:1,ask:2}},n=f.create(g,{props:{defaultValue:j,options:k()},persister:{errors:function(a){return"Error occurred ( E"+a+")"},fetch:function(){var a=e.makeDeferred(),b=m.VALUE_MAP[zmail.userOptions.loadExternalImages];return a.resolve(b),a.promise()},save:function(){var a=e.makeDeferred();return d.save(g).done(a.resolve).fail(a.fail),a.resolve(),a.promise()}},type:"option",category:"mail"}),o=function(){n.on("props.change",function(a){if(a=a||{},a.changed.hasOwnProperty("value")){var b=m.VALUE_REVERSE_MAP[a.changed.value];zmail.userOptions=zmail.userOptions||{},zmail.userOptions.loadExternalImages=b,$.publish("SETTINGS_LOAD_EXTERNAL_IMAGES",b)}})};o(),a.Setting=n,a.Constants=m},"MailSuite.Settings.Mail"),_defineSettingsModule("DisplayTimeFormat",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Settings.Mail.Persister"),e=b("Platform.System.Utils"),f=c.SettingManager,g="display-time-format",h="12",i="24",j=function(){return[h,i]},k=function(){return{TWELVE_HOUR:h,TWENTY_FOUR_HOUR:i}},l={MODES:k(),VALUE_MAP:{"false":h,"true":i},VALUE_REVERSE_MAP:{12:!1,24:!0}},m=f.create(g,{props:{defaultValue:h,options:j()},persister:{errors:function(a){return"Error occurred ( E"+a+")"},fetch:function(){var a=e.makeDeferred(),b=l.VALUE_MAP[zmail.userOptions.isRailTime];return a.resolve(b),a.promise()},save:function(){var a=e.makeDeferred();return d.save(g).done(a.resolve).fail(a.fail),a.resolve(),a.promise()}},type:"option",category:"mail"}),n=function(){m.on("props.change",function(a){if(a=a||{},a.changed.hasOwnProperty("value")){var b=l.VALUE_REVERSE_MAP[a.changed.value];zmail.userOptions=zmail.userOptions||{},zmail.userOptions.isRailTime=b,$.publish("SETTINGS_TIME_FORMAT",b)}})};n(),a.Setting=m,a.Constants=l},"MailSuite.Settings.Mail"),_defineSettingsModule("FolderListSortMode",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Settings.Mail.Persister"),e=b("Platform.System.Utils"),f=c.SettingManager,g="folder-list-sort-mode",h="alphabetical",i="user-preference",j=function(){return[h,i]},k=function(){return{ALPHABETICAL:h,USER_PREFERENCE:i}},l={MODES:k(),VALUE_MAP:{"user-preference":0,alphabetical:1},VALUE_REVERSE_MAP:{0:i,1:h}},m=f.create(g,{props:{defaultValue:h,options:j()},persister:{errors:function(a){return"Error occurred ( E"+a+")"},fetch:function(){var a=e.makeDeferred(),b=l.VALUE_REVERSE_MAP[zmail.mailOpt.folSort];return a.resolve(b),a.promise()},save:function(){var a=e.makeDeferred();return d.save(g).done(a.resolve).fail(a.fail),a.resolve(),a.promise()}},type:"option",category:"mail"}),n=function(){m.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&(zmail.mailOpt=zmail.mailOpt||{},zmail.mailOpt.folSort=l.VALUE_MAP[a.changed.value])})};n(),a.Setting=m,a.Constants=l},"MailSuite.Settings.Mail"),_defineSettingsModule("CommentBoxHide",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Settings.Mail.Persister"),e=b("Platform.System.Utils"),f=c.SettingManager,g="comment-box-hide-mode",h="show",i="hide",j=function(){return[h,i]},k=function(){var a=zmAdHocSettings.getCommentBoxView();return"0"===a&&!zmail.isOrg||zmail.isOrg&&"off"===a},l=function(){return{SHOW:h,HIDE:i}},m={MODES:l(),VALUE_MAP:{show:"on",hide:"off"},VALUE_REVERSE_MAP:{on:h,off:i}},n=f.create(g,{props:{defaultValue:m.VALUE_REVERSE_MAP[k()?"off":"on"],options:j()},persister:{errors:function(a){return"Error occurred ( E"+a+")"},fetch:function(){var a=e.makeDeferred(),b=m.VALUE_REVERSE_MAP[k()?"off":"on"];return a.resolve(b),a.promise()},save:function(){var a=e.makeDeferred();return d.save(g).done(a.resolve).fail(a.fail),a.resolve(),a.promise()}},type:"option",category:"mail"});a.Setting=n,a.Constants=m},"MailSuite.Settings.Mail"),_defineSettingsModule("TagListSortMode",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Settings.Mail.Persister"),e=b("Platform.System.Utils"),f=c.SettingManager,g="tag-list-sort-mode",h="alphabetical",i="user-preference",j=function(){return[h,i]},k=function(){return{ALPHABETICAL:h,USER_PREFERENCE:i}},l={MODES:k(),VALUE_MAP:{"user-preference":0,alphabetical:1},VALUE_REVERSE_MAP:{0:i,1:h}},m=f.create(g,{props:{defaultValue:h,options:j()},persister:{errors:function(a){return"Error occurred ( E"+a+")"},fetch:function(){var a=e.makeDeferred(),b=l.VALUE_REVERSE_MAP[zmail.mailOpt.labSort];return a.resolve(b),a.promise()},save:function(){var a=e.makeDeferred();return d.save(g).done(a.resolve).fail(a.fail),a.resolve(),a.promise()}},type:"option",category:"mail"}),n=function(){m.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&(zmail.mailOpt=zmail.mailOpt||{},zmail.mailOpt.labSort=l.VALUE_MAP[a.changed.value])})};n(),a.Setting=m,a.Constants=l},"MailSuite.Settings.Mail"),_defineSettingsModule("CalendarServiceSetting",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="calendar-service-setting",g="zcal",h="zcrm",i=function(){return[g,h]},j=function(){return{ZCAL:g,ZCRM:h}},k={MODES:j(),VALUE_MAP:{zcal:g,zcrm:h},VALUE_REVERSE_MAP:{zcal:"zcal",zcrm:"zcrm"}},l=e.create(f,{props:{defaultValue:g,options:i()},persister:{errors:function(a){return"Error occurred ( E"+a+")"},fetch:function(){var a=d.makeDeferred(),b=k.VALUE_MAP[zmAdHocSettings.getCalServiceName()];return a.resolve(b),a.promise()},save:function(){var a=d.makeDeferred();return zmAdHocSettings.setCalServiceName(l.get()),a.resolve(),a.promise()}},type:"option",category:"mail"});a.Setting=l,a.Constants=k},"MailSuite.Settings.Mail"),_defineSettingsModule("Cards",function(a,b){var c="event-mail-action",d="mail",e="event-mail-action",f=zmText.get("zm-settings-core","eventMailAction"),g=f.card,h=b("MailSuite.App"),i=b("Platform.Events.Base"),j=b("Platform.Components"),k=j.SettingCardManager,l=j.SettingCardItemManager,m=j.SettingManager,n=b("Platform.Entities"),o=n.SettingCardItem,p=o.Types,q=k.create(c,{props:{openable:!0,title:g.title,addToSearch:!1},state:{hidden:!1},attributes:{category:d},openAction:k.CardActions.OpenPageAction(e)}),r=f.cardItems.mailEventSaveTarget,s=l.create("calendar-service-setting",{props:{title:r.cardItem.title,value:"...",addToSearch:!1},attributes:{type:p.LabelValue,card:c},primaryAction:function(){var a=l.CardItemActions.OpenPageAction("event-mail-action",{showSection:"calendar-service-setting"});a()}}),t=function(){var a=m.get("calendar-service-setting");return zmText.applyArgs(r.cardItem.values[a.get()],{companyName:zmail.globalI18N.companyName})},u=function(){zmail.postJsDeffered.promise.then(function(){zmail.integStatusPromise.then(function(){_zm.checkForCRMMailAddonUser().done(function(){window.zmail.isCRMMailAddonUser||q.setState({hidden:!0})})})}),m.get("calendar-service-setting").on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&s.setProp({value:t()})}),i.subscribeEvent(h,h.Events.OPEN,function(){s.setProp({value:t()})})};u(),a.EventMailAction=q},"MailSuite"),_defineSettingsModule("MailViewOptions",function(a,b){var c,d=b("Platform.Components"),e=d.SettingAppManager,f=b("Platform.System.Utils"),g="mail-view-options",h="mail-view-options",i="zm-settings-app-mailviewoptions",j="MailSuite.Apps.MailViewOptions.AppCore",k=function(){return zmAppLoader.load(i)},l=function(){return b(j)},m=function(){var a=f.makeDeferred();return k().then(function(){l().initialize({process:a})},function(){f.debugLog("Module load failed !!!"),a.reject()}),a.promise()},n=function(){var a=f.makeDeferred();return k().then(function(){l().uninitialize({process:a})}),a.promise()},o=function(){var a=l();return a.getSettingsAppView()},p=function(){var a=l(),b=Array.prototype.slice.call(arguments);return a?a.handleContainerEvent.apply(this,b):null},q=function(){c=e.create(g,{attributes:{page:h,isReactApp:!0},initialize:m,uninitialize:n,getView:o,handleContainerEvent:p})},r=function(){q(),a.App=c};r()},"MailSuite.Apps"),_defineSettingsModule("EventMailAction",function(a,b){var c,d=b("Platform.Components"),e=d.SettingAppManager,f=b("Platform.System.Utils"),g="event-mail-action",h="event-mail-action",i="zm-settings-app-eventmailaction",j="MailSuite.Apps.EventMailAction.AppCore",k=function(){return zmAppLoader.load(i)},l=function(){return b(j)},m=function(){var a=f.makeDeferred();return k().done(function(){l().initialize({process:a})},function(){f.debugLog("Module load failed !!!"),a.reject()}),a.promise()},n=function(){var a=f.makeDeferred();return k().then(function(){l().uninitialize({process:a})}),a.promise()},o=function(){var a=l();return a.getSettingsAppView()},p=function(){var a=l(),b=Array.prototype.slice.call(arguments);return a?a.handleContainerEvent.apply(this,b):null},q=function(){c=e.create(g,{attributes:{page:h,isReactApp:!0},initialize:m,uninitialize:n,getView:o,handleContainerEvent:p})},r=function(){q(),a.App=c};r()},"MailSuite.Apps"),function(a){var b="mail-view-options",c={READING_PANE:"mail-reading-pane",READ_RECEIPT:"read-receipt",LOAD_EXTERNAL_IMAGES:"load-external-images",TIME_FORMAT:"display-time-format",FOLDER_LIST_SORT_MODE:"folder-list-sort-mode",TAG_LIST_SORT_MODE:"tag-list-sort-mode",SUBJECT_AND_SUMMARY_MODE:"sub-sum-mode"},d=zmText.get("zm-settings-core","mailViewOptions"),e=d.cardItems,f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Mail"),i=h.ReadingPane,j=h.ReadReceipt,k=h.LoadExternalImage,l=h.DisplayTimeFormat,m=h.FolderListSortMode,n=h.TagListSortMode,o=h.SubjectAndSummary,p=f.SettingCardItemManager,q=g.SettingCardItem,r=q.Types,s=function(a,b){for(var c in b)if(b[c]===a)return c},t=function(a){a=a||i.Setting.get();var b=s(a,i.Constants.MODES);return e.readingPane.modes[b]},u=p.create(c.READING_PANE,{props:{title:e.readingPane.cardItem.title,value:t()},attributes:{type:r.LabelValue,card:b},primaryAction:function(){var a=p.CardItemActions.OpenPageAction("mail-view-options",{showSection:"reading-pane"});a()}}),v=function(a){a=a||j.Setting.get();var b=s(a,j.Constants.MODES);return e.readReceipt.modes[b]},w=p.create(c.READ_RECEIPT,{props:{title:e.readReceipt.cardItem.title,value:v()},attributes:{type:r.LabelValue,card:b},primaryAction:function(){var a=p.CardItemActions.OpenPageAction("mail-view-options",{showSection:"read-receipt"});a()}}),x=function(a){a=a||k.Setting.get();var b=s(a,k.Constants.MODES);return e.loadExternalImages.modes[b]},y=p.create(c.LOAD_EXTERNAL_IMAGES,{props:{title:e.loadExternalImages.cardItem.title,value:x()},attributes:{type:r.LabelValue,card:b},primaryAction:function(){var a=p.CardItemActions.OpenPageAction("mail-view-options",{showSection:"load-external-images"});a()}}),z=function(a){a=a||l.Setting.get();var b=s(a,l.Constants.MODES);return e.displayTimeFormat.modes[b]},A=p.create(c.TIME_FORMAT,{props:{title:e.displayTimeFormat.cardItem.title,value:z()},attributes:{type:r.LabelValue,card:b},primaryAction:function(){var a=p.CardItemActions.OpenPageAction("mail-view-options",{showSection:"time-format"});a()}}),B=function(a){a=a||m.Setting.get();var b=s(a,m.Constants.MODES);return e.folderListSortMode.modes[b]},C=p.create(c.FOLDER_LIST_SORT_MODE,{props:{title:e.folderListSortMode.cardItem.title,value:B()},attributes:{type:r.LabelValue,card:b},primaryAction:function(){var a=p.CardItemActions.OpenPageAction("mail-view-options",{showSection:"folder-list-sort-mode"});a()}}),D=function(a){a=a||n.Setting.get();var b=s(a,n.Constants.MODES);return e.tagListSortMode.modes[b]},E=p.create(c.TAG_LIST_SORT_MODE,{props:{title:e.tagListSortMode.cardItem.title,value:D()},attributes:{type:r.LabelValue,card:b},primaryAction:function(){var a=p.CardItemActions.OpenPageAction("mail-view-options",{showSection:"tag-list-sort-mode"});a()}}),F=function(a){a=a||o.Setting.get();var b=s(a,o.Constants.MODES);return e.subjectAndSummaryMode.modes[b]},G=p.create(c.SUBJECT_AND_SUMMARY_MODE,{props:{title:e.subjectAndSummaryMode.cardItem.title,value:F()},attributes:{type:r.LabelValue,card:b},primaryAction:function(){var a=p.CardItemActions.OpenPageAction("mail-view-options",{showSection:"sub-sum-mode"});a()}}),H=function(){i.Setting.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&u.setProp({value:t(a.changed.value)})}),j.Setting.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&w.setProp({value:v(a.changed.value)})}),k.Setting.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&y.setProp({value:x(a.changed.value)})}),l.Setting.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&A.setProp({value:z(a.changed.value)})}),m.Setting.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&C.setProp({value:B(a.changed.value)})}),o.Setting.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&G.setProp({value:F(a.changed.value)})}),n.Setting.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&E.setProp({value:D(a.changed.value)})})};H()}(zmail.Settings.Modules["import"]),function(a){var b="mail-view-options",c={READING_PANE:"mail-reading-pane",READ_RECEIPT:"read-receipt",LOAD_EXTERNAL_IMAGES:"load-external-images",TIME_FORMAT:"display-time-format"},d=zmText.get("zm-settings-core","mailViewOptions.quickNavigatorItems"),e=d,f="mail-view-options",g={READING_PANE:"reading-pane",READ_RECEIPT:"read-receipt",LOAD_EXTERNAL_IMAGES:"load-external-images",TIME_FORMAT:"time-format"},h=a("Platform.Components"),i=h.QuickNavigatorSectionManager,j=h.QuickNavigatorItemManager;i.create(b,{props:{title:e.sectionTitle},state:{selected:!1}}),j.create(c.READING_PANE,{props:{title:e.readingPane,linkedPage:f,linkedPageSection:g.READING_PANE,selectable:!0},attributes:{section:b}}),j.create(c.READ_RECEIPT,{props:{title:e.readReceipt,linkedPage:f,linkedPageSection:g.READ_RECEIPT,selectable:!0},attributes:{section:b}}),j.create(c.LOAD_EXTERNAL_IMAGES,{props:{title:e.loadExternalImages,linkedPage:f,linkedPageSection:g.LOAD_EXTERNAL_IMAGES,selectable:!0},attributes:{section:b}}),j.create(c.TIME_FORMAT,{props:{title:e.displayTimeFormat,linkedPage:f,linkedPageSection:g.TIME_FORMAT,selectable:!0},attributes:{section:b}})}(zmail.Settings.Modules["import"]),_defineSettingsModule("Pages",function(a,b){var c="compose-settings",d=b("Platform.Components"),e=b("Platform.Entities"),f=zmText.get("zm-settings-core","compose"),g=f.page,h=d.SettingPageManager,i=e.SettingPage,j=i.Types,k=h.create(c,{props:{title:g.title},attributes:{type:j.PageAlone,card:c,pageContainerClassNames:"zmSetPage",category:"mail",pageCSSClass:"zmSetNPwra"}});a.Compose=k},"MailSuite"),_defineSettingsModule("Cards",function(a,b){var c="compose-settings",d="mail",e="compose-settings",f=zmText.get("zm-settings-core","compose"),g={cardTitle:f.card.title},h=b("Platform.Components"),i=h.SettingCardManager,j=i.create(c,{props:{openable:!0,title:g.cardTitle},attributes:{category:d},openAction:i.CardActions.OpenPageAction(e)});a.Compose=j},"MailSuite"),_defineSettingsModule("ComposeTarget",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="compose-target",g="inline",h="tab",i="window",j=function(){return[0,1,2]},k=function(){return{0:i,1:h,2:g}},l={ALLOWED_VALUES:j(),TARGET_MODE:k()},m={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=d.makeDeferred();return d.debugLog("fetching mail-setting "+f,a),b.resolve(zmail.userOptions.composeView),b.promise()},save:function(a,b){var c=d.makeDeferred();d.debugLog("saving "+f,a,b);var e={settings:JSON.stringify({composeView:a}),mode:"composeVO"},g={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.composeView=b.value,c.resolve(b.value)},p:e,csr:"s",ep:g}),c.promise()}},n=e.create(f,{props:{defaultValue:zmail.userOptions.composeView,options:j()},persister:m,type:"option",category:"compose"});n.initialize(),a.Setting=n,a.Constants=l},"MailSuite.Settings.Compose"),_defineSettingsModule("ContentEncoding",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="compose-content-encoding",g=function(){return zmail.userOptions.encodings},h={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+f,a),b.resolve(zmail.userOptions.encoding),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b);var d={settings:JSON.stringify({encoding:a}),mode:"composeVO"},g={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.encoding=b.value,c.resolve(b.value)},p:d,csr:"s",ep:g}),c.promise()}},i={allowedValues:g()},j=d.create(f,{props:{defaultValue:"UTF-8",options:g()},persister:h,type:"option",category:"compose"});j.initialize(),a.Setting=j,a.Constants=i},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeFontFamily",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="compose-font-family",g=function(){var a=zmail.userOptions.composeFonts.slice();if(zmail.zoid!==-1){var b=zmAdHocSettings.getCustomFontFamilyList().split(",");b.length>0&&"0"!==b[0]&&""!==b[0].trim()&&b.forEach(function(b){a.push(b)}),b.length<5&&a.push("custom")}return a},h={allowedValues:g()},i={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+f,a),"Default"===zmail.userOptions.fontFamily&&(zmail.userOptions.fontFamily="Arial"),b.resolve(zmail.userOptions.fontFamily),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b);var d={settings:JSON.stringify({fontFamily:a}),mode:"composeVO"},g={value:a,opts:b};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){b.opts.hasOwnProperty("customFont")||(zmail.userOptions.fontFamily=b.value),c.resolve(b.value)},p:d,csr:"s",ep:g}),c.promise()}},j=d.create(f,{props:{defaultValue:zmail.userOptions.fontFamily},persister:i,category:"compose"});j.initialize(),a.Setting=j,a.Constants=h,a.fontFamilyList=g},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeFontSize",function(a,b){var c=b("Platform.Components"),d=b("Platform.System.Utils"),e=c.SettingManager,f="compose-font-size",g=function(){for(var a=[],b=8;b<100;)a.push(b),b+=.5;return a},h=function(){return[8,10,12,14,18,24,36,"custom"]},i={allowedValues:h()},j={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=d.makeDeferred();return d.debugLog("fetching mail-setting "+f,a),b.resolve(zmail.userOptions.fontSize),b.promise()},save:function(a,b){var c=d.makeDeferred();d.debugLog("saving "+f,a,b);var e={settings:JSON.stringify({fontSize:a}),mode:"composeVO"},g={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.fontSize=b.value,c.resolve(b.value)},p:e,csr:"s",ep:g}),c.promise()}},k=e.create(f,{props:{defaultValue:zmail.userOptions.fontSize,options:g()},persister:j,type:"option",category:"compose"});k.initialize(),a.Setting=k,a.Constants=i},"MailSuite.Settings.Compose"),_defineSettingsModule("AutoAddContacts",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="compose-auto-add-contacts",g={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+f,a),b.resolve(Boolean(zmail.userOptions.autoAddContacts)),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b),a=a?1:0;var d={settings:JSON.stringify({autoAddContacts:a}),mode:"composeVO"},g={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.composeView=b.value,c.resolve(b.value)},p:d,csr:"s",ep:g}),c.promise()}},h=d.create(f,{props:{defaultValue:!0},persister:g,type:"boolean",category:"compose"});h.initialize(),a.Setting=h},"MailSuite.Settings.Compose"),_defineSettingsModule("OutboxDelayDuration",function(a,b){var c=b("Platform.Components"),d=b("Platform.Validators.Basic"),e=b("Platform.System.Utils"),f=c.SettingManager,g={range:{max:120,min:-1}},h="compose-outbox-delay-duration",i={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+h,a),b.resolve(zmail.userOptions.outboxInterval),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+h,a,b);var d={settings:JSON.stringify({outboxInterval:a}),mode:"composeVO"},f={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.outboxInterval=b.value,c.resolve(b.value)},p:d,csr:"s",ep:f}),c.promise()}},j=f.create(h,{props:{defaultValue:-1},persister:i,validations:[{validator:d.RangeValidator,opts:g.range}],type:"default",category:"compose"});j.initialize(),a.Setting=j,a.Constants=g},"MailSuite.Settings.Compose"),_defineSettingsModule("OutboxDelayState",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Settings.Compose"),e=d.OutboxDelayDuration.Setting,f=c.SettingManager,g="compose-outbox-delay-state",h=f.create(g,{props:{defaultValue:!1},type:"boolean",category:"compose"});h.initialize({value:e.get()>0}),a.Setting=h;var i=function(){e.on("props.change",function(a){h.set(a.changed.value>0)}),h.on("props.change",function(a){var b=e.get("value");a.changed.value&&b>0||e.set(a.changed.value?1:-1)})};i()},"MailSuite.Settings.Compose"),_defineSettingsModule("AskReceipt",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="compose-ask-receipt",g={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+f,a),b.resolve(Boolean(zmail.cmpdata.ASKRECEIPT)),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b),a=a?1:0;var d={settings:JSON.stringify({askReceipt:a}),mode:"composeVO"},g={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.askReceipt=b.value,c.resolve(b.value)},p:d,csr:"s",ep:g}),c.promise()}},h=d.create(f,{props:{defaultValue:Boolean(zmail.cmpdata.ASKRECEIPT)},persister:g,type:"boolean",category:"compose"});h.initialize(),a.Setting=h},"MailSuite.Settings.Compose"),_defineSettingsModule("hugeAttachment",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="compose-huge-attachment",g={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+f,a),b.promise()},save:function(a,b){var c=e.makeDeferred();return e.debugLog("saving "+f,a,b),c.promise()}},h=d.create(f,{props:{defaultValue:0},persister:g,type:"boolean",category:"compose"});h.initialize(),a.Setting=h},"MailSuite.Settings.Compose"),_defineSettingsModule("ShowCC",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="compose-show-cc",g={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();e.debugLog("fetching mail-setting "+f,a);var c="1"===zmAdHocSettings.getShowCCOption();return b.resolve(c),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b);var d="0";return a&&(d="1"),zmAdHocSettings.setShowCCOption(d),c.resolve(a),c.promise()}},h=d.create(f,{props:{defaultValue:"1"===zmAdHocSettings.getShowCCOption()},persister:g,type:"boolean",category:"compose"});h.initialize(),a.Setting=h},"MailSuite.Settings.Compose"),_defineSettingsModule("ShowBCC",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="compose-show-bcc",g={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+f,a),b.resolve(Boolean(zmail.cmpdata.SHOWBCC)),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b),a=a?1:0;var d={settings:JSON.stringify({showBcc:a}),mode:"composeVO"},g={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.showBCC=b.value,zmail.cmpdata.SHOWBCC=b.value,c.resolve(b.value)},p:d,csr:"s",ep:g}),c.promise()}},h=d.create(f,{props:{defaultValue:Boolean(zmail.cmpdata.SHOWBCC)},persister:g,type:"boolean",category:"compose"});h.initialize(),a.Setting=h},"MailSuite.Settings.Compose"),_defineSettingsModule("SuggestContacts",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="compose-suggest-contacts",g={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();e.debugLog("fetching mail-setting "+f,a);var c="1"===zmAdHocSettings.getContactsSuggestionType();return b.resolve(c),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b);var d="0";return a&&(d="1"),zmAdHocSettings.setContactsSuggestionType(d),c.resolve(a),c.promise()}},h=d.create(f,{props:{defaultValue:"1"===zmAdHocSettings.getContactsSuggestionType()},persister:g,type:"boolean",category:"compose"});h.initialize(),a.Setting=h},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeFontColor",function(a,b){var c,d=b("Platform.Components"),e=b("Platform.System.Utils"),f=d.SettingManager,g="compose-font-color",h=function(){return["#ffffff","#cceeff","#ccccff","#e5ccff","#ffccff","#ffccee","#ffcccc","#ffe5cc","#ffffcc","#ccffcc","#ccffff","#cccccc","#99ccff","#9999ff","#cc99ff","#ff99ff","#ff99cc","#ff9999","#ffcc99","#ffff99","#99ff99","#99ffff","#c0c0c0","#66ccff","#6666ff","#b266ff","#ff66fe","#ff66b2","#ff6666","#ffb266","#feff66","#66ff66","#66feff","#999999","#399cfd","#3333ff","#9933ff","#ff33fe","#ff3398","#ff3333","#ff9933","#feff33","#33ff33","#33feff","#666666","#3399ff","#0000ff","#7700ff","#ff00ee","#ff0077","#ff0000","#ff7f00","#feff00","#00ff00","#00feff","#444444","#0065cc","#0000cc","#6600cc","#cc00cb","#cc00cb","#cc0000","#cc6600","#cbcc00","#00cc00","#00cbcc","#333333","#004c99","#000099","#4B0099","#990098","#99004c","#990000","#994c00","#989900","#009900","#009899","#000000","#003366","#000066","#330066","#660066","#660032","#660000","#663300","#666600","#006600","#006666"]},i={allowedValues:h()},j={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+g,a),b.resolve(zmail.userOptions.fontColor),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+g,a,b);var d={settings:JSON.stringify({fontColor:a}),mode:"composeVO"},f={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){zmail.userOptions.fontColor=b.value,c.resolve(b.value)},p:d,csr:"s",ep:f}),c.promise()}};c=f.create(g,{props:{defaultValue:zmail.userOptions.fontColor},persister:j,category:"compose"}),c.initialize(),a.Setting=c,a.Constants=i},"MailSuite.Settings.Compose"),function(a){var b=a("MailSuite.Settings.Compose"),c=b.AutoAddContacts.Setting,d=b.OutboxDelayDuration.Setting,e=b.ComposeFontSize.Setting,f=b.ComposeFontFamily.Setting,g=b.ContentEncoding.Setting,h=b.ComposeTarget.Setting,i=b.AskReceipt.Setting,j=b.ShowBCC.Setting,k=b.SuggestContacts.Setting,l={autoAddContacts:"CS_ADD_RECIPIENTS_CHANGED",composeView:"CS_EDITOR_TYPE_CHANGED",encoding:"CS_ENCODING_CHANGED",fontFamily:"CS_FONT_FAMILY_CHANGED",fontSize:"CS_FONT_SIZE_CHANGED",outboxInterval:"CS_SENDING_DELAY_CHANGED",askReceipt:"CS_ASK_RECEIPT_CHANGED",showBcc:"CS_SHOW_BCC_CHANGED",suggestContacts:"CS_SUGGEST_CONTACTS_CHANGED"},m=function(a){return function(b){b=b||{},b.changed.hasOwnProperty("value")&&$.publish(a,b.changed.value)}};d.props.on("change",m(l.outboxInterval)),c.props.on("change",m(l.autoAddContacts)),e.props.on("change",m(l.fontSize)),f.props.on("change",m(l.fontFamily)),g.props.on("change",m(l.encoding)),h.props.on("change",m(l.composeView)),i.props.on("change",m(l.askReceipt)),j.props.on("change",m(l.showBcc)),k.props.on("change",m(l.suggestContacts))}(zmail.Settings.Modules["import"]),function(a){var b="compose-settings",c="compose-settings",d={COMPOSE_TARGET:"compose-target",CONTENT_ENCODING:"compose-encoding",AUTO_ADD_CONTACTS:"auto-add-contacts",
COMPOSE_FONT_FAMILY:"compose-font-family",COMPOSE_FONT_SIZE:"compose-font-size",OUTBOX_INTERVAL:"compose-outbox-delay-duration",SHOW_BCC:"compose-show-bcc",COMPOSE_FONT_COLOR:"compose-font-color"},e=zmText.get("zm-settings-core","compose.cardItems"),f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Compose"),i=h.ComposeTarget,j=h.ContentEncoding,k=h.AutoAddContacts,l=h.ComposeFontFamily,m=h.ComposeFontSize,n=h.OutboxDelayDuration,o=h.ShowBCC,p=f.SettingCardItemManager,q=g.SettingCardItem,r=q.Types,s=i.Setting,t=j.Setting,u=k.Setting,v=l.Setting,w=m.Setting,x=n.Setting,y=o.Setting,z=i.Constants.TARGET_MODE,A=function(a){a=a||s.get();var b=z[a];return e.composeTarget.targetModes[b]},B=function(a){return"undefined"==typeof a&&(a=x.get()),a<=0?e.outboxDelayDuration.valueNotSet:a+" "+e.outboxDelayDuration.minutes},C=p.create(d.COMPOSE_TARGET,{props:{title:e.composeTarget.cardItem.title,value:A()},attributes:{type:r.LabelValue,card:b},primaryAction:p.CardItemActions.OpenPageAction(c,{showSection:d.COMPOSE_TARGET})}),D=p.create(d.CONTENT_ENCODING,{props:{title:e.contentEncoding.cardItem.title,value:t.get()},attributes:{type:r.LabelValue,card:b},primaryAction:p.CardItemActions.OpenPageAction(c,{showSection:d.CONTENT_ENCODING})}),E=p.create(d.COMPOSE_FONT_FAMILY,{props:{title:e.composeFontFamily.cardItem.title,value:v.get()},attributes:{type:r.LabelValue,card:b},searchCommand:{title:e.composeFontFamily.searchCommand.title},primaryAction:p.CardItemActions.OpenPageAction(c,{showSection:d.COMPOSE_FONT_FAMILY})}),F=p.create(d.COMPOSE_FONT_SIZE,{props:{title:e.composeFontSize.cardItem.title,value:w.get()},attributes:{type:r.LabelValue,card:b},searchCommand:{title:e.composeFontSize.searchCommand.title},primaryAction:p.CardItemActions.OpenPageAction(c,{showSection:d.COMPOSE_FONT_SIZE})}),G=p.create(d.OUTBOX_INTERVAL,{props:{title:e.outboxDelayDuration.cardItem.title,value:B()},attributes:{type:r.LabelValue,card:b},transformer:function(a,b){b=b||{},"props"===a&&b.hasOwnProperty("value")&&(b.value=B(b.value))},primaryAction:p.CardItemActions.OpenPageAction(c,{showSection:d.COMPOSE_FONT_SIZE})}),H=p.create(d.AUTO_ADD_CONTACTS,{props:{title:e.autoAddContacts.cardItem.title},attributes:{type:r.LabelAction,card:b},transformer:function(a,b){return b=b||{},"props"===a&&b.hasOwnProperty("value")&&(b.value=b.value===!0?e.autoAddContacts.enabled:e.autoAddContacts.disabled),b},primaryAction:p.CardItemActions.OpenPageAction(c,{showSection:d.AUTO_ADD_CONTACTS}),secondaryAction:function(){var a=u,b=a.get()!==!0;a.set(b)}}),I=p.create(d.SHOW_BCC,{props:{title:e.showBcc.cardItem.title},attributes:{type:r.LabelAction,card:b},transformer:function(a,b){return b=b||{},"props"===a&&b.hasOwnProperty("value")&&(b.value=b.value===!0?e.showBcc.disabled:e.showBcc.enabled),b},primaryAction:p.CardItemActions.OpenPageAction(c,{showSection:d.AUTO_ADD_CONTACTS}),secondaryAction:function(){var a=y,b=a.get()!==!0;a.set(b)}}),J=function(){s.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&C.setProp({value:A(a.changed.value)})}),t.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&D.setProp({value:a.changed.value})}),v.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&E.setProp({value:a.changed.value})}),w.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&F.setProp({value:a.changed.value})}),x.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&G.setProp({value:B(a.changed.value)})}),p.bindSetting(H,u),p.bindSetting(I,y)};J()}(zmail.Settings.Modules["import"]),function(a){var b="compose-settings",c={COMPOSE_TARGET:"compose-target",CONTENT_ENCODING:"compose-encoding",AUTO_ADD_CONTACTS:"auto-add-contacts",COMPOSE_FONT:"compose-font",OUTBOX_INTERVAL:"outbox-inteval",ASK_RECEIPT:"compose-ask-receipt",SHOW_CC:"compose-show-cc",SHOW_BCC:"compose-show-bcc",SUGGEST_CONTACTS:"compose-suggest-contacts",HUGE_ATTACHMENT:"huge-attachment"},d={COMPOSE_TARGET:"sa-compose-target",CONTENT_ENCODING:"sa-compose-encoding",AUTO_ADD_CONTACTS:"sa-auto-add-contacts",COMPOSE_FONT:"compose-font",OUTBOX_INTERVAL:"outbox-interval",ASK_RECEIPT:"compose-ask-receipt",SHOW_CC:"compose-show-cc",SHOW_BCC:"compose-show-bcc",SUGGEST_CONTACTS:"compose-suggest-contacts",HUGE_ATTACHMENT:"huge-attachment"},e={APPCORE_MODULE_ID:"zm-settings-app-composesettings"},f=zmText.get("zm-settings-core","compose.page"),g=a("Platform.Components"),h=a("Platform.Entities"),i=h.SettingPageSection,j=g.SettingAppManager,k=i.Types,l=g.SettingPageSectionManager,m=a("MailSuite.Settings.Compose"),n=m.AutoAddContacts.Setting,o=m.OutboxDelayDuration.Setting,p=m.OutboxDelayState.Setting,q=m.AskReceipt.Setting,r=m.ShowCC.Setting,s=m.ShowBCC.Setting,t=m.SuggestContacts.Setting,u=function(){return zmAppLoader.load(e.APPCORE_MODULE_ID)};l.create(c.COMPOSE_TARGET,{props:{title:f.section.composeTarget.title},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.composeTarget.quickLink,linkedPage:b,linkedPageSection:c.COMPOSE_TARGET,selectable:!0},attributes:{section:"compose-settings"}}}),l.create(c.CONTENT_ENCODING,{props:{title:f.section.defaultEncoding.title},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.defaultEncoding.quickLink,linkedPage:b,linkedPageSection:c.CONTENT_ENCODING,selectable:!0},attributes:{section:"compose-settings"}}}),l.create(c.COMPOSE_FONT,{props:{title:f.section.fontOptions.title},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.fontOptions.quickLink,linkedPage:b,linkedPageSection:c.COMPOSE_FONT,selectable:!0},attributes:{section:"compose-settings"}}}),zmail.ishugeAttachmentEnabled&&l.create(c.HUGE_ATTACHMENT,{props:{title:f.section.hugeAttachment.title},attributes:{page:b,type:k.PageAlone,appContainer:!0}});var v=l.create(c.OUTBOX_INTERVAL,{props:{title:f.section.outboxDelay.title,toggleSwitchFlex:!0,toggleSwitchOnText:"ON",toggleSwitchOffText:"OFF",toggleSwitchActive:o.get()>0},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.outboxDelay.quickLink,linkedPage:b,linkedPageSection:c.OUTBOX_INTERVAL,selectable:!0},attributes:{section:"compose-settings"}}}),w=l.create(c.AUTO_ADD_CONTACTS,{props:{title:f.section.autoAddContacts.title,toggleSwitchFlex:!0,toggleSwitchOnText:"ON",toggleSwitchOffText:"OFF",toggleSwitchActive:n.get()},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.autoAddContacts.quickLink,linkedPage:b,linkedPageSection:c.AUTO_ADD_CONTACTS,selectable:!0},attributes:{section:"compose-settings"}}}),x=l.create(c.ASK_RECEIPT,{props:{title:f.section.askReceipt.title,toggleSwitchFlex:!0,toggleSwitchOnText:"ON",toggleSwitchOffText:"OFF",toggleSwitchActive:!q.get()},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.askReceipt.quickLink,linkedPage:b,linkedPageSection:c.ASK_RECEIPT,selectable:!0},attributes:{section:"compose-settings"}}}),y=l.create(c.SHOW_CC,{props:{title:f.section.showCc.title,toggleSwitchFlex:!0,toggleSwitchOnText:"ON",toggleSwitchOffText:"OFF",toggleSwitchActive:!r.get()},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.showCc.quickLink,linkedPage:b,linkedPageSection:c.SHOW_CC,selectable:!0},attributes:{section:"compose-settings"}}});r.props.on("change",function(a){a.changed.hasOwnProperty("value")&&y.setProp({toggleSwitchActive:!a.changed.value})}),y.props.on("change:toggleSwitchActive",function(a){var b=a.changed.toggleSwitchActive;r.set(!b)});var z=l.create(c.SHOW_BCC,{props:{title:f.section.showBcc.title,toggleSwitchFlex:!0,toggleSwitchOnText:"ON",toggleSwitchOffText:"OFF",toggleSwitchActive:!s.get()},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.showBcc.quickLink,linkedPage:b,linkedPageSection:c.SHOW_BCC,selectable:!0},attributes:{section:"compose-settings"}}});if(zmail.isInternalOrgUser){var A=l.create(c.SUGGEST_CONTACTS,{props:{title:f.section.suggestContacts.title,toggleSwitchFlex:!0,toggleSwitchOnText:"ON",toggleSwitchOffText:"OFF",toggleSwitchActive:!t.get()},attributes:{page:b,type:k.PageAlone,appContainer:!0},quickNavigation:{props:{title:f.section.suggestContacts.quickLink,linkedPage:b,linkedPageSection:c.SUGGEST_CONTACTS,selectable:!0},attributes:{section:"compose-settings"}}});t.props.on("change",function(a){a.changed.hasOwnProperty("value")&&A.setProp({toggleSwitchActive:!a.changed.value})}),A.props.on("change:toggleSwitchActive",function(a){var b=a.changed.toggleSwitchActive;t.set(!b)})}var B=function(){return u()},C=function(){return u()},D=function(){var b=a("MailSuite.Settings.Compose.Views");return b.getComposeTargetComponent()},E=function(){j.create(d.COMPOSE_TARGET,{attributes:{pageSection:c.COMPOSE_TARGET,isReactApp:!0},initialize:B,uninitialize:C,getView:D,handleContainerEvent:function(){}}),j.create(d.CONTENT_ENCODING,{attributes:{pageSection:c.CONTENT_ENCODING,isReactApp:!0},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views");return b.getContentEncodingComponent()},handleContainerEvent:function(){}}),j.create(d.COMPOSE_FONT,{attributes:{pageSection:c.COMPOSE_FONT,isReactApp:!0},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views");return b.getComposeFontComponent()},handleContainerEvent:function(){}}),zmail.ishugeAttachmentEnabled&&j.create(d.HUGE_ATTACHMENT,{attributes:{pageSection:c.HUGE_ATTACHMENT,isReactApp:!0},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views"),c=f.section.hugeAttachment.modes,d=zmAdHocSettings.getAttachComp().hugeAttPref;d||(d="askMe");var e={initialSelected:d,onSelect:function(a){zmAdHocSettings.setAttachComp({hugeAttPref:a})},options:[{id:"askMe",title:c.ask},{id:"yes",title:c.yes},{id:"no",title:c.no}]},g=b.getHugeAttachment(e);return g}}),j.create(d.OUTBOX_INTERVAL,{attributes:{pageSection:c.OUTBOX_INTERVAL,isReactApp:!0},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views");return b.getOutboxDelayDurationComponent()},handleContainerEvent:function(){}}),j.create(d.AUTO_ADD_CONTACTS,{attributes:{pageSection:c.AUTO_ADD_CONTACTS},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views");return b.getAutoAddContactDOM()},handleContainerEvent:function(){}}),j.create(d.ASK_RECEIPT,{attributes:{pageSection:c.ASK_RECEIPT},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views");return b.getAskReceiptDOM()},handleContainerEvent:function(){}}),j.create(d.SHOW_CC,{attributes:{pageSection:c.SHOW_CC},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views");return b.getShowCcDOM()},handleContainerEvent:function(){}}),j.create(d.SHOW_BCC,{attributes:{pageSection:c.SHOW_BCC},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views");return b.getShowBccDOM()},handleContainerEvent:function(){}}),zmail.isInternalOrgUser&&j.create(d.SUGGEST_CONTACTS,{attributes:{pageSection:c.SUGGEST_CONTACTS},initialize:function(){return u()},uninitialize:function(){return u()},getView:function(){var b=a("MailSuite.Settings.Compose.Views");return b.getSuggestContactsDOM()},handleContainerEvent:function(){}})},F=function(){w.props.on("change:toggleSwitchActive",function(a){var b=a.changed.toggleSwitchActive;n.set(b)}),n.props.on("change",function(a){a.changed.hasOwnProperty("value")&&w.setProp({toggleSwitchActive:a.changed.value})}),x.props.on("change:toggleSwitchActive",function(a){var b=a.changed.toggleSwitchActive;q.set(!b)}),q.props.on("change",function(a){a.changed.hasOwnProperty("value")&&x.setProp({toggleSwitchActive:!a.changed.value})}),s.props.on("change",function(a){a.changed.hasOwnProperty("value")&&z.setProp({toggleSwitchActive:!a.changed.value})}),z.props.on("change:toggleSwitchActive",function(a){var b=a.changed.toggleSwitchActive;s.set(!b)}),v.props.on("change:toggleSwitchActive",function(a){a=a||{},a.changed.hasOwnProperty("toggleSwitchActive")&&p.set(a.changed.toggleSwitchActive)}),p.props.on("change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&v.setProp({toggleSwitchActive:a.changed.value})})};E(),F()}(zmail.Settings.Modules["import"]),_defineSettingsModule("ComposeClassConstants",function(a,b){var c={btnCls:"zmSelectBtn",selCls:" zmSel",customFontCls:"zmSelectBtnCE zmCenterAlign zmPlaceholder",separatorCls:"zmSLine",customFntCls:"zmSelectBtnCE",titleCls:"zmSetARLabel",selectionRowCls:"zmSetActionRow zmFlex zmMB10",fontColorSelRowCls:"zmSetActionRow zmFlex",imgTxtCls:"zmSetImgTxtBox",flexCls:"zmFlex",groupingCls:"zmSetActionGroup zmSetAGIndent",actionWrapperCls:"zmSetActionWra",fontPreviewCls:"zmSetFontPreview zmModeBdr"};a.classConstants=c},"MailSuite.Settings.Compose"),function(a){var b="compose-settings",c=zmText.get("zm-settings-core","compose.quickNavigatorItems"),d=a("Platform.Components"),e=d.QuickNavigatorSectionManager;e.create(b,{props:{title:c.sectionTitle},state:{selected:!1}})}(zmail.Settings.Modules["import"]),_defineSettingsModule("Cards",function(a,b){var c="activesync",d="general",e=zmText.get("zm-settings-core","activesync"),f={cardTitle:e.card.title};zmail.Settings.Modules.create("mSyncDeferred"),zmail.Settings.mSyncDeferred=$.Deferred();var g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!1,title:f.cardTitle},attributes:{category:d}}),j=function(){zmail.postJsDeffered.promise.then(function(){"false"===zmail.mailOpt.activeSync&&i.setState({hidden:!0})})};j(),a.activeSync=i},"MailSuite"),_defineSettingsModule("activeSyncMailSetting",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="activesync",g={"true":1,"false":0},h={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();e.debugLog("fetching mail-setting "+f,a);var c={mode:"getMSyncdata"};return"true"===zmail.mailOpt.activeSync?(zmAjq.XHR({u:zmail.conPath+"/userSettings.do",p:c,t:"POST",fn:function(a){a.msyncData.length||(a={}),zmail.Settings.mSyncDeferred.resolve(a),zmail.Settings.mSyncDeferred.done(function(a){a.hasOwnProperty("msyncData")&&a.msyncData.length?b.resolve(Boolean(a.msyncData[0].mail)):b.resolve({})})},csr:"s"}),b.promise()):b.resolve()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b);var d={settings:JSON.stringify({mail:g[a]}),mode:"setMSyncdata"};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a){c.resolve(a.value)},p:d,csr:"s"}),c.promise()}},i=d.create(f,{props:{defaultValue:!1},persister:h,type:"boolean",category:"general"});i.initialize(),a.Setting=i},"MailSuite.Settings.activeSync"),_defineSettingsModule("activeSyncCalendarSetting",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="activesync",g={"true":1,"false":0},h={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+f,a),zmail.Settings.mSyncDeferred.done(function(a){a.hasOwnProperty("msyncData")?b.resolve(Boolean(a.msyncData[0].calendar)):b.resolve({})}),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b);var d={settings:JSON.stringify({calendar:g[a]}),mode:"setMSyncdata"};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a){c.resolve(a.value)},p:d,csr:"s"}),c.promise()}},i=d.create(f,{props:{defaultValue:!1},persister:h,type:"boolean",category:"general"});i.initialize(),a.Setting=i},"MailSuite.Settings.activeSync"),_defineSettingsModule("activeSyncContactSetting",function(a,b){var c=b("Platform.Components"),d=c.SettingManager,e=b("Platform.System.Utils"),f="activesync",g={"true":1,"false":0},h={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+f,a),zmail.Settings.mSyncDeferred.done(function(a){a.hasOwnProperty("msyncData")?b.resolve(Boolean(a.msyncData[0].contact)):b.resolve({})}),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+f,a,b);var d={settings:JSON.stringify({contact:g[a]}),mode:"setMSyncdata"};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a){c.resolve(a.value)},p:d,csr:"s"}),c.promise()}},i=d.create(f,{props:{defaultValue:!1},persister:h,type:"boolean",category:"general"});i.initialize(),a.Setting=i},"MailSuite.Settings.activeSync"),function(a){var b="activesync",c={MAIL:"mail",CALENDAR:"calendar",CONTACTS:"contacts"},d=a("Platform.Components"),e=a("Platform.Entities"),f=zmText.get("zm-settings-core","activesync"),g=a("MailSuite.Settings.activeSync"),h=d.SettingCardItemManager,i=e.SettingCardItem,j=i.Types,k=g.activeSyncMailSetting.Setting,l=g.activeSyncCalendarSetting.Setting,m=g.activeSyncContactSetting.Setting,n=h.create(c.MAIL,{props:{title:f.cardItems.mail.title,value:"Disabled"},attributes:{type:j.LabelAction,card:b},transformer:function(a,b){return b=b||{},"props"===a&&b.hasOwnProperty("value")&&(b.value=b.value===!0?"Enabled":"Disabled"),b},secondaryAction:function(){var a=k,b=a.get()!==!0;a.set(b)}}),o=h.create(c.CALENDAR,{props:{title:f.cardItems.calendar.title,value:"Disabled"},attributes:{type:j.LabelAction,card:b},transformer:function(a,b){return b=b||{},"props"===a&&b.hasOwnProperty("value")&&(b.value=b.value===!0?"Enabled":"Disabled"),b},secondaryAction:function(){var a=l,b=a.get()!==!0;a.set(b)}}),p=h.create(c.CONTACTS,{props:{title:f.cardItems.contacts.title,value:"Disabled"},attributes:{type:j.LabelAction,card:b},transformer:function(a,b){return b=b||{},"props"===a&&b.hasOwnProperty("value")&&(b.value=b.value===!0?"Enabled":"Disabled"),b},secondaryAction:function(){var a=m,b=a.get()!==!0;a.set(b)}}),q=function(){h.bindSetting(n,k),h.bindSetting(o,l),h.bindSetting(p,m)};q()}(zmail.Settings.Modules["import"]),_defineSettingsModule("Pages",function(a,b){var c="conversation-settings",d=b("Platform.Components"),e=b("Platform.Entities"),f=zmText.get("zm-settings-core","conversation.page"),g=d.SettingPageManager,h=e.SettingPage,i=h.Types,j=g.create(c,{props:{title:f.title},attributes:{type:i.Title,card:c,category:"mail",pageCSSClass:"conversation-settings-page"}});a.Conversation=j},"MailSuite"),_defineSettingsModule("Cards",function(a,b){var c="conversation-settings",d="mail",e="conversation-settings",f={cardTitle:zmText.get("zm-settings-core","conversation.card.title")},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!0,title:f.cardTitle},attributes:{category:d},openAction:h.CardActions.OpenPageAction(e)});a.Conversation=i},"MailSuite"),function(a){var b="conversation-settings",c="conversation-settings",d={CONVERSATION_VIEW:"converation-view",CONVERSATION_SORT:"conversation-sort"},e=zmText.get("zm-settings-core","conversation.cardItems"),f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Conversation"),i=h.ViewState,j=h.SortOrder,k=f.SettingCardItemManager,l=g.SettingCardItem,m=l.Types,n=i.Setting,o=j.Setting,p=i.Constants.MODE_MAP,q=j.Constants.MODE_MAP,r=function(a){a="undefined"!=typeof a?a:n.get();var b=p[a];return e.conversationView.viewModes[b]},s=function(a){a="undefined"!=typeof a?a:o.get();var b=q[a];return e.conversationSort.sortModes[b]},t=k.create(d.CONVERSATION_VIEW,{props:{title:e.conversationView.cardItem.title,value:r()},attributes:{type:m.LabelValue,card:b},primaryAction:k.CardItemActions.OpenPageAction(c,{showSection:d.CONVERSATION_VIEW}),searchCommand:{title:e.quickActionTitle.state}}),u=k.create(d.CONVERSATION_SORT,{props:{title:e.conversationSort.cardItem.title,value:s()},attributes:{type:m.LabelValue,card:b},primaryAction:k.CardItemActions.OpenPageAction(c,{showSection:d.CONVERSATION_SORT}),searchCommand:{title:e.quickActionTitle.sortOrder}}),v=function(){n.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&t.setProp({value:r(a.changed.value)})}),o.on("props.change",function(a){a=a||{},a.changed.hasOwnProperty("value")&&u.setProp({value:s(a.changed.value)})})};v()}(zmail.Settings.Modules["import"]),function(a){var b="conversation-settings",c={CONVERSATION_VIEW:"conversation-view",CONVERSATION_SORT:"converstion-sort",CONVERSATION_ACTION:"conversation-action"},d={CONVERSATION_VIEW:"sa-conversation-view",CONVERSATION_SORT:"sa-conversation-sort",CONVERSATION_ACTION:"sa-conversation-action"},e={APPCORE_MODULE_ID:"zm-settings-app-conversationsettings"},f=zmText.get("zm-settings-core","conversation.pageItems"),g=a("Platform.Components"),h=a("Platform.Entities"),i=h.SettingPageSection,j=g.SettingAppManager,k=i.Types,l=g.SettingPageSectionManager,m=a("MailSuite.Settings.Conversation"),n=m.ViewState,o=n.Setting,p=function(){return zmAppLoader.load(e.APPCORE_MODULE_ID)},q=l.create(c.CONVERSATION_VIEW,{props:{title:f.conversationView.sectionTitle,toggleSwitchOnText:f.toggleSwitch.onText,toggleSwitchOffText:f.toggleSwitch.offText,toggleSwitchActive:0!==n.Setting.get()},attributes:{page:b,type:k.TitleToggleSwitch,appContainer:!0},quickNavigation:{props:{title:f.conversationView.quickLinkTitle,linkedPage:b,linkedPageSection:c.CONVERSATION_VIEW,selectable:!0},attributes:{section:"mail-conversation-settings"}}});l.create(c.CONVERSATION_SORT,{props:{title:f.conversationSort.sectionTitle},attributes:{page:b,type:k.Title,appContainer:!0},quickNavigation:{props:{title:f.conversationSort.quickLinkTitle,linkedPage:b,linkedPageSection:c.CONVERSATION_SORT,selectable:!0},attributes:{section:"mail-conversation-settings"}}});var r=function(){return p()},s=function(){return p()},t=function(){var b=a("MailSuite.Settings.Conversation.Views");return b.getConversationViewComponent()},u=function(){j.create(d.CONVERSATION_VIEW,{attributes:{pageSection:c.CONVERSATION_VIEW,isReactApp:!0},initialize:r,uninitialize:s,getView:t,handleContainerEvent:function(){}}),j.create(d.CONVERSATION_SORT,{attributes:{pageSection:c.CONVERSATION_SORT,isReactApp:!0},initialize:function(){return p()},uninitialize:function(){return p()},getView:function(){var b=a("MailSuite.Settings.Conversation.Views");return b.getConversationSortComponent()},handleContainerEvent:function(){}})},v=function(){q.props.on("change:toggleSwitchActive",function(a){var b=a.changed.toggleSwitchActive;b=b?2:0,o.set(b)}),o.props.on("change",function(a){q.setProp({toggleSwitchActive:Boolean(a.changed.value)})})};u(),v()}(zmail.Settings.Modules["import"]),function(a){var b="mail-conversation-settings",c=zmText.get("zm-settings-core","conversation.quickNavigatorItems"),d=a("Platform.Components"),e=d.QuickNavigatorSectionManager;e.create(b,{props:{title:c.sectionTitle},state:{selected:!1}})}(zmail.Settings.Modules["import"]),_defineSettingsModule("Integrations",function(a){a.DNOTIFY_SETTING_ID="desktop-notification-toggle",a.TWITTER_SETTING_ID="twitter-integration",a.SMARTMENU_SETTING_ID="smart-menu-toggle",a.CARD_ID="integrations-settings",a.PAGE_ID="integrations-settings",a.APP_ID="sa-integrations-settings",a.CATEGORY_ID="general",a.APPCORE_MODULE_ID="zm-settings-app-integrationsettings",a.HASH_MAP={1:"Apps",3:"Connectors"},a.REVERSE_HASH_MAP={Apps:1,Connectors:3},a.TEXT_MAP={1:"Apps",3:"Connectors"}},"MailSuite.Constants"),_defineSettingsModule("Integration",function(a,b){var c={};return c={DROPBOX_ZOHOGADGETS:"1",ZOHODOCS:"2",DRE:"3",GDRIVE_ZOHOGADGETS:"4",ONEDRIVE_ZOHOGADGETS:"5",BOX_ZOHOGADGETS:"6",CLEARBIT:"7",FULLCONTACT:"8",EVERNOTE:"9",TWITTER:"10",ZENDESK:"11",INCOMINGWEBHOOKS:"12",ASANA:"13",OUTGOINGWEBHOOKS:"14",SERVICES:"15",ZOHODESK:"1001",ZOHOCRM:"1002",SUPPORT:"1003",CHATLET:"1005",ZOHOPROJECTS:"1006",ZOHOBOOKS:"1009",ZOHOINVOICE:"1007",ZOHOSUBSCRIPTION:"1010",ZOHOINVENTORY:"1011",ZOHOVAULT:"1012",ZOHOEXPENSE:"1013"},a.Constants=c,a},"MailSuite.Settings"),_defineSettingsModule("Apps",function(a,b){var c,d,e=zmail.Core.Namespaces,f=e.get("zmail.DataLayer"),g=f.DSModel,h=f.DSCollection,i=b("MailSuite.Settings.Integration.Constants"),j=b("Platform.UI.Utils"),k=zmText.get("zm-settings-core","integrations"),l=function(){function a(){babelHelpers.classCallCheck(this,a),this.apps={}}return babelHelpers.createClass(a,[{key:"add",value:function(a,b){this.apps[a]||(this.apps[a]=b)}},{key:"get",value:function(a){return this.apps[a]}},{key:"getType",value:function(a){for(var b in this.apps)if(this.apps.hasOwnProperty(b)&&this.apps[b].hashUrl===a)return b}}]),a}(),m=f.Adapter.HTTPAdapter,n=function(b){function c(){return babelHelpers.classCallCheck(this,c),babelHelpers.possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return babelHelpers.inherits(c,b),babelHelpers.createClass(c,[{key:"getDefaults",value:function(){return{ostatus:!0}}},{key:"getIdAttribute",value:function(){return"appType"}},{key:"toggleStatus",value:function(a){var b,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=this;return c.bool=a,b=this.get("integList"),this.get("appType")===i.ZOHOPROJECTS?(b[0].status=a,this.set({integList:b},{silent:!0}),this.trigger("change"),zmAdHocSettings.setProjectInteg({enabled:a,id:b[0].integId}),$.Deferred().resolve()):(b?(b[0].status=a?1:2,this.trigger("change")):this.set("integList",[{integId:"dummy",status:a?1:2}]),c.setSessionId=!0,this.triggerAction("CHANGE_STATUS",c).then(function(a){return d.afterStatusChange(a.resp.data),a},function(c){b[0].status=a?2:1,d.trigger("change"),c&&_zm.getProperty(c,"resp.data")&&j.showErrorMessage(c.resp.data)}))}},{key:"afterStatusChange",value:function(b){b.appType=String(b.appType),b.integList=[{integId:b.integId,status:b.status}],this.set(b,{silent:!0}),this.trigger("change",this);var c=a.ConfigManager.get(b.appType);if(c){var d=this.getStatus()?k.enabled:k.disabled;j.showSuccessMessage(zmText.applyArgs(d,{App:c.displayName}))}}},{key:"getStatus",value:function(){var b=this.attributes,c=a.ConfigManager.get(b.appType),d=!1;return c&&(d="defaultValue"in c&&c.defaultValue),b.integList&&1===b.integList.length?this.get("appType")===i.ZOHOPROJECTS?b.integList[0].status:2!==b.integList[0].status:d}}]),c}(g),o=function(b){function e(){return babelHelpers.classCallCheck(this,e),babelHelpers.possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return babelHelpers.inherits(e,b),babelHelpers.createClass(e,[{key:"getBaseModelClass",value:function(){return n}},{key:"getIntegrations",value:function(){var b=[];return this.models.forEach(function(c){var d=c.attributes,e=a.ConfigManager.get(d.appType);e&&b.push(c)}),b}},{key:"getIntegAppConfig",value:function(a){return"number"==typeof a&&(a=String(a)),this.get(a)}},{key:"fetchList",value:function(){var a=this;return zmUtil.getIntegStatus().then(function(b){return a.afterFetchList(b)},function(b){var c={appType:i.ZOHOPROJECTS,Categories:[3,1,9]},d=zmAdHocSettings.getProjectInteg();return d.id&&(c.integList=[{status:d.enabled,integId:d.id}]),a.set([c]),a.trigger("fetched"),b})}},{key:"afterFetchList",value:function(b){var e,f=this;return f.isLoaded?b:(f.isLoaded=!0,a.Categories=b.Categories,a.CategoriesMap={},a.Categories.forEach(function(b){a.CategoriesMap[b.categoryId]=b.categoryName}),e=b.data.map(function(a){if(a.appType=String(a.appType),a.appType===i.ZOHOPROJECTS){var b={appType:i.ZOHOPROJECTS,Categories:[3,1,9]},d=zmAdHocSettings.getProjectInteg();return b.integList=[{status:!0}],$.isEmptyObject(d)||(b.integList[0].status=d.enabled,b.integList[0].integId=d.id),b}return a.appType===i.CHATLET&&(a.ostatus=c()),a}),f.set(e),f.trigger("fetched"),d(),b)}}]),e}(h),p=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"getUrl",value:function(){return"/integPlatform/integAction.do"}},{key:"serialize",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=null;return c=c||{},"fetchAll"===a?d={mode:"AVAILABILITY",action:"GET_INTEG_CONFIGS"}:"CHANGE_STATUS"===a&&(d={appType:b.get("appType"),action:"CHANGE_STATUS",status:c.bool?"1":"2"},c.integId?d.integId=c.integId:b.get("integList")&&b.get("integList")[0]&&"dummy"!==b.get("integList")[0].integId&&(d.integId=b.get("integList")[0].integId)),d}},{key:"normalize",value:function(a,b,d){var e=[];return"fetchAll"===a?e=b.data.map(function(a){if(a.appType=String(a.appType),a.appType===i.ZOHOPROJECTS){var b={appType:i.ZOHOPROJECTS},d=zmAdHocSettings.getProjectInteg();return d.id&&(b.integList=[{status:d.enabled,integId:d.id}]),b}return a.appType===i.CHATLET&&(a.ostatus=c()),a}):b}}]),b}(m),q={adapters:[{id:"http-adapter",type:"default",classObj:p}],"default":"http-adapter"},r=ZMStore.createInstance("IntegAppsCollection",o,{adapterConfig:q});zmComponent.notifier.addHandler("integration",function(b,c){var d=_zm.getProperty(c,"data.act"),e=_zm.getProperty(c,"data.Integresponse.data");if(d&&e&&"INTEGRATION_SETTINGS_CHANGE"===d){var f=String(e.appType),g=a.Collection.get(f);g&&g.afterStatusChange(e)}});var s={ACTIVE:1,INACTIVE:0,CLOSED:2,NONE:-1};c=function(){return[s.ACTIVE,s.NONE].indexOf(zmail.chatAdminPref)!==-1},a.getChatPreference=function(){var a=$.Deferred();return r.fetchList().then(function(){var b=c();a.resolve({value:b&&r.get(i.CHATLET).getStatus(),isDisabledByAdmin:!b})}),a.promise()},a.getCRMPreference=function(){var a=$.Deferred();return r.fetchList().then(function(){a.resolve({value:r.get(i.ZOHOCRM).getStatus()})}),a.promise()};var t=function(a,b){var c=_zm.getProperty(zmail.Settings,"Apps.Filter.Models.metaInfo");c&&(c[a]=b)};d=function(){var a,b=r.get(i.CHATLET),c=r.get(i.ZOHOCRM),d=r.get(i.DROPBOX_ZOHOGADGETS),e=r.get(i.ONEDRIVE_ZOHOGADGETS),f=r.get(i.BOX_ZOHOGADGETS),g=r.get(i.GDRIVE_ZOHOGADGETS);b.on("change",function(){zmail.IntegrationStatus.CHAT=b.getStatus(),$.publish("integration/chatStatusChange",b.getStatus())}),c.on("change",function(){zmail.IntegrationStatus.CRM=c.getStatus(),$.publish("integration/CRMStatusChange",c.getStatus())}),d&&d.on("change",function(){a=d.getStatus(),zmail.IntegrationStatus.dropBox=a,t("dropbox",a),$.publish("integration/dropBoxStatusChange",a)}),e&&e.on("change",function(){a=e.getStatus(),zmail.IntegrationStatus.oneDrive=a,t("onedrive",a),$.publish("integration/oneDriveStatusChange",a)}),f&&f.on("change",function(){a=f.getStatus(),zmail.IntegrationStatus.box=a,t("box",a),$.publish("integration/boxStatusChange",a)}),g&&g.on("change",function(){a=g.getStatus(),zmail.IntegrationStatus.gDrive=a,t("gdrive",a),$.publish("integration/gDriveStatusChange",a)})},r.fetchList();var u=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"getDefaults",value:function(){return{currentTab:1,tabs:[{text:"Apps",value:1},{text:"Connectors",value:3,showTab:!1}],selectedIcon:1,showIcons:!0,icons:[{name:"msi-gridview",value:1,tooltip:k.classicView},{name:"msi-thumbview",value:2,tooltip:k.compactView}]}}}]),b}(g);a.Tabs=new u,a.Collection=r,a.ConfigManager=new l,a.initializeOnChangePublizers=d},"MailSuite.Settings.Integration"),_defineSettingsModule("View",function(a,b){var c=zmail.Core.Namespaces,d=c.get("zmail.DataLayer.Utils"),e=b("Platform.System.Utils"),f=function(){function a(){babelHelpers.classCallCheck(this,a)}return babelHelpers.createClass(a,[{key:"init",value:function(a,b){var c=this;if("string"!=typeof a)throw new Error("Give a proper id for Integration");
c.id=a,d.isFunction(b.getView)||c.throwError("getView must be Functions"),c.destroy=b.destroy,c.getView=b.getView,c.afterMount=b.afterMount}},{key:"mount",value:function(a){var b=this;this.elm=a;try{this.isReactApp?ReactDOM.render(b.view(),a):$(a).html(b.view()),d.isFunction(b.afterMount)&&b.afterMount()}catch(c){e.debugLogError(c)}}},{key:"rhsmount",value:function(a){var b=this;try{this.settingElm=a,this.isReactApp?ReactDOM.render(b.view(),a):$(a).html(b.view()),d.isFunction(b.afterMount)&&b.afterMount()}catch(c){e.debugLogError(c)}}},{key:"unmount",value:function(){try{this.isReactApp?ReactDOM.unmountComponentAtNode(this.elm):(d.isFunction(this.destroy)&&this.destroy(),this.elm.innerHTML="")}catch(a){e.debugLogError(a)}}},{key:"initialize",value:function(){var a=this;a._init()}},{key:"throwError",value:function(a){throw new Error(a)}}]),a}(),g=function(){function a(){babelHelpers.classCallCheck(this,a),this.integrations={}}return babelHelpers.createClass(a,[{key:"add",value:function(a,b){if(!(b instanceof f))throw new Error("Given integration is not a instance of Base IntegEntity");this.integrations[a]=b}},{key:"get",value:function(a){return this.integrations[a]}},{key:"remove",value:function(){delete this.integrations[name]}},{key:"register",value:function(a,b,c){var e,g=this;return b instanceof f?e=b:(e=new f,e.init(a,{destroy:b.destroy,getView:b.getView,afterMount:b.afterMount}),c&&d.copyProperties(e.prototype,c)),g.add(a,e),g.get(a)}}]),a}(),h=new g;return a.ViewManager=h,a.Integration=f,g},"MailSuite.Settings.Integration"),_defineSettingsModule("AppConfigs",function(a,b){var c=b("MailSuite.Settings.Integration"),d=b("MailSuite.Settings.Integration.Apps.ConfigManager"),e=b("MailSuite.Settings.Integration.Constants"),f=function(a,b,c){return zmText.get("zm-settings-core","integrations.apps",b,c)},g=f();d.add(e.CHATLET,{desc:g.chatletDesc,defaultValue:!0,isOpenable:!1,helpUrl:"cliq-integration.html",displayName:zmText.applyArgs(g.chatlet,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/cliq.png"}),d.add(e.ZOHOCRM,{desc:g.crmDesc,defaultValue:!0,isOpenable:!1,helpUrl:"crm-add-on.html",displayName:zmText.applyArgs(g.crm,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/crm.png"}),d.add(e.ZOHOPROJECTS,{desc:g.projectDesc,defaultValue:!0,isOpenable:!0,helpUrl:"projects-integration.html",displayName:zmText.applyArgs(g.projects,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/projects.png",hashUrl:"Projects",init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-projects").then(function(){void 0!==zmail.projectsInteg.portalsList?a.resolve():c.Projects.getPortalsList().done(function(){a.resolve()})}),a.promise()}}),zmail.isZohoDeskIntegEnabled&&(d.add(e.ZOHODESK,{desc:g.deskDesc,isOpenable:!0,displayName:zmText.applyArgs(g.desk,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/desk.png",hashUrl:"Desk",init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-desk").then(function(){c.Desk.getPortals().then(function(){a.resolve()})}),a.promise()}}),d.add(e.ASANA,{desc:g.asanaDesc,isOpenable:!0,displayName:"Asana",imgSrc:"settings/integration/asana.png",hashUrl:"Asana",init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-asana").then(function(){c.Asana.getWorkspace.then(function(){a.resolve()})}),a.promise()}})),zmail.isZendeskIntegEnabled&&d.add(e.ZENDESK,{desc:g.zendeskDesc,isOpenable:!0,displayName:"Zendesk",imgSrc:"settings/integration/zendesk.png",hashUrl:"Zendesk",init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-zendesk").then(function(){c.Zendesk.getConfig().then(function(){a.resolve()})}),a.promise()}}),zmail.isClearbitIntegEnabled&&d.add(e.CLEARBIT,{desc:g.clearbitDesc,isOpenable:!0,displayName:"Clearbit",imgSrc:"settings/integration/clearbit.png",hashUrl:"Clearbit",init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-clearbit").then(function(){c.Clearbit.getConfig().then(function(){a.resolve()})}),a.promise()}}),zmail.isFullcontactIntegEnabled&&d.add(e.FULLCONTACT,{desc:g.fullcontactDesc,isOpenable:!0,displayName:"FullContact",imgSrc:"settings/integration/fullcontact.png",hashUrl:"FullContact",init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-fullcontact").then(function(){c.Fullcontact.getConfig().then(function(){a.resolve()})}),a.promise()}}),_zm.isCloudServiceIntegEnabled&&(d.add(e.DROPBOX_ZOHOGADGETS,{desc:g.uploaderDesc.dropbox,isOpenable:!0,defaultValue:!0,imgSrc:"settings/integration/dropbox.png",init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-clouduploader").then(function(){c.CloudUploader.getAuthDetails(e.DROPBOX_ZOHOGADGETS).done(function(){a.resolve()})}),a.promise()},displayName:"Dropbox",hashUrl:"Dropbox"}),d.add(e.GDRIVE_ZOHOGADGETS,{desc:g.uploaderDesc.gdrive,isOpenable:!0,defaultValue:!0,init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-clouduploader").then(function(){c.CloudUploader.getAuthDetails(e.GDRIVE_ZOHOGADGETS).done(function(){a.resolve()})}),a.promise()},hashUrl:"Gdrive",displayName:"Google Drive",imgSrc:"settings/integration/drive.png"}),d.add(e.ONEDRIVE_ZOHOGADGETS,{desc:g.uploaderDesc.onedrive,isOpenable:!0,defaultValue:!0,init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-clouduploader").then(function(){c.CloudUploader.getAuthDetails(e.ONEDRIVE_ZOHOGADGETS).done(function(){a.resolve()})}),a.promise()},displayName:"OneDrive",hashUrl:"Onedrive",imgSrc:"settings/integration/onedrive.png"}),d.add(e.BOX_ZOHOGADGETS,{desc:g.uploaderDesc.box,isOpenable:!0,defaultValue:!0,init:function(){var a=$.Deferred();return zmAppLoader.load("zm-settings-integration-clouduploader").then(function(){c.CloudUploader.getAuthDetails(e.BOX_ZOHOGADGETS).done(function(){a.resolve()})}),a.promise()},displayName:"Box",hashUrl:"Box",imgSrc:"settings/integration/box.png"})),zmail.isVaultIntegEnabled&&d.add(e.ZOHOVAULT,{desc:g.vaultDesc,defaultValue:!0,isOpenable:!1,displayName:zmText.applyArgs(g.vault,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/vault.png"}),zmail.isBooksIntegEnabled&&d.add(e.ZOHOBOOKS,{desc:g.booksDesc,defaultValue:!0,isOpenable:!1,displayName:zmText.applyArgs(g.books,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/books.png"}),zmail.isInvoiceIntegEnabled&&d.add(e.ZOHOINVOICE,{desc:g.invoiceDesc,defaultValue:!0,isOpenable:!1,displayName:zmText.applyArgs(g.invoice,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/invoice.png"}),zmail.isInventoryIntegEnabled&&d.add(e.ZOHOINVENTORY,{desc:g.inventoryDesc,defaultValue:!0,isOpenable:!1,displayName:zmText.applyArgs(g.inventory,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/inventory.png"}),zmail.isSubscriptionIntegEnabled&&d.add(e.ZOHOSUBSCRIPTION,{desc:g.subscriptionDesc,defaultValue:!0,isOpenable:!1,displayName:zmText.applyArgs(g.subscription,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/subscription.png"}),zmail.isExpenseIntegEnabled&&d.add(e.ZOHOEXPENSE,{desc:g.crmDesc,defaultValue:!0,isOpenable:!1,displayName:zmText.applyArgs(g.expense,{companyName:zmail.globalI18N.companyName}),imgSrc:"settings/integration/expense.png"}),zmail.isTwitterIntegEnabled&&d.add(e.TWITTER,{desc:g.twitterDesc,isOpenable:!0,displayName:g.twitter,imgSrc:"settings/integration/twitter.png",hashUrl:"Twitter",init:function(){return zmAppLoader.load("zm-settings-integration-twitter")}})},"MailSuite.Settings.Integration"),_defineSettingsModule("Pages",function(a,b){var c,d=b("Platform.Components"),e=b("Platform.Entities"),f=b("MailSuite.Constants.Integrations"),g=zmText.get("zm-settings-core","integrations.page"),h=d.SettingPageManager,i=e.SettingPage,j=d.SettingAppManager,k=i.Types,l=function(){return zmAppLoader.load(f.APPCORE_MODULE_ID)};c=h.create(f.PAGE_ID,{props:{title:g.title},attributes:{type:k.PageAlone,card:f.PAGE_ID,category:"general",appContainer:!0,defaultPageName:"Apps",showActionable:!1,pageCSSClassName:""}});var m,n=function(){return l()},o=function(){return l()},p=function(){var a=b("MailSuite.Settings.Integration.Views");return a.init()},q=function(a,d){var e,f=b("MailSuite.Settings.Integration").Apps.Tabs;"active"===a?(e=c.getProp("focusedSection"),e?f.trigger("change",{triggerHash:!1}):(f.set({currentTab:1},{silent:!0}),f.trigger("change",{triggerHash:!0}))):zmsuite.isWorkspaceAvailable("zm-settings")&&(f.set({currentTab:1},{silent:!0}),f.trigger("change",{triggerHash:!1}))},r=function(){m=j.create(f.APP_ID,{attributes:{page:f.PAGE_ID,isReactApp:!0},initialize:n,uninitialize:o,getView:p,handleContainerEvent:q})};r(),a.Integrations=c,a.App=m,a.Page=c},"MailSuite"),_defineSettingsModule("Cards",function(a,b){var c=zmText.get("zm-settings-core","integrations"),d=b("Platform.Components"),e=b("MailSuite.Constants.Integrations"),f=b("Platform.Entities"),g=d.SettingCardManager,h=d.SettingCardItemManager,i=f.SettingCardItem,j=i.Types,k=h.CardItemActions.OpenPageAction(e.PAGE_ID),l=function(){return zmAppLoader.load(e.APPCORE_MODULE_ID)},m=function(a,c){l().then(function(){k();var d=b("MailSuite.Settings.Integration").Apps.Tabs;d.set({currentTab:a},{silent:!0}),d.trigger("change",{triggerHash:c})})},n=g.create(e.CARD_ID,{props:{openable:!0,title:c.card.title},attributes:{category:e.CATEGORY_ID},openAction:g.CardActions.OpenPageAction(e.PAGE_ID)});h.create("integration-apps",{props:{title:"Apps",showInBreadCrumb:!0,showListCards:{list:[{htm:"Apps",data:{action:1}}],clk:function(a,b){zmUtil.hideMenu(),m(a.action,!0)},customHeaderAction:function(){m(1,!0)},defaultPageName:"Apps"}},attributes:{type:j.Action,card:e.CARD_ID},primaryAction:function(){m(1,!0)}}),a.Integrations=n,a.changeTab=m},"MailSuite"),_defineSettingsModule("DesktopNotification",function(a,b){var c=b("Platform.Components"),d=b("MailSuite.Constants.Integrations"),e=b("Platform.System.Utils"),f=c.SettingManager,g={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=e.makeDeferred();return e.debugLog("fetching mail-setting "+d.DNOTIFY_SETTING_ID,a),b.resolve(Boolean(zmail.mailOpt.dtNotify)),b.promise()},save:function(a,b){var c=e.makeDeferred();e.debugLog("saving "+d.DNOTIFY_SETTING_ID,a,b);var f=a?1:0,g={settings:JSON.stringify({notifyDesktop:f}),mode:"viewVO"},h={value:a};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(a,b){c.resolve(b.value)},p:g,csr:"s",ep:h}),c.promise()}},h=f.create(d.DNOTIFY_SETTING_ID,{props:{defaultValue:!1},type:"boolean",category:d.CATEGORY_ID,persister:g});h.initialize(),a.Setting=h},"MailSuite.Settings.General"),_defineSettingsModule("SmartMenu",function(a,b){var c,d=b("Platform.Components"),e=b("MailSuite.Constants.Integrations"),f=b("Platform.System.Utils"),g=d.SettingManager,h={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=f.makeDeferred();return f.debugLog("fetching mail-setting "+e.SMARTMENU_SETTING_ID,a),b.resolve(zmAdHocSettings.getHelperBlockVisibility()),b.promise()},save:function(a,b){var c=f.makeDeferred();return f.debugLog("saving "+e.SMARTMENU_SETTING_ID,a,b),zmAdHocSettings.setHelperBlockVisibility(a)?c.resolve(a):c.reject(),c.promise()}},i=function(){c=g.create(e.SMARTMENU_SETTING_ID,{props:{defaultValue:"0",options:["0","1"]},type:"option",category:e.CATEGORY_ID,persister:h}),c.initialize()},j=function(){i(),a.Setting=c};j()},"MailSuite.Settings.General"),_defineSettingsModule("TwitterIntegration",function(a,b){var c=zmail.Core.Namespaces.create("zmail.twitterInteg"),d=zmText.get("zm-settings-core","integrations.twitter");c.twitterData={error:!0};var e=function(){var a,b=$.Deferred(),d=function(d){if(d=d||{},a=!1,"success"===d.status){var e=d.data[0];c.twitterData=e,a=1===e.status}else c.twitterData={};b.resolve(a)},e=function(){c.twitterData={error:!0},a=!1,b.resolve(a)};return zmAjq.XHR({u:"/integPlatform/integAction.do",t:"GET",fn:d,p:{action:"GET_CONFIGURED_ACCS",appType:"twitter"},onnetfailure:e,onerror:e}),b.promise()},f=function(a,b){if(b=b||"{}",b=JSON.parse(b),"success"===a)b.msg?_zm.succErrMsg("e",b.msg):b.reAuth?_zm.succErrMsg("s",d.succAuth):(_zm.succErrMsg("s",d.succAuth),c.configured&&c.configured(b));else{var e=b.msg?b.msg:d.common;_zm.succErrMsg("e",e)}};zmail.isTwitterIntegEnabled&&(c.fetchDeferred=e(),$.subscribe("integration/configure",function(a,b){if(zmail.isTwitterIntegEnabled){var c=b.type,d=b.data;"twitter"===c&&f(d.status,d.data)}}))},"MailSuite.Settings.Integration"),function(a){var b="integration-settings",c=zmText.get("zm-settings-core","integrations.quickNavigatorItems"),d=a("Platform.Components"),e=d.QuickNavigatorSectionManager;e.create(b,{props:{title:c.sectionTitle},state:{selected:!1}})}(zmail.Settings.Modules["import"]),function(){window.zmail=window.zmail||{},window.zmail.integConfigSettings=function(a,b){b=b||"",b=JSON.parse(b),$.publish("integration/configure",{type:a,data:b})}}(),_defineSettingsModule("FolderSettings",function(a,b){var c,d,e=b("Platform.Components"),f=b("Platform.Entities"),g=b("Platform.System.Utils"),h=e.SettingCardManager,i=e.SettingCardItemManager,j=e.SettingPageManager,k=e.SettingAppManager,l=f.SettingPage,m=f.SettingCardItem,n=l.Types,o=m.Types,p=zmText.get("zm-settings-core","folders.labels"),q={CARD_ID:"folders",PAGE_ID:"folders",APP_ID:"sa-folders",CATEGORY_ID:"mail",FOLDER_PROP_CARD_ITEM_ID:"folder-props",NEW_FOLDER_CARD_ITEM_ID:"new-folder",ARCHIVE_POLICY_CARD_ITEM_ID:"archive-policy",APPCORE_MODULE_ID:"zm-settings-app-foldersettings",APPCORE_MODULE_NAMESPACE:"MailSuite.Apps.FolderSettings.AppCore"},r=function(){h.create(q.CARD_ID,{props:{title:p.title,openable:!0},attributes:{category:q.CATEGORY_ID},openAction:h.CardActions.OpenPageAction(q.PAGE_ID)})},s=function(){i.create(q.NEW_FOLDER_CARD_ITEM_ID,{props:{title:p.createFolder,loadFrameworkOnCommandExecution:!1},attributes:{type:o.Action,card:q.CARD_ID},primaryAction:function(){zmfolAction.showCreateFolderPopUp({noMask:!1,noAnchor:!0,mode:"new"})}}),i.create(q.FOLDER_PROP_CARD_ITEM_ID,{props:{title:p.manageNotifications},attributes:{type:o.Action,card:q.CARD_ID},primaryAction:i.CardItemActions.OpenPageAction(q.PAGE_ID)})},t=function(){d=j.create(q.PAGE_ID,{props:{title:p.title},attributes:{type:n.TitleChoiceMenu,card:q.PAGE_ID,category:"mail",appContainer:!0,pageCSSClass:"folder-settings"}})},u=function(){return zmAppLoader.load(q.APPCORE_MODULE_ID)},v=function(){return b(q.APPCORE_MODULE_NAMESPACE)},w=function(){var a=g.makeDeferred();return u().then(function(){v().initialize({progress:a})},function(){g.debugLog("Module load failed !!!"),a.reject()}),a.promise()},x=function(){var a=g.makeDeferred();return u().then(function(){v().uninitialize({progress:a})}),a.promise()},y=function(){return v().getAppView()},z=function(a,b){var c=v();c&&c.handleContainerEvent(a,b)},A=function(){c=k.create(q.APP_ID,{attributes:{page:q.PAGE_ID,isReactApp:!0},initialize:w,uninitialize:x,getView:y,handleContainerEvent:z})},B=function(){r(),s(),t(),A(),a.Constants=q,a.App=c,a.Page=d};B()},"MailSuite.Apps"),_defineSettingsModule("ArchivePolicy",function(a,b){var c,d,e=b("Platform.Components"),f=b("Platform.Entities"),g=b("Platform.System.Utils"),h=e.SettingPageManager,i=e.SettingAppManager,j=f.SettingPage,k=e.SettingCardManager,l=e.SettingCardItemManager,m=f.SettingCardItem,n=j.Types,o=m.Types,p=zmText.get("zm-settings-core","archivePolicy"),q={CARD_ID:"archivepolicy",PAGE_ID:"archivepolicy",APP_ID:"sa-archivepolicy",CATEGORY_ID:"mail",APPCORE_MODULE_ID:"zm-settings-app-archivepolicy",ARCHIVE_POLICY_CARD_ITEM_ID:"archive-policy",APPCORE_MODULE_NAMESPACE:"MailSuite.Apps.ArchivePolicy.AppCore"},r=null,s=function(){return zmAppLoader.load(q.APPCORE_MODULE_ID)},t=function(){return b(q.APPCORE_MODULE_NAMESPACE)},u=function(){k.create(q.CARD_ID,{props:{title:p.labels.title,openable:!0},attributes:{category:q.CATEGORY_ID},openAction:k.CardActions.OpenPageAction(q.PAGE_ID)})},v=function(){l.create(q.ARCHIVE_POLICY_CARD_ITEM_ID,{props:{title:p.labels.title},attributes:{type:o.Action,card:q.CARD_ID},primaryAction:l.CardItemActions.OpenPageAction("archivepolicy")})},w=function(){d=h.create(q.PAGE_ID,{props:{title:p.labels.title},attributes:{type:n.TitleChoiceMenu,appContainer:!0,card:q.PAGE_ID,category:"mail",pageCSSClass:"archive-policy"},onComponentCreate:function(a){r=a}})},x=function(){var a=g.makeDeferred();return s().then(function(){t().initialize({settingPageComponent:r,progress:a})},function(){g.debugLog("Module load failed !!!"),a.reject()}),a.promise()},y=function(){var a=g.makeDeferred();return s().then(function(){t().uninitialize({progress:a}),c=null,d=null,r=null}),a.promise()},z=function(){return t().getAppView()},A=function(a,b){t().handleAppContainerEvent(a,b)},B=function(){c=i.create(q.APP_ID,{attributes:{page:q.PAGE_ID,isReactApp:!0},initialize:x,uninitialize:y,getView:z,handleContainerEvent:A})},C=function(){u(),v(),w(),B(),a.Constants=q,a.App=c,a.Page=d};C()},"MailSuite.Apps"),_defineSettingsModule("Filter",function(a,b){var c,d,e,f=b("Platform.Components"),g=b("Platform.Entities"),h=b("Platform.System.Utils"),i=f.SettingCardManager,j=f.SettingCardItemManager,k=f.SettingPageManager,l=f.SettingAppManager,m=g.SettingPage,n=g.SettingCardItem,o=m.Types,p=n.Types,q=zmText.get("zm-settings-core","filters"),r={title:q.title,createFilter:q.createNew,importFilter:q.importFilter,exportFilter:q.exportFilter,smartFilters:q.smartFilters,enabled:q.enabled,disabled:q.disabled},s={CARD_ID:"filters",PAGE_ID:"filters",APP_ID:"sa-filters",CATEGORY_ID:"mail",CREATE_FILTER_CARD_ITEM_ID:"create-filter",IMPORT_FILTER_CARD_ITEM_ID:"import-filter",EXPORT_FILTER_CARD_ITEM_ID:"export-filter",SMART_FILTER_CARD_ITEM_ID:"smart-filters",APPCORE_MODULE_ID:"zm-settings-app-filters-new"},t=f.SettingManager,u="smart-filter",v={errors:function(a){return"Error occured ! Error Code = "+a},fetch:function(a){var b=h.makeDeferred();return h.debugLog("fetching mail-setting "+u,a),Backbone.ajax({url:zmail.conPath+"/filter.do",data:{accId:zmail.accId,mode:"getSmartFilterStatus"}}).done(function(a){1===a[0]&&b.resolve(Boolean(a[1].SmartFilterStatus))}),b.promise()},save:function(a,b){var c=h.makeDeferred();return h.debugLog("saving "+u,a,b),Backbone.ajax({url:zmail.conPath+"/filter.do",data:{mode:a?"enableSmartFilter":"disableSmartFilter",accId:zmail.accId}}).done(function(b){var d=ZMStore.getInstance("IncomingFilterCollection");if(d){var e=d.query().where("filterType","is",3).select();0===e.length?d.resetAndFetchCollectionOf(!0):e.forEach(function(b){b.set("enable",a)})}if(a){var f,g=q.longDesc,h={title:r.smartFilters,$content:g,right:[],buttons:[{name:zmText.get("dialog","ok"),selected:!0}]};h.buttons[0].callback=function(){f.remove()},f=Dialog["new"](h),c.resolve(!a)}}),c.promise()}},w=t.create(u,{props:{defaultValue:!1},persister:v,type:"boolean",category:"filter"});w.initialize();var x=function(){i.create(s.CARD_ID,{props:{addToSearch:!1,title:r.title,openable:!0},attributes:{category:s.CATEGORY_ID},openAction:function(){i.CardActions.OpenPageAction(s.PAGE_ID)()}})},y=function(){return zmAppLoader.load(s.APPCORE_MODULE_ID)},z=function(){j.create(s.CREATE_FILTER_CARD_ITEM_ID,{props:{title:r.createFilter},attributes:{type:p.Action,card:s.CARD_ID},primaryAction:function(){d.setProp({showNewFilter:!0}),j.CardItemActions.OpenPageAction(s.PAGE_ID)()}}),j.create(s.IMPORT_FILTER_CARD_ITEM_ID,{props:{title:r.importFilter},attributes:{type:p.Action,card:s.CARD_ID},primaryAction:function(){y().then(function(){b("Apps.Filter.Views.Utils").importFilters()})}}),j.create(s.EXPORT_FILTER_CARD_ITEM_ID,{props:{title:r.exportFilter},attributes:{type:p.Action,card:s.CARD_ID},primaryAction:function(){y().then(function(){b("Apps.Filter.Views.Utils").exportFilters()})}}),e=j.create(s.SMART_FILTER_CARD_ITEM_ID,{props:{title:r.smartFilters},attributes:{type:p.LabelAction,card:s.CARD_ID},transformer:function(a,b){return b=b||{},"props"===a&&b.hasOwnProperty("value")&&(b.value=b.value===!0?r.enabled:r.disabled),b},primaryAction:function(){d.setProp({showNewFilter:!0}),j.CardItemActions.OpenPageAction(s.PAGE_ID)()},secondaryAction:function(){var a=w.get()!==!0;w.set(a)}})},A=function(){var a=b("MailSuite.Common.React.UIComponents.AccountsBand"),d=b("MailSuite.App.Core.Framework.Sections.Category.getComponents")();c=d.breadcrumbSection,ReactDOM.render(React.createElement(a),c.getLeftHeaderComponentWrapper())},B=function(){ReactDOM.unmountComponentAtNode(c.getLeftHeaderComponentWrapper())},C=function(){k.create(s.PAGE_ID,{props:{title:r.title,showTitle:!1},attributes:{type:o.PageAlone,card:s.PAGE_ID,category:"mail",appContainer:!0,pageCSSClassName:""},onComponentCreate:function(a){c=a}})},D=function(){return y()},E=function(){b("Apps.Filter.Views.Utils")._reset()},F=function(){d.getProp().showNewFilter&&ZMStore.getInstance("IncomingFilterCollection").fetchFilters().then(function(){b("Apps.Filter.Events").trigger("create-new-filter"),d.setProp({showNewFilter:!1})}),A()},G=function(){b("Apps.Filter.Views.Utils")._reset(),B()},H=function(){d=l.create(s.APP_ID,{attributes:{page:s.PAGE_ID,isReactApp:!0},initialize:D,uninitialize:E,getView:function(){var a=zmail.Settings.Apps.Filter.Views.UIComponents;return a.getView()},handleContainerEvent:function(a,b){h.debugLog("Container event",a,b),"active"===a?F():G()}})},I=function(){x(),z(),C(),H(),j.bindSetting(e,w)};return I(),a.smartFilterSetting=w,a},"Apps"),_defineSettingsModule("Signature",function(a,b){var c,d=b("Platform.Components"),e=b("Platform.Entities"),f=b("Platform.System.Utils"),g=d.SettingCardManager,h=d.SettingCardItemManager,i=d.SettingPageManager,j=d.SettingAppManager,k=e.SettingPage,l=e.SettingCardItem,m=k.Types,n=l.Types,o=zmText.get("zm-settings-core","signature.labels"),p={CARD_ID:"signatures",PAGE_ID:"signatures",APP_ID:"sa-signatures",SIGNATURE_NEW_CARD_ITEM_ID:"signature-new",CATEGORY_ID:"mail",APPCORE_MODULE_ID:"zm-settings-app-signature"},q=h.CardItemActions.OpenPageAction(p.PAGE_ID),r=function(){g.create(p.CARD_ID,{props:{title:o.title,openable:!0},attributes:{category:p.CATEGORY_ID},openAction:g.CardActions.OpenPageAction(p.PAGE_ID)})},s=function(){i.create(p.PAGE_ID,{props:{title:o.title},attributes:{type:m.Title,card:p.PAGE_ID,category:"mail",appContainer:!0,pageCSSClass:"signature-setting-app"}})},t=function(){return zmAppLoader.load(p.APPCORE_MODULE_ID)},u=function(){var a=f.makeDeferred();return t().then(function(){zmail.Settings.Apps.Signature.initRequest().done(function(){a.resolve()})},function(){a.reject()}),a.promise()},v=function(){var a=f.makeDeferred();return t().then(function(){a.resolve()}),a.promise()},w=function(){var a=null;return a=zmail.Settings.Apps.Signature.init()},x=function(a,c){var d=b("Apps.Signature");d&&d.handleContainerEvent(a,c)},y=function(){c=j.create(p.APP_ID,{attributes:{page:p.PAGE_ID,isReactApp:!0},initialize:u,uninitialize:v,getView:w,handleContainerEvent:x})},z=function(){h.create(p.SIGNATURE_NEW_CARD_ITEM_ID,{props:{title:o.addNewSignature},attributes:{type:n.Action,card:p.CARD_ID},primaryAction:function(){c.setProp({openNew:!0}),q()}})},A=function(){r(),z(),s(),y(),a.App=c};A()},"Apps"),function(){var a=zmail.Settings.Modules,b=a["import"]("Apps.Signature"),c=function(a,b,c,d,e,f){var g;"file"===f?zmAttachComponent.imageEditTool.init({file:a.file,onAttach:function(b){a.file=b.blob,g()},onClose:function(){},handBckObj:function(){}}):"source"===f&&zmAttachComponent.imageEditTool.init({source:a,onAttach:function(b){a={},a.file=b.blob,g()},onClose:function(){},handBckObj:function(){}}),a.dataURI&&(a.file=zmCUtil.dataURItoBlob(a.dataURI)),g=function(){if(a.file){var b,f="pastImg",g=(new Date).getTime()+".png",h=0;if(a&&a.file){if(a.file&&(b=a.file,a.file.name&&(g=a.file.name)),g.lastIndexOf(".")!==-1){var i=g.substr(g.lastIndexOf("."));"png"!==i&&(g+=".png")}else g+=".png";a.file.size&&(h=a.file.size)}var j=3145728;if(h>j){var k=zmText.get("zm-settings-app-signature"),l=k.imageupload_size_exceeds;Dialog.alert(l)}var m=new XMLHttpRequest;m.upload.addEventListener("loadstart",function(){c(f)},!1);var n=new FormData,o=zmAjq.getCookie("zmcsr");n.append("aId",zmail.accId),n.append("frm","c"),n.append("uploadMode","drop"),n.append("mode","composeSet"),n.append("context","zm"),n.append("zmrcsr",o),n.append("img_file",b,g),m.onreadystatechange=function(){if(4===m.readyState)if(200===m.status){var a,b=$.parseJSON(m.responseText),c=b.fileName,g=b.aId,h=b.storeName,i=b.frm;c&&g&&h&&i?(a="/mail/ImageSignature?fileName="+c,a+="&accountId="+g+"&storeName="+h,"c"===i&&(a+="&frm=c"),d(a,f)):e(f)}else e(500===m.status||400===m.status?f:f)},m.open("POST",zmail.conPath+"/zeUploadImage.do",!0),m.send(n)}}};b.inlineImage=c}(),_defineSettingsModule("VacationReply",function(a,b){var c,d=b("Platform.Components"),e=b("Platform.Entities"),f=b("Platform.System.Utils"),g=d.SettingCardManager,h=d.SettingCardItemManager,i=d.SettingPageManager,j=d.SettingAppManager,k=e.SettingPage,l=e.SettingCardItem,m=k.Types,n=l.Types,o=zmText.get("zm-settings-core","vacationreply"),p={CARD_ID:"vacationreply",PAGE_ID:"vacationreply",APP_ID:"sa-vacationreply",CATEGORY_ID:"mail",APPCORE_MODULE_ID:"zm-settings-app-vacationreply",VACATIONREPLY_NEW_CARD_ITEM_ID:"vacationreply-new"},q=g.CardActions.OpenPageAction(p.PAGE_ID),r=function(){g.create(p.CARD_ID,{props:{title:o.title,openable:!0},attributes:{category:p.CATEGORY_ID},openAction:g.CardActions.OpenPageAction(p.PAGE_ID)})},s=function(){i.create(p.PAGE_ID,{props:{title:o.title},attributes:{type:m.TitleChoiceMenu,card:p.PAGE_ID,category:"mail",appContainer:!0,pageCSSClass:"vacationreply-setting-app"}})},t=function(){return zmAppLoader.load(p.APPCORE_MODULE_ID)},u=function(){var a=f.makeDeferred();return t().then(function(){zmail.Settings.Apps.VacationReply.initRequest(),a.resolve()},function(){a.reject()}),a.promise()},v=function(){var a=f.makeDeferred();return t().then(function(){zmail.Settings.Apps.VacationReply.clearTrace(),a.resolve()}),a.promise()},w=function(){var a=null;return a=zmail.Settings.Apps.VacationReply.init()},x=function(a,c){var d=b("Apps.VacationReply");d&&d.handleContainerEvent(a,c)},y=function(){c=j.create(p.APP_ID,{attributes:{page:p.PAGE_ID,isReactApp:!0},initialize:u,uninitialize:v,getView:w,handleContainerEvent:x})},z=function(){h.create(p.VACATIONREPLY_NEW_CARD_ITEM_ID,{props:{title:o.createNew},attributes:{type:n.Action,card:p.CARD_ID},primaryAction:function(){c.setProp({openNew:!0}),q()}})},A=function(){r(),z(),s(),y(),a.App=c};A()},"Apps"),_defineSettingsModule("AntiSpam",function(a,b){var c,d=b("Platform.Components"),e=b("Platform.Entities"),f=b("Platform.System.Utils"),g=d.SettingCardManager,h=d.SettingCardItemManager,i=d.SettingPageManager,j=d.SettingAppManager,k=e.SettingPage,l=e.SettingCardItem,m=k.Types,n=l.Types,o=zmText.get("zm-settings-core","antispam"),p={CARD_ID:"antispam",PAGE_ID:"antispam",APP_ID:"antispam",CATEGORY_ID:"mail",APPCORE_MODULE_ID:"zm-settings-app-antispam",DOMAIN_ID:"domain-list",EMAIL_ADDRESS_ID:"email-list",UNSUBSCRIBED_LIST_ID:"unsubscribed-list",LANGUAGE_FILTER_ID:"language-filter-list"},q=function(){return g.CardActions.OpenPageAction(p.PAGE_ID)()},r=function(){g.create(p.CARD_ID,{props:{addToSearch:!1,title:o.title,openable:!0},attributes:{category:p.CATEGORY_ID},openAction:q})},s=function(){var a=b("Apps.AntiSpam.Views.UIComponents"),d=b("MailSuite.App.Core.Framework.Sections.Category.getComponents")();c=d.breadcrumbSection,ReactDOM.render(React.createElement(a.StatusBand),c.getLeftHeaderComponentWrapper())},t=function(){ReactDOM.unmountComponentAtNode(c.getLeftHeaderComponentWrapper())},u=function(){return zmAppLoader.load(p.APPCORE_MODULE_ID)},v=function(){h.create(p.EMAIL_ADDRESS_ID,{props:{title:o.email},attributes:{type:n.Action,card:p.CARD_ID},primaryAction:function(){u().then(function(){zmail.Settings.Apps.AntiSpam.Models.tabs.set({currentTab:1}),q()})}}),h.create(p.DOMAIN_ID,{props:{title:o.domain},attributes:{type:n.Action,card:p.CARD_ID},primaryAction:function(){u().then(function(){zmail.Settings.Apps.AntiSpam.Models.tabs.set({currentTab:2}),q()})}}),h.create(p.UNSUBSCRIBED_LIST_ID,{props:{title:o.unsubscribedlist},attributes:{type:n.Action,card:p.CARD_ID},primaryAction:function(){u().then(function(){zmail.Settings.Apps.AntiSpam.Models.tabs.set({currentTab:3}),q()})}}),h.create(p.LANGUAGE_FILTER_ID,{props:{title:o.langfilter},attributes:{type:n.Action,card:p.CARD_ID},primaryAction:function(){u().then(function(){zmail.Settings.Apps.AntiSpam.Models.tabs.set({currentTab:4}),q()})}})},w=function(){i.create(p.PAGE_ID,{props:{title:o.pageTitle},attributes:{type:m.PageAlone,card:p.PAGE_ID,category:"mail",appContainer:!0,pageCSSClassName:""},onComponentCreate:function(a){c=a}})},x=function(){return u()},y=function(){ZMStore.getInstance("WLEmailCollection").resetList(),ZMStore.getInstance("BLEmailCollection").resetList(),ZMStore.getInstance("WLDomainCollection").resetList(),ZMStore.getInstance("BLDomainCollection").resetList()},z=function(){j.create(p.APP_ID,{attributes:{page:p.PAGE_ID,isReactApp:!0},initialize:x,uninitialize:y,getView:function(){var a=zmail.Settings.Apps.AntiSpam.Views.UIComponents;return a.getView()},handleContainerEvent:function(a,b){f.debugLog("Container event",a,b),"active"===a?s():t()}})},A=function(){r(),v(),w(),z()};A()},"MailSuite.Apps"),_defineSettingsModule("ImportExport",function(a,b){var c,d=b("Platform.Components"),e=b("Platform.Entities"),f=b("Platform.System.Utils"),g=d.SettingCardManager,h=d.SettingCardItemManager,i=d.SettingPageManager,j=d.SettingAppManager,k=e.SettingPage,l=e.SettingCardItem,m=k.Types,n=l.Types,o=zmText.get("zm-settings-core","importexport"),p={title:o.title,importLog:o.importLog,exportLog:o.exportLog},q={CARD_ID:"importexport",PAGE_ID:"importexport",APP_ID:"sa-importexport",CATEGORY_ID:"mail",APPCORE_MODULE_ID:"zm-settings-app-importexport",IMPORT_LOG_CARD_ITEM_ID:"import-log",EXPORT_LOG_CARD_ITEM_ID:"export-log"},r=function(){g.create(q.CARD_ID,{props:{addToSearch:!1,title:p.title,openable:!0},attributes:{category:q.CATEGORY_ID},openAction:function(){g.CardActions.OpenPageAction(q.PAGE_ID)()}})},s=function(){var a=b("MailSuite.Common.React.UIComponents.AccountsBand"),d=b("MailSuite.App.Core.Framework.Sections.Category");c=d.breadcrumbSection(),ReactDOM.render(React.createElement(a),c.getLeftHeaderComponentWrapper())},t=function(){ReactDOM.unmountComponentAtNode(c.getLeftHeaderComponentWrapper())},u=function(){return zmAppLoader.load(q.APPCORE_MODULE_ID)},v=function(){h.create(q.IMPORT_LOG_CARD_ITEM_ID,{props:{title:p.importLog},attributes:{type:n.Action,card:q.CARD_ID},primaryAction:function(){u().then(function(){h.CardItemActions.OpenPageAction(q.PAGE_ID)(),b("Apps.ImportExport.Views.Utils").showImportList()})}}),h.create(q.EXPORT_LOG_CARD_ITEM_ID,{props:{title:p.exportLog},attributes:{type:n.Action,card:q.CARD_ID},primaryAction:function(){u().then(function(){h.CardItemActions.OpenPageAction(q.PAGE_ID)(),b("Apps.ImportExport.Views.Utils").showExportList()})}})},w=function(){i.create(q.PAGE_ID,{props:{title:p.title,showTitle:!1},attributes:{category:"mail",appContainer:!0,type:m.PageAlone,card:q.PAGE_ID,showActionable:!1,pageCSSClassName:""},onComponentCreate:function(a){c=a}})},x=function(){return u().then(function(){var a=b("Apps.ImportExport.Models");a.ImportList.initialize(),a.ExportList.initialize(),s()})},y=function(){var a=b("Apps.ImportExport.Models");a.ImportList.uninitialize(),a.ExportList.uninitialize(),t()},z=function(){j.create(q.APP_ID,{attributes:{page:q.PAGE_ID,isReactApp:!0},initialize:x,uninitialize:y,getView:function(){var a=b("Apps.ImportExport.Views.UIComponents");return a.getView()},handleContainerEvent:function(a,b){f.debugLog("Container event",a,b)}})},A=function(){r(),v(),w(),z()};A()},"MailSuite.Apps"),function(){var a=zmail.Settings.Platform.Commands,b=zmail.Settings.SearchCommandIntegrator,c=zmText.get("zm-settings-core","importexport.commands");
a.register([{command:"importexport",title:c.importExport,on:"goto",executeDependentCommands:!1,callback:function(){var c=this;a.execute("load-importexport").then(function(){b.showAutoFill(c.getDependentCommands())})}},{command:"show-export-log",title:c.showExportLog,on:"importexport",base:"importexport",callback:function(){a.execute("load-importexport").done(function(){zmail.Settings.Apps.ImportExport.Views.Utils.showExportList()})}},{command:"show-import-log",title:c.showImportLog,on:"importexport",base:"importexport",callback:function(){a.execute("load-importexport").done(function(){zmail.Settings.Apps.ImportExport.Views.Utils.showImportList()})}}])}(),function(){var a=zmail.Settings.Modules,b=a.create("Apps.SendMailAs.models");b.accountInfo=Zmail.Model.extend({defaults:{},initialize:function(){},idAttribute:"accId",validate:function(){},parse:function(a){var b={};return b.accId=a.accId||a.acId,b.sendId=a.sendId,b.emailId=a.eMail,b},url:zmail.conPath+"/jsp/sendMailAs.jsp",serialized:function(a,b){var c=this,d=null;return"delete"===a&&(d={mode:"delete",accId:c.id}),d},fetchContent:function(a){return this.sync("get",this,a).done(function(a){})}},{})}(),function(){var a=zmail.Settings.Modules,b=a.create("Apps.SendMailAs.models"),c={GET_LIST:"getList"};b.accIdCollection=Zmail.Collection.extend({initialize:function(){},model:b.accountInfo,url:zmail.conPath+"/jsp/sendMailAs.jsp",serialized:function(a,b){var d=null;return"read"===a&&(d={mode:c.GET_LIST}),d},fetchCompleted:!1,fetchList:function(){return this.fetch()},parse:function(a,b){var c=[];return"object"===("undefined"==typeof a?"undefined":babelHelpers["typeof"](a))?(a.acId||a.accId)&&(c=[a]):Array.isArray(c)&&(c=_(a).each(function(a){(a.acId||a.accId)&&c.push(a)})),c},resetAndSetAll:function(a){}},{getCollection:function(){}})}(),define([],function(){var a=zmail.Settings.Modules,b=a.create("Apps.SendMailAs.models"),c=zmail.Core.Namespaces,d=c.get("zmail.DataLayer"),e=d.DSModel,f={SERVERDETAIL_FETCH_STARTED:"SERVERDETAIL_FETCH_STARTED",SERVERDETAIL_FETCH_COMPLETED:"SERVERDETAIL_FETCH_COMPLETED"},g=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"getDefaults",value:function(){return{isDefault:!1,dispName:"",isGroup:!1,isEnabled:!1,isAliasOrGroup:!1,isReplyVerified:!1,replyTo:"",mode:"",serverDetails:{}}}},{key:"getIdAttribute",value:function(){return"sendId"}},{key:"getAttrsConfig",value:function(){return{dispName:"string",isGroup:"boolean"}}},{key:"parse",value:function(a){var b={};return a.sendId&&(b.sendId=a.sendId),b.isEnabled=a.isAlias&&"true"===a.isAlias,b.isGroup=a.group&&"true"===a.group,b.isAliasOrGroup=a.isZoho&&"true"===a.isZoho,b.isDefault=a.defaut&&"true"===a.defaut,b.dispName=a.dispName||"",b.fromAddr=a.fromAddr||"",b.replyTo=a.replyTo||"",b.isReplyVerified=a.isReplyVerified&&"true"===a.isReplyVerified,a.mode&&(b.mode=Number(a.mode)),b}},{key:"fetchServerDetails",value:function(a){var b=this;return b.serverDataFetched=!1,b.trigger(f.SERVERDETAIL_FETCH_STARTED),b.triggerAction("frmEdit",b,a).then(function(a){var c=a.resp;b.serverDataFetched=!0,b.updateServerDetails(c),b.trigger(f.SERVERDETAIL_FETCH_COMPLETED)})}},{key:"updateServerDetails",value:function(a){var b=this,c={mode:a[0],name:a[1]};a[2]&&(c.server=a[2]);var d;4===a.length&&a[3].repTo?(d=a[3],c.repTo=a[3].repTo):3===a.length&&a[2].repTo&&(d=a[2]),d&&(c.repProp={repTo:d.repTo,isRepVeri:d.isRepVeri}),b.set({serverDetails:c})}}]),b}(e);return b.SendMailAs=g,g}),define([],function(){var a=zmail.Settings.Modules,b=a.create("Apps.SendMailAs.models"),c=zmail.Core.Namespaces,d=c.get("zmail.DataLayer"),e=d.DSCollection,f=b.SendMailAs,g=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"getBaseModelClass",value:function(){return f}}]),b}(e);return b.SendMailAsCollection=g,g}),define([],function(){var a=zmail.Settings.Modules,b=a.create("Apps.SendMailAs.models"),c=zmail.Core.Namespaces,d=c.get("zmail.DataLayer"),e=d.Adapter.HTTPAdapter,f={GET_LIST:"frmList",CREATE:"frmSave",DELETE:"frmDelete",RESEND_CODE:"frmResend",VERIFY:"frmVerify",UPDATE_ZACC:"frmZacc",UPDATE:"frmUpdate",EDIT:"frmEdit",RESEND_CODE_REPLYTO:"replyToResend",VERIFY_REPLYTO:"replyToVerify"},g=function(a){function c(){return babelHelpers.classCallCheck(this,c),babelHelpers.possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return babelHelpers.inherits(c,a),babelHelpers.createClass(c,[{key:"getUrl",value:function(){return zmail.conPath+"/sendMailAs.do"}},{key:"getDefaultRequestMethods",value:function(){return{create:"POST",update:"POST",patch:"POST","delete":"POST",read:"GET"}}},{key:"serialize",value:function(a,b,c){var d,e,g=null;return"create"===a?(g={mode:f.CREATE,dispName:b.get("dispName"),emailId:b.get("fromAddr")},c.isZoho?g.isZ=!0:(g.smtpServer=c.smtpServer,g.smtpPort=c.smtpPort,g.sslMode=c.sslMode,c.auth&&(g.uName=c.uName,g.pass=c.pass)),c.replyTo&&(g.replyTo=c.replyTo)):"delete"===a?g={mode:f.DELETE,smId:b.id}:"update"===a?(e=c.attrs,g={smId:b.id,dispName:e.dispName,emailId:e.emailId},b.get("isAliasOrGroup")?d=f.UPDATE_ZACC:(d=f.UPDATE,g.otMode=e.accMode,e.isZoho?g.isZ=!0:(g.smtpServer=e.smtpServer,g.smtpPort=e.smtpPort,g.sslMode=e.sslMode,e.auth&&(g.uName=e.uName,g.pass=e.pass))),e.replyTo&&(g.replyTo=e.replyTo),g.mode=d):"fetchAll"===a?g={mode:f.GET_LIST}:"frmEdit"===a?g={mode:f.EDIT,smId:b.id,isDef:b.get("isDefault")}:"resendCode"===a?g={smId:b.id,emailId:b.get("fromAddr"),mode:f.RESEND_CODE}:"resendCode_replyto"===a?g={emailId:b.get("fromAddr"),replyTo:b.get("replyTo"),mode:f.RESEND_CODE_REPLYTO}:"verify_replyto"===a?g={emailId:b.get("fromAddr"),mode:f.VERIFY_REPLYTO,vCode:c.code}:"verify"===a&&(g={smId:b.id,emailId:b.get("fromAddr"),mode:f.VERIFY,vCode:c.code}),g}},{key:"normalize",value:function(a,c,d){var e,f,g={};if("fetchAll"===a){c=c[0];var h=c.fact;b.sendMailIdMap=c.acLst;var i=[];for(e in h)h[e].sendId&&i.push(h[e]);g=i}else if("create"===a){var j=void 0;j=c[0];var k,l,m,n,o;if("Success"===j.oth.st){for(l=Object.keys(j.fact),m=l.length,n=0;n<m;n++)if(j.fact[l[n]].fromAddr===j.semId.emId){k=j.fact[l[n]].sendId;break}o=!0,"undefined"!=typeof j.vfyst&&"false"===j.vfyst&&(o=!1),g.sendId=k,f=j.fact[k],g.isReplyVerified=f.isReplyVerified&&"true"===f.isReplyVerified,g.isEnabled=o,g.replyTo=f.replyTo||""}else g.error=!0}else if("update"===a){var p=void 0;p=c[0],"Success"===p.oth.st?(f=p.fact[d.attrs.sendId],g.isReplyVerified=f.isReplyVerified&&"true"===f.isReplyVerified,g.isEnabled=f.isAlias&&"true"===f.isAlias,g.serverDetails={}):g.error=!0}else if("resendCode"===a||"resendCode_replyto"===a){var q=void 0;q=c[0],"Error"===q.oth.st?g.error=!0:g.status="s",g.msg=q.oth.msg}else if("verify"===a){var r=c[0];"Error"===r.oth.st?g.status="e":(g.status="s",f=r.fact[d.sendId],g.isReplyVerified=f.isReplyVerified&&"true"===f.isReplyVerified,g.isEnabled=f.isAlias&&"true"===f.isAlias),g.msg=r.oth.msg}else if("verify_replyto"===a){var s=c[0],t="",u="";if(s.oth)t=s.oth.st,u=s.oth.msg;else{var v=c[1];t=v.st,u=v.msg}"Error"===t?g.status="e":(g.status="s",f=s.fact[d.sendId],g.isReplyVerified=f.isReplyVerified&&"true"===f.isReplyVerified,g.isEnabled=f.isAlias&&"true"===f.isAlias),g.msg=u}else g=c;return g}}]),c}(e);return b.HTTPAdapter=g,g}),function(){var a=zmail.Settings.Modules,b=a["import"]("Apps.SendMailAs.models"),c=zmText.get("zm-settings-core","sendmailas"),d={FETCH_STARTED:"FETCH_STARTED",FETCH_COMPLETED:"FETCH_COMPLETED"},e=b.SendMailAsCollection,f=null,g=$.Deferred(),h=function(){f.trigger(d.FETCH_STARTED),f.fetchAll().then(function(a){g.resolve(),f.trigger(d.FETCH_COMPLETED)})},i=function(a){$.publish("FROM_ADDRESS/CHANGE",{attr:a.attributes,dispName:a.get("dispName"),emailId:a.get("fromAddr")})},j=function(a){$.publish("FROM_ADDRESS/ADD",{id:a.id,dispName:a.get("dispName"),emailId:a.get("fromAddr"),attr:a.attributes})},k=function(a){$.publish("FROM_ADDRESS/REMOVE",{id:a.id,emailId:a.get("fromAddr")})},l=function(){f.on("change:dispName",i),f.on("change:isEnabled",j),f.on("change:isReplyVerified",i),f.on("add",j),f.on("remove",k)},m=function(){var a={adapters:[{id:"http-adapter",type:"default",classObj:b.HTTPAdapter}],"default":"http-adapter"};f=ZMStore.createInstance("sendmailas",e,{adapterConfig:a}),h(),l()},n=function(){return g=$.Deferred(),f.reset(),h()},o=function(a,b){return ZMStore.createRecord("sendmailas",a,b).then(function(a){zmUtil.succErrMsg("s",c.succMsg.added)},function(a){var b=a.resp,c=b[0];throw c=c&&c.oth,zmUtil.succErrMsg("e",c.msg),c})},p=function(a){var b="object"===("undefined"==typeof a?"undefined":babelHelpers["typeof"](a))?a.id:a,d=f.get(b);return d.destroy().then(function(){f.remove(b),zmUtil.succErrMsg("s",c.succMsg.deleted)})},q=function(a){var b=f.get(a);return b.triggerAction("resendCode",{})},r=function(a,b){var c=f.get(a);return c.triggerAction("verify",{code:b,sendId:a}).then(function(a){var b=a.resp;return"e"!==b.status&&c.set({isEnabled:!0}),a})},s=function(a){var b=f.get(a);return b.triggerAction("resendCode_replyto",{})},t=function(a,b){var c=f.get(a);return c.triggerAction("verify_replyto",{code:b,sendId:a}).then(function(a){var b=a.resp;return"e"!==b.status&&c.set({isReplyVerified:!0}),a})},u=function(){return ZMStore.getInstance("sendmailas")};m(),b.getSendMailAsCollection=u,b.resetAndFetch=n,b.deleteModel=p,b.addNewModel=o,b.resendConfirmation=q,b.verifyFromAddress=r,b.resendReplyToConfirmation=s,b.verifyReplyTo=t,b.sendMailCollectionDeferred=g}(),_defineSettingsModule("models",function(a,b,c){var d={},e=function(a){return{id:a.id,dispName:a.get("dispName"),emailId:a.get("fromAddr"),isEnabled:a.get("isEnabled")}},f=function(){return ZMStore.getInstance("sendmailas")},g=function(){var a,b,c=f(),d=[];return c.forEach(function(c){b=c.get("mode"),b&&(b=Number(b)),a=c.get("isEnabled"),6!==b&&a&&d.push(e(c))}),d},h=function(){var a=f(),b=[];return a.forEach(function(a){b.push(e(a))}),b},i=function(a){var b,c=f();if(a&&(b=c.get(a)))return e(b)},j=function(){var a=0,b=f();return b.forEach(function(b){b.get("isEnabled")||a++}),a},k=function(){var a=0,b=f();return b.forEach(function(b){!b.get("isAliasOrGroup")||b.get("isGroup")||b.get("isDefault")||a++}),a},l=function(a){for(var b=zmail.Settings.Modules,c=b.create("Apps.SendMailAs.models"),d=Object.keys(c.sendMailIdMap),e=d.length,f=0;f<e;f++)if(c.sendMailIdMap[d[f]].eMail===a)return{sendMailId:c.sendMailIdMap[d[f]].sendId,mailID:c.sendMailIdMap[d[f]].acId}};d.getConfirmedList=g,d.getFromAddressList=h,d.getFromAddrDetails=i,d.getUnverifiedListCount=j,d.getAliasListCount=k,d.getSendMailId=l,a.API=d},"Apps.SendMailAs"),_defineSettingsModule("Validators",function(a,b){var c=zmail.Utils.EmailValidator,d=zmText.get("zm-settings-core","sendmailas"),e=d.errMsg,f=function(a){if(!a)return{valid:!1,errMsg:e.emptyEmail};var b=c.validate(a),d={};return d.valid=b.status,b.status||(d.errMsg=e.validEmail),d},g=function(a){var b=c.validate(a),d={};return d.valid=b.status,b.status||(d.errMsg=e.validReplyToEmail),d},h=function(a){var b=!0,c="";return a||(b=!1,c=e.emptyName),b&&(b=!zmUtil.hasSpecialChars(a,"dispName"),b||(c=e.nameHasSpecialChar)),{valid:b,errMsg:c}},i=function(a){var b=!0,c="";return a||(b=!1,c=e.emptyServerDetails),b&&(b=!zmUtil.hasSpecialChars(a,"dispName"),b||(c=e.serverDetailsHasSpecialChar)),{valid:b,errMsg:c}},j=function(a){var b=!0,c="",d=a.uName,f=a.pass;return d?f||(b=!1,c=e.emptyPass):(b=!1,c=e.emptyUname),{valid:b,errMsg:c}};a.validateUserCred=j,a.validateServerName=i,a.validateDispName=h,a.validateEmailId=f,a.validateReplyToId=g},"Apps.SendMailAs"),_defineSettingsModule("SendMailAs",function(a,b){var c,d,e,f,g=b("Platform.Components"),h=b("Platform.Entities"),i=b("Platform.System.Utils"),j=g.SettingCardManager,k=g.SettingCardItemManager,l=g.SettingPageManager,m=g.SettingAppManager,n=h.SettingPage,o=h.SettingCardItem,p=n.Types,q=o.Types,r=b("Apps.SendMailAs.models"),s=zmText.get("zm-settings-core","sendmailas"),t={CARD_ID:"sendmailas",PAGE_ID:"sendmailas",APP_ID:"sa-sendmailas",CATEGORY_ID:"mail",APPCORE_MODULE_ID:"zm-settings-app-sendmailas",SENDMAILAS_NEW_CARD_ITEM_ID:"sendmailas-new",SENDMAILAS_MANAGE_CARD_ITEM_ID:"sendmailas-manage",SENDMAILAS_UNVERIFIED_CARD_ITEM_ID:"sendmailas-unverified",SENDMAILAS_ALIAS_CARD_ITEM_ID:"sendmailas-alias"},u={REMOVE:"remove",ADD:"add",VERIFY_STATUS_CHANGE:"change:isEnabled"},v="Apps.SendMailAs.AppCore",w=j.CardActions.OpenPageAction(t.PAGE_ID),x=function(){j.create(t.CARD_ID,{props:{title:s.title,openable:!0},attributes:{category:t.CATEGORY_ID},openAction:j.CardActions.OpenPageAction(t.PAGE_ID)})},y=function(){l.create(t.PAGE_ID,{props:{title:s.title,showTitle:!0},attributes:{type:p.TitleChoiceMenu,card:t.PAGE_ID,category:"mail",appContainer:!0,pageCSSClass:"sendmailas-setting-app"},onComponentCreate:function(a){c=a}})},z=function(){return zmAppLoader.load(t.APPCORE_MODULE_ID)},A=function(){var a=i.makeDeferred();return z().then(function(){b(v).initialize({_settingPageComponent:c}),a.resolve()},function(){a.reject()}),a.promise()},B=function(){var a=i.makeDeferred();return z().then(function(){b(v).uninitialize({_settingPageComponent:c}),a.resolve()}),a.promise()},C=function(){var a=b(v);return a.getAppView()},D=function(a,c){var d=b(v);d&&d.handleContainerEvent(a,c)},E=function(){f=m.create(t.APP_ID,{attributes:{page:t.PAGE_ID,isReactApp:!0},initialize:A,uninitialize:B,getView:C,handleContainerEvent:D})},F=function(){k.create(t.SENDMAILAS_NEW_CARD_ITEM_ID,{props:{title:s.createNew},attributes:{type:q.Action,card:t.CARD_ID},primaryAction:function(){f.setProp({openNew:!0}),w()}}),k.create(t.SENDMAILAS_MANAGE_CARD_ITEM_ID,{props:{title:s.manageFromAddress},attributes:{type:q.Action,card:t.CARD_ID},primaryAction:function(){w()}})},G=function(){var a=r.API;d=k.create(t.SENDMAILAS_UNVERIFIED_CARD_ITEM_ID,{props:{title:s.unverifiedList,value:a.getUnverifiedListCount()},attributes:{type:q.LabelValue,card:t.CARD_ID},primaryAction:function(){w()}}),e=k.create(t.SENDMAILAS_ALIAS_CARD_ITEM_ID,{props:{title:s.aliasAddress,value:a.getAliasListCount()},attributes:{type:q.LabelValue,card:t.CARD_ID},primaryAction:function(){w()}})},H=function(){var a=r.API;d.setProp({value:a.getUnverifiedListCount()})},I=function(){var a=r.API;e.setProp({value:a.getAliasListCount()})},J=function(){var a=ZMStore.getInstance("sendmailas");a.on(u.REMOVE,H),a.on(u.ADD,H),a.on(u.VERIFY_STATUS_CHANGE,H),a.on(u.ADD,I)},K=function(){r.sendMailCollectionDeferred.done(function(){G(),J()})},L=function(){f.setProp({openNew:!0}),w()},M=function(){x(),F(),y(),E(),K(),a.App=f,a.createNew=L};M()},"Apps"),define([],function(){var a,b=zmail.Core.Namespaces,c=b.get("zmail.DataLayer"),d=c.DSModel,e=zmail.Settings.Modules,f=e.create("Apps.Signature.constants"),g=b.create("zmail.Signature"),h=b.create("zmail.Signature.models"),i=function(a,b){$.publish(a,b)},j=function(b){function c(){return babelHelpers.classCallCheck(this,c),babelHelpers.possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return babelHelpers.inherits(c,b),babelHelpers.createClass(c,[{key:"defaults",value:function(){return{name:"",id:"",content:"",position:1,sendMailIds:[]}}},{key:"getIdAttribute",value:function(){return"id"}},{key:"parse",value:function(a){var b=[],c={name:a.name,id:a.id,content:a.content,position:a.position};return a.sendMailIds&&(b=a.sendMailIds,c.sendMailIds=b),c}},{key:"savePosition",value:function(b){var c={attrs:{id:this.id,position:b}},d=this;return this.triggerAction(f.METHODS.UPDATE,c).then(function(c){d.set("position",b),a=f.EVENTS,i(a.UPDATE,d.cloneAttributes())})}},{key:"associateSignature",value:function(b,c){var d=this,e=this.id,g={attrs:{mailIds:b,mailIdsWithNoSignature:c}};return this.triggerAction(f.METHODS.ASSOCIATE,g).then(function(){var g=h.getSignatureIdsOf(b),j=[],k=[];_(b).each(function(a){j.push(h.mailDetails[a].fromAddress),h.updateSendMailDetail(a,e)}),_(c).each(function(a){k.push(h.mailDetails[a].fromAddress),h.updateSendMailDetail(a,void 0)}),d.updateSendMailIds(),d._collection.updatesendMailId(g),a=f.EVENTS,i(a.ASSOCIATE,{id:e,mailIds:j,mailIdsWithNoSignature:k})})}},{key:"updateSendMailIds",value:function(){this.set("sendMailIds",h.getSendMailIdsOf(this.id))}},{key:"cloneAttributes",value:function(){var a=this.attributes;return{id:this.id,name:a.name,content:a.content,position:a.position,sendMailIds:a.sendMailIds&&a.sendMailIds.slice()}}}]),c}(d);return g.Signature=j,j}),define([],function(){var a=zmail.Core.Namespaces,b=a.get("zmail.DataLayer"),c=b.DSCollection,d=a.get("zmail.Signature"),e=d.Signature,f=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"getBaseModelClass",value:function(){return e}},{key:"updatesendMailId",value:function(a){var b=this;_(a).each(function(a){var c=b.get(a);c&&c.updateSendMailIds()})}}]),b}(c);return d.signatureCollection=f,f}),define([],function(){var a=zmail.Core.Namespaces,b=a.get("zmail.DataLayer"),c=b.Adapter.HTTPAdapter,d=a.get("zmail.Signature"),e=a.create("zmail.Signature.models"),f=e,g={0:1,1:0},h=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"getUrl",value:function(){return"/zm/signature.do"}},{key:"getDefaultRequestMethods",value:function(){return{create:"POST",update:"POST",patch:"POST","delete":"POST",read:"GET"}}},{key:"serialize",value:function(a,b,c){var d=null,e=c.attrs;return"delete"===a?d={mode:"delete",id:b.get(b.getIdAttribute())}:"fetchAll"===a?d={mode:"getAll"}:"associate"===a?(d={mode:"associate",id:b.get(b.getIdAttribute())},e.mailIds.length>0?d.set=e.mailIds[0]:c.attrs.mailIdsWithNoSignature.length>0&&(d.unset=e.mailIdsWithNoSignature[0])):"update"===a?(d={mode:"update",id:b.get(b.getIdAttribute()),position:g[b.get("position")]},null!==e&&e.attrs?(d={mode:"update",name:e.attrs.name,id:e.attrs.id,content:e.attrs.content,position:e.attrs.position},e.attrs.hasOwnProperty("mailIds")&&e.attrs.mailIds.length>0&&(d.set=e.attrs.mailIds),e.attrs.hasOwnProperty("mailIdsWithNoSignature")&&e.attrs.mailIdsWithNoSignature.length>0&&(d.unset=e.attrs.mailIdsWithNoSignature)):null===c.attrs&&(d={mode:"add",content:c.content,name:c.name,position:c.position},c.mailIds.length>0&&(d.set=c.mailIds,d.sendMailIds=c.mailIds),c.mailIdsWithNoSignature.length>0&&(d.unset=c.mailIdsWithNoSignature))):"create"===a&&(d={mode:"add",content:c.content,name:c.name,position:c.position},c.mailIds.length>0&&(d.set=c.mailIds)),d}},{key:"normalize",value:function(a,b,c){var d={},e=c.attrs;if("fetchAll"===a){var g,h=[];if(b.signatures){zmail.Signature.adminAddedAcc=[],zmail.Signature.adminSignSendMailId=[],zmail.Signature.adminAddedSignId=[],f.mailDetails=b.mailDetails,f.mailIds=b.mailIds;for(var i=b.signaturesOrder.length,j=0;j<i;j++){g=[];for(var k=b.signaturesOrder[j],l=0;l<b.mailIds.length;l++)b.mailDetails[b.mailIds[l]].hasOwnProperty("signatureId")&&b.mailDetails[b.mailIds[l]].signatureId===k&&g.push(b.mailIds[l]);b.signatures[b.signaturesOrder[j]].sendMailIds=g,h.push(b.signatures[b.signaturesOrder[j]])}for(var m=0;m<f.mailIds.length;m++)if(f.mailDetails[f.mailIds[m]].hasOwnProperty("isAdminAdded")&&f.mailDetails[f.mailIds[m]].isAdminAdded===!0){var n=f.mailDetails[f.mailIds[m]];zmail.Signature.adminAddedAcc.push(n.fromAddress),zmail.Signature.adminSignSendMailId.push(n.id)}for(var o=0;o<i;o++)if(b.signatures[b.signaturesOrder[o]].hasOwnProperty("isAdminAdded")&&b.signatures[b.signaturesOrder[o]].isAdminAdded===!0){var p=b.signatures[b.signaturesOrder[o]];zmail.Signature.adminAddedSignId.push(p.id)}return h}}else if("associate"===a){if(b)return d={content:b.content,id:b.id,position:b.position,name:b.name},e.mailIds.length>0?d.set=c.attrs.mailIds[0]:e.mailIdsWithNoSignature.length>0&&(d.unset=c.attrs.mailIdsWithNoSignature[0]),d}else if("delete"===a){if(b)return d}else if("update"===a){if(b)return d={id:b.id,position:b.position},null!==e&&e.attrs?(d={name:b.name,id:b.id,content:b.content,position:b.position},e.attrs.hasOwnProperty("mailIds")&&e.attrs.mailIds.length>0&&(d.set=e.attrs.mailIds,d.sendMailIds=e.attrs.mailIds.split(","))):null===e&&(d={name:b.name,id:b.id,content:b.content,position:b.position},c.hasOwnProperty("mailIds")&&c.mailIds.length>0&&(d.set=c.mailIds,d.sendMailIds=c.mailIds.split(","))),d}else if("create"===a)return d={content:c.content,name:c.name,set:c.mailIds,id:c.resp.id,position:c.position,sendMailIds:c.mailIds.split(",")}}}]),b}(c);return d.Adapter=h,h}),function(){var a=zmail.Core.Namespaces,b=a.get("zmail.Signature"),c=null,d=b.signatureCollection,e=a.get("zmail.Signature.models"),f=$.Deferred(),g=function(){c.fetchAll().then(function(){e.models=c,f.resolve()})},h=function(){var a={adapters:[{id:"http-adapter",type:"default",classObj:b.Adapter}],"default":"http-adapter"};return ZMStore.getInstance("signature")?(c=ZMStore.getInstance("signature"),f.resolve()):(c=ZMStore.createInstance("signature",d,{adapterConfig:a}),g()),f.promise()};b.initialize=h}(),define([],function(){var a=this,b=zmail.Core.Namespaces,c=b.get("zmail.Signature.models"),d={},e=zmail.Settings.Modules,f={};f.EVENTS={UPDATE_SIGNATURE_IMAGE:"UPDATE_SIGNATURE_IMAGE",FETCH_COMPLETED:"fetchCompleted",ADD:"SIGNATURE_ADDED",UPDATE:"SIGNATURE_UPDATED",DELETE:"SIGNATURE_DELETED",ASSOCIATE:"SIGNATURE_ASSOCIATED"};var g,h=e["import"]("Platform.System.Base"),i=function(a,b,c){return zmText.get("zm-settings-app-signature",a,b,c)},j=function(a,b){$.publish(a,b)};return c.getSendMailDetails=function(a){return c.mailIds&&c.mailDetails?_(c.mailIds).map(function(b){var d=c.mailDetails[b],e={};return e.id=d.id,e.fromAddress=d.fromAddress,e.type="uncheck",void 0!==a&&d.signatureId===a&&(e.type="check"),e}):[]},c.getSignatureImgURL=function(a){return d[a]},c.updateSignatureImgURL=function(a){return d[a]="/zm/SignatureImage?signatureId="+a+"&xhr="+(new Date).getTime(),d[a]},c.getSendMailDetail=function(a){if(c.mailIds&&c.mailDetails)return c.mailDetails[a]},c.updateSendMailDetail=function(a,b){if(c.mailDetails){var d=c.mailDetails[a];d&&(d.signatureId=b)}},c.getSendMailIdsOf=function(a){var b=[];return c.mailIds&&c.mailDetails&&_(c.mailIds).each(function(d){var e=c.mailDetails[d];e.signatureId===a&&b.push(e.id)}),b},c.hasAssociation=function(a,b){if(c.mailDetails){var d=c.mailDetails[a]||{};return d.signatureId===b}},c.getSignatureIdsOf=function(a){var b=[];return c.mailDetails&&_(a).each(function(a){var d=c.mailDetails[a];void 0!==d.signatureId&&b.push(d.signatureId)}),b},c.cloneAttributes=function(){var b=a.attributes;return{id:a.id,name:b.name,content:b.content,position:b.position,sendMailIds:b.sendMailIds&&b.sendMailIds.slice()}},c.addNewModel=function(a,b){return ZMStore.createRecord("signature",a,b).then(function(a){var b=c.models.models,d=b.indexOf(a.model);return b.splice(d,1),b.unshift(a.model),a},function(a){return a})},c.validate=function(a){a=a||{};var b,d=a.attrs||{},e=d.name,f=d.id,g={invalidName:!0};if(!e||!e.trim())throw new h.Error(i("dispMsg.emptyName"),g);if(e.length>25)throw new h.Error(i("dispMsg.longName"),g);if(c.isSignatureNameExist(e,f))throw new h.Error(i("dispMsg.alreadyExists"),g);if(b=d.content,!b||!b.trim())throw new h.Error(i("dispMsg.emptySignature"))},c.isSignatureNameExist=function(a,b){if(c.models.get(b)&&!c.models.get(b).isNew){var d=c.models.get(b).attributes.name;if(a===d)return!1}var e=_(c.models.pluck("name")).map(function(a){return a.toLowerCase()});return a=a.toLowerCase(),e.indexOf(a)!==-1},c.save=function(a){g=f.EVENTS;var b,d=g.UPDATE,e=a.opts,h=a.resp;b=e.attrs?""===e.attrs.attrs.mailIds?[]:e.attrs.attrs.mailIds.split(","):""===e.mailIds?[]:e.mailIds.split(",");var i;a.isNew?d=g.ADD:i=""===e.attrs.attrs.mailIdsWithNoSignature?[]:e.attrs.attrs.mailIdsWithNoSignature.split(",");var k=[],l=[],m=c.getSignatureIdsOf(b);b.forEach(function(a){k.push(c.mailDetails[a].fromAddress),c.updateSendMailDetail(a,h.id)}),i&&_(i).each(function(a){l.push(c.mailDetails[a].fromAddress),c.updateSendMailDetail(a,void 0)}),a.model._collection?a.model._collection.updatesendMailId(m):c.models&&c.models.length&&a.model.updateSendMailId(m),a.model.updateSendMailId&&a.model.updateSendMailId(),j(d,a.model.cloneAttributes()),j(g.ASSOCIATE,{id:a.model.get("id"),mailIds:k,mailIdsWithNoSignature:l})},c.createNewModel=function(a){var b=new zmail.Signature.Signature({attrs:a.attrs});return c.addNewModel(b,a.attrs).then(function(a){var b=e.create("Apps.Signature.views"),d=a.id||a.opts.resp.id;a.isNew=!0,c.save(a),"function"==typeof b.trigger&&(b.trigger(f.EVENTS.UPDATE_SIGNATURE_IMAGE,d),self.props.onSave&&self.props.onSave())})},c}),_defineSettingsModule("MailAccounts",function(a,b){var c,d,e=b("Platform.Components"),f=b("Platform.Entities"),g=b("Platform.System.Utils"),h=e.SettingCardManager,i=e.SettingCardItemManager,j=e.SettingPageManager,k=e.SettingAppManager,l=f.SettingPage,m=f.SettingCardItem,n=l.Types,o=m.Types,p=zmText.get("zm-settings-core","mailAccounts"),q={CARD_ID:"mailaccounts",PAGE_ID:"mailaccounts",APP_ID:"sa-mailaccounts",CATEGORY_ID:"mail",ADD_MAIL_ACCOUNT_CARD_ITEM_ID:"sci-add-mail-account",MANAGE_MAIL_ACCOUNTS_CARD_ITEM_ID:"sci-manage-mail-accounts",MANAGE_POP_CARD_ITEM_ID:"sci-manage-pop",MANAGE_IMAP_CARD_ITEM_ID:"sci-manage-imap",MANAGE_FORWARDS_CARD_ITEM_ID:"sci-manage-forwards",MANAGE_FETCH_CARD_ITEM_ID:"sci-manage-fetch",APPCORE_MODULE_ID:"zm-settings-app-mailaccounts",APPCORE_MODULE_NAMESPACE:"MailSuite.Apps.MailAccounts.AppCore"},r=null,s=function(){h.create(q.CARD_ID,{props:{title:p.labels.title,openable:!0},attributes:{category:q.CATEGORY_ID},openAction:h.CardActions.OpenPageAction(q.PAGE_ID)})},t=h.CardActions.OpenPageAction(q.PAGE_ID),u=function(){i.create(q.ADD_MAIL_ACCOUNT_CARD_ITEM_ID,{props:{title:p.cardItems.title.addAccount},attributes:{type:o.Action,card:q.CARD_ID},primaryAction:function(){k.get(q.APP_ID).setProp({initialAction:"add-new"}),t()}}),i.create(q.MANAGE_POP_CARD_ITEM_ID,{props:{title:p.cardItems.title.managePop},attributes:{type:o.Action,card:q.CARD_ID},primaryAction:function(){k.get(q.APP_ID).setProp({initialAction:"manage-pop"}),t()}}),i.create(q.MANAGE_IMAP_CARD_ITEM_ID,{props:{title:p.cardItems.title.manageImap},attributes:{type:o.Action,card:q.CARD_ID},primaryAction:function(){k.get(q.APP_ID).setProp({initialAction:"manage-imap"}),t()}}),i.create(q.MANAGE_FORWARDS_CARD_ITEM_ID,{props:{title:p.cardItems.title.manageForwards},attributes:{type:o.Action,card:q.CARD_ID},primaryAction:function(){k.get(q.APP_ID).setProp({initialAction:"manage-forwards"}),t()}}),i.create(q.MANAGE_FETCH_CARD_ITEM_ID,{props:{title:p.cardItems.title.manageFetch},attributes:{type:o.Action,card:q.CARD_ID},primaryAction:function(){k.get(q.APP_ID).setProp({initialAction:"manage-pop-fetch"}),t()}})},v=function(){return zmAppLoader.load(q.APPCORE_MODULE_ID)},w=function(){return b(q.APPCORE_MODULE_NAMESPACE)},x=function(){d=j.create(q.PAGE_ID,{props:{title:p.labels.title,showTitle:!0},attributes:{type:n.TitleChoiceMenu,card:q.PAGE_ID,category:"mail",appContainer:!0,pageCSSClass:"account-settings"},onComponentCreate:function(a){r=a}})},y=function(){var a=g.makeDeferred();return v().done(function(){w().initialize({settingPageComponent:r}),a.resolve()},function(){g.debugLog("Module load failed !!!"),a.reject()}),a.promise()},z=function(){var a=g.makeDeferred();return v().then(function(){w().uninitialize(),a.resolve(),c=null,d=null,r=null}),a.promise()},A=function(){return w().getAppView()},B=function(a,b){w().handleAppContainerEvent(a,b)},C=function(){c=k.create(q.APP_ID,{attributes:{page:q.PAGE_ID,isReactApp:!0},initialize:y,uninitialize:z,getView:A,handleContainerEvent:B})},D=function(){s(),u(),x(),C(),a.Constants=q,a.App=c,a.Page=d};D()},"MailSuite.Apps"),_defineSettingsModule("Cards",function(a,b){var c="group-settings",d="groups",e={cardTitle:zmText.get("zm-settings-core","groups.cardTitle")},f=b("Platform.Components"),g=f.SettingCardManager,h=g.create(c,{props:{title:e.cardTitle},state:{hidden:!1},attributes:{category:d}});a.MailAccountSettings=h},"MailSuite"),function(a){var b="group-settings",c={GROUP_SETTINGS:"group-settings"},d={cardItem:{title:{groupSettings:zmText.get("zm-settings-core","groups.cardItems.manageGroups")}}},e=a("Platform.Components"),f=a("Platform.Entities"),g=e.SettingCardItemManager,h=f.SettingCardItem,i=h.Types,j=function(a){setTimeout(function(){window.open(a)},0)},k={openGroupSettingsPage:function(){zmUtil.isNewGroupUser()?zmUtil.loadGroupManagement().then(function(){zmStreamsApp.GroupManageApp.init({groupManage:!0})}):j("/biz/groups.do")}},l=function(a,b){b=b||{},g.create(a,b)};l(c.GROUP_SETTINGS,{props:{loadFrameworkOnCommandExecution:!1,title:d.cardItem.title.groupSettings},attributes:{type:i.Action,card:b},primaryAction:function(){k.openGroupSettingsPage()}})}(zmail.Settings.Modules["import"]),_defineSettingsModule("AccountData",function(a,b){var c=b("Platform.System.Utils"),d={},e=zmail.Utils.DeferredCollection.create({keepDeferreds:!1}),f=function(a){var b=c.makeDeferred();return zmAjq.XHR({u:[zmail.conPath,"swAcc.do"].join("/"),p:{accId:a,mode:"json"},t:"post",fn:function(a){b.resolve({data:a})},efn:function(){b.reject()}}),b.promise()},g=function(a,b){b=b||{},b.refresh===!0&&(e.clear(a),d[a]=void 0,delete d[a]);var g=!e.has(a),h=e.get(a);return d[a]?h.resolve(c.copyProperties(d[a],{},!0)).promise():(g&&f(a).done(function(b){d[a]=b.data,h.resolve(c.copyProperties(d[a],{},!0))}).fail(function(){h.reject()}),h.promise())},h=function(a){return d[a]};a.getAccountData=g,a.getAccountDataSync=h},"MailSuite.Common"),_defineSettingsModule("External",function(a,b){var c=b("Platform.System.Utils"),d=function(){var a=$.Deferred(),b=function(){"resolved"!==a.state()&&a.resolve()};return setTimeout(b,3e3),zmApp.loadCalendarSettingsResources().done(b).fail(b),a.promise()},e=function(){var a=$.Deferred(),b=d();return $.when(b).done(function(){a.resolve()}).fail(function(){c.debugLog("_initializeExternalIntegrations - failed"),a.resolve()}),a.promise()};a.loadSettingsCore=function(){return e()}},"Platform");